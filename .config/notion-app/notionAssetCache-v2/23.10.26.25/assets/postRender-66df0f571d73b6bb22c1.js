"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[586],{80567:(e,t,i)=>{i.d(t,{a:()=>s});var a=i(19234),n=i(54642);async function s(e,t){const i=(0,a.gq)(t);if("skip"===i)return{valid:!0};if("insufficient_data"===i)return{valid:!1};const s=await(0,n.resolveAddress)(e,{address:{line1:t.addressLine1,city:t.city,zip:t.zipCode,state:t.state,country:t.country}});return"failed"===s.type?{valid:!1}:s.data}},95209:(e,t,i)=>{i.d(t,{zK:()=>g,Mr:()=>h,qg:()=>f,kL:()=>v,PV:()=>y,Vu:()=>S,jC:()=>M,XC:()=>b});i(73210),i(33948);var a=i(33728),n=i(27006),s=i(21202),o=i(75246),r=i(97880),l=i(76464),d=i(75472),c=i(65598),u=i(29677),m=i(50906),p=i(93678);const g=async e=>{const{environment:t,store:i,permissionsInviteStore:m,onInviteStart:p,contextualInviteStore:g,inviteOrigin:h}=e,{tokenQuery:f}=m.state;if((0,a.oH)(f.trim())&&(m.state.isInviteTargetsEmpty||!(0,u.ow)(m.state))){const e={type:"newUser",value:{email:f.trim()}};d.Nd({target:e,permissionsInviteStore:m})||m.setState({...m.state,inviteTargets:[...m.state.inviteTargets,e],isInviteTargetsEmpty:!1,tokenQuery:""})}if(!m.state.isInviteTargetsEmpty&&m.state.inviteTargets.length>0){null==p||p();const e=m.state;if((0,u.ow)(e)){if(e.table===s.iU){if(!(0,c.NZ)(i))throw new Error("Table mismatch.");const{inviteTargets:a,flowId:n,emailMessage:s}=e;m.reset();return(await l.n_({environment:t,store:i,inviteTargets:a,inviteRole:void 0,isOnboarding:!1,invite:{inviteFlowId:n,inviteMessage:s,inviteOrigin:h}})).success}if(e.table===o.bx){if(!(0,c.Mm)(i))throw new Error("Table mismatch.");const{inviteTargets:a,inviteRole:n,flowId:s}=e;m.reset();return(await l.n_({environment:t,store:i,inviteTargets:a,inviteRole:n,isOnboarding:!1,invite:{inviteFlowId:s,inviteOrigin:h}})).success}(0,r.t1)(e)}else{const{inviteTargets:a,inviteRole:s,flowId:o,emailMessage:r}=e;if(m.reset(),(0,n.iC)(s)){const e=await l.n_({environment:t,store:i,inviteTargets:a,inviteRole:s,isOnboarding:!1,invite:{inviteFlowId:o,inviteMessage:r,inviteOrigin:h}});return e.success&&(null==g||g.setState({...null==g?void 0:g.state,invitedEmailToUserIdMap:e.invitedUsers})),e.success}if((0,c.Y)(i)&&(0,u.Db)(e))return await l.GQ({environment:t,store:i,inviteTargets:e.inviteTargets,inviteRole:s,createNewTeamFlowId:o})}}return!0},h=e=>{e.permissionsInviteStore.setState({...e.permissionsInviteStore.state,modalOpen:!1,flowId:void 0})},f=async e=>{const{environment:t,store:i,permissionsInviteStore:a,contextualInviteStore:n,onInviteClick:s,onInviteComplete:o,inviteOrigin:r}=e;(e=>{const{permissionsInviteStore:t,contextualInviteStore:i}=e;if(!i)return;const a=[];t.state.inviteTargets.forEach((e=>{if("newUser"===e.type)a.push({email:e.value.email,isGuest:!0});else if("existingUser"===e.type){const t={...e.value,email:e.value.email,isGuest:"none"===e.spaceRole||"not_in_space"===e.spaceRole};a.push(t)}})),i.setState({...i.state,invitedUsers:a})})({permissionsInviteStore:a,contextualInviteStore:n});let l=!1;try{l=await g({environment:t,store:i,permissionsInviteStore:a,contextualInviteStore:n,onInviteStart:()=>{null==s||s()},inviteOrigin:r})}catch(d){}finally{null==o||o(l)}},v=async e=>{const{environment:t,permissionsInviteStore:i}=e;await d.Aw(t,i.state)||i.reset()},y=e=>{const{permissionsInviteStore:t,targetToRemove:i,defaultRoleForNonBot:a}=e;if(!t.state.isInviteTargetsEmpty)if((0,u.ow)(t.state))if((0,u.ow)(t.state)){const e=t.state.inviteTargets.filter((e=>e!==i));0===e.length?t.setState({...t.state,inviteTargets:[],inviteRole:a,isInviteTargetsEmpty:!0}):t.setState({...t.state,inviteTargets:e})}else(0,r.t1)(t.state);else{const e=t.state.inviteTargets.filter((e=>e!==i));0===e.length?t.setState({...t.state,inviteTargets:[],inviteRole:a,isInviteTargetsEmpty:!0}):t.setState({...t.state,inviteTargets:e})}},S=e=>{const{environment:t,onUpgradeButtonClick:i,upgradeButtonName:a}=e;p.y(t,{from:a,for:"team"}),null==i||i()},M=e=>{const t="invitee",{permissionsInviteStore:i,event:n}=e;if(!i.state.isInviteTargetsEmpty&&(0,u.ow)(i.state)){const e=n.target.value;i.setState({...i.state,inputFocus:t,tokenQuery:e})}else{const e=n.target.value,{extractedEmails:s,newInputValue:o}=(0,a.zI)(e),r=s.map((e=>({type:"newUser",value:{email:e}}))).filter((e=>!d.Nd({target:e,permissionsInviteStore:i}))),l=[...i.state.inviteTargets,...r];l.length>0?i.setState({...i.state,inviteTargets:l,isInviteTargetsEmpty:!1,inputFocus:t,tokenQuery:o}):i.setState({...i.state,inviteTargets:[],isInviteTargetsEmpty:!0,inputFocus:t,tokenQuery:o})}},b=e=>{const{environment:t,newRole:i,permissionsInviteStore:a}=e,{state:n}=a;m.trackInviteChangeRole(t,{...d.a_(t,n),invite_updated_role:i}),!n.isInviteTargetsEmpty&&(0,u.ow)(n)||a.setState({...n,inviteRole:i})}},4054:(e,t,i)=>{i.r(t),i.d(t,{default:()=>kr});var a=i(77094),n=i.n(a),s=i(67294),o=i.n(s),r=i(83355),l=i(23537),d=i(27832),c=i(19671),u=i(13023),m=i(41464),p=i(77422),g=i.n(p),h=(i(33948),i(54564)),f=i(10663),v=i(45094),y=i(24229),S=i(21202),M=i(5366),b=i(78089),w=i(65598),C=i(77704),T=i(97543),k=i(69972),Z=i(72704),A=i(89206),I=i(71202),P=i(15282),_=i(37064),x=i(66957),F=i(80172);const B=[y.u.Open,y.u.Resolved];class E extends r.Z{constructor(){super(...arguments),g()(this,"deepDiscussionsStores",this.createComputedStore((()=>{const{discussionIds:e}=this.props,{blockStore:t,recursivelyLoadAllDiscussions:i}=this.props;return w.al(t,{recursivelyLoadAllDiscussions:i}).filter((t=>!e||e.includes(t.id)||(0,b.De)(t)))}))),g()(this,"handleChangeTab",(e=>{const t=y.Z.state;t.open&&y.Z.setState({...t,tab:B[e]})})),g()(this,"handleBackspace",(e=>{null==e||e.preventDefault(),h.LZ()}))}renderComponent(){if((0,v.Sx)(this.environment))return null;const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:I.Z.MenuType.Modal,title:n()(M.FormattedMessage,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:this.renderMenuHeader(),right:n()(P.DoneMenuText,{}),onClickRight:h.LZ,whiteBackground:!0}:{menuType:I.Z.MenuType.Popup,header:this.renderMenuHeader(),width:480,maxHeight:"50vh",onClickOutside:h.LZ},n()(Z.Z,{capture:!0,preventType:F.Z.All},void 0,n()(k.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>n()(A.Z,{capture:!0,onEsc:h.LZ,onBackspace:this.handleBackspace,onDelete:this.handleBackspace},void 0,n()(_.Z,{store:this.props.blockStore,droppable:!0,render:()=>o().createElement(I.Z,t,this.renderMenuContent())},this.props.blockStore.id))}))}renderMenuHeader(){const{device:e}=this.environment,{resolved:t,unresolved:i}=w.bB(this.deepDiscussionsStores.state),a=i.length,s=t.length;return 0===s||0===a?null:n()(x.Z,{tabs:[n()(M.FormattedMessage,{defaultMessage:"Open ({numberOfOpenDiscussions})",id:"blockDiscussionMenu.openDiscussionsTab.title",values:{numberOfOpenDiscussions:a}}),n()(M.FormattedMessage,{defaultMessage:"Resolved ({numberOfResolvedDiscussions})",id:"blockDiscussionMenu.resolvedDiscussionsTab.title",values:{numberOfResolvedDiscussions:s}})],selectedIndex:B.indexOf(this.props.tab),onChange:this.handleChangeTab,style:{...e.isAndroid&&{borderBottom:"none"}}})}renderMenuContent(){const{device:e}=this.environment,{resolved:t,unresolved:i}=w.bB(this.deepDiscussionsStores.state);if(this.props.tab===y.u.Open){if(i.length){const t=i.map(((e,t,i)=>n()(T.Z,{store:e,format:b.O2.Menu,isFirst:0===t,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:this.props.blockStore,onDismiss:h.LZ},e.id))),a=this.props.blockStore.getType(),o=a&&S.p2[a];if(e.isMobile&&o){const e=C.h(this.props.blockStore);return e?n()(s.Fragment,{},void 0,n()("div",{style:{padding:"12px 16px",boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor),marginBottom:1}},void 0,n()(e,{store:this.props.blockStore,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})),t):t}return t}return this.renderEmptyState(n()(M.FormattedMessage,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"}))}return t.length?t.map(((e,t,i)=>n()(T.Z,{store:e,format:b.O2.Menu,isFirst:0===t,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:this.props.blockStore,onDismiss:h.LZ},e.id))):this.renderEmptyState(n()(M.FormattedMessage,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"}))}renderEmptyState(e){const{device:t}=this.environment;return n()("div",{style:{textAlign:"center",padding:t.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:this.theme.mediumTextColor}},void 0,e)}}const D=E;var R=i(66722);class L extends r.Z{constructor(){super(...arguments),g()(this,"renderDiscussionMenu",(()=>{if(y.Z.state.open&&!(0,v.Sx)(this.environment))return n()(D,{rect:y.Z.state.rect,tab:y.Z.state.tab,blockStore:y.Z.state.blockStore,discussionIds:y.Z.state.discussionIds,recursivelyLoadAllDiscussions:y.Z.state.recursivelyLoadAllDiscussions})}))}renderComponent(){const{device:e}=this.environment,{rect:t}=y.Z.state,i=!(0,v.Sx)(this.environment)&&y.Z.state.open&&!(0,f.az)(this.environment,y.Z.state.blockStore);return n()(R.ZP,{popupType:e.isMobile?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:i,originRect:t,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Center,disableMouseCapture:!0,originGap:4,render:this.renderDiscussionMenu,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:h.LZ})}}const O=L;var N=i(96486),U=i.n(N),W=i(29369),V=i(50906),z=i(6404),G=i(33665),H=i(35328),q=i(8949),K=i(20431),j=i(27724),Y=i(52858),Q=i(13713),J=i(80209),X=i(83182),$=i(73581),ee=i(83071);class te extends r.Z{constructor(){super(...arguments),g()(this,"renderOverlay",(()=>{const{device:e}=this.environment,t=q.Z.state;if(!t.isActive)return;const{originBlockRect:i,actions:a,inputValue:s,publicEditMode:r}=t,l={environment:this.environment,blocks:t.stores,originRect:i,publicEditMode:r},d=t.showInput&&this.renderInputSection(),c=t.stores[0];let u;return u=e.isPhone?{menuType:I.Z.MenuType.Modal,title:n()(M.FormattedMessage,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:n()(P.DoneMenuText,{}),onClickRight:this.handleOverlayBgClick,header:d}:e.isNative?{menuType:I.Z.MenuType.Popup,width:265,header:d}:{menuType:I.Z.MenuType.Popup,width:245,header:d},n()(A.Z,{capture:!0,onBackspace:U().identity},void 0,o().createElement(I.Z,u,n()(Y.Z,{filter:s,context:l,sections:a,onAccept:this.handleAccept,initialFocus:s?0:void 0}),!s&&this.renderBlockAuthorInfo(),!s&&n()(J.Z,{store:c}),!s&&c.isCollectionView()&&this.renderCollectionHelpButton()))})),g()(this,"handleOverlayBgClick",(()=>{z.xv()})),g()(this,"handleAccept",(e=>{const t=q.Z.state;if(!t.isActive)return;const{stores:i}=j.default.state,{analyticsFrom:a}=t,n=i[0];if(n){const t=n.getValue();if(t){let i;if(t.parent_table===W.e0){const{currentSpaceStore:e}=d.default.getState();e&&(i=K.Z.createChildStore(e,{table:W.e0,id:t.parent_id}))}V.trackBlockAction(this.environment,{analyticsName:e.analyticsName,from:a,block_type:t.type,parentTeamStore:i,is_toggleable:(0,H._A)(t.type,t.format)})}}e.closeParentMenu&&z.xv()})),g()(this,"handleInputChange",(e=>{q.Z.state.isActive&&q.Z.setState({...q.Z.state,inputValue:e.target.value})}))}renderComponent(){const{device:e}=this.environment,t=q.Z.state;return n()(R.ZP,{popupType:e.isPhone?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:this.handleOverlayBgClick,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Start,originGap:0,preventScaleTransition:!0,render:this.renderOverlay,preventBlockRenderQueueOnEnter:e.isMobile})}renderBlockAuthorInfo(){const e=q.Z.state;if(e.isActive&&!(e.stores.length>1))return n()(Q.Z,{store:e.stores[0],isPageMoreButton:!1})}renderInputSection(){const{device:e}=this.environment,{intl:t}=this.props,i=q.Z.state;if(!i.isActive||e.isPhone)return;const{inputValue:a}=i;return n()(ee.Z,{isInput:!0},void 0,n()($.Z,{value:a,onChange:this.handleInputChange,focus:!0,focusAfterAnimation:!0,placeholder:t.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0}))}renderCollectionHelpButton(){return n()(ee.Z,{topBorder:!0},void 0,n()(X.Z,{title:n()(M.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,G.UY)("guides.database"),analyticsFrom:"block_menu"}))}}const ie=(0,M.injectIntl)(te);var ae=i(97464),ne=i.n(ae),se=i(62965),oe=i(79554),re=i(43250),le=i(33929),de=i(61207),ce=i(48762),ue=i(25584);const me=(0,M.defineMessages)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"}});class pe extends r.Z{constructor(){super(...arguments),g()(this,"renderMenu",(()=>{const{device:e}=this.environment,t=de.Z.state;if(!t.open)return;const i=this.getSections(t);let a;return a=e.isMobile?{menuType:I.Z.MenuType.ActionSheet}:{menuType:I.Z.MenuType.Popup,width:320,maxHeight:"40vh"},o().createElement(I.Z,ne()({},a,{className:re.sr}),n()(ue.Z,{type:ue.Z.Type.Vertical,sections:i,initialFocus:0}))})),g()(this,"handleDismiss",(()=>{oe.xv()}))}willMountOrUpdate(){const e=de.Z.state;if(e.open){const{stores:t,phase:i}=j.default.state;(0,se.Z)(t,e.blocks)&&i===j.SelectionPhase.Selected||oe.xv()}}renderComponent(){const{device:e}=this.environment,t=de.Z.state;return n()(R.ZP,{popupType:e.isMobileNative&&!e.isTablet?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.rect:void 0,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDismiss})}getSections(e){const{blocks:t}=e,i=[];if("blocks"===e.type){const{copiedStores:a,pageSource:n}=e;oe.H8({blocks:t,copiedStores:a})&&i.push({name:le.default.formatMessage(me.createTransclusion),action:async()=>{await oe.ry({environment:this.environment,blocks:t,copiedBlockIds:a.map((e=>e.id))})}}),oe.wK({blocks:t})&&i.push({name:le.default.formatMessage(me.linkToPage),action:async()=>oe.Dq({environment:this.environment,blocks:t,source:{type:"blocks",copiedStores:a,pageSource:n}})})}"links"===e.type&&i.push({name:le.default.formatMessage(me.linkToPage),action:async()=>oe.Dq({environment:this.environment,blocks:t,source:{type:"links",copiedLinks:e.copiedLinks}})});return[{key:"embed section",render:e=>o().createElement(ee.Z,e),items:[{key:"dismiss",render:e=>o().createElement(ce.Z,ne()({},e,{title:le.default.formatMessage(me.dismissItem)})),action:this.handleDismiss},...i.map((e=>{let{name:t,action:i}=e;return{key:"embed ".concat(t),render:e=>o().createElement(ce.Z,ne()({},e,{title:t})),action:i}}))]}]}}const ge=pe;var he=i(98308),fe=i(87143),ve=i(62727),ye=i(46951);class Se extends r.Z{constructor(){super(...arguments),g()(this,"handleOverlayBgClick",(e=>{fe.Z.setState({...fe.Z.state,active:!1,stringValue:""})}))}renderComponent(){const{device:e}=this.environment,{active:t,stringValue:i}=fe.Z.state,a=window.innerWidth/2-150,s=window.innerHeight/2;return n()(R.ZP,{popupType:e.isMobileNative?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:t,originRect:{top:s,left:a},onDismiss:this.handleOverlayBgClick,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Start,originGap:0,render:()=>n()(A.Z,{capture:!0,onEnter:U().identity,onCommandEnter:U().identity,onCommandShiftEnter:U().identity,onCommandSlash:U().identity,onDelete:U().identity,onBackspace:U().identity,onEsc:U().identity,onLeft:U().identity,onRight:U().identity,onUntab:U().identity,onTab:U().identity,onSelectAll:U().identity,onRedo:U().identity,onUndo:U().identity,onToggleBold:U().identity,onToggleItalics:U().identity,onToggleStrike:U().identity,onToggleCode:U().identity,onCut:U().identity,onCopy:U().identity,onPaste:U().identity,onKeypress:U().identity},void 0,n()("div",{style:{padding:8,width:300}},void 0,n()(ve.Z,{style:{width:"100%",fontSize:12},value:i,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),n()(ye.Z,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"}},void 0,n()(M.FormattedMessage,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"}))))})}}const Me=Se;var be=i(480),we=i(28350),Ce=i(24405),Te=i(7476),ke=i(13884),Ze=i(73935),Ae=i.n(Ze),Ie=i(29566);class Pe extends Ie.Z{}const _e=new Pe;var xe=i(49085);class Fe extends xe.Z{getInitialState(){return{}}}const Be=Fe;class Ee extends r.Z{constructor(){super(...arguments),g()(this,"storeTypes",{store:Be}),g()(this,"rootNode",void 0),g()(this,"observer",void 0),g()(this,"handleMutation",(()=>{if(this.rootNode){const e=this.rootNode.getBoundingClientRect();this.stores.store.setState({rect:e})}}))}get registries(){return[_e]}didMount(){this.props.capture&&this.startListeners()}willUpdate(e){e.capture&&!this.props.capture?this.startListeners():!e.capture&&this.props.capture&&this.stopListeners()}willUnmount(){this.stopListeners()}startListeners(){const e=Ae().findDOMNode(this);e&&(this.rootNode=e,this.observer=new MutationObserver(this.handleMutation),this.observer.observe(this.rootNode,{attributes:!0,subtree:!0}))}stopListeners(){this.observer&&(this.observer.disconnect(),this.rootNode=void 0,this.observer=void 0)}renderComponent(){return o().Children.only(this.props.children)}}const De=Ee;var Re=i(56952);const Le=function(){const e=(0,be.O7)(),{device:t,WindowSizeStore:i}=e,a=(0,we.VK)((()=>ke.Z.state.rect),[]),s=(0,we.VK)((()=>{if(ke.Z.state.open){const{blockStore:t,discussionInputStore:i}=ke.Z.state;return{blockStore:t,discussionInputStore:i,canMarginCommentsRender:(0,f.az)(e,t)}}return null}),[e]),o=(0,we.VK)((()=>({paddingLeft:t.isMobileNative?i.getSafePaddingLeftCSS(10):10,paddingRight:t.isMobileNative?i.getSafePaddingRightCSS(10):10})),[i,t.isMobileNative]),r=(0,Ce.y)((()=>({inputWrapper:{width:t.isMobileNative?"100%":470,maxWidth:t.isMobileBrowser?"90vw":"100%",paddingTop:8,paddingBottom:t.isAndroid?12:8,paddingLeft:o.paddingLeft,paddingRight:o.paddingRight}})),[t,o]),l=()=>{Te.ZL(e)},d=()=>{s&&Te.uK(s.discussionInputStore,e)};return null!=s&&s.canMarginCommentsRender?null:n()(R.ZP,{popupType:t.isMobileNative?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,keepFocus:!0,open:null!==s,originRect:a,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Center,originGap:4,onDismiss:d,render:()=>{if(s){const{blockStore:e,discussionInputStore:t}=s;return n()(De,{capture:!0},void 0,n()(k.Z,{capture:!0,allowOpenLinkMenu:!0,render:()=>n()(_.Z,{store:e,droppable:!0,render:()=>n()("div",{style:r.inputWrapper},void 0,n()(Re.Z,{showAvatar:!0,parentStore:e,onCancel:d,onSubmit:l,discussionInputStore:t,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:b.O2.Page,blockStore:e,canDrop:!0}))},e.id)}))}}})};i(15306),i(73210);var Oe=i(51454),Ne=i(86080),Ue=i(47307),We=i(81700),Ve=i(15102),ze=i(47966);class Ge extends r.Z{constructor(){super(...arguments),g()(this,"lastOpenState",void 0),g()(this,"renderModal",(()=>{if(!this.lastOpenState)return;const{acceptLabel:e,requiredInputValue:t}=this.lastOpenState,i=[{key:"accept",render:t=>o().createElement(ze.Z,ne()({isRed:!0,isLarge:!0,style:Ge.buttonStyle,hovered:t.focused},t),e),action:this.handleAccept},{key:"cancel",render:e=>o().createElement(ze.Z,ne()({isLarge:!0,style:Ge.buttonStyle,hovered:e.focused},e),n()(M.FormattedMessage,{id:"confirmationInputDialog.cancelButton.label",defaultMessage:"Cancel"})),action:this.handleCancel}];return n()(Z.Z,{capture:!0,preventType:F.Z.All},void 0,n()("div",{},void 0,n()("div",{style:{minHeight:64,display:"flex",alignItems:"center",justifyContent:"center",marginBottom:16}},void 0,this.lastOpenState.message),n()(A.Z,{capture:!0,onLeft:U().identity,onRight:U().identity,onSelectAll:U().identity,onRedo:U().identity,onUndo:U().identity,onToggleBold:U().identity,onToggleItalics:U().identity,onToggleCode:U().identity,onCut:U().identity,onCopy:U().identity,onPaste:U().identity,onKeypress:U().identity,onDelete:U().identity,onBackspace:U().identity},void 0,n()(ve.Z,{value:this.lastOpenState.inputValue,onChange:this.handleInputChange,style:{height:38,marginBottom:2},placeholder:t})),n()(ue.Z,{type:ue.Z.Type.Vertical,initialFocus:void 0,sections:[{key:"dialog",render:e=>o().createElement(ee.Z,e),items:i}]})))})),g()(this,"handleAccept",(()=>{const e=We.Z.state;e.open&&(this.cleanAcceptInput(e.inputValue)===this.cleanAcceptInput(e.requiredInputValue)?Ne.x({didConfirm:!0}):Ue.showErrorMessage(n()(M.FormattedMessage,{id:"confirmDialogInput.incorrectInputError.message",defaultMessage:'Please type "{requiredInputValue}" to continue',values:{requiredInputValue:e.requiredInputValue}})))})),g()(this,"cleanAcceptInput",(e=>e.trim().toLowerCase().replace(/’/g,"'"))),g()(this,"handleCancel",(()=>{Ne.x({didConfirm:!1})})),g()(this,"handleInputChange",(e=>{const t=We.Z.state;t.open&&We.Z.setState({...t,inputValue:e.target.value})}))}renderComponent(){const e=We.Z.state;return e.open&&(this.lastOpenState={...e}),n()(Ve.Z,{open:e.open,keepFocus:!0,overlayZIndex:Oe.Wd,onDismiss:this.handleCancel,preventHideChildrenWhileOpening:!0,innerStyle:{borderRadius:3,paddingTop:24,paddingBottom:16,paddingLeft:32,paddingRight:32,width:this.lastOpenState&&this.lastOpenState.width||336,fontSize:16,boxShadow:this.theme.largeBoxShadow,background:this.theme.modalBackground,maxHeight:"90vh",overflowY:"scroll",marginLeft:24,marginRight:24},render:this.renderModal})}}g()(Ge,"buttonStyle",{width:"100%",marginTop:16});const He=Ge;var qe=i(70203),Ke=i(67133),je=i(9953),Ye=i(93561),Qe=i(28020),Je=i(77907),Xe=i(28748);class $e extends r.Z{constructor(){super(...arguments),g()(this,"handleChangeValue",(e=>{if(!e)return void this.removeDateAnnotation();const t=this.getEverythingIWant();if(!t)return;const{date_format:i,time_format:a}=t;this.setDateAnnotationData({date_format:i,time_format:a,...e})})),g()(this,"handleChangeDateFormat",(e=>{const t=this.getEverythingIWant();if(!t)return;const{dateValue:i,time_format:a}=t;this.setDateAnnotationData({date_format:e,time_format:a,...i})})),g()(this,"handleChangeTimeFormat",(e=>{const t=this.getEverythingIWant();if(!t)return;const{dateValue:i,date_format:a}=t;this.setDateAnnotationData({date_format:a,time_format:e,...i})})),g()(this,"setDateAnnotationData",(e=>{const t=this.getEverythingIWant();if(!t)return;const{textStore:i,textValue:a,tokenIndex:n,annotations:s}=t,o=a.map(((t,i)=>{if(i===n){const i=s.map((t=>qe.fp(t)?["d",e]:t));return qe.V3(t[0],i)}return t}));Ye.createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:this.environment,perform:e=>{je.sO({store:i,value:o,transaction:e})}})})),g()(this,"removeDateAnnotation",(()=>{const e=this.getEverythingIWant();if(!e)return;const{textStore:t,textValue:i,tokenIndex:a}=e,n=i.filter(((e,t)=>t!==a));Ye.createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:this.environment,perform:e=>{je.sO({store:t,value:n,transaction:e})}})}))}renderComponent(){const{device:e}=this.environment,t=Xe.Z.state;return n()(R.ZP,{popupType:e.isMobile?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:t.open,originRect:t.originRect,onDismiss:Ke.x,render:()=>{const e=this.getEverythingIWant();if(!e)return null;const{date_format:i,time_format:a,dateValue:s}=e;return n()(Je.DependencyConsumer,{dependency:Je.deps.menus},void 0,(e=>{let{DatePropertyMenu:o}=e;return n()(o,{firstDayOfWeek:Qe.AK.state,value:s,canConfigureCollection:!0,onChangeValue:this.handleChangeValue,dateFormat:i,onChangeDateFormat:this.handleChangeDateFormat,timeFormat:a,onChangeTimeFormat:this.handleChangeTimeFormat,onDismiss:Ke.x,disabled:!1,shouldShowReminder:!!t.open&&t.allowReminders,allowTabUntab:!1})}))}})}getEverythingIWant(){const e=Xe.Z.state;if(e.open){const{textStore:t,tokenIndex:i}=e,a=t.getValue();if(a){const e=a[i];if(e){const n=qe.hD(e),s=qe.K9(n);if(s){const{date_format:o,time_format:r,...l}=qe.Ot(s);return{textStore:t,textValue:a,tokenIndex:i,token:e,annotations:n,date_format:o,time_format:r,dateValue:l}}}}}}}const et=$e;var tt=i(55367),it=i(34041),at=i(27431);class nt extends r.Z{constructor(){super(...arguments),g()(this,"renderGhost",(()=>{const e=tt.ZP.state;if(!e.isDragging)return;const t=e.draggedStores.map(((t,i)=>n()(it.Z,{store:t,ghostElement:e.ghostElements[i]},"".concat(i))));return n()("div",{style:this.getGhostStyle()},void 0,t)})),g()(this,"isDragging",this.createComputedStore((()=>tt.ZP.state.isDragging)))}renderComponent(){return n()(at.Z,{open:this.isDragging.state,render:this.renderGhost})}getGhostStyle(){const e=tt.ZP.state;if(!e.isDragging)return;const{startX:t,startY:i,currentX:a,currentY:n}=e,s=n-i;return{position:"absolute",top:0,left:0,transform:"translate3d(".concat(a-t,"px, ").concat(s,"px, 0)")}}}const st=nt;var ot=i(1302),rt=i(84908),lt=i(98104),dt=i(68056),ct=i(80935),ut=i(81212);class mt extends xe.Z{getInitialState(){return{open:!1}}}const pt=new mt;var gt=i(24666),ht=i(58945),ft=i(56109);class vt extends r.Z{constructor(){super(...arguments),g()(this,"handleContextMenu",((e,t)=>{if(e.preventDefault(),t.misspelledWord){const e=gt.default.state,i="editing"===e.mode&&(0,dt.QY)(e.multiSelection);if(i&&i.selection.startIndex===i.selection.endIndex){const e=qe.Oq(i.store.getValue()||[],t.misspelledWord),a=i.selection.startIndex,n=qe.PE(e,a);n&&lt.Z5({store:i.store,selection:n})}}pt.setState({open:!0,menuInfo:t})})),g()(this,"handleDismiss",(()=>{pt.setState({...pt.state,open:!1})}))}willMount(){rt.electronApi&&rt.electronApi.contextMenu&&rt.electronApi.contextMenu.addListener(this.handleContextMenu)}willUnmount(){rt.electronApi&&rt.electronApi.contextMenu&&rt.electronApi.contextMenu.removeListener(this.handleContextMenu)}renderComponent(){const{menuInfo:e,open:t}=pt.state,{device:i}=this.environment,{x:a,y:s}=this.getClickPosition(e),o=new DOMRect(a,s,0,0),r=e?this.getMenuSections(e):[],l=document.activeElement,d=ct.get();let c=null,u=null;(l instanceof HTMLInputElement||l instanceof HTMLTextAreaElement)&&(c=l.selectionStart,u=l.selectionEnd);for(const n of r)for(const e of n.items){const t=e.action;e.action=e=>{l.focus(),l instanceof HTMLInputElement||l instanceof HTMLTextAreaElement?(l.selectionStart=c,l.selectionEnd=u):d&&ct.set(d,i),ot.default.afterNextFlush((()=>{t(e)}))}}return n()(R.ZP,{open:t&&r.length>0,popupType:R.ZP.PopupType.Popup,originRect:o,render:()=>n()(ft.Z,{capture:!0,allowEsc:!0},void 0,n()(I.Z,{menuType:I.Z.MenuType.Popup},void 0,n()(ue.Z,{type:ue.Z.Type.Vertical,sections:r,initialFocus:void 0,onAccept:this.handleDismiss}))),onDismiss:this.handleDismiss,overlayContainerStore:ut.Z})}getClickPosition(e){const t=(0,rt.getCurrentZoom)();return{x:e?e.x/t:0,y:e?e.y/t:0}}getMenuSections(e){const t=[],i=this.getSpellingCorrectionItems(e);if(i.length>0){const e=t.length>0;t.push({key:"spellingCorrectionItems",items:i,render:t=>o().createElement(ee.Z,ne()({},t,{topBorder:e}))})}const a=this.getDisableSpellCheckItems(e);if(a.length>0){const e=t.length>0;t.push({key:"disableSpellCheckItems",items:a,render:t=>o().createElement(ee.Z,ne()({},t,{topBorder:e}))})}const n=this.getSearchItems(e);if(n.length>0){const e=t.length>0;t.push({key:"searchItems",items:n,render:t=>o().createElement(ee.Z,ne()({},t,{topBorder:e}))})}const s=this.getLinkMenuItems(e);if(s.length>0){const e=t.length>0;t.push({key:"linkMenuItems",items:s,render:t=>o().createElement(ee.Z,ne()({},t,{topBorder:e}))})}const r=this.getImageMenuItems(e);if(r.length>0){const e=t.length>0;t.push({key:"imageMenuItems",items:r,render:t=>o().createElement(ee.Z,ne()({},t,{topBorder:e}))})}const l=this.getTextEditingItems(e);if(l.length>0){const e=t.length>0;t.push({key:"textEditingItems",items:l,render:t=>o().createElement(ee.Z,ne()({},t,{topBorder:e}))})}const d=this.getEnableSpellCheckItem(e);if(d.length>0){const e=t.length>0;t.push({key:"enableSpellCheckItems",items:d,render:t=>o().createElement(ee.Z,ne()({},t,{topBorder:e}))})}return t}getLinkMenuItems(e){const t=[];return e.linkURL&&e.linkURL.length>0&&(e.linkURL.startsWith("mailto:")?t.push({key:"copy-email",action:()=>{rt.electronApi&&rt.electronApi.copyText&&rt.electronApi&&rt.electronApi.copyText(e.linkText)},render:e=>o().createElement(ce.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"Copy email address",id:"desktop.rightClickMenu.copyEmailAddress"})}))}):t.push({key:"copy-link",action:()=>{rt.electronApi&&rt.electronApi.copyText&&rt.electronApi&&rt.electronApi.copyText(e.linkURL)},render:e=>o().createElement(ce.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"Copy link",id:"desktop.rightClickMenu.copyLink"})}))}),t.push({key:"open-link",action:()=>{rt.electronApi&&rt.electronApi.openExternalUrl(e.linkURL)},render:e=>o().createElement(ce.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"Open link",id:"desktop.rightClickMenu.openLink"})}))})),t}getImageMenuItems(e){const t=[];return e.hasImageContents&&e.srcURL&&e.srcURL.length>0&&(t.push({key:"copy-image",action:()=>{rt.electronApi&&rt.electronApi.copyImage&&rt.electronApi.copyImage(e.srcURL)},render:e=>o().createElement(ce.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"Copy image",id:"desktop.rightClickMenu.copyImage"})}))}),t.push({key:"copy-image-address",action:()=>{rt.electronApi&&rt.electronApi.copyText&&rt.electronApi.copyText(e.srcURL)},render:e=>o().createElement(ce.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"Copy image address",id:"desktop.rightClickMenu.copyImageAddress"})}))})),t}isEditing(e){return e.isEditable||e.inputFieldType&&"none"!==e.inputFieldType}hasMisspelling(e){return this.isEditing(e)&&e.misspelledWord&&e.misspelledWord.length>0}getSpellingCorrectionItems(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,i=[];if(this.hasMisspelling(e)&&t&&t.isEnabled()){const a=t.getCorrections(e);for(const e of a)i.push({key:e,action:()=>{rt.electronApi&&rt.electronApi.replaceMisspelling&&rt.electronApi.replaceMisspelling(e)},render:t=>o().createElement(ce.Z,ne()({},t,{title:e}))})}return i}getDisableSpellCheckItems(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,i=[];return this.hasMisspelling(e)&&t&&t.isEnabled()&&i.push({key:"disable",action:()=>{t.setEnabled(!1)},render:e=>o().createElement(ce.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"Disable spell check",id:"desktop.spellcheckMenuItem.disableSpellcheck.title"})}))}),i}getEnableSpellCheckItem(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,i=[];return this.isEditing(e)&&t&&!t.isEnabled()&&i.push({key:"enable",action:()=>{t.setEnabled(!0)},render:e=>o().createElement(ce.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"Enable spell check",id:"desktop.spellcheckMenuItem.enableSpellcheck.title"})}))}),i}getSearchItems(e){const t=[];return e.selectionText&&e.selectionText.length>0&&t.push({key:"google",action:()=>{if(rt.electronApi){const t="https://www.google.com/search?q=".concat(encodeURIComponent(e.selectionText.trim()));rt.electronApi.openExternalUrl(t)}},render:e=>o().createElement(ce.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"Search with Google",id:"desktop.searchMenuItem.searchWithGoogle.title"})}))}),t}getTextEditingItems(e){const t=[];return this.isEditing(e)&&(e.editFlags.canCut&&t.push({key:"cut",action:()=>{rt.electronApi&&rt.electronApi.cut&&rt.electronApi.cut()},render:e=>o().createElement(ht.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"Cut",id:"desktop.textEditingMenuItem.cutAction.title"}),shortcuts:["cut"]}))}),e.editFlags.canCopy&&t.push({key:"copy",action:()=>{rt.electronApi&&rt.electronApi.copy&&rt.electronApi.copy()},render:e=>o().createElement(ht.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"Copy",id:"desktop.textEditingMenuItem.copyAction.title"}),shortcuts:["copy"]}))}),e.editFlags.canPaste&&t.push({key:"paste",action:()=>{rt.electronApi&&rt.electronApi.paste&&rt.electronApi.paste()},render:e=>o().createElement(ht.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"Paste",id:"desktop.textEditingMenuItem.pasteAction.title"}),shortcuts:["paste"]}))})),t}}const yt=vt;var St=i(41432),Mt=i(95538),bt=i(74335),wt=i(63143),Ct=i(89951),Tt=i(95477),kt=i(64233),Zt=i(80270);const At=(0,M.defineMessages)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Map",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Create embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"}}),It=(0,M.defineMessages)({linkToPage:{defaultMessage:"Link to page",id:"embedMenu.actions.linkToPage.title"},mentionPage:{defaultMessage:"Mention page",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention block",id:"embedMenu.actions.mentionBlock.title",description:"Mention a non-page block"},createLinkedDatabase:{defaultMessage:"Create linked database",id:"embedMenu.actions.createLinkedDatabase.title"},createLinkedViewOfDatabase:{defaultMessage:"Create linked view of database",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Create bookmark",id:"embedMenu.actions.createBookmark.title"},createTransclusionItem:{defaultMessage:"Paste and sync",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"Dismiss",id:"embedMenu.actions.dismiss.title"}}),Pt={image:le.default.formatMessage(At.image),video:le.default.formatMessage(At.video),tweet:le.default.formatMessage(At.tweet),drive:le.default.formatMessage(At.drive),gist:le.default.formatMessage(At.gist),figma:le.default.formatMessage(At.figma),invision:le.default.formatMessage(At.invision),abstract:le.default.formatMessage(At.abstract),framer:le.default.formatMessage(At.framer),whimsical:le.default.formatMessage(At.whimsical),miro:le.default.formatMessage(At.miro),sketch:le.default.formatMessage(At.sketch),excalidraw:le.default.formatMessage(At.excalidraw),replit:le.default.formatMessage(At.replit),audio:le.default.formatMessage(At.audio),maps:le.default.formatMessage(At.maps),loom:le.default.formatMessage(At.loom),typeform:le.default.formatMessage(At.typeform),codepen:le.default.formatMessage(At.codepen),pdf:le.default.formatMessage(At.pdf),embed:le.default.formatMessage(At.embed),hex:le.default.formatMessage(At.hex),deepnote:le.default.formatMessage(At.deepnote)};class _t extends r.Z{constructor(){super(...arguments),g()(this,"renderMenu",(()=>{const{device:e}=this.environment,t=kt.Z.state;if(!t.open)return;const i=this.getSections(t);let a;return a=e.isMobile?{menuType:I.Z.MenuType.ActionSheet}:{menuType:I.Z.MenuType.Popup,width:320,maxHeight:"40vh"},o().createElement(I.Z,ne()({},a,{className:re.sr}),n()(ue.Z,{type:ue.Z.Type.Vertical,sections:i,initialFocus:0}))})),g()(this,"handleDismiss",(()=>{Ct.xv()})),g()(this,"handleAccept",(e=>{Ct.RL({environment:this.environment,type:e})}))}willMountOrUpdate(){const e=kt.Z.state;if(e.open){const t=gt.default.state;if("editing"===t.mode){const{multiSelection:i}=t;(0,dt.qS)(i)&&i.start.store.id===e.textStore.id&&i.end.index===e.urlSelection.endIndex||Ct.xv()}}}renderComponent(){const{device:e}=this.environment,t=kt.Z.state;return n()(R.ZP,{popupType:e.isMobileNative&&!e.isTablet?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDismiss})}isInCollection(e){const t=e.getRecordStoreAtRootPath();return(0,w.NZ)(t)&&void 0!==Zt.Z.fromRecordStore(t).getParentCollectionStore()}getSections(e){const{device:t}=this.environment,{url:i,textStore:a}=e,n=[],s=(0,bt.Wj)({url:i,baseUrl:Tt.Z.domainBaseUrl,publicDomainName:Tt.Z.publicDomainName,isMobile:t.isMobile,protocol:Tt.Z.protocol,currentUrl:window.location.href});if("page"===s.name){const e=Zt.Z.createChildStore(a,{table:S.iU,id:s.blockId}),t=s.scrollToBlockId?Zt.Z.createChildStore(a,{table:S.iU,id:s.scrollToBlockId}):void 0;n.push({name:le.default.formatMessage(It.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!this.isInCollection(a),type:St.ZP.collectionView}),n.push({name:le.default.formatMessage(It.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!this.isInCollection(a)),type:"create-transclusion"}),n.push({name:le.default.formatMessage(void 0===t?It.mentionPage:It.mentionBlock),validator:()=>!0,type:"mention-page"}),n.push({name:le.default.formatMessage(It.linkToPage),validator:()=>!t&&!e.isCollectionView()&&!this.isInCollection(a),type:St.ZP.page})}const r=wt.XP(Pt);for(const o of r)"embed"!==o&&n.push({name:Pt[o],validator:Mt.Wb[o],type:o});n.push({name:le.default.formatMessage(It.bookmarkMenuItem),validator:Mt.Cm,type:St.ZP.bookmark}),n.push({name:Pt.embed,validator:Mt.Wb.embed,type:"embed"});return[{key:"embed section",render:e=>o().createElement(ee.Z,e),items:[{key:"dismiss",render:e=>o().createElement(ce.Z,ne()({},e,{title:le.default.formatMessage(It.dismissItem)})),action:this.handleDismiss},...U().compact(n.map((e=>{let{name:t,validator:a,type:n}=e;if(a({url:i,baseUrl:Tt.Z.domainBaseUrl,publicDomainName:Tt.Z.publicDomainName})){return{key:"embed ".concat(t),render:e=>o().createElement(ce.Z,ne()({},e,{title:t})),action:()=>this.handleAccept(n)}}})))]}]}}const xt=_t;var Ft=i(4727),Bt=i(31352),Et=i(88833),Dt=i(1994);class Rt extends r.Z{constructor(){super(...arguments),g()(this,"renderMenu",(()=>{const{device:e}=this.environment,t=Et.Z.state;if(!t.open)return;let i;return i=e.isMobileNative&&!e.isTablet?{menuType:I.Z.MenuType.ActionSheet}:{menuType:I.Z.MenuType.Popup,width:410,maxHeight:270,onClickOutside:Ft.xv},o().createElement(I.Z,i,n()(Dt.Z,{filter:this.getFilter(t)||"",onSubmit:this.handleSubmit,onNoResults:this.handleNoResults,isCallout:!1}))})),g()(this,"handleNoResults",(()=>{const e=Et.Z.state;if(!e.open)return;const t=this.getFilter(e),i=U().last(t);i&&/\s/g.test(i)&&Ft.xv()})),g()(this,"handleSubmit",(e=>{Ye.createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:this.environment,perform:t=>{Ft.RL({environment:this.environment,emoji:e,transaction:t})}})})),g()(this,"handleCancel",(()=>{Ft.xv()}))}willMountOrUpdate(){const e=Et.Z.state;if(e.open){var t;const i=gt.default.state,a=this.getFilter(e);("editing"!==i.mode||(null===(t=(0,dt.QY)(i.multiSelection))||void 0===t?void 0:t.store)!==e.textStore||void 0===a||":"===a||a.startsWith("\n")||a.startsWith(" "))&&Ft.xv()}}renderComponent(){const{device:e}=this.environment,t=Et.Z.state;let i=!1;if(t.open){const e=this.getFilter(t);e&&e.length>0&&(i=!0),t.showPopupWithEmptyFilter&&(i=!0)}return n()(R.ZP,{popupType:e.isMobileNative&&!e.isTablet?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:i,originRect:t.open?t.selectionRect:void 0,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:this.handleCancel,render:this.renderMenu,keepFocus:!0})}getFilter(e){return Bt.zK(e.textStore,e.oldTextValue,!0)}}const Lt=Rt;var Ot=i(8848),Nt=i(43593),Ut=i(53397),Wt=i(54604),Vt=i(42858),zt=i(24677),Gt=i(39500),Ht=i(17504),qt=i(58202),Kt=i(95155),jt=i(38302),Yt=i(12318),Qt=i(13548),Jt=i(56813),Xt=i(68932),$t=i(42001),ei=i(37235);class ti extends r.Z{constructor(){var e;super(...arguments),e=this,g()(this,"zoomFocusPercentageX",0),g()(this,"zoomFocusPercentageY",0),g()(this,"isListeningToWheel",!1),g()(this,"hideControlsTimeout",void 0),g()(this,"isMovingToPrevOrNextTimeout",void 0),g()(this,"isEditingZoom",new Yt.default(!1)),g()(this,"isZoomedIn",new Yt.default(!1)),g()(this,"contentDimensions",new Yt.default(void 0)),g()(this,"showControls",new Yt.default(!1)),g()(this,"responsiveSettings",this.createComputedStore((()=>{const e=this.environment.WindowSizeStore.state.width;return{edgePadding:Wt.zp(e),backgroundOpacity:.8}}))),g()(this,"renderOverlay",(()=>{const{isOpen:e,renderFullScreenNode:t,fullScreenNodeRect:i,contentAspectRatio:a,zoomScale:s,panOffset:r,skipAnimations:l}=jt.Z.state;if(!i)return;const d="on"===Kt.default.getEligibleGroup({experimentId:"lightbox_v2",defaultGroup:"control"});d&&e&&!this.isListeningToWheel?(window.addEventListener("wheel",this.handleWheel,{passive:!1}),this.isListeningToWheel=!0):d&&!e&&this.isListeningToWheel&&(window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1);const{edgePadding:c,backgroundOpacity:u}=this.responsiveSettings.state,{canZoomIn:m}=jt.Z.state,p=window.innerWidth,g=window.innerHeight,h=g-2*c;let f=p-2*c;const v=a||i.height/i.width;let y=f*v;if(y>h){const e=y/h;y/=e,f/=e}const S=(p-f)/2,b=(g-y)/2;let w,C,T,k;return d?(w={opacity:0},C={scale:s,opacity:1,translateX:r.x,translateY:r.y}):(w={translateX:i.left,translateY:i.top,width:i.width,height:i.height},C={translateX:S,translateY:b,scale:s,width:f,height:y}),t&&(T=t({isZoomedIn:this.isZoomedIn.get(),handleClickWhileInFullScreen:e=>{this.handleFullScreenNodeClick(e)}})),d&&(k=this.showControls.get()?s>=1.5?"zoom-out":"zoom-in":"none"),(0,Ht.Z)((t=>n()(A.Z,{capture:e,onEsc:()=>{this.handleClose(!0)},onEnter:U().identity,onSpace:()=>this.handleClose(!0),onCommandEnter:()=>this.handleClose(!0),onCommandShiftEnter:U().identity,onCommandSlash:U().identity,onUp:U().identity,onDown:U().identity,onDelete:U().identity,onBackspace:U().identity,onLeft:()=>this.handlePrevious(!0),onRight:()=>this.handleNext(!0),onUntab:U().identity,onTab:U().identity,onSelectAll:U().identity,onRedo:U().identity,onUndo:U().identity,onToggleBold:U().identity,onToggleItalics:U().identity,onToggleStrike:U().identity,onToggleCode:U().identity,onCut:U().identity,onCopy:U().identity,onPaste:U().identity,onKeypress:this.handleKeypress},void 0,n()(Z.Z,{capture:e,preventType:F.Z.All},void 0,o().createElement("div",ne()({style:this.getStyle({isOpen:e,canZoomIn:m})},t,{onClick:this.handleBackgroundClick,onMouseMove:this.resetHideControlsTimeout}),n()(Qt.Z,{isVisible:e,enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},animationStyle:{opacity:u},render:()=>n()("div",{style:this.getBackgroundStyle()}),onAnimationEnd:this.handleBackgroundAnimationEnd}),n()(Qt.Z,d?{isVisible:e,enterAnimationStyle:w,exitAnimationStyle:w,animationStyle:C,skipAnimation:l,springConfig:{scale:this.getSpringConfig(),translateX:this.getSpringConfig(),translateY:this.getSpringConfig()},render:()=>o().createElement("div",{style:{display:"flex",cursor:k,width:f,height:y},ref:e=>{e&&this.contentDimensions.set({width:e.clientWidth,height:e.clientHeight})},onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseUp,onMouseMove:this.handleMouseMove},T),onAnimationEnd:this.handleFullscreenNodeAnimationEnd}:{isVisible:e,enterAnimationStyle:w,exitAnimationStyle:w,animationStyle:C,springConfig:{translateX:this.getSpringConfig(),translateY:this.getSpringConfig(),scale:this.getSpringConfig(),width:this.getSpringConfig(),height:this.getSpringConfig()},render:()=>n()("div",{style:{position:"absolute",left:0,top:0,display:this.isZoomedIn.get()?"none":"flex",cursor:k}},void 0,T),onAnimationEnd:this.handleFullscreenNodeAnimationEnd}),!d&&n()(Qt.Z,{isVisible:e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},animationStyle:{opacity:1},springConfig:{opacity:this.getSpringConfig()},render:()=>o().createElement("div",{ref:e=>{e&&this.scrollToZoomFocus(e)},style:{display:this.isZoomedIn.get()?"flex":"none",width:"100vw",height:"100vh",overflow:"scroll"}},T)}),d?void 0:n()("div",{style:this.getCloseButtonStyle(e)},void 0,n()($t.Z,{onClick:()=>this.handleClose(),style:{color:this.getBottomBarPrimaryColor()},icon:e=>Ut.Z.close({...e,fill:this.getBottomBarPrimaryColor(),height:16,width:16})},void 0,n()(M.FormattedMessage,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label",description:"Shown in the top right corner when viewing an asset (image, file, etc.) in full screen mode, to close out of full screen mode."}))),this.renderBottomBar())))))})),g()(this,"clearHideControlsTimeout",(()=>{this.hideControlsTimeout&&clearTimeout(this.hideControlsTimeout)})),g()(this,"resetHideControlsTimeout",(()=>{const{isSaving:e}=jt.Z.state;this.showControls.set(!0),this.clearHideControlsTimeout(),this.isEditingZoom.get()||e||(this.hideControlsTimeout=setTimeout((()=>this.showControls.set(!1)),2e3))})),g()(this,"enableZoomEditing",(()=>{this.isEditingZoom.set(!0),this.clearHideControlsTimeout()})),g()(this,"disableZoomEditing",(()=>{this.isEditingZoom.set(!1),this.resetHideControlsTimeout()})),g()(this,"handleBackgroundClick",(e=>{(0,Gt.uG)(e)||this.handleClose()})),g()(this,"handleFullScreenNodeClick",(e=>{const{canZoomIn:t,zoomScale:i}=jt.Z.state,a="on"===Kt.default.getEligibleGroup({experimentId:"lightbox_v2",defaultGroup:"control"});if(e.stopPropagation(),a){if((0,Gt.uG)(e))return;let t,a;t=i<1?1:i<1.5?1.5:1,a=t<=1?{x:0,y:0}:{x:(window.innerWidth/2-e.clientX)/(t/(t-1)),y:(window.innerHeight/2-e.clientY)/(t/(t-1))},jt.Z.setState({...jt.Z.state,zoomScale:t,panOffset:a}),this.resetHideControlsTimeout(),this.disableZoomEditing()}else{if(!t)return;const i=!this.isZoomedIn.get();if(this.isZoomedIn.set(i),i){const t=e.target.getBoundingClientRect();this.zoomFocusPercentageX=(e.clientX-t.left)/t.width,this.zoomFocusPercentageY=(e.clientY-t.top)/t.height}}})),g()(this,"handleClose",(function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Wt.xv(),e.resetControls(),V.trackFullScreenAction(e.environment,{type:"close",triggered_by:t?"keypress":"click"}),zt.ZH(e.environment)})),g()(this,"handleResize",(()=>{const{isOpen:e}=jt.Z.state;e&&this.enqueueForceUpdate()})),g()(this,"handleBackgroundAnimationEnd",(()=>{const{isOpen:e}=jt.Z.state;e||jt.Z.setState({...jt.Z.state,backgroundAnimationComplete:!0})})),g()(this,"handleFullscreenNodeAnimationEnd",(()=>{const{isOpen:e}=jt.Z.state;e||jt.Z.setState({...jt.Z.state,fullscreenNodeAnimationComplete:!0})})),g()(this,"cancelBackgroundClick",(e=>{e.stopPropagation()})),g()(this,"handlePrevious",(function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(-1,t)})),g()(this,"handleNext",(function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(1,t)})),g()(this,"handleZoomInputSubmit",(e=>{const t=e.target,i=parseInt(t.value);if(!isNaN(i)){const e=i/100;V.trackFullScreenAction(this.environment,{type:"set_zoom",new_zoom:e}),this.setZoomScale(e)}this.disableZoomEditing()})),g()(this,"handleZoomOut",(function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:i}=jt.Z.state;let a=Math.ceil((i-ti.ZOOM_STEP)*ti.INVERSE_ZOOM_STEP)/ti.INVERSE_ZOOM_STEP;i-a<ti.ZOOM_THRESHOLD&&(a-=ti.ZOOM_STEP),V.trackFullScreenAction(e.environment,{type:"zoom_out",new_zoom:a,triggered_by:t?"keypress":"click"}),e.setZoomScale(a)})),g()(this,"handleZoomIn",(function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:i}=jt.Z.state;let a=Math.floor((i+ti.ZOOM_STEP)*ti.INVERSE_ZOOM_STEP)/ti.INVERSE_ZOOM_STEP;a-i<ti.ZOOM_THRESHOLD&&(a+=ti.ZOOM_STEP),V.trackFullScreenAction(e.environment,{type:"zoom_in",new_zoom:a,triggered_by:t?"keypress":"click"}),e.setZoomScale(a)})),g()(this,"addDeltaToZoomScale",(e=>{const{zoomScale:t}=jt.Z.state;this.setZoomScale(t+e)})),g()(this,"setZoomScale",(e=>{const{panOffset:t}=jt.Z.state;if(!("on"===Kt.default.getEligibleGroup({experimentId:"lightbox_v2",defaultGroup:"control"})))return;this.resetHideControlsTimeout();const i=Math.max(Math.min(e,ti.MAX_ZOOM),ti.MIN_ZOOM),a=i<=1?{x:0,y:0}:t;jt.Z.setState({...jt.Z.state,zoomScale:i,panOffset:a})})),g()(this,"handleWheel",(e=>{const{isOpen:t,panOffset:i}=jt.Z.state;"on"===Kt.default.getEligibleGroup({experimentId:"lightbox_v2",defaultGroup:"control"})&&t&&(e.preventDefault(),e.ctrlKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*ti.TRACK_PAD_SCALE):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*ti.TRACK_PAD_SCALE):e.metaKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*ti.MOUSE_WHEEL_SCALE):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*ti.MOUSE_WHEEL_SCALE):this.canPan()&&this.setPanOffset({x:i.x-e.deltaX,y:i.y-e.deltaY}))})),g()(this,"handleMouseDown",(e=>{const{panOffset:t}=jt.Z.state;jt.Z.setState({...jt.Z.state,panStartPosition:{x:e.clientX-t.x,y:e.clientY-t.y},skipAnimations:!0})})),g()(this,"handleMouseUp",(()=>{jt.Z.setState({...jt.Z.state,skipAnimations:!1})})),g()(this,"handleMouseMove",(e=>{const{panStartPosition:t}=jt.Z.state;this.contentDimensions.get()&&1===e.buttons&&this.canPan()&&this.setPanOffset({x:e.clientX-t.x,y:e.clientY-t.y})})),g()(this,"handleSave",(e=>{const{block:t}=jt.Z.state;if(!t||!this.environment.currentUser.id)return;jt.Z.setState({...jt.Z.state,isSaving:!0}),this.clearHideControlsTimeout();const i=null==t?void 0:t.getProperties(),a=qe.Q(null==i?void 0:i.source),n=qe.Q(null==i?void 0:i.caption);(0,Nt.GN)(a,null==t?void 0:t.pointer,Tt.Z.domainBaseUrl,this.environment.currentUser.id,n).then((()=>{jt.Z.setState({...jt.Z.state,isSaving:!1}),V.trackFullScreenAction(this.environment,{type:"download",triggered_by:"click"}),this.resetHideControlsTimeout()}))})),g()(this,"handleKeypress",(e=>{switch(e.key){case"+":case"=":this.handleZoomIn(!0);break;case"-":case"_":this.handleZoomOut(!0)}}))}didMount(){super.didMount(),window.addEventListener("resize",this.handleResize)}willUnmount(){super.willUnmount(),window.removeEventListener("resize",this.handleResize),window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1}renderComponent(){const{isOpen:e,fullscreenNodeAnimationComplete:t,backgroundAnimationComplete:i}=jt.Z.state;return n()(at.Z,{open:e||!t||!i,render:this.renderOverlay})}getAllImageBlocksOnPage(){const e=j.default.getCurrentRootStore();return qt.R.getMembersByDOMOrder().filter((e=>e instanceof Jt.Z)).filter((t=>Boolean(t.props.store.findRecordStoreUIAncestor((t=>Boolean(e&&t===e))).ancestor))).map((e=>e.props.store)).filter((e=>Boolean(e.getProperties().source)))}renderBottomBar(){const{isOpen:e}=jt.Z.state;if("on"===Kt.default.getEligibleGroup({experimentId:"lightbox_v2",defaultGroup:"control"})&&!this.environment.device.isMobile)return n()(Qt.Z,{isVisible:this.showControls.get(),enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},animationStyle:{opacity:1},render:()=>n()("div",{style:this.getBottomContainerStyle(e),onClick:e=>{this.cancelBackgroundClick(e),this.resetHideControlsTimeout(),this.disableZoomEditing()}},void 0,n()("div",{style:{...ti.controlBarStyle,marginRight:10}},void 0,this.renderPrevNextButtons()),n()("div",{style:ti.controlBarStyle},void 0,this.renderZoomControls(),this.renderVerticalLine(),this.renderDownloadButton(),this.renderVerticalLine(),this.renderCloseButton()))})}renderZoomControls(){const{zoomScale:e}=jt.Z.state,t=(100*e).toFixed(0);return n()("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"}},void 0,n()(ei.Z,{renderTooltip:()=>this.renderTooltip({primaryText:n()(M.FormattedMessage,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out",description:"Label for a button to zoom out an image"}),secondaryText:"-"}),disableTooltip:e<=ti.MIN_ZOOM,render:t=>o().createElement($t.Z,ne()({},t,{disabled:e<=ti.MIN_ZOOM,style:{...this.getButtonStyle(e<=ti.MIN_ZOOM),...ti.firstButtonPadding},onClick:()=>this.handleZoomOut(),icon:e=>Ut.Z.minus({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))}),this.isEditingZoom.get()?n()(ii,{initialValue:t,onSubmit:this.handleZoomInputSubmit,onCancel:this.disableZoomEditing,primaryColor:this.getBottomBarPrimaryColor(),secondaryColor:this.getBottomBarSecondaryColor()}):n()($t.Z,{onClick:e=>{e.stopPropagation(),this.enableZoomEditing()},style:{color:this.getBottomBarSecondaryColor(),margin:0,width:46,padding:0,justifyContent:"center"}},void 0,"".concat(t,"%")),n()(ei.Z,{renderTooltip:()=>this.renderTooltip({primaryText:n()(M.FormattedMessage,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in",description:"Label for a button to zoom in an image"}),secondaryText:"+"}),disableTooltip:e>=ti.MAX_ZOOM,render:t=>o().createElement($t.Z,ne()({},t,{disabled:e>=ti.MAX_ZOOM,style:this.getButtonStyle(e>=ti.MAX_ZOOM),onClick:()=>this.handleZoomIn(),icon:e=>Ut.Z.plus({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))}))}renderPrevNextButtons(){var e,t;const{block:i}=jt.Z.state,a=this.getAllImageBlocksOnPage(),s=null!==(e=null==a?void 0:a.length)&&void 0!==e?e:0,r=null!==(t=null==a?void 0:a.findIndex((e=>e===i)))&&void 0!==t?t:-1;return s<=1||r<0?n()("div",{}):o().createElement(o().Fragment,null,n()(ei.Z,{renderTooltip:()=>this.renderTooltip({primaryText:n()(M.FormattedMessage,{id:"fullScreenRenderer.previous",defaultMessage:"Back",description:"Label for a button in a slideshow of images to go back to the previous image"}),secondaryText:this.renderPrevNextSecondaryText(r-1,s)}),disableTooltip:0===r,render:e=>o().createElement($t.Z,ne()({},e,{disabled:r<=0,style:{...this.getButtonStyle(r<=0),...ti.firstButtonPadding},hoveredStyle:ti.hoveredButtonStyle,onClick:()=>this.handlePrevious(),icon:e=>Ut.Z.arrowLeft({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))}),n()(ei.Z,{renderTooltip:()=>this.renderTooltip({primaryText:n()(M.FormattedMessage,{id:"fullScreenRenderer.next",defaultMessage:"Next",description:"Label for a button in a slideshow of images to go to the next image"}),secondaryText:this.renderPrevNextSecondaryText(r+1,s)}),disableTooltip:r+1===s,render:e=>o().createElement($t.Z,ne()({},e,{disabled:r>=s-1,style:{...this.getButtonStyle(r>=s-1),...ti.lastButtonPadding},hoveredStyle:ti.hoveredButtonStyle,onClick:()=>this.handleNext(),icon:e=>Ut.Z.arrowRight({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))}))}renderDownloadButton(){const{isSaving:e}=jt.Z.state;return n()(ei.Z,{renderTooltip:()=>this.renderTooltip({primaryText:n()(M.FormattedMessage,{id:"fullScreenRenderer.download",defaultMessage:"Download",description:"Label for a button to download an image"})}),render:t=>o().createElement($t.Z,ne()({},t,{disabled:e,onClick:this.handleSave,style:this.getButtonStyle(!1),hoveredStyle:ti.hoveredButtonStyle}),e?n()(Xt.Z,{style:{width:16}}):Ut.Z.download({fill:this.getBottomBarPrimaryColor(),width:16}))})}renderCloseButton(){return n()(ei.Z,{renderTooltip:()=>this.renderTooltip({primaryText:n()(M.FormattedMessage,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label",description:"Shown in the top right corner when viewing an asset (image, file, etc.) in full screen mode, to close out of full screen mode."}),secondaryText:"esc"}),render:e=>o().createElement($t.Z,ne()({},e,{onClick:()=>this.handleClose(),style:{...this.getButtonStyle(!1),...ti.lastButtonPadding},hoveredStyle:ti.hoveredButtonStyle,icon:e=>Ut.Z.collapse({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})}))})}renderPrevNextSecondaryText(e,t){return n()(M.FormattedMessage,{values:{currentIndex:e+1,totalCount:t},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label",description:"Description stating what image number this is in a list of images. For example, 3 of 14"})}renderTooltip(e){const{primaryText:t,secondaryText:i}=e;return o().createElement(o().Fragment,null,n()("span",{style:{marginRight:i?4:void 0}},void 0,t),i?n()("span",{style:{color:this.getBottomBarSecondaryColor()}},void 0,i):void 0)}renderVerticalLine(){return n()("span",{style:{borderLeft:"1px solid ".concat(Ot.ZP.whiteWithAlpha(.25)),height:"100%"}})}scrollToZoomFocus(e){const t=window.innerWidth/2,i=window.innerHeight/2,a=e.scrollWidth*this.zoomFocusPercentageX,n=e.scrollHeight*this.zoomFocusPercentageY;e.scrollLeft=a-t,e.scrollTop=n-i}resetControls(){this.isZoomedIn.set(!1),this.isEditingZoom.set(!1),jt.Z.setState({...jt.Z.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}canPan(){const{zoomScale:e}=jt.Z.state;return"on"===Kt.default.getEligibleGroup({experimentId:"lightbox_v2",defaultGroup:"control"})&&e>1}setPanOffset(e){const{panStartPosition:t}=jt.Z.state,i=this.contentDimensions.get();if(!i)return;let a,n;a=i.width*ti.MAX_ZOOM>window.innerWidth?(i.width*ti.MAX_ZOOM-window.innerWidth)/(2*ti.MAX_ZOOM):(window.innerWidth-i.width*ti.MAX_ZOOM)/(2*ti.MAX_ZOOM),n=i.height*ti.MAX_ZOOM>window.innerHeight?(i.height*ti.MAX_ZOOM-window.innerHeight)/(2*ti.MAX_ZOOM):(window.innerHeight-i.height*ti.MAX_ZOOM)/(2*ti.MAX_ZOOM);const s=Math.min(Math.max(e.x,-1*a),a),o=Math.min(Math.max(e.y,-1*n),n);e.x!==s&&(t.x=t.x+(e.x-s)),e.y!==o&&(t.y=t.y+(e.y-o)),jt.Z.setState({...jt.Z.state,panOffset:{x:s,y:o},panStartPosition:t})}moveToImageOffset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{block:i}=jt.Z.state;if(!("on"===Kt.default.getEligibleGroup({experimentId:"lightbox_v2",defaultGroup:"control"})))return;const a=this.getAllImageBlocksOnPage();if(!a)return;const n=a.findIndex((e=>e===i));if(n+e<0||n+e>=a.length)return;V.trackFullScreenAction(this.environment,{type:e>0?"next":"previous",image_count:a.length,image_index:n+e,triggered_by:t?"keypress":"click"}),jt.Z.setState({...jt.Z.state,skipAnimations:!0}),this.isMovingToPrevOrNextTimeout&&clearTimeout(this.isMovingToPrevOrNextTimeout),this.isMovingToPrevOrNextTimeout=setTimeout((()=>{jt.Z.setState({...jt.Z.state,skipAnimations:!1})}),250);const s=a[n+e];Vt.dK({blocks:[s]}),this.resetControls()}getSpringConfig(){return{stiffness:"on"===Kt.default.getEligibleGroup({experimentId:"lightbox_v2",defaultGroup:"control"})?100:65,damping:10,precision:.001}}getStyle(e){const{isOpen:t,canZoomIn:i}=e;return"on"===Kt.default.getEligibleGroup({experimentId:"lightbox_v2",defaultGroup:"control"})?{zIndex:Oe.mJ,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:this.showControls.get()?void 0:"none"}:{zIndex:Oe.mJ,position:"fixed",top:0,left:0,right:0,bottom:0,pointerEvents:t?"auto":"none",cursor:i?void 0:"zoom-out"}}getBackgroundStyle(){return{position:"absolute",top:0,left:0,right:0,bottom:0,background:Ot.ZP.black}}getCloseButtonStyle(e){const{WindowSizeStore:t}=this.environment;return{position:"absolute",top:t.getSafePaddingBottomCSS(16),right:t.getSafePaddingRightCSS(18),display:e?"block":"none"}}getBottomContainerStyle(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}getBottomBarPrimaryColor(){return Ot.ZP.white}getBottomBarSecondaryColor(){return Ot.ZP.whiteWithAlpha(.5)}getButtonStyle(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}}function ii(e){const[t,i]=(0,s.useState)(e.initialValue);return n()(ve.Z,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:3,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;i(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:ve.B.Transparent,right:n()("span",{style:{color:e.secondaryColor}},void 0,"%"),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}g()(ti,"MAX_ZOOM",2),g()(ti,"MIN_ZOOM",.5),g()(ti,"ZOOM_STEP",.5),g()(ti,"INVERSE_ZOOM_STEP",1/ti.ZOOM_STEP),g()(ti,"ZOOM_THRESHOLD",.25),g()(ti,"MOUSE_WHEEL_SCALE",-.002),g()(ti,"TRACK_PAD_SCALE",-.004),g()(ti,"controlBarStyle",{display:"flex",borderRadius:4,background:Ot.ZP.blackWithAlpha(.65)}),g()(ti,"firstButtonPadding",{padding:"6px 6px 6px 10px"}),g()(ti,"lastButtonPadding",{padding:"6px 10px 6px 6px"}),g()(ti,"hoveredButtonStyle",{background:"rgba(255, 255, 255, 0.055)"});const ai=ti;var ni=i(24684),si=i(98459),oi=i(19889),ri=i(97880),li=i(82990),di=i(54642),ci=i(51118),ui=i(93678),mi=i(617),pi=i(98742),gi=i(52533),hi=i(17256),fi=i(21115),vi=i(46096),yi=i(41952),Si=i(78291),Mi=i(72693),bi=i(46247),wi=i(45055),Ci=i(26263),Ti=i(17215),ki=i(16691),Zi=i(4615),Ai=i(45953),Ii=i(77420),Pi=i(6287),_i=i(13493),xi=i(70279),Fi=i(26111),Bi=i(68718),Ei=i(82136),Di=i(60588),Ri=i(7765),Li=i(11082),Oi=i(92166);class Ni extends r.Z{constructor(){super(...arguments),g()(this,"handleOverrideLinkClick",(e=>{(0,ci.U4)(),Fi.navigate({environment:this.environment,url:e})})),g()(this,"loadSnapshot",(async e=>{const{timestamp:t}=e,i=e.block.id,a=await di.getSnapshotContents(this.environment,e);if("failed"===a.type)throw a.error;const n=Ai.Ak.create(a.data.contentMap),s=this.environment.currentUser.id,o=new Ci.Z;for(const{pointer:m,value:p}of n)p&&o.setRecord({pointer:m,userId:s},{...p,role:"reader"});o.snapshotData={blockId:i,timestamp:t};const r=new Map,l=e=>{const t=o.getRecord({pointer:e,userId:s}),i=(0,ki.dn)(e);t||!(0,Zi.e)(e.id)||r.has(i)||r.set(i,(0,yi.Kv)(this.props.blockStore,e))};for(const{pointer:m,value:p}of n)if(p&&p.value)if(m.table===S.iU){var d;const{value:e}=p,t=e,i=Ti.jD(t);for(const o of i)l(o);const a=Ti.DF(t)?[]:t.content||[];for(const o of a)l({table:S.iU,id:o});const n=null===(d=t.format)||void 0===d?void 0:d.collection_pointer;n&&l(n);const s=t.collection_id;s&&l({table:Pi.v,id:s});for(const o of Ti.lc(t))l({table:oi.KJ,id:o});t.created_by_table&&t.created_by_id&&(t.created_by_table===oi.KJ?l({table:oi.KJ,id:t.created_by_id}):l({table:Ii.cZ,id:t.created_by_id})),t.last_edited_by_table&&t.last_edited_by_id&&(t.last_edited_by_table===oi.KJ?l({table:oi.KJ,id:t.last_edited_by_id}):l({table:Ii.cZ,id:t.last_edited_by_id}))}else if(m.table===_i.n){var c;const{value:e}=p,t=null===(c=e.format)||void 0===c?void 0:c.collection_pointer;t&&l(t)}else if(m.table===xi.x_){const{value:e}=p,t=e;t.created_by_id&&t.created_by_table&&(t.created_by_table===oi.KJ?l({table:oi.KJ,id:t.created_by_id}):l({table:Ii.cZ,id:t.created_by_id}))}const u=Array.from(r.values());return await Promise.all(u.map((async e=>{await e.load();const t=e.getValue();t&&o.setRecord({pointer:e.pointer,userId:s},{role:"reader",value:t})}))),{blockStore:new Zt.Z(this.environment,{table:S.iU,id:i},{inMemoryRecordCache:o}),timestamp:t}}))}getChildContext(){return{...this.context,overrideLinkClick:this.handleOverrideLinkClick}}renderComponent(){const e=this.props.blockStore.id,t=this.props.timestamp,i={request:{block:{id:e,spaceId:(0,si.CG)(this.props.blockStore.pointer.spaceId)},timestamp:t},performRequest:this.loadSnapshot,render:(e,t,i)=>n()(Oi.Z,{show:!i||!t,showDelay:400,showHold:400,render:i=>i?n()("div",{style:this.getSpinnerWrapperStyles()},void 0,n()(Xt.Z,{})):e?n()("div",{style:{padding:32}},void 0,n()(M.FormattedMessage,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})):t?n()(_.Z,{store:t.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:i}=e;return o().createElement(Li.Z,ne()({style:{background:this.theme.contentBackground,zIndex:1,flexGrow:1},type:(0,Qe.Zy)({environment:this.environment,store:t.blockStore})},i),n()(Di.Z,{store:t.blockStore,disabled:!0,loadingContainerStore:void 0,context:Ei.S.InAppTemplatePreview,paddingBottom:Di.Z.paddingBottom(this.environment),paddingLeft:(0,Qe.ui)(this.environment),paddingRight:(0,Qe.ui)(this.environment),pageCoverHeight:Di.Z.defaultPageCoverHeight(this.environment)}))}},t.timestamp):void 0})};return o().createElement(Ri.Z,i)}getSpinnerWrapperStyles(){return{padding:32,display:"flex",alignItems:"center",justifyContent:"center"}}}g()(Ni,"contextTypes",r.w),g()(Ni,"childContextTypes",Bi.u);const Ui=Ni;var Wi=i(40039),Vi=i(79029),zi=i(61543);class Gi extends r.Z{constructor(){super(...arguments),g()(this,"renderSnapshotsListRequest",(()=>{const{device:e}=this.environment,t=vi.Z.state;if(!t.open)return;const i={request:{block:{id:t.blockStore.id,spaceId:(0,si.CG)(t.blockStore.pointer.spaceId)},size:t.size},performRequest:e=>this.loadSnapshotsList(e,t),render:(i,a,s)=>n()(Oi.Z,{show:Boolean(!a||a.snapshots.length>=t.size&&t.openSnapshotNearTimestamp),showDelay:400,showHold:100,render:n=>e.isMobile?this.renderMobileHistory({snapshotValues:a?a.snapshots:[],menuState:t,error:i,initialLoading:n,loadingMore:!s}):this.renderDesktopHistory({snapshotValues:a?a.snapshots:[],menuState:t,error:i,initialLoading:n,loadingMore:!s})})};return o().createElement(Ri.Z,i)})),g()(this,"renderMobileHistory",(e=>{let t,i;return this.historyIsEnabled()?e.loadingMore||0!==e.snapshotValues.length||(t=this.renderUnavailableMessage(Gi.noSnapshotsMessage,!1)):t=this.renderUnavailableMessage(this.getUnavailableMessage(),fi.M9(this.environment)||"team"),i=e.error?n()("div",{style:Gi.wrapStyle},void 0,n()(M.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})):e.initialLoading?n()("div",{style:Gi.wrapStyle},void 0,n()(Xt.Z,{})):n()(s.Fragment,{},void 0,n()(Li.Z,{type:F.Z.Y},void 0,this.renderSnapshotsMenuList(e)),this.renderMobileSnapshotPreview(e.menuState)),n()(I.Z,{menuType:I.Z.MenuType.Modal,title:n()(M.FormattedMessage,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:this.renderMobileHelpButton(),right:n()(P.DoneMenuText,{}),onClickRight:ci.U4,header:t},void 0,i)})),g()(this,"renderDesktopHistory",(e=>{let t;return t=e.error?n()("div",{style:Gi.wrapStyle},void 0,n()(M.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})):e.initialLoading?n()("div",{style:Gi.wrapStyle},void 0,n()(Xt.Z,{})):this.historyIsEnabled()?e.menuState.snapshot&&!this.snapshotIsAvailable({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot})?this.renderUnavailableMessage(Gi.restrictedMessage,"enterprise"):e.loadingMore||0!==e.snapshotValues.length?this.renderDesktopSnapshotPreview(e.menuState):this.renderUnavailableMessage(Gi.noSnapshotsMessage,!1):this.renderUnavailableMessage(this.getUnavailableMessage(),fi.M9(this.environment)||"team"),n()(s.Fragment,{},void 0,n()("div",{style:{display:"flex",flexDirection:"column",width:"calc(100% - ".concat(Gi.sidebarWidth,"px)"),boxShadow:"1px 0 0 ".concat(this.theme.regularDividerColor)}},void 0,t),this.renderDesktopSidebar(e))})),g()(this,"renderSnapshotsMenuList",(e=>{const{device:t}=this.environment,{menuState:i,loadingMore:a}=e,r=U().compact(e.snapshotValues.map(((a,s)=>{const r=s>0?e.snapshotValues[s-1]:void 0,l=this.snapshotIsAvailable({snapshot:a,nextFutureSnapshot:r});return{key:a.id,action:()=>{ci.gs({environment:this.environment,snapshot:a,nextFutureSnapshot:r})},render:e=>{const s=a.authors||[],r=this.props.intl.formatList(U().compact(s.map(((e,t)=>{if(e.table===oi.KJ){const t=(0,yi.Kv)(i.blockStore,e).getValue();if(!t)return;return(0,oi.Nz)(this.props.intl,t)}{const t=(0,yi.Kv)(i.blockStore,e).getValue();if(!t)return;return t.name}}))),{type:"conjunction",style:"narrow"}),d=n()("div",{style:{...li.Z.textOverflowStyle}},void 0,r),c=Boolean(i.snapshot&&i.snapshot.id===a.id),u=6*wt.A0,m=(0,hi.Z)(parseInt(a.timestamp)),p=m.format("lll");let g=m.format("LL");if((0,hi.Z)().diff(m)<=u&&(g=m.calendar()),l)return n()(ei.Z,{render:i=>o().createElement(ce.Z,ne()({},(0,pi.Z)(e,i),{title:g,focused:!t.isMobile&&c,caption:d})),renderTooltip:()=>n()("div",{style:{maxWidth:270,whiteSpace:"normal"}},void 0,n()("div",{},void 0,p),n()("div",{},void 0,r))},e.key);{const i=!this.historyIsEnabled();return n()(ei.Z,{render:a=>o().createElement(ce.Z,ne()({},(0,pi.Z)(a,e),{title:n()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},void 0,n()("div",{style:{...t.isMobile&&{display:"flex",flex:1},...li.Z.textOverflowStyle}},void 0,g),!i&&n()(zi.Z,{subscriptionTier:"enterprise",analyticsName:"history_modal",desktopStyle:{marginLeft:8},onClick:()=>this.handleUpgrade("enterprise")})),focused:!t.isMobile&&c,disabled:i,caption:d})),renderTooltip:()=>n()(M.FormattedMessage,{defaultMessage:"Upgrade to view this snapshot.",id:"historyModal.snapshotsMenuList.upgrade.tooltip"}),disableTooltip:!i},e.key)}}}}))),l=i.snapshot&&i.snapshot.id,d=r.findIndex((e=>l===e.key)),c=[{key:"snapshots",render:e=>o().createElement(ee.Z,e),items:r}];return n()(s.Fragment,{},void 0,n()(ue.Z,{type:ue.Z.Type.Vertical,initialFocus:d,sections:c}),n()(wi.Z,{loading:a,fetchSize:i.size,resultSize:e.snapshotValues.length,onLoadMore:ci.FF}),n()(Oi.Z,{show:a,showDelay:300,showHold:100,render:e=>e&&n()("div",{style:Gi.wrapStyle},void 0,n()(Xt.Z,{}))}))})),g()(this,"handleUpgrade",(e=>{ui.y(this.environment,{from:"history_modal",for:e})})),g()(this,"loadSnapshotsList",(async(e,t)=>{const{device:i}=this.environment,a=await di.getSnapshotsList(this.environment,e);if("failed"===a.type)throw a.error;const{snapshots:n}=a.data;if(t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),i=n.findIndex((t=>parseInt(t.timestamp)<e));0===n.length||(0===i?ci.gs({environment:this.environment,snapshot:n[i],nextFutureSnapshot:void 0}):i>0?ci.gs({environment:this.environment,snapshot:n[i-1],nextFutureSnapshot:i>1?n[i-2]:void 0}):n.length<t.size?ci.gs({environment:this.environment,snapshot:n[n.length-1],nextFutureSnapshot:n.length>1?n[n.length-2]:void 0}):ci.FF())}else Boolean(t.snapshot)||i.isMobile||vi.Z.setState({...t,snapshot:n[0],nextFutureSnapshot:void 0});return a.data})),g()(this,"iconSize",(()=>{const{device:e}=this.environment;return e.isMobile?24:20}))}renderComponent(){const{device:e}=this.environment,t=vi.Z.state;return e.isMobile?n()(R.ZP,{popupType:R.ZP.PopupType.SlideUp,open:t.open,render:this.renderSnapshotsListRequest,onDismiss:ci.U4}):n()(Ve.Z,{open:t.open,innerStyle:{height:"80vh",width:"80vw",overflow:"hidden",display:"flex"},onDismiss:ci.U4,render:this.renderSnapshotsListRequest,className:re.Nn})}renderMobileSnapshotPreview(e){if(this.historyIsEnabled())return n()(R.ZP,{popupType:R.ZP.PopupType.SlideUp,open:Boolean(e.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!e.snapshot)return;const t=this.snapshotIsAvailable({snapshot:e.snapshot,nextFutureSnapshot:e.nextFutureSnapshot}),i=t?n()(Ui,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp}):this.renderUnavailableMessage(Gi.restrictedMessage,"enterprise");return n()(I.Z,{menuType:I.Z.MenuType.Modal,title:(0,hi.Z)(parseInt(e.snapshot.timestamp)).calendar(),right:n()(P.DoneMenuText,{}),onClickRight:ci.zb,leftDisabled:!t,left:n()(M.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>ci.xx(this.environment),whiteBackground:t,forceFullScreenSlideUp:!0},void 0,i)}})}hasPermissionToRestore(e){return(0,mi.k5)({environment:this.environment,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}renderDesktopSidebar(e){const{menuState:t}=e,i=Boolean(t.snapshot&&this.snapshotIsAvailable({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot})&&this.hasPermissionToRestore(t)),a=!this.historyIsEnabled();return n()("div",{style:this.getSidebarStyle()},void 0,n()(Li.Z,{type:F.Z.Y,style:{flex:1}},void 0,this.renderSnapshotsMenuList(e)),n()("div",{style:{display:"flex",padding:14,borderTop:"\n\t\t\t\t\t\t\t1px solid ".concat(this.theme.regularDividerColor,"\n\t\t\t\t\t\t")}},void 0,n()(ei.Z,{disableTooltip:!a,renderTooltip:()=>n()(M.FormattedMessage,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:e=>o().createElement(Mi.Z,ne()({isLarge:!0,onClick:()=>ci.xx(this.environment),disabled:!i},e),n()(M.FormattedMessage,{defaultMessage:"Restore version",id:"historyModal.desktopModal.restoreButton.label"}))}),n()(ze.Z,{isLarge:!0,style:{marginLeft:12},onClick:ci.U4},void 0,n()(M.FormattedMessage,{defaultMessage:"Cancel",id:"historyModal.desktopModal.cancelButton.label"}))),n()(ee.Z,{topBorder:!0,disableDesktopPadding:!0},void 0,n()(X.Z,{title:n()(M.FormattedMessage,{id:"historyModal.desktopModal.learnMoreButton.label",defaultMessage:"Learn about page history"}),href:(0,G.UY)("guides.pageHistory"),analyticsFrom:"page_history"})))}renderDesktopSnapshotPreview(e){if(e.snapshot)return n()(s.Fragment,{},void 0,n()("div",{style:{display:"flex",alignItems:"center",flexShrink:0,height:45,fontSize:14,paddingLeft:14}},void 0,e.blockStore.hasIcon()&&n()(Wi.Z,{disabled:!0,icon:e.blockStore.getIcon(),isEmptyPage:e.blockStore.isEmptyPage(),size:this.iconSize(),style:{marginRight:6}}),n()(Vi.Z,{store:e.blockStore})),n()(Ui,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp}))}deviceSupportsUpgrade(e){const{device:t}=this.environment;return!t.isMobile||"personal"===e&&(0,gi.S)({environment:this.environment})}renderUnavailableMessage(e,t){const{device:i}=this.environment,a=Si.default.state.data;let s=this.deviceSupportsUpgrade(t);const o=a&&fi.GJ(a);return s&&(0,gi.S)({environment:this.environment})&&"personal"===t&&!o&&(s=!1),n()("div",{style:this.getUnavailableMessageStyle()},void 0,this.deviceSupportsUpgrade(t)&&this.renderVersionHistoryIcon(),n()("div",{style:{...!i.isMobile&&{maxWidth:340}}},void 0,e),s&&t&&n()(Mi.Z,{isLarge:!0,onClick:()=>this.handleUpgrade(t),style:{marginTop:16}},void 0,n()(M.FormattedMessage,{defaultMessage:"Upgrade",id:"historyModal.upgradeForHistoryButton.label"})))}renderVersionHistoryIcon(){return Ut.Z.versionHistory({width:64,height:"auto",fill:this.theme.lightIconColor,marginBottom:12})}renderMobileHelpButton(){return n()(bi.Z,{href:(0,G.UY)("guides.pageHistory"),analyticsFrom:"page_history"})}snapshotIsAvailable(e){return!!Tt.Z.isAdminMode||!!this.historyIsEnabled()&&(!e.nextFutureSnapshot||this.snapshotIsWithinSubscriptionTierDayLimit(e.nextFutureSnapshot))}snapshotIsWithinSubscriptionTierDayLimit(e){const t=(0,fi.CM)(this.environment);if("enterprise"===t)return!0;const i=this.getSnapshotDayLimit(t);return parseInt(e.timestamp)>Date.now()-i*wt.A0}getSnapshotDayLimit(e){if(!e)return 0;switch(e){case"student":case"personal":return ni.Zm.personal.days;case"team":return ni.Zm.team.days;case"business":return ni.Zm.business.days;case"enterprise":return ni.Zm.enterprise.days;case"team_free":case"free":case"personal_free":return 0;default:return ri.t1(e)}}historyIsEnabled(){return!!Tt.Z.isAdminMode||fi.t9(this.environment)}getUnavailableMessage(){return n()(s.Fragment,{},void 0,n()(M.FormattedMessage,{defaultMessage:"Version history is not available for free workspaces.",id:"historyModal.unavailableForFreeWorkspaces.messagePart1"}),n()("br",{}),n()(M.FormattedMessage,{defaultMessage:"Please upgrade to one of our paid plans.",id:"historyModal.unavailableForFreeWorkspaces.messagePart2"}))}getSidebarStyle(){return{display:"flex",flexDirection:"column",flexShrink:0,width:Gi.sidebarWidth}}getUnavailableMessageStyle(){const{device:e}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,...e.isMobile?{position:"relative",zIndex:1,background:this.theme.popoverBackground,boxShadow:"\n\t\t\t\t\t\t\t0 -1px 0 ".concat(this.theme.regularDividerColor,",\n\t\t\t\t\t\t\t0 1px 0 ").concat(this.theme.regularDividerColor,"\n\t\t\t\t\t\t")}:{height:"100%"}}}}g()(Gi,"sidebarWidth",240),g()(Gi,"restrictedMessage",n()(M.FormattedMessage,{defaultMessage:"Please upgrade to the Enterprise Plan to access versions older than 30 days.",id:"historyModal.upgradeToEnterprise.message"})),g()(Gi,"noSnapshotsMessage",n()(M.FormattedMessage,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"})),g()(Gi,"wrapStyle",{display:"flex",justifyContent:"center",padding:32});const Hi=(0,M.injectIntl)(Gi);var qi=i(67206),Ki=i(36280),ji=i(73959),Yi=i(89086),Qi=i(66949),Ji=i(46650),Xi=i(3702);class $i extends r.Z{constructor(){super(...arguments),g()(this,"input",o().createRef()),g()(this,"handleInputChange",((e,t)=>{Qi.Z.isOpen()&&Qi.Z.setState({...Qi.Z.state,value:e,error:t})})),g()(this,"handleSubmit",(()=>{Ye.createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:this.environment,perform:e=>{Ki.gt({environment:this.environment,equationStore:Qi.Z,transaction:e})}})})),g()(this,"handleClose",(()=>{Ki.Wj()})),g()(this,"handleLeft",(e=>{if(!this.input.current)return;const t=this.input.current.getSelection();t&&"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===t.startIndex&&0===t.endIndex&&(this.handleSubmit(),Ki.Wj(Qi.P.Backward))})),g()(this,"handleRight",(e=>{if(!Qi.Z.isOpen())return;if(!this.input.current)return;const t=this.input.current.getSelection();if(!t)return;const i=Qi.Z.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&t.startIndex===i&&t.endIndex===i&&(this.handleSubmit(),Ki.Wj())})),g()(this,"isDisabled",(()=>{var e;if("editing"!==gt.default.state.mode&&!Qi.Z.isOpen())return!0;const t=Qi.Z.isOpen()?null===(e=(0,dt.QY)(Qi.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,ji.J2)(t);if(e&&e.isLocked())return!0}if(t&&t.table===xi.x_){const e=this.getCommentValue(t),{currentUserStore:i}=d.default.state;if(!e||!i)return!0;if(e.created_by_table!==oi.KJ||i.id!==e.created_by_id)return!0}const i={[qe.GK.User]:qe.GK.User,[qe.GK.Page]:qe.GK.Page,[qe.GK.Comment]:qe.GK.Comment,[qe.GK.Bot]:qe.GK.Bot,[qe.GK.Date]:qe.GK.Date,[qe.GK.ExternalObjectInstance]:qe.GK.ExternalObjectInstance,[qe.GK.TemporaryPage]:qe.GK.TemporaryPage,[qe.GK.TemplateVariable]:qe.GK.TemplateVariable};for(const a of Object.values(i))if((0,Yi.J6)(a))return!0;return!1})),g()(this,"INPUT_ORIGIN_GAP_PX",8)}renderComponent(){if(!Qi.Z.isOpen())return;const e=!Qi.Z.isOpen(),t=this.isDisabled(),i=this.getInputOriginRect(),a=Qi.Z.state.value,s=Qi.Z.state.error;return n()(Je.DependencyConsumer,{dependency:Je.deps.prismjs},void 0,(n=>{if(!e)return o().createElement(Xi.Z,{Prism:n,ref:this.input,isOpen:!0,equationValue:a,error:s,displayMode:"inline",disabled:t,originRect:i,originGap:this.INPUT_ORIGIN_GAP_PX,onDismiss:this.handleClose,onChange:this.handleInputChange,onSubmit:this.handleSubmit,onLeft:this.handleLeft,onRight:this.handleRight})}))}getCommentValue(e){return Ji.Z.createChildStore(e,{table:xi.x_,id:e.id,spaceId:(0,si.CG)(e.pointer.spaceId)}).getValue()}getInputOriginRect(){if(Qi.Z.isOpen())return Qi.Z.state.savedTextSelectionRect}}const ea=$i;var ta=i(94416);class ia extends r.Z{constructor(){super(...arguments),g()(this,"handleOpen",(()=>{ta.Z.setState({open:!0})})),g()(this,"handleClose",(()=>{ta.Z.setState({open:!1})}))}willMount(){rt.inPageSearch.started.addListener(this.handleOpen),rt.inPageSearch.stopped.addListener(this.handleClose)}willUnmount(){rt.inPageSearch.started.removeListener(this.handleOpen),rt.inPageSearch.stopped.removeListener(this.handleClose)}}const aa=ia;var na=i(79694),sa=i(64572),oa=i(88295),ra=i(45990),la=i(21325),da=i(64002),ca=i(23178);function ua(){const e=ca.Z.state;e.open&&(e.focusMenu||ca.Z.setState({...e,focusMenu:!0}))}function ma(e){const{editingToken:t}=e;if(!t)return;const i=qe.hD(t),a=qe.rl(i);return a?qe.zW(a):void 0}function pa(e){return e.url||""}function ga(e){const t=qe.rO(e);if(t&&"url"===t.type){const e=(0,bt.Wj)({url:t.href,baseUrl:Tt.Z.domainBaseUrl,publicDomainName:Tt.Z.publicDomainName,isMobile:!1,protocol:void 0,currentUrl:void 0});return"page"===e.name?{type:"notion",url:t.href,notionPage:e}:{type:"web",url:t.href}}const i=(0,da.yn)(e);if(i)return{type:"other",url:i}}var ha=i(18466),fa=i(1800),va=i(25186),ya=i(61766),Sa=i(63334),Ma=(i(82902),i(23566));const ba={...li.Z.textOverflowStyle,fontWeight:li.Z.fontWeight.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function wa(e){const{pageTitle:t}=e;return n()(M.FormattedMessage,t?{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:n()("span",{style:ba},void 0,t)}}:{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function Ca(e){const{pageTitle:t}=e;return n()(M.FormattedMessage,t?{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:n()("span",{style:ba},void 0,t)}}:{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var Ta=i(24042);function ka(e){const{inputUrl:t,allSections:i,previousSections:a,sectionToFocus:n,itemToFocus:o}=e,r=(0,be.MO)();return(0,s.useMemo)((()=>{if(r)return;if(!t||!n||!o)return 0===i.length?void 0:0;const e=U().sum(a.map((e=>e.items.length)))+n.items.indexOf(o);return Math.max(e,0)}),[r,t,i,a,n,o])}var Za=i(59054),Aa=i(31299),Ia=i(15447),Pa=i(88632);function _a(e){const{state:t,inputUrl:i,query:a,handleLinkSelection:r,disableEmptyQueryResults:l}=e,d=(0,be.O7)(),[{online:c}]=(0,we.oR)(Pa.Z),u=(0,s.useMemo)((()=>{var e;const i=null===(e=(0,dt.QY)(t.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store;if(i&&(0,w.NZ)(i))return i}),[t]),[{value:m,status:p}]=(0,Za.r5)((async()=>{if(!c)return[];if(!a)return l?[]:Ia.X4.state.map((e=>e.pageId));return(await(0,Aa.WL)({nearBlock:u,environment:d,query:a,source:"mention_menu",limit:10})).map((e=>e.id))}),[a,u,d,c,l]),g=(0,s.useMemo)((()=>{if(i&&"notion"===i.type){const e=m?U().without(m,i.notionPage.blockId):[];return[i,...e]}return m}),[m,i]);return(0,s.useMemo)((()=>{if(!g||0===g.length)return;if(i&&"web"===i.type&&i.url===a)return;const e=ha.Z.withListenerIgnored(Qe.RM);if(!e)return;const s=t.url?5:3,l=n()(M.FormattedMessage,{id:"selectionLinkButton.linkToPage.linkToBlock",defaultMessage:"Link to block",description:"Shown beneath a page title if linking to a block inside that page"}),c=n()(M.FormattedMessage,{defaultMessage:"Link to page",id:"selectionLinkButton.linkToPageSection.title"});return{items:U().compact(g.map((i=>{const a="object"==typeof i?i.notionPage.peekViewBlockId||i.notionPage.blockId:i,s=Zt.Z.createChildStore(e,{table:S.iU,id:a});return{key:a,action:()=>{if("object"==typeof i){const e=(0,sa.nR)({pageId:i.notionPage.blockId,peekViewBlockId:i.notionPage.peekViewBlockId,peekMode:i.notionPage.peekMode,discussionId:i.notionPage.discussionId,collectionViewId:i.notionPage.collectionViewId,scrollToBlockId:i.notionPage.scrollToBlockId});r(d,t,e)}else r(d,t,(0,sa.nR)({pageId:a}))},render:e=>{const t="object"==typeof i&&i.notionPage.scrollToBlockId;return o().createElement(Ta.Z,ne()({},e,{store:s,caption:t?l:void 0,placeholder:n()(Oi.Z,{showHold:300,showDelay:300,show:"resolved"===p,render:e=>n()(M.FormattedMessage,e?{id:"selectionLinkButton.linkToPage.unknownBlock",defaultMessage:"Unknown block"}:{id:"selectionLinkButton.linkToPage.loading",defaultMessage:"Loading..."})})}))}}}))).slice(0,s),title:g.some((e=>Boolean("object"==typeof e&&e.notionPage.scrollToBlockId)))?c:l}}),[g,t,d,a,i,p,r])}function xa(e){const{state:t}=e,i=(0,be.O7)();return(0,s.useMemo)((()=>{if(t.editingToken)return{key:"unlink",action:()=>ra.PP(i),render:e=>o().createElement(ce.Z,ne()({},e,{title:n()(M.FormattedMessage,{id:"selectionLinkButton.removeLink",defaultMessage:"Remove link"}),icon:Ut.Z.trash({width:16})}))}}),[t.editingToken,i])}function Fa(e){const{state:t}=e,i=(0,s.useMemo)((()=>pa(t)),[t]),a=(0,s.useMemo)((()=>ga(i)),[i]),r=function(e){const{state:t,inputUrl:i,query:a}=e,n=_a({state:t,inputUrl:i,query:a,handleLinkSelection:Ba});return(0,s.useMemo)((()=>n?{key:"mention results",items:n.items,render:e=>o().createElement(ee.Z,ne()({},e,{title:n.title,isTitleUppercase:!0}))}:void 0),[n])}({state:t,inputUrl:a,query:i}),l=function(e){const{state:t}=e,i=(0,be.O7)(),a=(0,Ce.F)();return(0,s.useMemo)((()=>{const e=n()(M.FormattedMessage,{defaultMessage:"Linked to",id:"selectionLinkButton.linkedToSection.title"}),s=ma(t),r=s?(0,sa.A5)({url:s,baseUrl:Tt.Z.domainBaseUrl,publicDomainName:Tt.Z.publicDomainName}):void 0;if(r&&s){const t=ha.Z.withListenerIgnored(Qe.RM);if(!t)return;const a=Zt.Z.createChildStore(t,{table:S.iU,id:r});return{key:"linked to",render:t=>o().createElement(ee.Z,ne()({title:e,isTitleUppercase:!0},t)),items:[{key:"linked to page",action:e=>{let{event:t}=e;const a=t&&t.metaKey;a||ca.Z.setState({open:!1}),(0,Fi.navigate)({environment:i,url:s,metaClick:a})},render:e=>o().createElement(Ta.Z,ne()({},e,{store:a}))}]}}if(s)return{key:"linked to",render:t=>o().createElement(ee.Z,ne()({title:e,isTitleUppercase:!0},t)),items:[{key:"linked to web",action:e=>{let{event:t}=e;return(0,Fi.navigate)({environment:i,url:s,metaClick:t&&t.metaKey})},render:e=>o().createElement(ce.Z,ne()({},e,{title:s,caption:n()(M.FormattedMessage,{defaultMessage:"Web page",id:"selectionLinkButton.linkedToSection.webPage"}),icon:Ut.Z.globe2({width:16,fill:a.mediumIconColor})}))}]}}),[i,t,a])}({state:t}),d=U().compact([r,l]),c=d.length>0,u=function(e){const{state:t,inputUrl:i,query:a}=e,r=(0,be.O7)(),[{online:l}]=(0,we.oR)(Pa.Z);return(0,s.useMemo)((()=>{if(!i)return;if("notion"===i.type&&l)return;let e;return"web"===i.type?e=n()(M.FormattedMessage,{id:"selectionLinkButton.linkToWebPage",defaultMessage:"Link to web page"}):"notion"===i.type?e=n()(M.FormattedMessage,{id:"selectionLinkButton.linkToPage",defaultMessage:"Link to page"}):"other"===i.type?e=n()(M.FormattedMessage,{id:"selectionLinkButton.linkToURL",defaultMessage:"Link to URL"}):(0,ri.t1)(i.type),{key:"link to url",action:()=>Ba(r,t,a),render:t=>o().createElement(ce.Z,ne()({},t,{title:e,icon:Ut.Z.link({width:16})}))}}),[t,a,r,l,i])}({state:t,inputUrl:a,query:i}),m=function(e){const{state:t,hasResults:i,query:a,linkToUrlItem:r}=e,l=function(e){const{state:t}=e,i=(0,be.O7)();return(0,s.useMemo)((()=>{if(t.editingToken)return{key:"copy link",action:()=>function(e,t){const i=ma(t);if(!i)return;const a=(0,sa.A5)({url:i,baseUrl:Tt.Z.domainBaseUrl,publicDomainName:Tt.Z.publicDomainName}),n=a?(0,fa.Z)({pageId:a,baseUrl:Tt.Z.domainBaseUrl}):i;va.RD({environment:e,stringValue:n,copiedMessage:va.tq.copiedLinkToClipboard}),ra.F5()}(i,t),render:e=>o().createElement(ce.Z,ne()({},e,{title:n()(M.FormattedMessage,{id:"selectionLinkButton.copyLink",defaultMessage:"Copy link",description:"Copies the URL for the focused link to the user's clipboard"}),icon:Ut.Z.copy({width:16})}))}}),[t,i])}({state:t}),d=xa({state:t}),c=function(e){var t;const{state:i,query:a}=e,r=null===(t=(0,dt.QY)(i.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store;return(0,s.useMemo)((()=>{if(!a)return;if(!r||!r.isDefaultRecordCache())return;const e=ga(a);return e&&(e.url===a||"notion"===e.type&&e.notionPage)?void 0:{key:"create page",action:Ea,render:e=>o().createElement(ce.Z,ne()({},e,{icon:Ut.Z.alias({width:16}),title:n()(wa,{pageTitle:a})}))}}),[a,r])}({state:t,query:a});return(0,s.useMemo)((()=>{const e=U().compact([r,l,d,c]);if(0!==e.length)return{key:"link actions",render:e=>o().createElement(ee.Z,ne()({topBorder:i},e)),items:e}}),[i,r,l,d,c])}({query:i,state:t,hasResults:c,linkToUrlItem:u}),p=U().compact([...d,m]);return{sections:p,initialFocus:ka({inputUrl:a,allSections:p,previousSections:d,sectionToFocus:m,itemToFocus:u})}}function Ba(e,t,i){const a=(0,da.D5)(i);a&&(Ye.createAndCommit({userAction:"LinkMenu.handleLinkSelection",environment:e,perform:i=>{ra.gp({environment:e,transaction:i,url:a,editingToken:t.editingToken,savedTextSelectionState:t.savedTextSelectionState})}}),V.trackUrlPaste(e,{pastedText:a,source:"link_menu"}))}function Ea(){const e=ca.Z.state;e.open&&ca.Z.setState({...e,showCreateIn:!0})}function Da(e){const{state:t,placeholder:i}=e,a=(0,be.MO)(),s=(0,M.useIntl)(),o=s.formatMessage({defaultMessage:"Paste link or search pages",id:"selectionLinkButton.search.createNewLinkPlaceholder",description:"Placeholder text in the link input field when there is no current link"}),r=s.formatMessage({defaultMessage:"Edit link or search pages",id:"selectionLinkButton.search.editLinkPlaceholder",description:"Placeholder text in the link input field when there is an existing link that will be modified"}),l=!a||!t.showCreateIn,d=a?void 0:!t.showCreateIn&&t.focusMenu,c=null!=i?i:t.editingToken?r:o;return n()(ee.Z,{isInput:!0,desktopStyle:Ra(t)?{marginBottom:8}:void 0},void 0,l&&n()($.Z,{onFocus:ua,placeholder:c,value:t.url,onChange:La,focus:d,focusInitial:a,focusAfterAnimation:!0,preventCaptureArrowShortcuts:!0}))}function Ra(e){return""===pa(e)&&void 0===ma(e)}const La=e=>{const t=ca.Z.state;t.open&&ca.Z.setState({...t,url:e.target.value,focusMenu:!0})};function Oa(e){const{state:t}=e,i=(0,s.useMemo)((()=>pa(t)),[t]),a=(0,s.useMemo)((()=>ga(i)),[i]),r=function(e){const{state:t,inputUrl:i,query:a,handleLinkSelection:r}=e,l=(0,be.O7)(),[{online:d}]=(0,we.oR)(Pa.Z),c=!!t.url;return(0,s.useMemo)((()=>{let e,s=!1;if(!i&&c)e=n()(M.FormattedMessage,{defaultMessage:"Type a complete URL to link",id:"selectionLinkButton.invalidUrl",description:"Caption for the disabled link to URL menu item when the user has typed an incomplete URL"}),s=!0;else{if(!i)return;if("notion"===i.type&&d)return;"web"===i.type?e=n()(M.FormattedMessage,{id:"selectionLinkButton.linkToWebPage",defaultMessage:"Link to web page"}):"notion"===i.type?e=n()(M.FormattedMessage,{id:"selectionLinkButton.linkToPage",defaultMessage:"Link to page"}):"other"===i.type?e=n()(M.FormattedMessage,{id:"selectionLinkButton.linkToURL",defaultMessage:"Link to URL"}):(0,ri.t1)(i.type)}return{key:"link to url",action:()=>r(l,t,a),render:i=>o().createElement(ce.Z,ne()({},i,{title:t.url,caption:e,icon:Ut.Z.globe2({width:16,paddingTop:4}),disabled:s}))}}),[t,a,l,d,i,r,c])}({state:t,inputUrl:a,query:i,handleLinkSelection:Na}),l=function(e){const{state:t,inputUrl:i,query:a,additionalItem:n}=e,r=_a({state:t,inputUrl:i,query:a,handleLinkSelection:Na,disableEmptyQueryResults:!!t.editingToken});return(0,s.useMemo)((()=>{if(r||n){return{key:"mention results",items:U().compact([...(null==r?void 0:r.items)||[],n]),render:e=>o().createElement(ee.Z,ne()({},e,{isTitleUppercase:!0}))}}}),[r,n])}({state:t,inputUrl:a,query:i,additionalItem:r}),d=function(e){const{state:t}=e,i=ma(t),a=i&&(0,sa.A5)({url:i,baseUrl:Tt.Z.domainBaseUrl,publicDomainName:Tt.Z.publicDomainName}),r=(0,we.VK)((()=>{if(!a)return;const e=(0,Qe.RM)();if(!e)return;const t=Zt.Z.createChildStore(e,{table:S.iU,id:a});return qe.Q(t.getTitleValue())}),[a]);return(0,s.useMemo)((()=>{let e,s=n()(M.FormattedMessage,{defaultMessage:"Page or URL",id:"selectionLinkButton.pageOrUrl",description:"Section title for the currently linked page or URL"});return a&&i?e={key:"link to page",action:()=>{},render:e=>o().createElement(Da,ne()({state:t,placeholder:r},e))}:i?e={key:"link to web",action:()=>{},render:e=>o().createElement(Da,ne()({state:t,placeholder:i},e))}:(s=void 0,e={key:"create link",action:()=>{},render:e=>o().createElement(Da,ne()({state:t},e))}),{key:"page or url",render:e=>o().createElement(ee.Z,ne()({title:s},e)),items:[e]}}),[t,a,r,i])}({state:t}),c=function(e){const{state:t}=e,i=xa({state:t});return(0,s.useMemo)((()=>{const e=U().compact([i]);if(0!==e.length)return{key:"link actions",render:e=>o().createElement(ee.Z,ne()({topBorder:!0},e)),items:e}}),[i])}({state:t}),u=U().compact([d,l,c]);return{initialFocus:ka({inputUrl:a,allSections:u,previousSections:U().compact([d]),sectionToFocus:l,itemToFocus:r}),sections:u}}function Na(e,t,i){const a=(0,da.D5)(i);a&&(Ye.createAndCommit({userAction:"LinkMenu.handleLinkSelection",environment:e,perform:i=>{ra.gp({environment:e,transaction:i,url:a,editingToken:t.editingToken,savedTextSelectionState:t.savedTextSelectionState})}}),V.trackUrlPaste(e,{pastedText:a,source:"link_menu"}))}function Ua(){const[e]=(0,we.oR)(ca.Z),t=(0,be.Fy)(),i=(0,we.VK)(l.bq,[]),a=(0,we.VK)((()=>{if(!e.open)return!1;if(e.focusMenu)return!1;const t=gt.default.state;if("editing"!==t.mode)return!0;const i=(0,dt.QY)(t.multiSelection);if(!i)return!0;const{store:a,selection:n}=i;return(0,Yi.wd)(n)?!qe.oP(a.getValue(),n.startIndex,n.endIndex,qe.GK.Link):!(0,dt._v)(t.multiSelection,e.savedTextSelectionState.multiSelection)}),[e]);return(0,s.useEffect)((()=>{a&&ra.F5()}),[a]),n()(R.ZP,{popupType:t.isMobile?t.isTablet?R.ZP.PopupType.Popup:R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,style:{width:qa(i)},keepFocus:t.isPhone,open:e.open,originRect:e.open?e.selectionRect:void 0,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Center,originGap:8,disableContentScroll:!0,onDismiss:ra.F5,render:()=>e.open?n()(Wa,{state:e}):void 0,preventBlockRenderQueueOnEnter:!t.isMobile})}function Wa(e){const{state:t}=e,i=(0,be.MO)(),a=(0,we.VK)((()=>Kt.default.checkGate("edit_link_v2")),[]),[r,l]=(0,s.useState)(!0);if((0,s.useEffect)((()=>l(!1)),[]),t.showCreateIn&&!i)return n()(za,{state:t});const d=!a&&n()(Da,{state:t});let c;return c=i?{menuType:I.Z.MenuType.Modal,title:n()(M.FormattedMessage,{defaultMessage:"Link",id:"selectionLinkButton.mobile.title"}),right:n()(P.CancelMenuText,{}),onClickRight:ra.F5,header:d,footer:n()(R.ZP,{popupType:R.ZP.PopupType.SlideUp,open:t.showCreateIn||!1,render:()=>n()(za,{state:t})})}:{menuType:I.Z.MenuType.Popup,header:d},n()(ft.Z,{capture:t.open&&(r||t.focusMenu),allowEsc:!0},void 0,o().createElement(I.Z,c,n()(Va,{state:t,useMenuList:a?Oa:Fa})),n()(A.Z,{capture:!0,onCommandSlash:ua}))}function Va(e){const{state:t,useMenuList:i}=e,{initialFocus:a,sections:s}=i({state:t});return n()(ue.Z,{type:ue.Z.Type.Vertical,initialFocus:a,sections:s})}function za(e){var t;const{state:i}=e,a=(0,be.O7)(),o=(0,s.useCallback)((async e=>{var t;if(!la.M_(a))return;const n=null===(t=(0,dt.QY)(i.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store;if(!n)return;const{performResult:{createInState:s}}=await Ye.createAndCommitAsync({environment:a,userAction:"LinkMenu.LinkCreateInMenu",waitForServerCommit:!0,perform:async t=>{const s=(0,oa.f8)({environment:a,transaction:t,titleText:i.url||"",createInValue:e,recordStoreParent:n}),[o]=s.createdPages;return o&&ra.gp({environment:a,url:(0,sa.nR)({pageId:o.id}),transaction:t,editingToken:i.editingToken,savedTextSelectionState:i.savedTextSelectionState}),await s.moveToStorePromise,{createInState:s}}});await(0,oa.c_)({analyticsFrom:"link_menu",createInState:s})}),[i,a]),r=null===(t=(0,dt.QY)(i.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store,d=r&&"block"===r.table?r.id:void 0,c=(0,we.VK)(l.bq,[]);return n()(Ma.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:o,captureSelection:!1,restoreSelection:!1,parentBlockId:d,onAutocompleteQueryChange:Ga,autocompleteQuery:i.createInQuery||"",desktopWidth:qa(c),onCancel:Ha})}function Ga(e){const t=ca.Z.state;t.open&&ca.Z.setState({...t,createInQuery:e})}function Ha(){const e=ca.Z.state;e.open&&ca.Z.setState({...e,showCreateIn:!1,createInQuery:""})}function qa(e){return e?400:330}var Ka=i(27153),ja=i(91390),Ya=i(65792),Qa=i.n(Ya),Ja=i(91584),Xa=i(96802),$a=i(64964),en=i(53471),tn=i(37181),an=i(34809);const nn="fileTypeAnyFiles",sn="fileTypeImages",on="fileTypeVideos",rn="fileTypeNone";var ln=i(4323),dn=i(78609);class cn extends xe.Z{getInitialState(){return{allIcons:{},recentIcons:[],loadIconCount:0}}}const un=cn;var mn=i(33846),pn=i(36324),gn=i(14947),hn=i(73657),fn=i(87648);function vn(e){let{type:t,dropTargetKey:i,children:a,dropzoneStyle:s,onDropFile:r}=e;const[{currentSpaceStore:l}]=(0,we.oR)(d.default);if(!l)return o().createElement(o().Fragment,null,a);const c=e=>1===e.length&&function(e){let{fileMimeType:t,allowedType:i}=e;switch(i){case nn:return!0;case sn:return function(e){return e.startsWith("image")&&!e.includes("photoshop")}(t);case on:return function(e){return e.startsWith("video")}(t);case rn:return!1;default:(0,ri.t1)(i)}}({allowedType:t,fileMimeType:e[0]}),u=e=>{let{files:t}=e;c(t.map((e=>e.type)))?r({type:"validFileDrop",file:t[0]}):r({type:"invalidFileDrop",file:t[0]})};return n()(_.Z,{store:l,droppable:!0,render:()=>n()(fn.G,{dropTargetKey:i,canNativeDropOnto:!0,onNativeDrop:u,keepTextSelectionOnDrop:!0,shouldShowDropZone:!0,dropzoneStyle:s,canAcceptDrop:e=>e.isNativeDrag},void 0,a)})}var yn=i(80527),Sn=i(15095),Mn=i(54153),bn=i(29798),wn=i(46167);const Cn=["gray","lightgray","brown","yellow","orange","green","blue","purple","pink","red"];class Tn extends r.Z{constructor(){super(...arguments),g()(this,"storeTypes",{buttonPopupStore:ya.Z}),g()(this,"renderIconWithVariations",(()=>{const{icon:e,focused:t}=this.props,{buttonPopupStore:i}=this.stores;return n()(A.Z,{capture:t,onEnter:this.handleOpenMenu,onEsc:this.handleCloseMenu},e,n()(wn.Z,{buttonPopupStore:i,popupType:wn.Z.PopupType.Popup,renderOrigin:e=>this.renderSingleIcon(e),render:this.renderVariationMenu}))})),g()(this,"renderSingleIcon",(e=>{const{icon:t,focused:i,color:a,onClick:s,onMouseEnter:r,variations:l}=this.props,d="dark"===this.theme.mode?l.dark:l.light;return n()(ei.Z,{allowHover:Boolean(t),renderTooltip:()=>t.replaceAll("-"," ").replaceAll("_"," "),closeDelay:0,render:l=>o().createElement(gn.Z,ne()({key:t,focused:i,onClick:s},(0,pi.Z)(e||{},(0,pi.Z)({onMouseEnter:r},l)),{ignoreLocalHoverState:!0,style:this.styles.iconButton}),n()("img",{src:"data:image/svg+xml;utf8,".concat(encodeURIComponent(d[a])),style:this.styles.iconImage,onContextMenu:e=>e.preventDefault()}))})})),g()(this,"renderVariationMenu",(e=>{const{icon:t,variations:i,insertIcon:a}=this.props,s="dark"===this.theme.mode?i.light:i.dark,r=Object.keys(s).sort(((e,t)=>Cn.indexOf(e)-Cn.indexOf(t))).map((n=>{const s="".concat(t,"_").concat(n);return{key:s,action:t=>{e.close(),a("/icons/".concat(s,".svg"))},render:e=>o().createElement(Tn,ne()({},this.props,e,{icon:s,color:n,variations:i,inVariationPopup:!0}))}}));return n()(ft.Z,{capture:!0,allowEsc:!0},void 0,n()(ue.Z,{type:ue.Z.Type.Grid,itemsPerRow:5,initialFocus:0,sections:[{key:"variations",render:e=>o().createElement("div",e),items:r}],renderRow:(e,t)=>n()("div",{style:this.styles.variationMenu},t,e)}))})),g()(this,"handleOpenMenu",(e=>{e.preventDefault();const{buttonPopupStore:t}=this.stores;t.setState({...t.state,open:!0})})),g()(this,"handleCloseMenu",(()=>{const{buttonPopupStore:e}=this.stores;e.setState({...e.state,open:!1})})),g()(this,"styles",{iconButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,...this.getIconButtonSize()},variationMenu:{display:"flex",padding:2,gap:1},iconImage:{width:24,height:24}})}renderComponent(){const{inVariationPopup:e}=this.props;return e?this.renderSingleIcon():this.renderIconWithVariations()}getIconButtonSize(){const{desktopButtonSize:e,desktopFontSize:t,mobileButtonSize:i,mobileFontSize:a}=this.props,{device:n}=this.environment;return n.isMobile?{width:i,height:i,fontSize:a}:{width:e,height:e,fontSize:t}}}g()(Tn,"defaultProps",{desktopButtonSize:32,desktopFontSize:24,mobileButtonSize:44,mobileFontSize:32});const kn=Tn;var Zn=i(12235);class An extends r.Z{constructor(){super(...arguments),g()(this,"splitFilter",[]),g()(this,"storeTypes",{store:un,menuListStore:bn.Z}),g()(this,"insertIcon",(e=>{const t=this.getNormalizedIconPath(e);this.props.onSubmit(t);const i=t.split(/[/_.]/),a=i[2],n=i[3];this.addToRecentIcons(a),this.props.iconLoggingData&&(0,V.trackIconActions)(this.environment,"pick_colored_icon",{icon:a,color:n,...this.props.iconLoggingData})})),g()(this,"createListItem",((e,t)=>{const i="/icons/".concat(e,".svg");return{key:i,action:e=>this.handleIconButtonClick(i),render:i=>o().createElement(kn,ne()({},i,{icon:e,color:"gray",variations:t,insertIcon:this.insertIcon,inVariationPopup:!1,desktopButtonSize:An.desktopIconButtonSize,mobileButtonSize:An.mobileIconButtonSize}))}})),g()(this,"performGetAllIconsRequest",(async e=>{const t=await(0,an.Z)({environment:this.environment,url:e,method:"GET",format:"json",mode:"cors"});if("success"===t.type)return this.stores.store.setState({...this.stores.store.state,allIcons:t.data}),t.data;throw t.error})),g()(this,"createCategory",((e,t)=>{if(!t)return;let i=[];return i="recent"===e.id?this.stores.store.state.recentIcons||[]:Object.keys(t),0!==i.length?{key:e.id,items:i.map((e=>this.createListItem(e,t[e]))),render:t=>n()(ee.Z,{isTitleUppercase:!0,title:e.title},t.key,n()("div",{style:this.getIconSectionWrapStyle()},void 0,t.children))}:void 0})),g()(this,"handleScroll",(e=>{if(Math.abs(e)<An.loadMoreCategoryEdgeDistance){const{loadIconCount:e,allIcons:t}=this.stores.store.state,i=this.environment.device.isMobile?144:84,a=Math.max(i,this.getAllSectionsIconCount(t));this.stores.store.setState({...this.stores.store.state,loadIconCount:Math.min(a,e+i)})}})),g()(this,"handleIconButtonClick",(e=>{this.insertIcon(e)})),g()(this,"getNormalizedIconPath",(e=>e.replace("_dark","")))}willMount(e){super.willMount(e);const t=Mn.Z.get(An.localRecentIconsKey);this.stores.store.setState({...this.stores.store.state,recentIcons:t||[]})}renderComponent(){return n()(Ri.Z,{request:"/icons/all",performRequest:this.performGetAllIconsRequest,render:(e,t)=>this.renderIconPicker(t)})}renderIconPicker(e){const{menuListStore:t}=this.stores,i=this.getVisibleSections(this.getAllSections(e)),a=!this.environment.device.isPhone&&i.length>0?0:void 0;return n()("div",{style:An.wrapStyle},void 0,n()("div",{style:{flexGrow:1}},void 0,o().createElement(ue.Z,ne()({},this.getMenuListProps(),{store:t,initialFocus:a,sections:i,disableMouseLeaveBlur:!0,disableKeyboardArrowWrap:!0,unfocusOnScroll:this.environment.device.isMobile}))),n()(Zn.Z,{onChange:this.handleScroll}))}getCategories(){return U().compact([!this.props.filter&&{id:"recent",title:n()(M.FormattedMessage,{id:"iconPicker.section.recent",defaultMessage:"Recent",description:"Heading for recently selected icons in the icon picker"})},!this.props.filter&&{id:"icons",title:n()(M.FormattedMessage,{id:"iconPicker.section.icons",defaultMessage:"Icons",description:"Heading for all icons in the icon picker"})}])}createFilteredSection(e,t){if(!t)return[];return[{key:"search-results",items:this.filterAndSortIcons(e,this.splitFilter,t).map((e=>this.createListItem(e,t[e]))),render:e=>n()(ee.Z,{},e.key,n()("div",{style:this.getIconSectionWrapStyle()},void 0,e.children))}]}getMenuListProps(){const{device:e}=this.environment;return e.isMobile?{type:ue.Z.Type.Vertical}:{type:ue.Z.Type.Grid,itemsPerRow:An.desktopItemsPerRow,renderRow:(e,t)=>n()("div",{style:An.rowStyle},t,e)}}addToRecentIcons(e){const t=Mn.Z.get(An.localRecentIconsKey),i=U().union([e],t),a=U().take(i,An.recentIconsCount);Mn.Z.set(An.localRecentIconsKey,a),this.stores.store.setState({...this.stores.store.state,recentIcons:a})}getAllSections(e){const t=Sn.rJ(this.props.filter);this.splitFilter=t?t.split(" ").filter(Boolean):[];const i=U().compact(this.getCategories().map((t=>this.createCategory(t,e))));return this.props.filter&&t?this.createFilteredSection(t,e):i}getAllSectionsIconCount(e){const t=this.getAllSections(e);let i=0;for(const a of t)i+=a.items.length;return i}getVisibleSections(e){let{loadIconCount:t}=this.stores.store.state;0===t&&(t+=this.environment.device.isMobile?144:84);const i=[];let a=0;for(const n of e){if(!(a+n.items.length<=t)){i.push({...n,items:n.items.slice(0,t-a)});break}i.push(n),a+=n.items.length}return i}filterAndSortIcons(e,t,i){const a=U().compact(Object.keys(i).map((a=>{const n=i[a].tags||[],s=n.findIndex((t=>t===e));if(-1!==s)return[10*(10-s),a];const o=n.findIndex((t=>t.startsWith(e)));if(-1!==o)return[10-o,a];if(t.length>1){if(t.every((e=>n.find((t=>t.startsWith(e))))))return[t.length,a]}return n.some((t=>t.includes(e)))?[1,a]:void 0})));return U().sortBy(a,(e=>-e[0])).map((e=>e[1]))}getIconSectionWrapStyle(){const{device:e,WindowSizeStore:t}=this.environment,{type:i}=this.getMenuListProps();return{display:"flex",flexDirection:i===ue.Z.Type.Grid?"column":"row",flexWrap:"wrap",alignItems:"flex-start",background:e.isMobile?this.theme.popoverBackground:Ot.ZP.transparent,paddingTop:e.isMobile?10:0,paddingBottom:e.isMobile?10:0,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(10):An.desktopPaddingLeft,paddingRight:e.isMobile?t.getSafePaddingLeftCSS(10):An.desktopPaddingRight,boxShadow:e.isMobile?"0 1px 0 ".concat(this.theme.regularDividerColor):"",marginBottom:1}}}g()(An,"loadMoreCategoryEdgeDistance",50),g()(An,"recentIconsCount",24),g()(An,"desktopItemsPerRow",12),g()(An,"localRecentIconsKey","recentIcons"),g()(An,"desktopIconButtonSize",32),g()(An,"desktopPaddingLeft",12),g()(An,"desktopPaddingRight",0),g()(An,"desktopSpacingRight",22),g()(An,"mobileIconButtonSize",44),g()(An,"wrapStyle",{display:"flex",flexDirection:"column"}),g()(An,"rowStyle",{display:"flex"});const In=An;var Pn=i(4637),_n=i(42402),xn=i(86512),Fn=i(78948),Bn=i(48243),En=i(33058),Dn=i(6202),Rn=i(46034);const Ln=(0,M.defineMessages)({embedPlaceholder:{id:"mediaPicker.embedPlaceholder.text",defaultMessage:"Paste in https://…"},filterPlaceholder:{id:"mediaPicker.emojiFilter.text",defaultMessage:"Filter…"},unsplashPlaceholder:{id:"mediaPicker.unsplashPlaceholder.text",defaultMessage:"Search for an image…"}});class On extends r.Z{constructor(){super(...arguments),g()(this,"storeTypes",{embedInputStore:mn.Z,emojiInputStore:mn.Z,emojiPickerStore:dn.Z,iconInputStore:mn.Z,iconPickerStore:un,unsplashInputStore:mn.Z}),g()(this,"renderUnsplashResults",((e,t,i,a)=>a?!i||i&&!i.length?n()(hn.Z,{shouldWrapCaption:!0,caption:n()(M.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.unsplash.noResultsText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}):n()(s.Fragment,{},void 0,i.map((t=>this.renderUnsplashImage(e,t))),n()(hn.Z,{shouldWrapCaption:!0,caption:n()(M.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.unsplash.searchText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}})):n()("div",{style:this.getLoadingContainerStyle()},void 0,n()(Xt.Z,{})))),g()(this,"renderUnsplashImage",((e,t)=>{const{device:i}=this.environment;return n()("div",{style:{width:i.isMobile?"33%":"25%",padding:3}},t.id,n()(gn.Z,{hoveredStyle:{opacity:.85},onClick:()=>this.handleSelectUnsplashImage(e,t)},void 0,n()(Pn.Z,{src:t.thumbUrl,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:3}})),n()(ye.Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:2,marginBottom:4}},void 0,n()(M.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.unsplash.byAuthor",description:"Caption attributing the author of the Unsplash image",values:{authorName:t.authorName,inlinetextlink:function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return n()(_n.Z,{external:!0,href:t.unsplashUrl},void 0,i)}}})))})),g()(this,"handleEmbedSubmit",(e=>()=>{const t=this.stores.embedInputStore.state.inputValue;t&&(e.onChange(t),V.trackUrlPaste(this.environment,{pastedText:t,source:"media_picker"}))})),g()(this,"handleSelectUnsplashImage",(async(e,t)=>{const i=await(0,an.Z)({environment:this.environment,url:t.downloadUrl,method:"GET",format:"json"});"success"===i.type&&e.onChange({url:i.data.url})})),g()(this,"handleSwipeLeft",(()=>{if(!ja.Z.state.isActive)return;const e=this.getTabs(),t=e.map((e=>e.type)).indexOf(ja.Z.state.currentTab),i=e[t+1];void 0!==i&&this.handleTabChange(i.type)})),g()(this,"handleSwipeRight",(()=>{if(!ja.Z.state.isActive)return;const e=this.getTabs(),t=e.map((e=>e.type)).indexOf(ja.Z.state.currentTab),i=e[t-1];void 0!==i&&this.handleTabChange(i.type)})),g()(this,"handleTabChange",(e=>{ja.Z.state.isActive&&(ja.Z.setState({...ja.Z.state,currentTab:e}),"icon"===e&&(this.setSeenIconPickerNewBadge({environment:this.environment,seen:!0}),ja.Z.state.recordIconLoggingData&&V.trackMediaPicker(this.environment,"select_icon_tab",ja.Z.state.recordIconLoggingData)))})),g()(this,"handleRandomEmojiClick",(()=>{const{device:e}=this.environment,t=this.getTabs().find((e=>e.type===this.props.currentTab));if(t&&"emoji"===t.type){const i=(0,Xa.zM)();t.onChange(i,{keepVisible:!e.isMobile})}})),g()(this,"handleRandomIconClick",(()=>{const{device:e}=this.environment,{iconPickerStore:t}=this.stores,i=this.getTabs().find((e=>e.type===this.props.currentTab));if(i&&"icon"===i.type){const a=U().sample(Object.keys(t.getState().allIcons)),n=U().sample(Cn),s="/icons/".concat(a,"_").concat(n,".svg");i.onChange(s,{keepVisible:!e.isMobile})}})),g()(this,"handleFilterChange",(e=>{const{emojiInputStore:t,emojiPickerStore:i,iconInputStore:a,iconPickerStore:n}=this.stores;t.setState({...t.state,inputValue:e.currentTarget.value}),i.setState({...i.state,loadEmojiCount:dn.Z.emojisPerPage}),a.setState({...a.state,inputValue:e.currentTarget.value}),n.setState({...n.state,loadIconCount:84})}))}renderComponent(){const{device:e}=this.environment,t=this.renderTabsHeader(),i=this.renderInputHeader(),a=(t||i)&&n()(s.Fragment,{},void 0,t,i);let r;if(e.isMobile)r={menuType:I.Z.MenuType.Modal,title:this.props.title,header:a,right:n()(M.FormattedMessage,{defaultMessage:"Close",id:"mediaPicker.mobileCloseButton.label"}),onClickRight:this.props.onCancel,left:this.props.onDelete&&n()(M.FormattedMessage,{defaultMessage:"Remove",id:"mediaPicker.mobileRemoveButton.label"}),onClickLeft:this.props.onDelete};else{r={menuType:I.Z.MenuType.Popup,header:a};const e=this.getTabs().find((e=>e.type===this.props.currentTab)),t=e&&"custom"===e.type?e.tabHeight:void 0;r.width=this.props.popupWidth||300,r.height=t||this.props.popupHeight,r.maxHeight=this.props.maxHeight,r.maxWidth=this.props.maxWidth}return n()(Rn.Z,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>o().createElement(I.Z,ne()({},r,e,{className:re.tQ}),this.renderCurrentTab())})}renderTabsHeader(){const{device:e}=this.environment;if(!(this.getTabs().length<=1)||this.props.onDelete){const t={gallery:n()(M.FormattedMessage,{id:"mediaPicker.tabs.gallery",defaultMessage:"Gallery"}),embed:n()(M.FormattedMessage,{id:"mediaPicker.tabs.embedLink",defaultMessage:"Embed link"}),file:n()(M.FormattedMessage,{id:"mediaPicker.tabs.upload",defaultMessage:"Upload"}),emoji:n()(M.FormattedMessage,{id:"mediaPicker.tabs.emoji",defaultMessage:"Emoji"}),icon:n()(M.FormattedMessage,{id:"mediaPicker.tabs.icon",defaultMessage:"Icon",description:"Icon tab heading"}),custom:n()(M.FormattedMessage,{id:"mediaPicker.tabs.custom",defaultMessage:"Custom",description:"Upload or embed a custom image"}),unsplash:n()(s.Fragment,{},void 0,Ut.Z.unsplashLogo({width:12,marginRight:4,height:12}),n()("span",{},void 0,"Unsplash")),drive:n()(M.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"})},i=this.getTabs(),a=i.findIndex((e=>e.type===this.props.currentTab)),o=i.map((e=>e.title||t[e.type])),r=i.find((e=>e.type===this.props.currentTab)),l=r&&"emoji"!==r.type&&e.isAndroid;return n()(x.Z,{tabs:o,selectedIndex:a,onChange:e=>{const t=i[e];this.handleTabChange(t.type)},right:this.props.onDelete&&!e.isMobile&&n()($t.Z,{isGray:!0,onClick:this.props.onDelete},void 0,n()(M.FormattedMessage,{id:"mediaPicker.tabs.remove",defaultMessage:"Remove"})),style:{...l&&{borderBottom:"none"}}})}}renderInputHeader(){const{device:e}=this.environment,t=this.getTabs().find((e=>e.type===this.props.currentTab)),i=!e.isMobile||void 0;if(t){if("emoji"===t.type)return n()("div",{style:{display:"flex",margin:e.isMobile?0:"16px 0 10px"}},void 0,n()($.Z,{value:this.stores.emojiInputStore.state.inputValue,focusInitial:i,placeholder:le.default.formatMessage(Ln.filterPlaceholder),showClearButton:!0,left:Ut.Z.searchThick(this.getSearchIconStyle()),inputRight:n()(ei.Z,{renderTooltip:()=>n()(M.FormattedMessage,{id:"mediaPicker.emojiTab.random",defaultMessage:"Random"}),placement:ei.Z.Placement.Bottom,render:e=>o().createElement(yn.Z,ne()({icon:Ut.Z.shuffle,onClick:this.handleRandomEmojiClick},e))}),onChange:this.handleFilterChange,style:{...e.isAndroid&&{borderBottom:"none"}}}));if("icon"===t.type)return n()("div",{style:{margin:e.isMobile?0:"16px 0 10px"}},void 0,n()($.Z,{value:this.stores.iconInputStore.state.inputValue,focusInitial:i,placeholder:le.default.formatMessage(Ln.filterPlaceholder),showClearButton:!0,left:Ut.Z.searchThick(this.getSearchIconStyle()),inputRight:n()(ei.Z,{renderTooltip:()=>n()(M.FormattedMessage,{id:"mediaPicker.emojiTab.random",defaultMessage:"Random"}),placement:ei.Z.Placement.Bottom,render:e=>o().createElement(yn.Z,ne()({icon:Ut.Z.shuffle,onClick:this.handleRandomIconClick},e))}),onChange:this.handleFilterChange,style:{...e.isAndroid&&{borderBottom:"none"}}}))}}renderCurrentTab(){const e=this.getTabs().find((e=>e.type===this.props.currentTab));if(!e)return n()(M.FormattedMessage,{defaultMessage:"Uh oh! Something went wrong.",id:"mediaPicker.errorMessage"});switch(e.type){case"embed":return this.renderEmbedTab(e);case"file":return this.renderUploadTab(e);case"emoji":return this.renderEmojiTab(e);case"icon":return this.renderIconTab(e);case"gallery":return this.renderGalleryTab(e);case"unsplash":return this.renderUnsplashTab(e);case"drive":return this.renderGoogleDriveTab(e);case"custom":return this.renderCustomEmbedUploadTab(e)}}renderEmojiTab(e){return n()(Dt.Z,{onSubmit:e.onChange,filter:this.stores.emojiInputStore.state.inputValue||"",store:this.stores.emojiPickerStore,isCallout:this.props.isCallout,iconLoggingData:this.props.recordIconLoggingData})}renderIconTab(e){return n()(In,{store:this.stores.iconPickerStore,filter:this.stores.iconInputStore.state.inputValue||"",onSubmit:e.onChange,iconLoggingData:this.props.recordIconLoggingData})}renderGalleryTab(e){return n()("div",{style:{paddingBottom:8}},void 0,U().map(ln.Z,((t,i)=>n()(ee.Z,{title:n()(xn.Z,{style:{marginLeft:-5},href:t.url,external:!0},void 0,n()(En.Z,{},void 0,le.default.formatMessage(t.title))),isTitleUppercase:!0,noTextOverflow:!0},i,n()("div",{style:this.getGalleryWrapStyle()},void 0,t.items.map(((t,i)=>{let{coverUrl:a,title:s,subtitle:r,position:l}=t;return n()("div",{style:{width:"25%",padding:3}},i,n()(ei.Z,{originGap:0,placement:ei.Z.Placement.Bottom,delayThreshold:600,renderTooltip:()=>n()("div",{style:{maxWidth:180,whiteSpace:"normal"}},void 0,n()("span",{style:{color:this.theme.regularInvertedTextColor}},void 0,le.default.formatMessage(s))," ",n()("span",{style:{color:this.theme.mediumInvertedTextColor}},void 0,r&&le.default.formatMessage(r))),render:t=>o().createElement(gn.Z,ne()({hoveredStyle:{opacity:.85}},t,{onClick:()=>{e.onChange({url:a,position:l})}}),n()(Bn.Z,{url:a,width:200,isAuthenticated:!1,render:(e,t)=>t&&n()(Pn.Z,{src:t,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center ".concat(100*(l||0),"%"),borderRadius:3}})}))}))})))))))}renderUnsplashTab(e){const{device:t}=this.environment;return n()("div",{style:{paddingBottom:8}},void 0,n()(ee.Z,{desktopStyle:{marginTop:8,marginBottom:6}},void 0,n()($.Z,{value:this.stores.unsplashInputStore.state.inputValue,placeholder:le.default.formatMessage(Ln.unsplashPlaceholder),showClearButton:!0,focus:!t.isMobile||void 0,onChange:e=>{this.stores.unsplashInputStore.setState({...this.stores.unsplashInputStore.state,inputValue:e.target.value})}})),n()("div",{style:this.getGalleryWrapStyle()},void 0,n()(Ri.Z,{request:this.stores.unsplashInputStore.state.inputValue,debounce:Aa.vp,performRequest:async e=>{const t=await di.searchUnsplashImages(this.environment,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(t,i,a)=>this.renderUnsplashResults(e,t,i,a)})))}renderCustomEmbedUploadTab(e){var t;const{device:i}=this.environment,{data:a}=Si.default.state,s=n()(ee.Z,{desktopStyle:{marginTop:16,display:"flex",paddingTop:0,paddingBottom:12}},void 0,n()($.Z,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||le.default.formatMessage(Ln.embedPlaceholder),autoFocus:!i.isMobile||void 0,showClearButton:!0,focus:!i.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})}}),n()(Mi.Z,{onClick:this.handleEmbedSubmit(e),hovered:!1,style:i.isMobile?{width:"100%",marginTop:10,borderRadius:0}:{marginRight:10}},void 0,e.buttonText||n()(M.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"}))),r=n()(vn,{type:null!==(t=this.getAllowedFileTypeFromTab(e))&&void 0!==t?t:rn,dropTargetKey:"uploadTab",onDropFile:t=>{"invalidFileDrop"!==t.type?e.onUpload(t.file):(0,$a.oV)({label:n()(M.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",description:"Error message that shows when a user tries to drop an invalid file type into the image upload modal.",defaultMessage:"Sorry, that file type is not supported."})})},dropzoneStyle:{background:(0,Ot.fn)([Ot.ZP.blueWithAlpha(.2),Qa()(this.theme.contentBackground).alpha(.5).css()])}},void 0,n()("div",{style:{marginTop:-24,paddingTop:24}},void 0,e.fileUpload&&n()(ee.Z,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24}},void 0,n()(Dn.Z,{title:n()(M.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>this.handleUpload(e),fullWidth:this.props.isSmallWidth})),this.renderMediaCapture(e),e.caption&&n()(hn.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}),e.preventUploadLimitFreeFileSize||a&&fi.YK(a)&&n()("div",{style:{height:8}}),a&&!e.preventUploadLimitFreeFileSize&&!fi.YK(a)&&n()(hn.Z,{shouldWrapCaption:!0,caption:n()("div",{style:{display:"flex",alignItems:"center",justifyContent:this.props.isSmallWidth?"flex-start":"center"}},void 0,n()("div",{style:{marginRight:6,color:this.theme.mediumTextColor}},void 0,n()(M.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:en.K_}})),!pn.default.isOnboarding.state&&n()(zi.Z,{subscriptionTier:fi.M9(this.environment)||"team",onClick:()=>{this.props.onCancel&&this.props.onCancel()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}}))})));return o().createElement(o().Fragment,null,s,r)}renderUploadTab(e){var t;const{data:i}=Si.default.state;return n()(vn,{type:null!==(t=this.getAllowedFileTypeFromTab(e))&&void 0!==t?t:rn,dropTargetKey:"uploadTab",onDropFile:t=>{"invalidFileDrop"!==t.type?e.onUpload(t.file):(0,$a.oV)({label:n()(M.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",description:"Error message that shows when a user tries to drop an invalid file type into the image upload modal.",defaultMessage:"Sorry, that file type is not supported."})})},dropzoneStyle:{background:(0,Ot.fn)([Ot.ZP.blueWithAlpha(.2),Qa()(this.theme.contentBackground).alpha(.5).css()])}},void 0,n()("div",{style:{marginTop:-24,paddingTop:24}},void 0,e.fileUpload&&n()(ee.Z,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24}},void 0,n()(Dn.Z,{title:n()(M.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>this.handleUpload(e),fullWidth:this.props.isSmallWidth})),this.renderMediaCapture(e),e.caption&&n()(hn.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}),e.preventUploadLimitFreeFileSize||i&&fi.YK(i)&&n()("div",{style:{height:8}}),i&&!e.preventUploadLimitFreeFileSize&&!fi.YK(i)&&n()(hn.Z,{shouldWrapCaption:!0,caption:n()("div",{style:{display:"flex",alignItems:"center",justifyContent:this.props.isSmallWidth?"flex-start":"center"}},void 0,n()("div",{style:{marginRight:6,color:this.theme.mediumTextColor}},void 0,n()(M.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:en.K_}})),!pn.default.isOnboarding.state&&n()(zi.Z,{subscriptionTier:fi.M9(this.environment)||"team",onClick:()=>{this.props.onCancel&&this.props.onCancel()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}}))})))}renderMediaCapture(e){const{device:t}=this.environment;if(e.imageUpload||e.videoUpload)return n()(ee.Z,{desktopStyle:{marginTop:4,display:"flex",justifyContent:"center"}},void 0,e.imageUpload&&n()(ze.Z,{isLarge:!0,focused:!0,onClick:()=>this.handleUpload(e,"image/*"),style:t.isMobile?{width:"100%"}:{width:"95%"}},void 0,n()(M.FormattedMessage,{defaultMessage:"Upload file",id:"mediaPicker.chooseImage.buttonText"})),e.videoUpload&&n()(Dn.Z,{title:n()(M.FormattedMessage,{defaultMessage:"Choose a video",id:"mediaPicker.chooseVideo.buttonText"}),onClick:()=>this.handleUpload(e,"video/*"),fullWidth:this.props.isSmallWidth}))}renderEmbedTab(e){const{device:t}=this.environment;return n()(s.Fragment,{},void 0,n()(ee.Z,{desktopStyle:{marginTop:8,marginBottom:6}},void 0,n()($.Z,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||le.default.formatMessage(Ln.embedPlaceholder),autoFocus:!t.isMobile||void 0,showClearButton:!0,focus:!t.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})}})),n()(ee.Z,{},void 0,n()(Dn.Z,{onClick:this.handleEmbedSubmit(e),title:e.buttonText||n()(M.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"}),fullWidth:this.props.isSmallWidth})),e.caption&&n()(hn.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:t.isMobile?"left":"center"}}))}renderGoogleDriveTab(e){return n()(Ri.Z,{request:this.environment,performRequest:Ja.vQ,render:(t,i,a)=>{if(!a)return n()(ee.Z,{},void 0,n()(Fn.Z,{}));const s=i&&i.accounts?i.accounts:[];return this.renderGoogleDriveAccounts(e,s)}})}renderGoogleDriveAccounts(e,t){return 0===t.length?n()(ee.Z,{},void 0,n()(ce.Z,{title:n()(M.FormattedMessage,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>e.onSelect(),focused:!1,style:{color:this.theme.blueColor}}),n()(hn.Z,{shouldWrapCaption:!1,caption:n()(M.FormattedMessage,{defaultMessage:"Find and embed your Google Drive files.",id:"mediaPicker.menuItem.connectFirstGoogleAccount.caption"})})):n()(s.Fragment,{},void 0,n()(ee.Z,{},void 0,t.map(((t,i)=>n()(ce.Z,{title:n()(M.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.accountName}}),onClick:()=>e.onSelect(t),focused:!1},t.accountId)))),n()(ee.Z,{topBorder:!0},void 0,n()(ce.Z,{title:n()(M.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1})))}getTabs(){return this.props.tabs}getAllowedFileTypeFromTab(e){return e.fileUpload?nn:e.imageUpload?sn:e.videoUpload?on:void 0}setSeenIconPickerNewBadge(e){const{environment:t,seen:i}=e,{currentUserSettingsStore:a}=d.default.state;a&&(0,Ye.createAndCommit)({userAction:"mediaPicker.setSeenIconPickerNewBadge",environment:t,perform:e=>{(0,tn.d2)({userSettingsStore:a,transaction:e,data:{seen_icon_picker_new:i}})}})}async handleUpload(e,t){const i=await en.y({multiple:!1,accept:t});i.length&&e.onUpload(i[0])}getLoadingContainerStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1}}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,color:this.theme.regularIconColor}}getGalleryWrapStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexWrap:"wrap",alignContent:"flex-start",background:this.theme.popoverBackground,paddingTop:e.isMobile?12:0,paddingBottom:e.isMobile?12:0,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(14):12,paddingRight:e.isMobile?t.getSafePaddingRightCSS(14):12,boxShadow:e.isMobile?"0 1px 0 ".concat(this.theme.regularDividerColor):""}}}const Nn=On;class Un extends r.Z{constructor(){super(...arguments),g()(this,"handleCloseOverlay",(()=>{Ka.Z()}))}renderComponent(){const{device:e}=this.environment,{state:t}=ja.Z;return n()(R.ZP,{popupType:e.isMobile?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originRect:void 0,originGap:t.isActive?t.originGap:void 0,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Center,preventScaleTransition:!0,onDismiss:this.handleCloseOverlay,render:()=>{if(t.isActive)return o().createElement(Nn,ne()({},t,{onCancel:this.handleCloseOverlay}))}})}}const Wn=Un;var Vn=i(41892),zn=i(57269),Gn=i(32918),Hn=i(85114),qn=i(92338),Kn=i(9900),jn=i(47798),Yn=i(77100),Qn=i(17731),Jn=i(80084),Xn=i(472),$n=i(19111),es=i(69454),ts=i(72087),is=i(29026),as=i(16328),ns=i(60442),ss=i(97680);const os=(0,M.defineMessages)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"},addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}}),rs=(0,M.defineMessages)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime",description:"dateTime will be a message representing the date (with or without time) that the user wants to be reminded at, like 'Tomorrow 3pm' or 'Mar 1, 2020'"},noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title",description:"A label describing that no results have been found."}});class ls extends r.Z{constructor(){super(...arguments),g()(this,"storeTypes",{ignoreSelectionAreaStore:Sa.Z,localPageMentionRequestStore:ts.Z,localCachePageMentionRequestStore:ts.Z}),g()(this,"renderMentionResult",((e,t)=>{const{intl:i}=this.props,a=$n.Z.state,s=a.open&&a.insertionType,r={sections:[],nextSectionShouldHaveTopBorder:()=>r.sections.length>0,addSection(e){e&&this.sections.push(e)}};"+"===s&&r.addSection(this.getCreatePageMenuSection(r.nextSectionShouldHaveTopBorder())),r.addSection(this.getDateResultsMenuSection(t,r.nextSectionShouldHaveTopBorder())),r.addSection(this.getUserResultsMenuSection(t,r.nextSectionShouldHaveTopBorder())),r.addSection(this.getPageResultsMenuSection(t,r.nextSectionShouldHaveTopBorder())),("@"===s&&this.filterStore.state||"[["===s)&&r.addSection(this.getCreatePageMenuSection(r.nextSectionShouldHaveTopBorder()));const{sections:l}=r;let d,c;if(Pa.Z.state.online){const e=a.mentionTypes.user,t=a.mentionTypes.page,n=a.mentionTypes.date;let s="";const o=os;e&&t&&n?s=i.formatMessage(o.mentionAll):e&&t?s=i.formatMessage(o.mentionPersonPage):e&&n?s=i.formatMessage(o.mentionPersonDate):t&&n?s=i.formatMessage(o.mentionPageDate):e?s=i.formatMessage(o.mentionPerson):n?s=i.formatMessage(o.mentionDate):t&&a&&(s=a.open&&"+"===a.insertionType?i.formatMessage(os.addPage):i.formatMessage(o.mentionPage)),this.setTemporaryInputData({title:s,icon:this.renderTemporaryInputEmptyIcon(),allowTabCompletion:!1}),d=void 0}else d=n()(as.Z,{title:n()(M.FormattedMessage,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})});0===l.length&&(c=n()(ee.Z,{},void 0,n()(as.Z,{title:o().createElement(M.FormattedMessage,rs.noResults)})));const{device:u}=this.environment;let m;return m=this.isActionSheet()?{menuType:I.Z.MenuType.ActionSheet,disableBottomPadding:!0,height:"calc(70vh - ".concat(es.Z.estimatedNativeWebBottomOverlap(),"px)")}:{menuType:I.Z.MenuType.Popup,width:this.getMenuDesktopWidth(),maxHeight:u.isMobile?"30vh":"40vh",onClickOutside:this.makeHandleCancelCallback()},o().createElement(I.Z,ne()({},m,{header:d}),n()(A.Z,{capture:$n.Z.state.open,onBackspace:this.shouldCaptureBackspace()?this.handleEmptyBackspace:void 0,onTab:this.handleTab}),n()(ue.Z,{type:ue.Z.Type.Vertical,initialFocus:this.getMenuInitialFocus(),sections:l,onEmptyEnter:this.makeHandleCancelCallback()}),c)})),g()(this,"handleCreateInAutocompleteQueryChange",(e=>{this.updateOpenState({createInQuery:e})})),g()(this,"renderCreateInMenu",(()=>{const e=$n.Z.state;if(!e.open)return;const t="block"===e.textStore.table?e.textStore.id:void 0;return n()(Ma.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{jn.Br({environment:this.environment,titleText:this.getNormalizedFilter(),ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,createInValue:e,menuListItemAction:void 0})},captureSelection:!0,restoreSelection:!0,parentBlockId:t,onAutocompleteQueryChange:this.handleCreateInAutocompleteQueryChange,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,autocompleteQuery:e.createInQuery,desktopWidth:this.getMenuDesktopWidth(),onCancel:this.handleCreateInCancel})})),g()(this,"handleCreateInStart",(()=>{this.updateOpenState({showCreateIn:!0})})),g()(this,"handleCreateInCancel",(()=>{this.updateOpenState({showCreateIn:!1,createInQuery:""})})),g()(this,"handleEmptyBackspace",(e=>{this.shouldCaptureBackspace()&&e.preventDefault(),this.makeHandleCancelCallback()()})),g()(this,"makeHandleCancelCallback",(()=>{const e=$n.Z.state,t=this.getNormalizedFilter(),i=jn.WI();let a=Date.now();return e.open&&(a=e.openTime),()=>{V.trackMentionMenuAbandon(this.environment,{timeToAbandonInMs:Date.now()-a,queryLength:t.length,analyticsFrom:i}),jn.xv()}})),g()(this,"handleTab",(e=>{e.preventDefault();const t=this.tabCompletionString;if(!t)return;const i=gt.default.state;if("editing"!==i.mode)return;const a=(0,dt.QY)(i.multiSelection);if(!a)return;const n=$n.Z.state;n.open&&n.textStore===a.store&&Ye.createAndCommit({userAction:"MentionMenu.handleTab",environment:this.environment,perform:e=>{Yn.hJ({environment:this.environment,transaction:e,string:t,store:a.store,selection:a.selection,disableMentions:!0,disableDateMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0})}})})),g()(this,"tabCompletionString",void 0),g()(this,"letterCharacterClass",(()=>{try{return/\p{L}/u}catch(e){return/[a-zA-Z]/}})()),g()(this,"inputSelectionsStore",this.createComputedStore((()=>{const e=$n.Z.state;if(e.open)return Bt.O2(e.textStore,e.oldTextValue,e.insertionType)}))),g()(this,"filterStore",this.createComputedStore((()=>{const e=this.inputSelectionsStore.state,t=$n.Z.state;if(e&&t.open)return Bt.ug(t.textStore,e)}))),g()(this,"popupOpenStore",this.createComputedStore((()=>{const e=$n.Z.state;return!!e.open&&("+"!==e.insertionType||""!==this.getNormalizedFilter())}))),g()(this,"performUserMentionRequest",(async e=>{const t=$n.Z.state;if(!t.open)return;const i=t.mentionTypes.user?await this.getUserResults(e):[];return""===e?i.slice(0,2):i.slice(0,20)})),g()(this,"performLocalCachePageMentionRequest",(async()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=d.default.state;if(!e)return;return Jn.hb({environment:this.environment,currentSpaceStore:e,currentSpaceViewStore:t})})),g()(this,"performLocalPageMentionRequest",(e=>{const{localCachePageMentionRequestStore:t}=this.stores,i=t.state.result;if(!i)return;const a=Jn.tz({input:e,cache:i});if(!a)return;if(0===a.results.length)return{error:qn.Ix.NoResults};const n=Qe.RM();if(!n)return;const s=Jn.YB({sort:e.query.sort,unsorted:a.results,batchSize:is.Xv,currentUserId:this.environment.currentUser.id}).map(((e,t)=>({...e,originalPosition:t,store:Zt.Z.createChildStore(n,{table:S.iU,id:e.id})})));return{value:{total:s.length,results:s}}})),g()(this,"performPageMentionRequest",(async e=>{const t=$n.Z.state;if(!t.open)return[];const i=t.mentionTypes.page?await this.getPageResults(e):[];return""===e?i.slice(0,2):i.slice(0,20)})),g()(this,"getUserResults",(async e=>{if(Pa.Z.state.online){return await Aa.O$({environment:this.environment,query:e,membersOnly:!1})}return[]})),g()(this,"getPageResults",(async e=>{if(!Pa.Z.state.online)return[];const t=$n.Z.state,i=t.open&&(0,w.NZ)(t.textStore)&&t.textStore;return await Aa.WL({nearBlock:i||void 0,environment:this.environment,query:e,source:"mention_menu",limit:20})})),g()(this,"getDateResults",(e=>{const t=$n.Z.state;if(!t.open)return[];const{intl:i}=this.props,a=t.mentionTypes.reminder;return t.mentionTypes.date?function(e,t,i){if(0===e.length)return U().compact([{label:i.formatMessage(rs.autocompleteToday),value:()=>Gn.Lg(Gn.x7)},t?void 0:{label:i.formatMessage(rs.autocompleteNextTuesday),value:()=>{const e=Gn.bU(Gn.x7),t=e.clone().day(2);return t.isSameOrBefore(e)&&t.add(1,"week"),t.add(1,"week"),t.hour(15),{type:"datetime",start_date:t.format(Gn.Q1),start_time:t.format(Gn.jK),time_zone:Gn.x7}}},t?{label:i.formatMessage(rs.autocompleteReminder),value:()=>({type:"datetime",start_date:Gn.Ro(Gn.x7).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:Gn.HZ},time_zone:Gn.x7})}:void 0]);const a=t?(0,Hn.St)(e,i):(0,Hn.cg)(e,i);if(a){let e=(0,zn.ZV)({value:a,date_format:"relative",userTimeZone:Gn.x7,intl:i,allowRelativeDates:!0});return a.reminder&&(e=i.formatMessage(rs.reminder,{dateTime:e})),[{label:e,value:()=>a}]}return[]}(e,a,i).slice(0,6):[]})),g()(this,"getTemplateVariableResults",(e=>{const t=$n.Z.state;if(!t.open)return[];if(!t.mentionTypes.templateVariable)return[];const{intl:i}=this.props;return qe.XV(e,i)}))}willMountOrUpdate(){const e=$n.Z.state,t=this.filterStore.state;if(e.open){var i;const a=gt.default.state,n="editing"===a.mode?(0,dt.QY)(a.multiSelection):void 0,s=(null==n?void 0:n.store)===e.textStore,o=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,r=o&&"editing"===o.mode&&(null===(i=(0,dt.QY)(o.multiSelection))||void 0===i?void 0:i.store)===e.textStore;if(!s&&!r)return void jn.xv();const l=s&&(null==n?void 0:n.selection),d=this.inputSelectionsStore.state;if(d&&l&&(l.startIndex<d.filter.startIndex||l.endIndex>d.filter.endIndex))return void jn.xv();const c=this.filterStore.state&&this.filterStore.state[0];if("+"===e.insertionType&&c&&!c.match(this.letterCharacterClass))return void jn.xv();if(void 0===t)return void jn.xv()}}renderComponent(){const{device:e}=this.environment,t=$n.Z.state,i=_e.find((e=>e.props.capture)),a=this.popupOpenStore.state;let s;if(i&&e.isMobile){const e=i.stores.store.state.rect;e&&(s={height:"calc(100vh - ".concat(e.height,"px)")})}const r=t.open&&t.showCreateIn;return n()(R.ZP,{popupType:this.isActionSheet()?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:a,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:s,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Start,originGap:8,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:this.makeHandleCancelCallback(),disableDarkOverlayBackground:e.isMobile,keepFocus:!0,render:()=>e.isMobile?o().createElement(o().Fragment,null,this.renderMentionSearch(),n()(R.ZP,{popupType:R.ZP.PopupType.SlideUp,render:this.renderCreateInMenu,open:r,keepFocus:!0})):r?this.renderCreateInMenu():this.renderMentionSearch()})}renderMentionSearch(){var e=this;const t=this.getNormalizedFilter(),i=$n.Z.state,a=Xn.default.createMetric("rum.mention_menu_ready");return n()(Ri.Z,{requestStore:i.userRequestStore,request:t,performRequest:this.performUserMentionRequest,render:s=>n()(Ri.Z,{requestStore:i.pageRequestStore,request:t,performRequest:this.performPageMentionRequest,debounce:Aa.vp,render:i=>n()(Ri.Z,{requestStore:this.stores.localCachePageMentionRequestStore,request:d.default.state.currentSpaceStore&&d.default.state.currentSpaceStore.id,performRequest:this.performLocalCachePageMentionRequest,render:o=>n()(Ri.Z,{requestStore:this.stores.localPageMentionRequestStore,debounce:Aa.E5,request:{query:{text:t,filters:qn.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,requireEditPermissions:void 0}),sort:qn.As.Relevance},limit:5},performRequest:function(){return Promise.resolve(e.performLocalPageMentionRequest(...arguments))},render:e=>this.renderMentionResult(s||i||e,this.getCurrentMentionResults(a))})})})})}getDateResultsMenuSection(e,t){const{dateResults:i}=e,{intl:a}=this.props,s=this.getNormalizedFilter(),r=this.getTemplateVariableMenuItems(e,"date");if(0===i.length&&0===r.length)return;const l=i.map((e=>{let{label:t,value:i}=e;return{key:t,render:e=>{if(e.focused&&this.setTemporaryInputData({title:t,icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),(0,Hn.UL)(t,a)){const n=(0,zn.ZV)({value:i(),userTimeZone:Gn.x7,intl:a,allowRelativeDates:!1});return o().createElement(ce.Z,ne()({},e,{title:t,caption:n,inline:!0}))}return o().createElement(ce.Z,ne()({},e,{title:t}))},action:e=>{Ye.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:t=>{jn.RL({environment:this.environment,annotation:["d",{...i(),date_format:"relative"}],transaction:t,menuListItemAction:e,query:s,mentionType:"date"})}})}}}));return this.applySectionLimit("date",{key:"date results",render:e=>o().createElement(ee.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),topBorder:t,isTitleUppercase:!0})),items:r.concat(l)})}getTemplateVariableMenuItems(e,t){const{templateVariableResults:i}=e,{intl:a}=this.props,n=this.getNormalizedFilter();return i.filter((e=>qe.i6(e,t))).map((e=>({key:e,render:t=>{const i=qe.U$(e,a),n=qe.Z0(e,a);return t.focused&&this.setTemporaryInputData({title:i,icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),o().createElement(ce.Z,ne()({},t,{title:i,caption:n,inline:!0}))},action:t=>{Ye.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:i=>{jn.RL({environment:this.environment,annotation:["tv",{type:e}],transaction:i,menuListItemAction:t,query:n,mentionType:"templateVariable"})}})}})))}renderSpinner(e){return n()(Oi.Z,{show:e,showDelay:500,showHold:300,render:e=>n()(Xt.Z,{style:{textAlign:"center",visibility:e?"visible":"hidden",display:"inline",marginLeft:8}})})}renderTemporaryInputEmptyIcon(){const e=$n.Z.state;if(e.open)return"+"===e.insertionType?this.renderTemporaryInputAddIcon():n()("span",{style:{width:"1em",display:"inline-block",verticalAlign:"-0.15em",fill:this.theme.mediumIconColor,marginRight:"0.2em"}},void 0,Ut.Z.searchThick())}renderTemporaryInputAddIcon(){return n()("span",{style:{width:"1em",display:"inline-block",verticalAlign:"-0.15em",fill:this.theme.mediumIconColor,marginRight:"0.2em"}},void 0,Ut.Z.plus())}renderTemporaryInputPageIcon(e){return(0,Kn.tp)({pageValue:e.getValue(),pageRole:e.getRole(),showEmojiInline:!0,emojiType:(0,Qn.e)(this.environment),baseUrl:Tt.Z.domainBaseUrl,getRecordValue:e.getRecordValue,isClient:!0,isSafariOrIOS:this.environment.device.isSafari||this.environment.device.isIOS,currentUserId:this.environment.currentUser.id,theme:this.theme.mode})}renderTemporaryInputAtMentionIcon(){return n()("span",{style:{width:"1em",display:"inline-block",verticalAlign:"-0.15em",fill:this.theme.mediumIconColor,marginRight:"0.2em"}},void 0,Ut.Z.at())}getUserResultsMenuSection(e,t){const{userResults:i}=e,a=this.getNormalizedFilter(),s=this.getTemplateVariableMenuItems(e,"user");if(0===i.length&&0===s.length)return;const r=U().compact(i.map((e=>({key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:(0,oi.Nz)(this.props.intl,e),icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),o().createElement(ss.Z,ne()({},t,{user:e,useEmailAsTooltip:!0}))),action:t=>{Ye.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:i=>{jn.RL({environment:this.environment,annotation:(0,qe.tE)(e.id),transaction:i,menuListItemAction:t,query:a,mentionType:"user"})}})}}))));return this.applySectionLimit("user",{key:"user results",render:e=>o().createElement(ee.Z,ne()({},e,{title:n()(M.FormattedMessage,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),topBorder:t,isTitleUppercase:!0})),items:s.concat(r)})}getPageResultsMenuSection(e,t){const{pageResults:i}=e,a=this.getNormalizedFilter(),s=o().createElement(o().Fragment,null,0===i.length?o().createElement(M.FormattedMessage,rs.noResults):n()(M.FormattedMessage,{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}),this.renderSpinner($n.Z.state.pageRequestStore.state.loading));return this.applySectionLimit("page",{key:"page results",render:e=>o().createElement(ee.Z,ne()({},e,{title:s,topBorder:t,isTitleUppercase:!0})),items:U().compact(i.map((e=>{const t=Qe.RM();if(!t)return;const i=Zt.Z.createChildStore(t,{table:S.iU,id:e});return{key:e,render:e=>{if(e.focused){const e=i.getValue();if(e){const t=(0,Ti.T5)({table:i.table,value:e,getRecordValue:i.getRecordValue,userTimeZone:Gn.x7,intl:this.props.intl});this.setTemporaryInputData({title:t||"",icon:this.renderTemporaryInputPageIcon(i),allowTabCompletion:!0})}}return o().createElement(Ta.Z,ne()({},e,{store:i}))},action:t=>{Ye.createAndCommit({userAction:"MentionMenu.getPageResultsMenuSection",environment:this.environment,perform:i=>{jn.RL({environment:this.environment,annotation:["p",e],transaction:i,menuListItemAction:t,query:a,mentionType:"page"})}})}}})))})}getCreatePageMenuSection(e){if(!this.canCreatePage())return;const t=$n.Z.state;if(!t.open)return;const{intl:i}=this.props,a=this.getNormalizedFilter(),s="@"===t.insertionType?n()(M.FormattedMessage,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:t=>o().createElement(ee.Z,ne()({title:s,isTitleUppercase:!0},t,{topBorder:e})),items:[{key:"add new subpage",action:async e=>{const i=(0,oa.gt)(t.textStore);i&&await jn.Br({environment:this.environment,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,titleText:this.getNormalizedFilter(),createInValue:i.createInValue,onPageCreated:e=>{e&&""===qe.Q(e.getTitleValue())&&Fi.navigateToBlock({environment:this.environment,store:e})},menuListItemAction:e})},render:e=>{e.focused&&this.setTemporaryInputData({title:0===a.length?i.formatMessage(os.addPage):"",icon:this.renderTemporaryInputAddIcon(),allowTabCompletion:!1});const t=t=>o().createElement(ce.Z,ne()({},(0,pi.Z)(t||{},e),{icon:Ut.Z.plus({width:16}),title:n()(Ca,{pageTitle:this.getNormalizedFilter()})}));return this.environment.device.isMobile?t():n()(ei.Z,{renderTooltip:()=>n()(ns.Z,{imageURL:Vn.Z.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:o().createElement(M.FormattedMessage,Ma.s.createSubpage)}),placement:ei.Z.Placement.Right,delayThreshold:0,render:e=>t(e)})}},{key:"open create in menu",action:this.handleCreateInStart,render:e=>{e.focused&&this.setTemporaryInputData({title:0===a.length?i.formatMessage(os.addPage):"",icon:this.renderTemporaryInputAddIcon(),allowTabCompletion:!1});const t=n()(wa,{pageTitle:this.getNormalizedFilter()}),s=i=>o().createElement(ce.Z,ne()({},(0,pi.Z)(i||{},e),{icon:Ut.Z.alias({width:16}),title:t}));return this.environment.device.isMobile?s():n()(ei.Z,{renderTooltip:()=>n()(ns.Z,{imageURL:Vn.Z.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:o().createElement(M.FormattedMessage,Ma.s.newPageIn)}),placement:ei.Z.Placement.Right,delayThreshold:0,render:e=>s(e)})}}]}}applySectionLimit(e,t){const i=$n.Z.state;if(!i.open)return t;if(i.expandSection&&i.expandSection===e)return t;const{items:a}=t,s=this.environment.device.isPhone?3:5;if(a.length<=s)return t;const r=[...a.slice(0,s),{key:"show more",render:e=>o().createElement(ce.Z,ne()({},e,{icon:Ut.Z.dots({width:16,fill:this.theme.mediumTextColor}),title:n()("span",{style:{color:this.theme.mediumTextColor}},void 0,n()(M.FormattedMessage,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:a.length-s}}))})),action:()=>{this.updateOpenState({expandSection:e})}}];return{...t,items:r}}updateOpenState(e){const t=$n.Z.state;t.open&&$n.Z.setState({...t,...e})}getNormalizedFilter(){const e=this.filterStore.state;return e?$n.Z.state.open&&"[["===$n.Z.state.insertionType&&e.endsWith("]]")?e.slice(0,-2).trim():e.trim():""}setTemporaryInputData(e){const t=$n.Z.state;if(!t.open)return;if(!e)return void t.temporaryInputData.set(void 0);const{device:i}=this.environment,{title:a,icon:n,allowTabCompletion:s}=e,o=this.filterStore.state||"",r=a.toLowerCase().startsWith(o)?a.slice(o.length):"";this.tabCompletionString=s?r:void 0;const l=i.isFirefox?void 0:n;t.temporaryInputData.set({prefix:t.insertionType,suffix:"[["===t.insertionType&&o.endsWith("]]")?"]]":"",completion:r,prefixIcon:l})}getCurrentMentionResults(e){const t=$n.Z.state,i=t.userRequestStore.state.result||[],a=t.pageRequestStore.state.result||[],n=this.getDateResults(this.getNormalizedFilter()),s=this.getTemplateVariableResults(this.getNormalizedFilter());let o=a;const{result:r}=this.stores.localPageMentionRequestStore.state;if(r&&!r.error){const e=r.value.results,t=Qe.RM();o=t?Jn.oO({results:{local:e,server:a.map(((e,i)=>({...e,originalPosition:i,store:Zt.Z.createChildStore(t,{table:S.iU,id:e.id})})))}})||[]:e}let l;l=this.getNormalizedFilter()?o.map((e=>e.id)):Ia.X4.state.map((e=>e.pageId));const d=t.userRequestStore.state.ready&&t.pageRequestStore.state.ready;return d&&Xn.default.emit(this.environment,e,void 0),{userResults:i,pageResults:l,dateResults:n,templateVariableResults:s,ready:d}}canCreatePage(){return!!$n.Z.state.mentionTypes.createPage}isActionSheet(){const{device:e}=this.environment;return e.isMobileNative&&!e.isTablet}shouldCaptureBackspace(){return""===this.filterStore.state}getMenuInitialFocus(){if(""!==this.getNormalizedFilter())return 0}getMenuDesktopWidth(){return(0,l.bq)()?400:330}}const ds=(0,M.injectIntl)(ls);var cs=i(42239);class us extends r.Z{constructor(){super(...arguments),g()(this,"cancelDragTimeout",void 0),g()(this,"handleDragOver",(e=>{e.preventDefault(),this.startDrag(e),this.continueDragThrottled(e)})),g()(this,"handleDrop",(e=>{e.preventDefault();const t=Array.from(e.dataTransfer.files);t.length>0&&Ye.createAndCommit({userAction:"NativeDragHandler.handleDrop",environment:this.environment,perform:e=>{cs._4({environment:this.environment,files:t,analyticsFrom:"native_drag",transaction:e})}})})),g()(this,"startDrag",(e=>{cs.f$(this.environment,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0})&&zt.ZH(this.environment)})),g()(this,"continueDrag",(e=>{this.cancelDragTimeout&&window.clearTimeout(this.cancelDragTimeout),this.cancelDragTimeout=window.setTimeout(this.cancelDrag,this.getCancelDragTimeoutMS()),cs.td(this.environment,{currentX:e.clientX,currentY:e.clientY})})),g()(this,"continueDragThrottled",U().throttle(this.continueDrag,us.dragOverThrottleMS)),g()(this,"cancelDrag",(()=>{cs.cQ(this.environment)}))}didMount(){super.didMount(),window.addEventListener("dragover",this.handleDragOver),window.addEventListener("drop",this.handleDrop)}willUnmount(){super.willUnmount(),window.removeEventListener("dragover",this.handleDragOver),window.removeEventListener("drop",this.handleDrop)}getCancelDragTimeoutMS(){const{device:e}=this.environment;return e.isLinux?2e3:200}}g()(us,"dragOverThrottleMS",62.5);const ms=us;i(85827);var ps=i(40902),gs=i(69519),hs=i(44615),fs=i(65311),vs=i(6650),ys=i(12252),Ss=i(76487);class Ms extends r.Z{constructor(){super(...arguments),g()(this,"lastEmitValue",-1),g()(this,"lastSentBadgeNumber",void 0),g()(this,"lastSentCurrentSpaceBadgeNumber",void 0),g()(this,"handleNotificationEmit",(async(e,t)=>{if(t===this.lastEmitValue)return;this.lastEmitValue=t;const i=await di.getUserNotifications(this.environment,{size:1e3});if("failed"===i.type)return;const{results:a}=i.data;Ss.Z.setState({results:a}),this.syncInitialBadgeNumber();const n=U().union.apply(null,a.map((e=>e.unreceived.notificationIds)));for(const s of n)this.displayNotification(s)})),g()(this,"handleNotificationEmitThrottled",U().throttle(this.handleNotificationEmit,1e3)),g()(this,"handleNotificationEmitWhenActive",((e,t)=>{ys.Z.whenActive((()=>{this.handleNotificationEmitThrottled(e,t)}))})),g()(this,"listenerReference",void 0),g()(this,"updateBadgeNumbers",(()=>{const{results:e}=Ss.Z.state,{mobileNative:t}=this.environment,i=e.reduce(((e,t)=>e+t.unread.mentions),0);if(t){const e=Ss.Z.getUnreadCountForCurrentSpace().mentions;i===this.lastSentBadgeNumber&&e===this.lastSentCurrentSpaceBadgeNumber||t.setBadgeNumber(i,e),this.lastSentCurrentSpaceBadgeNumber=e}i!==this.lastSentBadgeNumber&&(i>0?rt.setBadge("".concat(i)):rt.setBadge("")),this.lastSentBadgeNumber=i})),g()(this,"syncInitialBadgeNumber",U().once(this.updateBadgeNumbers))}willMount(){this.startMessageListeners(),Ss.Z.addListener(this.updateBadgeNumbers),this.environment.mobileNative&&d.default.addListener(this.updateBadgeNumbers)}willUnmount(){this.stopMessageListeners(),Ss.Z.removeListener(this.updateBadgeNumbers),this.environment.mobileNative&&d.default.removeListener(this.updateBadgeNumbers)}startMessageListeners(){const{currentUserStore:e}=d.default.state;if(e){const t=(0,hs.Lp)(e.id);this.listenerReference=vs.Z.addListener(t,this.handleNotificationEmitWhenActive,void 0,this.environment)}}stopMessageListeners(){this.listenerReference&&vs.Z.removeListener(this.listenerReference,this.environment)}async displayNotification(e){const t=(0,yi.Kv)(this.props.rootStore,{table:fs.uX,id:e});await t.load();const i=t.getValue();if(!i)return;const a=(0,w.No)(t,i.activity_id,i.space_id);await a.load();const n=a.getValue(),{currentUserStore:s,currentSpaceViewStore:o}=d.default.state;if(s&&o&&n&&!n.invalid&&!ps.BX(n,s.id)&&await rt.shouldSendNotification()&&"undefined"!=typeof Notification){await o.load();const e=o.getValue();if(!e)return;if(!ps.OJ(n))return;if(!e.notify_desktop)return;if(!this.environment.device.isDesktop)return;const i=(0,(await Je.deps.desktop.loader()).PushNotification)({activity:n,getRecordValue:t.getRecordValue,userTimeZone:Gn.x7,intl:this.props.intl});if(!i)return;const{subject:a,body:s}=i;new Notification(a,{body:s,silent:!0}).addEventListener("click",(()=>{const e=ps.hY({activity:n,getRecordValue:t.getRecordValue,baseUrl:Tt.Z.domainBaseUrl}),i=ps.Fb(n),a=(0,gs.k)(e,[i,"desktop_push"]);Fi.navigate({environment:this.environment,url:a})}))}}}const bs=(0,M.injectIntl)(Ms);var ws=i(22889),Cs=i(94610);class Ts extends r.Z{constructor(){super(...arguments),g()(this,"renderTooltip",(()=>n()(A.Z,{capture:!0,onEnter:this.handleEnter,onCommandEnter:this.handleCommandEnter},void 0,o().createElement(o().Fragment,null,n()(M.FormattedMessage,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),n()("div",{},void 0,n()(Cs.Z,{onlyShowFirst:!0,name:"enter",style:{color:this.theme.mediumInvertedTextColor}})))))),g()(this,"handleEnter",(e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:i,store:a}=t;if(!i)return;e.preventDefault&&e.preventDefault();const n=Zt.Z.createChildStore(a,{table:S.iU,id:i});Fi.navigateToBlock({store:n,environment:this.environment,visitType:ws.vu.Link})})),g()(this,"handleCommandEnter",(e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:i,store:a}=t;if(!i)return;e.preventDefault();const n=Zt.Z.createChildStore(a,{table:S.iU,id:i});Fi.navigateToBlock({store:n,environment:this.environment,visitType:ws.vu.Link,metaClick:!0})})),g()(this,"pageMentionTokenStore",this.createComputedStore((()=>{const e=gt.default.state;if("editing"!==e.mode)return;const t=(0,dt.QY)(e.multiSelection);if(!t)return;const{store:i,selection:a}=t;if(a.endIndex!==a.startIndex+1)return;const n=i.getValue(),s=qe.b1(n,a.startIndex);if(!s||!qe.eO(s))return;const[o]=qe.jD([s]);return{pageId:o,store:i}})))}renderComponent(){if(this.environment.device.isMobile)return;const e=ct.getSelectionRect(),t=this.pageMentionTokenStore.state;return n()(ei.Z,{render:()=>{},renderTooltip:this.renderTooltip,originRect:e,forceVisibleState:Boolean(t&&e),placement:ei.Z.Placement.Bottom})}}const ks=Ts;var Zs=i(12534);class As extends r.Z{constructor(){super(...arguments),g()(this,"handleContextMenu",(e=>{const{device:t}=this.environment;t.isAndroid||pn.default.isOnboarding||(0,Zs.ZP)({event:e,context:Zs.Af.EditorContextMenu,callback:()=>{t.isElectron||this.environment.currentUser.isLoggedIn()&&e.preventDefault()}})})),g()(this,"handleDragStart",(e=>{e.preventDefault()}))}didMount(){window.addEventListener("contextmenu",this.handleContextMenu),window.addEventListener("dragstart",this.handleDragStart)}willUnmount(){window.removeEventListener("contextmenu",this.handleContextMenu),window.removeEventListener("dragstart",this.handleDragStart)}}const Is=As;var Ps=i(52989),_s=i(69784);class xs extends r.Z{constructor(){super(...arguments),g()(this,"handleKey",(e=>{_s.Z.state.isActive&&(e.preventDefault(),(0,Ps.MZ)({environment:this.environment,currentX:_s.Z.state.currentX,currentY:_s.Z.state.currentY,toggle:e.shiftKey}))})),g()(this,"handleMouseMove",(e=>{_s.Z.state.isActive&&(e.preventDefault(),(0,Ps.MZ)({environment:this.environment,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))})),g()(this,"handleMouseUp",(e=>{_s.Z.state.isActive&&((0,Gt.N9)(e)||e.preventDefault(),(0,Ps.qw)(this.environment))}))}willMount(){window.addEventListener("keydown",this.handleKey),window.addEventListener("keyup",this.handleKey),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp)}willUnmount(){window.removeEventListener("keydown",this.handleKey),window.removeEventListener("keyup",this.handleKey),window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}renderComponent(){return null}}const Fs=xs;var Bs=i(43008),Es=i(64951),Ds=i(65187);class Rs extends r.Z{constructor(){super(...arguments),g()(this,"renderPopupContent",(()=>n()(Os,{})))}renderComponent(){const{device:e}=this.environment,{blockStore:t,originRect:i}=Es.Z.state;return n()(R.ZP,{popupType:e.isMobile?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:Boolean(t),originRect:i,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Center,originGap:4,onDismiss:()=>Bs.x(this.environment),render:this.renderPopupContent})}}class Ls extends r.Z{didMount(){const{blockStore:e}=Es.Z.state;if(!e)return;const t=e.getTitleStore();t&&lt.mT({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{blockStore:t}=Es.Z.state;if(!t)return;const i=t.getTitleStore();if(!i)return;let a;return a=e.isMobile?{menuType:I.Z.MenuType.ActionSheet}:{menuType:I.Z.MenuType.Popup,width:380},o().createElement(I.Z,a,n()("div",{style:this.getWrapStyle()},void 0,n()(Ds.Z,{store:i,disabled:!t.canEdit(),onEsc:()=>Bs.x(this.environment),onEnter:()=>Bs.x(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:this.props.intl.formatMessage({defaultMessage:"Untitled",id:"renameFileMenuPopup.input.placeholder"}),style:this.getInputStyle(),pasteBehavior:"inline"})))}getWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:3,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}const Os=(0,M.injectIntl)(Ls),Ns=Rs;var Us=i(52771),Ws=i(82187);class Vs extends r.Z{constructor(){super(...arguments),g()(this,"renderPopupContent",(()=>{const{renderDelete:e}=Ws.Z.state;return n()(Gs,{renderDelete:Boolean(e)})}))}renderComponent(){const{device:e}=this.environment,{clonedBlockStore:t,originRect:i}=Ws.Z.state;return n()(R.ZP,{popupType:e.isMobile?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:Boolean(t),originRect:i,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Center,originGap:4,onDismiss:()=>Us.x(this.environment),render:this.renderPopupContent})}}class zs extends r.Z{constructor(){super(...arguments),g()(this,"handleRecordIconChange",(e=>{const{clonedBlockStore:t}=Ws.Z.state;if(t){const i=t.getIconStore();i&&Ye.createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:this.environment,perform:t=>{je.sO({store:i,value:e,transaction:t})}})}}))}didMount(){const{clonedBlockStore:e}=Ws.Z.state;if(!e)return;const t=e.getTitleStore();t&&lt.mT({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{clonedBlockStore:t}=Ws.Z.state;if(!t)return;const i=t.getTitleStore();if(!i)return;const{renderDelete:a}=this.props;let s;return s=e.isMobile?{menuType:I.Z.MenuType.ActionSheet}:{menuType:I.Z.MenuType.Popup,width:380},o().createElement(I.Z,s,n()("div",{style:this.getWrapStyle()},void 0,this.renderIcon(t),n()(Ds.Z,{store:i,disabled:!t.canEdit(),onEsc:()=>Us.x(this.environment),onEnter:()=>Us.x(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,placeholder:this.renderEmptyTitlePlaceholder(),style:this.getInputStyle(),pasteBehavior:"inline"}),a&&t.canEdit()&&this.renderDeleteButton()))}renderDeleteButton(){return n()(yn.Z,{icon:e=>Ut.Z.trash({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,isDarkIconColor:!0,showShadow:!0,onClick:async()=>{const{originalBlockStore:e}=Ws.Z.state;e&&await Vt.Qw({environment:this.environment,blocks:[e]}),Us.x(this.environment)}})}renderIcon(e){const t={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:"inset 0 0 0 1px ".concat(this.theme.darkDividerColor)};if(e.canEdit()){var i,a;const s=null===(i=e.getIconStore())||void 0===i?void 0:i.table;return n()(Wi.Z,{disabled:!1,bucket:"secure",store:e,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:18,style:t,iconLoggingData:{recordTable:s,source:"breadcrumb",block_type:e.getType(),collection_id:"collection"===s?null===(a=e.getIconStore())||void 0===a?void 0:a.id:void 0},onChange:this.handleRecordIconChange})}return n()(Wi.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:18,style:t})}renderEmptyTitlePlaceholder(){const{clonedBlockStore:e}=Ws.Z.state,{intl:t}=this.props;if(!e)return;const i=e.getValue();return i?(0,Ti.Q2)({table:e.table,value:i,getRecordValue:e.getRecordValue,userTimeZone:Gn.x7,intl:t}):void 0}getWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:3,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}const Gs=(0,M.injectIntl)(zs),Hs=Vs;var qs=i(4083),Ks=i(13264);class js extends r.Z{constructor(){super(...arguments),g()(this,"renderDiscussion",(()=>{const{device:e}=this.environment;if(Ks.Z.state.open){const{discussionStore:t,discussionInputStore:i,blockStore:a}=Ks.Z.state;let s;return s=e.isMobile?{menuType:I.Z.MenuType.Modal,title:n()(M.FormattedMessage,{defaultMessage:"Comments",id:"discussion.mobileReplyMenu.title"}),right:n()(M.FormattedMessage,{defaultMessage:"Close",id:"discussion.mobileReplyMenu.closeButton.label"}),onClickRight:()=>qs.UZ(this.environment),whiteBackground:!0}:{menuType:I.Z.MenuType.Popup,width:420,maxWidth:e.isMobileBrowser?"80vw":"100%"},o().createElement(I.Z,s,n()(k.Z,{capture:!0,render:()=>n()(T.Z,{store:t,discussionInputStore:i,onDismiss:()=>qs.UZ(this.environment),format:b.O2.Menu,isFirst:!0,isOnly:!0,discussionLocation:"reply_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:a})}))}}))}renderComponent(){const{device:e}=this.environment,{open:t,rect:i}=Ks.Z.state;return n()(R.ZP,{popupType:e.isMobile?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:t,originRect:i,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Center,originGap:4,onDismiss:()=>qs.UZ(this.environment),render:this.renderDiscussion})}}const Ys=js;var Qs=i(80503),Js=i(85767),Xs=i(56863),$s=i(40959),eo=i(87078),to=i(45162),io=i(67669),ao=i(67067),no=i(17903),so=i(4548),oo=i(42057),ro=i(49557),lo=i(4935),co=i(99757),uo=i(13966),mo=i(64131),po=i(82945),go=i(40464),ho=i(32404),fo=i(73383);class vo extends r.Z{constructor(){super(...arguments),g()(this,"mouseIsDownExternally",!1),g()(this,"lastRenderState",void 0),g()(this,"renderOverlay",(()=>{const{isActive:e}=ro.Z.state;return n()(Qt.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:{stiffness:100,damping:10,precision:1e-4}},render:this.renderAnimated,onAnimationEnd:this.handleAnimationEnd})})),g()(this,"renderAnimated",(()=>{const{top:e,left:t}=ro.Z.state,i=this.canOnlyDiscussStore.state,a=Math.max(i?t:t-vo.leftOffset,0),s=i?"12px 0":12;return n()("div",{className:re.Qc,style:{pointerEvents:"none",position:"absolute",top:e,left:0,display:"flex",width:"100%"}},void 0,n()("div",{style:{flexShrink:1,width:a,minWidth:24}}),(0,Ht.Z)((e=>o().createElement("div",ne()({style:{pointerEvents:"none",padding:s}},e),this.lastRenderState&&this.renderMenu(this.lastRenderState)))),n()("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}}))})),g()(this,"updateRichTextState",(()=>{const e=ro.Z.state;if(ca.Z.state.open||lo.Z.state.open)return;if(co.n.state)return Xs.w();const t=gt.default.state;if("empty"===t.mode)return Xs.w();const i=(0,to.L5)(t.multiSelection);if(0===i.length)return Xs.w();if(!i.every((e=>{let{store:t}=e;return t.table===S.iU||t.table===xi.x_||t.table===Pi.v})))return Xs.w();if(!this.environment.currentUser.isLoggedIn()||!i.every((e=>{let{store:t}=e;return t.canComment()})))return;const a=ct.get();if(Qe.JE())return Xs.w();if(i.some((e=>{let{editable:t}=e;return t.props.disableAnnotation})))return Xs.w();if(i.some((e=>{let{editable:t}=e;return t.props.disabled})))return Xs.w();const n=i.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(n.some(((e,t)=>e&&i[t].store.table!==xi.x_&&(e.isLocked()||e.isNavigableAncestorLocked()))))return Xs.w();if(this.mouseIsDownExternally&&e.blockTarget!==n[0])return Xs.w();const s=i.some((e=>{let{store:t}=e;if(t.table!==S.iU)return!1;const i=t.getRecordStoreAtRootPath().getValue();return!!i&&vo.richTextMenuBlockTypesDenylist[i.type]}));if(s)return Xs.w();const o=a?ct.getRect(a):void 0;if(o&&!ao.kK(o,(0,eo.Z)()))return Xs.w();if(Ws.Z.isActive()||Es.Z.isActive()||Qi.Z.isOpen()||s||!a||!this.hasNonCollapsedTextSelection()||pt.state.open)return Xs.w();let r=0,l=0;if(o){r=o.left;const e=25,t=o.top-vo.height-e,i=Qs.R6(this.environment.device.isElectronMac),a=this.environment.WindowSizeStore.state.height-vo.height-e;l=Math.min(Math.max(t,i),a)}0===Math.abs(ro.Z.state.top-l)&&Math.abs(ro.Z.state.left-r)<10&&(l=ro.Z.state.top,r=ro.Z.state.left),ro.Z.setState({...ro.Z.state,isActive:!0,isAnimatingClosed:!1,top:l,left:r,blockTarget:j.default.state.stores[0]})})),g()(this,"updateRichTextStateThrottled",U().throttle(this.updateRichTextState,200,{leading:!1})),g()(this,"handleAnimationEnd",(()=>{ro.Z.state.isActive||ro.Z.setState({...ro.Z.state,isAnimatingClosed:!1}),this.lastRenderState=this.renderStateStore.state})),g()(this,"renderStateStore",this.createComputedStore((()=>{const{isActive:e,blockTarget:t}=ro.Z.state,i=gt.default.state;if(!e||"empty"===i.mode)return;const{multiSelection:a}=i,n=(0,dt.qS)(a),s=gt.default.isEditingComment(),o=gt.default.isEditingCaption(),r=t&&t.getParentTable()===Pi.v,l=this.pageContext&&this.pageContext.publicEditModeStore.state,d=!(0,io.YF)(l)&&(a.start.store.canEdit()&&a.end.store.canEdit()),c=t&&t.getType(),u=c&&vo.richTextMenuActionsDenylist[c],m={isSingleStoreSelection:n,showTurnInto:Boolean(n&&!s&&!r&&!o&&t&&d),showBold:Boolean(d),showItalic:Boolean(d),showStrikethrough:Boolean(d),showUnderline:Boolean(d),showCode:Boolean(d),showLink:Boolean(n&&d),showHighlight:Boolean(d&&!s),showDiscuss:Boolean(!s&&t&&!r),showEquation:Boolean(n&&d),showMention:Boolean(n&&!s&&t&&!r&&d),showActionButton:Boolean(n&&!s&&!o&&t&&!r),blockTarget:t,isComment:s};if(u&&u.size>0)for(const p of u)m[p]=!1;return m}))),g()(this,"canOnlyDiscussStore",this.createComputedStore((()=>{const e=this.renderStateStore.state;return e&&e.showDiscuss&&!e.showBold})))}didMount(){j.default.addListener(this.updateRichTextStateThrottled),gt.default.addListener(this.updateRichTextStateThrottled),no.Z.addListener(this.updateRichTextState),oo.Z.addListener(this.updateRichTextState),so.Z.addListener(this.updateRichTextState)}willUnmount(){gt.default.removeListener(this.updateRichTextStateThrottled),j.default.removeListener(this.updateRichTextStateThrottled),no.Z.removeListener(this.updateRichTextState),oo.Z.removeListener(this.updateRichTextState),so.Z.removeListener(this.updateRichTextState)}willMountOrUpdate(){const e=this.renderStateStore.state;e&&(this.lastRenderState=e)}renderComponent(){const{isActive:e,isAnimatingClosed:t}=ro.Z.state;return n()(at.Z,{open:e||t,render:this.renderOverlay})}renderMenu(e){const{isActive:t}=ro.Z.state;return n()("div",{style:{display:"inline-flex",alignItems:"stretch",height:vo.height,background:this.theme.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:3,boxShadow:this.theme.mediumBoxShadow,pointerEvents:t?"auto":"none"},onMouseDown:e=>e.preventDefault()},void 0,e.showTurnInto&&e.blockTarget&&this.renderTurnInto(e.blockTarget),e.showLink&&this.renderLinkButton(!0),e.showDiscuss&&e.blockTarget&&this.renderCommentButton(e.blockTarget),n()("div",{style:{display:"flex"}},void 0,e.showBold&&this.renderBoldButton(),e.showItalic&&this.renderItalicButton(),e.showUnderline&&this.renderUnderlineButton(),e.showStrikethrough&&this.renderStrikethroughButton(),e.showCode&&this.renderCodeButton(),e.showEquation&&this.renderEquationButton()),e.showHighlight&&n()(mo.Z,{style:this.getBorderRight()}),e.showMention&&this.renderMention(),e.showActionButton&&e.blockTarget&&this.renderActionButton(e.blockTarget))}renderTurnInto(e){let t=n()(M.FormattedMessage,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const{intl:i}=this.props,a=e.getType();if(a){const e=$s.Hc[a];t=e&&e.displayName||t}return n()(wn.Z,{popupType:wn.Z.PopupType.Popup,buttonPopupStore:lo.Z,originGap:4,renderOrigin:e=>n()(ei.Z,{renderTooltip:()=>i.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:i=>o().createElement(gn.Z,ne()({style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...this.getBorderRight()}},(0,pi.Z)(e,i)),t,Ut.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor}))}),render:()=>n()(I.Z,{menuType:I.Z.MenuType.Popup},void 0,n()(Y.Z,{context:{blocks:[e],environment:this.environment,publicEditMode:void 0},sections:[Js.gH],onAccept:t=>{const i=e.getType(),a=e.getFormat();Xs.w(),V.trackBlockAction(this.environment,{analyticsName:t.analyticsName,from:"rich_text_menu",block_type:i,is_toggleable:i?(0,H._A)(i,a):void 0})}})),onClick:()=>{V.trackRichTextMenuClick(this.environment,{action:"turn_into"})}})}renderBoldButton(){return n()(go.Z,{type:"b",tooltipLabel:n()(s.Fragment,{},void 0,n()("div",{},void 0,n()(M.FormattedMessage,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})),n()("div",{},void 0,n()(Cs.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleBold"})))},void 0,n()("span",{style:{fontWeight:li.Z.fontWeight.semibold}},void 0,"B"))}renderItalicButton(){return n()(go.Z,{type:"i",tooltipLabel:n()(s.Fragment,{},void 0,n()("div",{},void 0,n()(M.FormattedMessage,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})),n()("div",{},void 0,n()(Cs.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleItalics"})))},void 0,n()("span",{style:{fontStyle:"italic"}},void 0,"i"))}renderStrikethroughButton(){return n()(go.Z,{type:"s",tooltipLabel:n()(s.Fragment,{},void 0,n()("div",{},void 0,n()(M.FormattedMessage,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})),n()("div",{},void 0,n()(Cs.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleStrike"})))},void 0,n()("span",{style:{textDecoration:"line-through"}},void 0,"S"))}renderUnderlineButton(){return n()(go.Z,{type:"_",tooltipLabel:n()(s.Fragment,{},void 0,n()("div",{},void 0,n()(M.FormattedMessage,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})),n()("div",{},void 0,n()(Cs.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleUnderline"})))},void 0,n()("span",{style:{textDecoration:"underline"}},void 0,"U"))}renderCodeButton(){return n()(go.Z,{type:"c",style:{padding:"0 6px"},tooltipLabel:n()(s.Fragment,{},void 0,n()("div",{},void 0,n()(M.FormattedMessage,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})),n()("div",{},void 0,n()(Cs.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleCode"})))},void 0,Ut.Z.code({width:15,height:15}))}renderLinkButton(e){const t=this.environment.device.isMobile;return n()(fo.Z,{style:this.getBorderRight()},void 0,e&&Ut.Z.alias({width:t?18:16,height:t?18:16,marginRight:4,fill:this.theme.regularIconColor}),n()("span",{style:{borderBottom:"1px solid ".concat(this.theme.linkDecorationColor)}},void 0,n()(M.FormattedMessage,{defaultMessage:"Link",id:"richTextMenu.linkButton.tooltip"})),e&&Ut.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor}))}renderEquationButton(){return n()(ho.Z,{style:this.getBorderRight(),onClick:()=>{V.trackRichTextMenuClick(this.environment,{action:"e"}),Xs.w()}},void 0,Ut.Z.equation({width:16,height:16}))}renderMention(){return n()(ei.Z,{renderTooltip:()=>n()(s.Fragment,{},void 0,n()("div",{},void 0,n()(M.FormattedMessage,{defaultMessage:"Mention a person,{br}page, or date",id:"richTextMenu.mentionButton.tooltip",values:{br:n()("br",{})}})),n()("div",{style:{color:this.theme.mediumInvertedTextColor}},void 0,"@")),render:e=>o().createElement(gn.Z,ne()({style:{...this.getBorderRight(),padding:"0 8px"}},e,{onClick:()=>{jn.lZ(this.environment,{page:!0,createPage:!0,user:!0,bot:!0,date:!0,reminder:!0,templateVariable:!0}),V.trackRichTextMenuClick(this.environment,{action:"mention"})}}),Ut.Z.mention({width:14,fill:this.theme.regularTextColor}))})}renderCommentButton(e){return n()(po.Z,{style:this.getBorderRight(),blockStore:e})}renderActionButton(e){return n()(uo.Z,{store:e,style:{borderRight:"none",borderRadius:0,padding:0,width:30,height:"none"},iconStyle:{fill:this.theme.regularTextColor},fadeIn:!1,onClick:()=>{V.trackRichTextMenuClick(this.environment,{action:"more"})}})}hasNonCollapsedTextSelection(){const e=ct.get();return!!e&&!e.collapsed&&"empty"!==gt.default.state.mode&&!(0,dt.iG)(gt.default.state.multiSelection)}getBorderRight(){return{boxShadow:"1px 0 0 ".concat(this.theme.regularDividerColor),marginRight:1}}}g()(vo,"richTextMenuBlockTypesDenylist",{[St.ZP.factory]:!0}),g()(vo,"richTextMenuActionsDenylist",{[St.ZP.code]:new Set(["showMention","showCode"]),[St.ZP.table]:new Set(["showTurnInto","showActionButton"]),[St.ZP.tableRow]:new Set(["showTurnInto","showActionButton"])}),g()(vo,"leftOffset",60),g()(vo,"height",32);const yo=(0,M.injectIntl)(vo);i(65069);var So=i(14248),Mo=i(14714),bo=i(66094),wo=i(12211),Co=i(50628);const To=200;var ko;function Zo(e){return e.type===ko.Selectable?{type:tt.Dl.Selectable,store:e.target.props.store,direction:e.direction}:{type:tt.Dl.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function Ao(e){const{target:t,device:i,direction:a,points:n}=e;return a===tt.vh.Onto||!i.isPhone||t.props.dropzoneShouldNeverUseOrigin?n.mousePoint:{x:n.originPoint.x,y:n.mousePoint.y}}function Io(e){return e instanceof bo.Z?{type:ko.Selectable,target:e}:{type:ko.DropTarget,target:e}}function Po(e){if(!(e&&e instanceof bo.Z))return!1;let t=e;const i=tt.ZP.state;if(!i.isDragging)return!1;const{draggedStores:a}=i;for(;t;){if(a.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function _o(e){const{dropzoneMustBeWithinHorizontalBound:t,device:i}=e;return t?0:i.isPhone?9999:0}function xo(e){switch(e.direction){case tt.vh.Onto:return function(e){const{device:t,isNativeDrag:i,rect:a,target:n,points:s,priority:o,canAcceptDrop:r}=e,l=tt.vh.Onto,d=Ao({device:t,target:n,direction:l,points:s});if((i?n.props.canNativeDropOnto:n.props.canDropOnto)&&Bo(d,a)&&!Po(n)&&r(n,l))return{...Io(n),direction:l,left:a.left,top:a.top,width:a.width,height:a.height,priority:o}}(e);case tt.vh.Left:return function(e){const{device:t,isNativeDrag:i,rect:a,target:n,points:s,priority:o,optionKeyDown:r,canAcceptDrop:l}=e,d=tt.vh.Left,c=Ao({device:t,target:n,direction:d,points:s});if((i?n.props.canNativeDropLeft:n.props.canDropLeft)&&a&&c.y>=a.top&&c.y<=a.bottom&&Math.abs(c.x-a.left)<=200&&(r||!Po(n))&&l(n,d))return{...Io(n),direction:d,left:a.left,top:a.top,width:0,height:a.height,priority:o}}(e);case tt.vh.Right:return function(e){const{device:t,isNativeDrag:i,rect:a,target:n,points:s,priority:o,optionKeyDown:r,canAcceptDrop:l}=e,d=tt.vh.Right,c=Ao({device:t,target:n,direction:d,points:s});if((i?n.props.canNativeDropRight:n.props.canDropRight)&&a&&c.y>=a.top&&c.y<=a.bottom&&Math.abs(c.x-a.right)<=To&&(r||!Po(n))&&l(n,d))return{...Io(n),direction:d,left:a.right,top:a.top,width:0,height:a.height,priority:o}}(e);case tt.vh.Above:return function(e){const{device:t,isNativeDrag:i,rect:a,target:n,points:s,priority:o,optionKeyDown:r,canAcceptDrop:l}=e,d=_o({dropzoneMustBeWithinHorizontalBound:n.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=tt.vh.Above,u=Ao({device:t,target:n,direction:c,points:s});if((i?n.props.canNativeDropAbove:n.props.canDropAbove)&&a&&u.x>=a.left-14-d&&u.x<=a.right+d&&(r||!Po(n))&&l(n,c))return{...Io(n),direction:c,left:a.left,top:a.top,width:a.width,height:0,priority:o}}(e);case tt.vh.Below:return function(e){const{device:t,isNativeDrag:i,rect:a,target:n,points:s,priority:o,optionKeyDown:r,canAcceptDrop:l}=e,d=_o({dropzoneMustBeWithinHorizontalBound:n.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=tt.vh.Below,u=Ao({device:t,target:n,direction:c,points:s});if((i?n.props.canNativeDropBelow:n.props.canDropBelow)&&a&&u.x>=a.left-14-d&&u.x<=a.right+d&&(r||!Po(n))&&l(n,tt.vh.Below))return{...Io(n),direction:tt.vh.Below,left:a.left,top:a.bottom,width:a.width,height:0,priority:o}}(e)}}function Fo(e){const{device:t,rect:i,target:a,points:n,optionKeyDown:s}=e;return Bo(Ao({device:t,target:a,direction:tt.vh.Onto,points:n}),i)&&Po(a)&&!s}function Bo(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}!function(e){e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget"}(ko||(ko={}));var Eo=i(73744),Do=i(28314),Ro=i(35026),Lo=i(17031),Oo=i(27406),No=i(81844),Uo=i(16339),Wo=i(95802),Vo=i(88923),zo=i(91681),Go=i(86486);class Ho extends r.Z{constructor(){super(...arguments),g()(this,"isUpdatingDragState",!1),g()(this,"didTouchEnd",!1),g()(this,"lastMouseInfo",void 0),g()(this,"handleWindowMouseMove",(e=>{if(this.didTouchEnd)return void(this.didTouchEnd=!1);e&&(this.lastMouseInfo={target:e.target,x:e.clientX,y:e.clientY});const{isDragging:t}=tt.ZP.state;if(t)this.updateDragState();else{if(!this.lastMouseInfo)return;this.updateHoverState(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}})),g()(this,"handleDragBlockStoreChange",(()=>{this.isUpdatingDragState||this.handleWindowMouseMoveThrottled(void 0)})),g()(this,"handleWindowMouseMoveThrottled",U().throttle((e=>ha.Z.withListenerIgnored((()=>this.handleWindowMouseMove(e)))),60)),g()(this,"handleSelectionChange",(()=>{const{isDragging:e}=tt.ZP.state;ot.default.afterNextFlush((()=>{this.lastMouseInfo&&!e&&this.updateHoverState(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}))})),g()(this,"handleSelectionChangeThrottled",U().throttle(this.handleSelectionChange,60)),g()(this,"handleWindowKeyEvent",(()=>{const{isDragging:e}=tt.ZP.state;e&&this.updateDragState()})),g()(this,"handleWindowTouchEnd",(()=>{this.didTouchEnd=!0})),g()(this,"handleWindowScroll",(()=>{zt.Ch(),this.clearHoverState()})),g()(this,"handleWindowResize",(()=>{zt.Ch(),this.clearHoverState()})),g()(this,"handleGlobalMenuIsOpenChange",(()=>{const e=Go.default.state,t=Qe.kw.state;e.isOpen&&!e.menuIsOpen&&t&&Go.default.reset()})),g()(this,"memoizedCanDragCache",new WeakMap),g()(this,"memoizedCanDrag",(e=>{const t=this.memoizedCanDragCache.get(e);if(this.memoizedCanDragCache.has(e))return t;const i=(0,mi.OO)({environment:this.environment,blocks:e,publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state});return this.memoizedCanDragCache.set(e,i),i})),g()(this,"getDropZonePriority",(e=>{var t;return null!==(t=null==e?void 0:e.priority)&&void 0!==t?t:0}))}didMount(){super.didMount();const{device:e}=this.environment;Eo.l(window,"mousemove",this.handleWindowMouseMoveThrottled),j.default.addListener(this.handleSelectionChangeThrottled),e.isIOS&&Eo.l(window,"touchend",this.handleWindowTouchEnd),Eo.l(window,"keydown",this.handleWindowKeyEvent),Eo.l(window,"keyup",this.handleWindowKeyEvent),tt.ZP.addListener(this.handleDragBlockStoreChange),Eo.l(window,"scroll",this.handleWindowScroll,!0),Eo.l(window,"resize",this.handleWindowResize),Qe.kw.addListener(this.handleGlobalMenuIsOpenChange),zt.Jy()}willUnmount(){super.willUnmount();const{device:e}=this.environment;Eo.Z(window,"mousemove",this.handleWindowMouseMoveThrottled),j.default.removeListener(this.handleSelectionChangeThrottled),e.isIOS&&Eo.Z(window,"touchend",this.handleWindowTouchEnd),Eo.Z(window,"keydown",this.handleWindowKeyEvent),Eo.Z(window,"keyup",this.handleWindowKeyEvent),tt.ZP.removeListener(this.handleDragBlockStoreChange),Eo.Z(window,"scroll",this.handleWindowScroll,!0),Eo.Z(window,"resize",this.handleWindowResize),Qe.kw.removeListener(this.handleGlobalMenuIsOpenChange)}updateDragState(){if(this.isUpdatingDragState)throw new Error("Assertion failure, updateDragState() called when this.isUpdatingDragState === true!");this.isUpdatingDragState=!0;try{this.updateDragStateInner()}finally{this.isUpdatingDragState=!1}}updateDragStateInner(){const e=tt.ZP.state;if(!e.isDragging)return;const{draggedStores:t,currentX:i,currentY:a,offsetX:n,offsetY:s,isNativeDrag:o}=e,r={x:i,y:a},l={x:i-n,y:a-s},d=this.findNearbyDropZones({mousePoint:r,originPoint:l},t[0],o);if(d.ontoDropZone)tt.ZP.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)tt.ZP.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],i=U().tail(d.horizontalDropZones);if(t.type===tt.Dl.Selectable){const a=Wo.C.findSelectableFromStore(t.store);if(a){const n=a.getContextClosestSelectable();let s;return n&&n.props.store!==t.store&&n.props.shouldShowParentHalo&&(s=n.props.store),void tt.ZP.setState({...e,currentDropZone:t,currentHintDropZones:i,currentParentStore:s})}}else{if(Oo.Z.findDropTargetFromKey(t.key))return void tt.ZP.setState({...e,currentDropZone:t,currentHintDropZones:i,currentParentStore:void 0})}}tt.ZP.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}clearHoverState(){const e=Go.default.state;e.isOpen&&!e.menuIsOpen&&Go.default.reset()}updateHoverState(e,t,i){const a=Go.default.state;if(!a.isOpen||!a.menuIsOpen){const n=this.findHoverMenuTarget(e,t,i);n?a.isOpen&&n.selectable.props.store===a.currentStore||Go.default.setState({isOpen:!0,currentStore:n.selectable.props.store,container:n.container,menuIsOpen:!1}):Go.default.reset()}}getHighestDropZonePriorityRects(e){const t=this.getDropZonePriority(U().maxBy(e,this.getDropZonePriority));return e.filter((e=>this.getDropZonePriority(e)===t))}getSelectableContainerPriority(e){return(j.default.state.droppableContainerStack||[]).indexOf(e)}findNearbyDropZones(e,t,i){const{device:a}=this.environment,n=Do.yA(),s=function(){const{selectableRectMap:e}=Co.Z.state,{dropTargetRectMap:t}=wo.Z.state,i=new Map;return e.forEach(((e,t)=>{i.set(t,e)})),t.forEach(((e,t)=>{i.set(t,e)})),i}(),o=s.keys();let r=o.next();const l=Wo.C.findSelectableFromStore(t),d=l?l.getContextSelectableContainer():void 0;let c=[];for(;!r.done;){const t=r.value;r=o.next();const l=s.get(t),u=t.getContextSelectableContainer();if(a.isPhone&&u!==d)continue;if(!u||u.props.disable)continue;const m=this.getSelectableContainerPriority(u),p={device:this.environment.device,isNativeDrag:i,rect:l,target:t,points:e,priority:m,optionKeyDown:n.option,canAcceptDrop:(e,t)=>this.selectableCanAcceptDrop(e,t)};if(Fo(p))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};c.push(...U().compact([xo({...p,direction:tt.vh.Onto}),xo({...p,direction:tt.vh.Left}),xo({...p,direction:tt.vh.Right}),xo({...p,direction:tt.vh.Above}),xo({...p,direction:tt.vh.Below})]))}c=this.getHighestDropZonePriorityRects(c);const u=c.filter((e=>e.direction===tt.vh.Above||e.direction===tt.vh.Below)),m=U().minBy(u,(t=>Math.abs(t.top-this.getReferencePointForRect(t,e).y)));let p=u.filter((e=>{let{top:t}=e;return Math.abs(t-(m?m.top:0))<=Ho.competingHorizontalDropZoneMinDist}));if(p.length>1){p=p.filter((t=>{const i=this.getReferencePointForRect(t,e).x,a=_o({device:this.environment.device});return i>=t.left-a&&i<=t.left+t.width+a})),p=U().sortBy(p,(e=>{let{left:t}=e;return t}));let t=0;for(;t<p.length-1;t++){const i=p[t+1],a=this.getReferencePointForRect(i,e).x;if(i.left>a)break}p=p.slice(0,t+1),p.reverse()}const g=p.map(Zo);let h;const f=c.filter((e=>e.direction===tt.vh.Onto)),v=U().minBy(f,(e=>e.height));if(v){u.some((t=>{const i=this.getReferencePointForRect(t,e).y;return Math.abs(t.top-i)<Ho.competingOntoDropZoneVerticalOffset}))||(h=Zo(v))}let y;const S=c.filter((e=>e.direction===tt.vh.Left||e.direction===tt.vh.Right));let M=U().minBy(S,(t=>{const i=this.getReferencePointForRect(t,e).x;return Math.abs(t.left-i)}));if(M){const e=M,t=S.filter((t=>Math.abs(t.left-e.left)<Ho.verticalDropZoneAmbiguousDist));t.length>0&&(M=U().minBy(t,(e=>e.left)))}if(M){const e=M;u.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(y=Zo(M))}return{ontoDropZone:h,verticalDropZone:y,horizontalDropZones:g}}findHoverMenuTarget(e,t,i){if(zo.Z.state.isResizing||tt.ZP.state.isDragging||_s.Z.state.isActive||Qe.kw.state)return;const{selectableRectMap:a}=Co.Z.state,n=Uo.Z.getMembersByDOMOrder().find((t=>{const i=t.getNode();return Boolean(i&&i.contains(e))})),s=j.default.getCurrentDefaultContainer(),o=n||s;if(!o)return;const r=a.keys();let l=r.next();const d=[];for(;!l.done;){const e=l.value,n=a.get(e);(e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===o&&n&&i>=n.top&&i<=n.bottom&&t>=n.left-Ho.hoverMaxHorizontalOffset&&t<=n.right&&d.push(e),l=r.next()}const c=U().sortBy(d,(e=>{const t=a.get(e);return t?-t.left:1/0})),u=c.find((e=>{const t=e.getNode();if(t){if(c.find((i=>{if(i!==e){const e=i.getNode();return Boolean(e&&t.contains(e))}return!1})))return!1}return!0}));return u?{selectable:u,container:o}:void 0}selectableCanAcceptDrop(e,t){if(c.Z.state.isOpen&&!Vo.default.state.open)return!1;if(u.Z.state.isOpen)return!1;const i=tt.ZP.state,a=i.isDragging?i.draggedStores:[],n=!!i.isDragging&&i.isNativeDrag;let s,o,r,l=!1,d=!1;a.find((e=>{const t=No.Z.findOutlinerItemFromStore(e);return!!t&&(s=t,o=t.props.type,l=t.props.isTopLevelItem,!0)}));const m=e instanceof bo.Z?No.Z.findOutlinerItemFromStore(e.props.store):void 0,p=null==m?void 0:m.props.parentStore;var g;m&&(r=m.props.type,d=m.props.isTopLevelItem||"team"===(null===(g=m.props.parentStore)||void 0===g?void 0:g.table));if(this.isDraggingSharedPageOutOfTopLevelTeamSection({draggingOutlinerItem:s,selectableOutlinerItemParent:p,direction:t}))return!1;if(!(e instanceof bo.Z))return e.props.canAcceptDrop({direction:t,draggingStores:a,isNativeDrag:n});const h=e.props.store;if(t===tt.vh.Onto&&"collection"===h.getParentTable()){const e=h.getParentId();if(a.find((t=>Boolean(t instanceof Zt.Z&&"collection"===t.getParentTable()&&t.getParentId()===e))))return!1}if(e.props.groupsPointer){if(e.props.groupsPointer.find((e=>!(0,So.WL)(e)))){if(a.find((t=>{var i;const a=Wo.C.findSelectableFromStore(t);return(null==a||null===(i=a.props)||void 0===i?void 0:i.groupsPointer)&&e.props.groupsPointer&&!(0,Mo.HH)(a.props.groupsPointer,e.props.groupsPointer)})))return!1}}const f=Boolean(a.find((e=>e.isCollectionView())));if(f&&"collection"===h.getParentTable()&&t!==tt.vh.Onto&&"bookmarks"!==o)return!1;if(f&&h.isCollectionView()&&t===tt.vh.Onto)return!1;if(f&&h.isCollectionView()&&!h.getRecordStoreUIParent()&&t!==tt.vh.Onto)return!1;if(m&&t!==tt.vh.Onto&&!d&&!(0,mi.M)({environment:this.environment,blocks:[m.props.store],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(r&&n)return!1;if("bookmarks"===o&&l&&("bookmarks"!==r||!d||t===tt.vh.Onto))return!1;if("bookmarks"===r&&d&&t!==tt.vh.Onto&&("bookmarks"!==o||!l))return!1;if(s&&s.props.isTopLevelItem&&"team"===s.props.type&&s.props.parentStore&&s.props.parentStore.table===W.e0){const e=s.props.parentStore,t=K.Z.createChildStore(e,{...e.pointer,table:W.e0});if(t&&!(0,Ro.Hn)({teamStore:t,environment:this.environment}))return!1}if(m&&m.props.isTopLevelItem&&"team"===m.props.type&&m.props.parentStore&&m.props.parentStore.table===W.e0){const e=m.props.parentStore,t=K.Z.createChildStore(e,{...e.pointer,table:W.e0});if(t&&!(0,Ro.Hn)({teamStore:t,environment:this.environment}))return!1}if("shared"===r&&("shared"!==o||!l)&&t!==tt.vh.Onto)return!1;if(r&&d&&t!==tt.vh.Onto){if(a.find((e=>{const t=e.getType();return Boolean(!t||!S.Z7[t])})))return!1}const{device:v}=this.environment;if(r&&v.isMobile&&t===tt.vh.Onto&&d)return!1;if(a.find((e=>Boolean(e instanceof Zt.Z&&e.isInlineCollectionView())))&&(t===tt.vh.Left||t===tt.vh.Right))return!1;if(a.some((e=>Boolean(Lo.Z.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(Lo.Z.findCollectionTemplatePickerItemFromStore(h)))return!1;if(t===tt.vh.Onto&&h&&!(0,mi.J5)({environment:this.environment,blocks:[h],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(!this.memoizedCanDrag(a))return!1;if(a.some((e=>e.isTransclusionType()))){if(h.findRecordStoreUIAncestor((e=>{if(e===h)return!1;const t=e.getValue();return t&&(0,Ti.nq)(t)})).ancestor)return!1}return!0}getReferencePointForRect(e,t){return Ao({device:this.environment.device,target:e.target,points:t})}isDraggingSharedPageOutOfTopLevelTeamSection(e){var t;const{draggingOutlinerItem:i,selectableOutlinerItemParent:a,direction:n}=e;if(i&&"team"===i.props.type&&i.props.isTopLevelItem&&(null===(t=i.props.parentStore)||void 0===t?void 0:t.pointer.table)===W.e0){const e=i.props.parentStore;if(!(i.props.store.getParentId()===e.pointer.id||a&&a.pointer.id===e.pointer.id&&n!==tt.vh.Onto))return!0}return!1}}g()(Ho,"hoverMaxHorizontalOffset",150),g()(Ho,"competingOntoDropZoneVerticalOffset",7),g()(Ho,"verticalDropZoneAmbiguousDist",20),g()(Ho,"competingHorizontalDropZoneMinDist",2);const qo=Ho;var Ko=i(74647),jo=i(49427),Yo=i(7755);class Qo extends r.Z{constructor(){super(...arguments),g()(this,"cachedPageViewRect",void 0),g()(this,"previousMousePosition",void 0),g()(this,"mouseSpeed",1/0),g()(this,"timerId",void 0),g()(this,"setPreviousMousePosition",((e,t)=>{this.previousMousePosition={x:e,y:t},clearTimeout(this.timerId),this.timerId=setTimeout((()=>{this.previousMousePosition=void 0}),100)})),g()(this,"handleWindowMouseMove",(e=>{(0,Zs.ZP)({event:e,context:Zs.Af.SidebarMouseMove,callback:()=>{if(this.updatePageViewRectThrottled(),void 0!==this.previousMousePosition&&(this.mouseSpeed=Math.sqrt(Math.pow(e.clientX-this.previousMousePosition.x,2)+Math.pow(e.clientY-this.previousMousePosition.y,2))),this.setPreviousMousePosition(e.clientX,e.clientY),this.cachedPageViewRect){const{sidebarMinTriggerWidth:t,sidebarOpenWidthPercent:i}=Qo,a=Yo.TC.state,n=(0,v.Wk)(this.environment),s=e.clientX,o=this.cachedPageViewRect.left,r=Math.max(o*i,t,Yo.Ic.get());s<r&&!Vo.default.isCenterPeekOpen()&&this.mouseSpeed<Qo.mouseSpeedThreshold&&0!==this.mouseSpeed&&!a&&Ko.open(),s>n&&s>r&&a&&Ko.close()}}})})),g()(this,"handleWindowMouseOut",(e=>{e.toElement||e.relatedTarget||Ko.close()})),g()(this,"handleWindowResize",(e=>{this.environment.WindowSizeStore.state.width<Ko.OnlyOneSidebarVisibleWidthThreshold&&(0,v.Sx)(this.environment)&&(0,v.in)(this.environment)&&Ko.setExpand({environment:this.environment,isExpanded:!1})})),g()(this,"updatePageViewRectThrottled",U().throttle(this.updatePageViewRect,500))}didMount(){window.addEventListener("mousemove",this.handleWindowMouseMove),window.addEventListener("mouseout",this.handleWindowMouseOut),window.addEventListener("resize",this.handleWindowResize)}willUnmount(){window.removeEventListener("mousemove",this.handleWindowMouseMove),window.removeEventListener("mouseout",this.handleWindowMouseOut),window.removeEventListener("resize",this.handleWindowResize)}updatePageViewRect(){const e=this.getPageViewWrapEl();this.cachedPageViewRect=e?e.getBoundingClientRect():document.body.getBoundingClientRect()}getPageViewWrapEl(){const{mainEditorCurrentBlockStore:e}=d.default.state,t=jo.Z.find((t=>t.props.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}}g()(Qo,"sidebarOpenWidthPercent",.38),g()(Qo,"sidebarMinTriggerWidth",18),g()(Qo,"mouseSpeedThreshold",5);const Jo=Qo;var Xo=i(13991),$o=i(84084),er=i(68204),tr=i(10743);class ir extends r.Z{constructor(){super(...arguments),g()(this,"renderMenu",(()=>{const{device:e}=this.environment,t=tr.Z.state;if(!t.open)return;const i=this.getSections(t),a=this.getFilter(t);let s;return s=e.isMobileNative&&!e.isTablet?{menuType:I.Z.MenuType.ActionSheet}:{menuType:I.Z.MenuType.Popup,width:this.getWidth(),maxHeight:"40vh",onClickOutside:$o.xv},o().createElement(I.Z,s,n()(Y.Z,{sections:i,onAccept:this.handleAccept,context:{environment:this.environment,blocks:j.default.state.stores,originRect:t.selectionRect,publicEditMode:void 0},filter:a,initialFocus:0,onEmptyEnter:this.handleCancel,useLimit:!0}))})),g()(this,"handleCancel",(()=>{$o.xv()})),g()(this,"handleAccept",(e=>{const t=j.default.state.stores[0];if(t){const i=t.getType(),a=t.getFormat();V.trackBlockAction(this.environment,{analyticsName:e.analyticsName,from:"slash_menu",block_type:i,is_toggleable:i?(0,H._A)(i,a):void 0})}Ye.createAndCommit({userAction:"SlashMenu.handleAccept",environment:this.environment,perform:e=>{$o.RL({environment:this.environment,transaction:e})}})}))}willMountOrUpdate(){let e=tr.Z.state;if(e.open){const i=gt.default.state;if("editing"!==i.mode)return!1;const a=this.getFilter(e),n=(0,er.sG)({sections:this.getSections(e),context:{blocks:j.default.state.stores,environment:this.environment,publicEditMode:void 0},query:a||""});let s=0;if(a)if(0===n.length)s=a.length-e.lettersAtLastResult;else{var t;const i={...e,lettersAtLastResult:null!==(t=null==a?void 0:a.length)&&void 0!==t?t:0};tr.Z.setState(i),e=i}const{multiSelection:o}=i;(0,dt.qS)(o)&&o.start.store===e.textStore&&!Bt.Ye(a,!0,n.length,s,e.textStore)||$o.xv()}}renderComponent(){const{device:e}=this.environment,t=tr.Z.state;return n()(R.ZP,{popupType:e.isMobileNative&&!e.isTablet?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:R.ZP.Placement.Bottom,alignmentToOrigin:R.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,preventBlockRenderQueueOnEnter:!0,onDismiss:this.handleCancel,render:this.renderMenu})}getFilter(e){return Bt.zK(e.textStore,e.oldTextValue,!e.isAddMenu)}getSections(e){const{insertActions:t,slashActions:i}=Js.wg.state;return e.isAddMenu?t:i}getWidth(){return"fr-FR"===Xo.SP?375:324}}const ar=ir;var nr=i(1310),sr=i(39134),or=i(28240);class rr extends r.Z{constructor(){super(...arguments),g()(this,"showingAnimatedList",new Yt.default(!1)),g()(this,"handleShow",(()=>{this.showingAnimatedList.set(!0)})),g()(this,"handleHide",(()=>{this.showingAnimatedList.set(!1)}))}renderComponent(){const{currentItem:e}=nr.Z.state,t=Boolean(e||this.showingAnimatedList.get());return n()(at.Z,{open:t,render:()=>n()(sr.Z,{render:()=>U().compact([this.renderCurrentItem()]),onShow:this.handleShow,onHide:this.handleHide})})}renderCurrentItem(){var e;const{currentItem:t}=nr.Z.state;if(!t)return;const i=null!==(e=null==t?void 0:t.position)&&void 0!==e?e:"bottom",{WindowSizeStore:a,device:s}=this.environment;let o=24;if(s.isMobileNative&&s.isIOS){o=es.Z.state.estimatedKeyboardWebViewOverlap>0?24+es.Z.estimatedNativeWebBottomOverlap():a.getSafePaddingBottomCSS(24+es.Z.estimatedNativeWebBottomOverlap())}const r="top"===i?{top:24}:{bottom:o};return n()(Qt.Z,{isVisible:!0,enterAnimationStyle:{translateY:"top"===i?-50:50,opacity:1,scale:1},animationStyle:{translateY:0,opacity:1,scale:1},exitAnimationStyle:{translateY:0,opacity:0,scale:.95},render:()=>n()("div",{style:{...r,position:"fixed",left:0,width:"100%",display:"flex",zIndex:Oe.E}},void 0,n()("div",{style:{background:this.theme.tooltipBackground,color:this.theme.regularInvertedTextColor,borderRadius:3,padding:"6px 12px",boxShadow:this.theme.largeBoxShadow,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center"}},void 0,t.label,t.helpUrl&&n()(or.Z,{href:t.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16}},void 0,Ut.Z.help({fill:this.theme.mediumInvertedTextColor})),t.button))},t.key)}}const lr=rr;var dr=i(94507),cr=i(61464);function ur(){const e=(0,be.O7)(),{currentSpaceStore:t}=(0,we.Kw)(d.default),i=e.currentUser.id,a=(0,we.VK)((()=>null==t?void 0:t.id),[t]);return(0,s.useEffect)((()=>{if(!a||!i)return;const t=vs.Z.addListener((0,hs.pD)({userId:i,spaceId:a}),(async(t,n)=>{(function(e){var t;let{spaceId:i,userId:a,emitValue:n}=e;const s=null===(t=cr.Z.getUserJoinedTeamsState({userId:a,spaceId:i}))||void 0===t?void 0:t.lastEmitValue;if(s===n)return!1;if(void 0===s&&cr.Z.getHasFetched({userId:a,spaceId:i}))return!1;return!0})({spaceId:a,userId:i,emitValue:n})&&await(0,dr.m)({environment:e,spaceId:a,userId:i,emitValue:n});const s=cr.Z.getUserJoinedTeamsState({userId:i,spaceId:a});s&&cr.Z.setUserJoinedTeamsState({userId:i,spaceId:a,state:{...s,lastEmitValue:n}})}),void 0,e);return function(){t&&vs.Z.removeListener(t,e)}}),[e,i,a]),null}var mr=i(30397);const pr=function(){const e=(0,be.O7)(),{currentSpaceStore:t,currentUserStore:i}=(0,we.Kw)(d.default),[,a,n]=(0,we.oR)(mr.Z),o=null==i?void 0:i.id;return(0,s.useEffect)((()=>{if(!t||!o)return;const i=vs.Z.addListener((0,hs.je)(t.id),(async(i,s)=>{if(!n.shouldRefetchTeamsInSpace({currentUserId:o,currentSpaceId:t.id,emitValue:s}))return;const r=await(0,l.qX)({environment:e,spaceStore:t,includeArchived:!1,currentUserId:o});a({teams:r,lastEmitData:{spaceId:t.id,userId:o,value:s}})}),void 0,e);return function(){i&&vs.Z.removeListener(i,e)}}),[t,o,e,a,n]),null};var gr=i(89475),hr=i(4926),fr=i(1634),vr=i(92452);class yr extends r.Z{constructor(){super(...arguments),g()(this,"handleConnectClick",(async()=>{const e=fr.Z.state,{currentSpaceStore:t}=d.default.state;e.open&&t&&(await(0,gr.h)({environment:this.environment,integration:e.integration,spaceId:t.id,unfurlUrl:e.unfurlUrl,externalObjectInstanceBlockId:e.externalObjectInstanceBlockId}),this.markPopupAsDismissed(e.integration.id),V.trackConnectExternalIntegration(this.environment,{integrationId:e.integration.id,from:"external_object_instance_inline_popup"}),fr.Z.reset())})),g()(this,"handleCloseClick",(()=>{const e=fr.Z.state;e.open&&this.markPopupAsDismissed(e.integration.id),fr.Z.reset()})),g()(this,"markPopupAsDismissed",(e=>{const{currentUserSettingsStore:t}=d.default.state;t&&(0,Ye.createAndCommit)({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:this.environment,perform:i=>{tn.GK({transaction:i,userSettingsStore:t,integrationId:e})}})}))}renderComponent(){const e=fr.Z.state;if(!e.open)return;const t=e.integration.info.icon;return t?n()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:this.theme.popoverBackground,borderRadius:3,boxShadow:this.theme.lightBoxShadow,position:"absolute",bottom:65+hr.Z.state,right:16+hr.Z.state,width:240,zIndex:Oe.hT,clipPath:"inset(-10px -10px -10px -10px)"}},void 0,n()(vr.Z,{type:"image_url",imageURL:t,size:38,style:{marginBottom:6}}),n()("div",{style:{color:this.theme.regularTextColor,fontSize:14,fontWeight:li.Z.fontWeight.semibold,marginBottom:6,textAlign:"center"}},void 0,n()(M.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:e.integration.name}})),n()("div",{style:{color:this.theme.mediumTextColor,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},void 0,n()(M.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live.",description:"Displays the first time a user pastes a link that we have a Link Preview integration for."}),n()(_n.Z,{href:(0,G.UY)("guides.unfurling"),external:!0},void 0,n()(M.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"}))),n()(Mi.Z,{onClick:this.handleConnectClick,style:{width:"100%"}},void 0,n()(M.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})),n()(yn.Z,{icon:Ut.Z.close,onClick:this.handleCloseClick,style:{position:"absolute",top:6,right:6}})):void 0}}const Sr=(0,M.injectIntl)(yr);var Mr=i(89314),br=i(80064);class wr extends r.Z{constructor(){super(...arguments),g()(this,"menuRef",(0,s.createRef)()),g()(this,"renderMenu",(()=>{const{device:e}=this.environment,t=br.Z.state;if(!t.open)return;const{allOptionTypes:i}=t,a={key:"embed section",render:e=>o().createElement(ee.Z,e),items:i.map((e=>({key:e,render:t=>o().createElement(ce.Z,ne()({},t,{title:this.renderTitleForOptionType(e),onMouseEnter:i=>{t.onMouseEnter(i),this.updateUnfurlingOptionType(e)}})),action:()=>this.handleDismiss(e)})))};let s;return s=e.isMobile?{menuType:I.Z.MenuType.ActionSheet}:{menuType:I.Z.MenuType.Popup,width:320,maxHeight:"40vh"},o().createElement(I.Z,ne()({},s,{className:re.b_,ref:this.menuRef}),n()(ue.Z,{type:ue.Z.Type.Vertical,sections:[a],initialFocus:0,onKeyboardArrow:this.handleMenuListKeyboardArrow,priority:1}))})),g()(this,"handleDefaultDismiss",(()=>{this.handleDismiss(void 0)})),g()(this,"handleDismiss",(e=>{(0,Ye.createAndCommit)({userAction:"UnfurlingMenu.handleDismiss",environment:this.environment,perform:t=>{Mr.xv({environment:this.environment,setType:e,transaction:t})}})})),g()(this,"updateUnfurlingOptionType",(e=>{(0,Ye.createAndCommit)({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:this.environment,perform:t=>{Mr.hJ({environment:this.environment,type:e,useTemporaryRecordCache:!0,transaction:t,intl:this.props.intl})}})})),g()(this,"handleMenuListKeyboardArrow",(e=>{const t=br.Z.state;if(!t.open||void 0===e.indexGlobal)return;const i=t.allOptionTypes[e.indexGlobal];i&&this.updateUnfurlingOptionType(i)})),g()(this,"handleWindowKeydown",(e=>{br.Z.state.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&this.handleDismiss(void 0)})),g()(this,"handleWindowMousedown",(e=>{const t=br.Z.state,i=this.menuRef.current;if(!t.open||!e.target||!i)return;const a=Ae().findDOMNode(i);a&&(a.contains(e.target)||this.handleDismiss(void 0))}))}willMount(){(0,Eo.l)(window,"keydown",this.handleWindowKeydown),(0,Eo.l)(window,"mousedown",this.handleWindowMousedown)}willUnmount(){(0,Eo.Z)(window,"keydown",this.handleWindowKeydown),(0,Eo.Z)(window,"mousedown",this.handleWindowMousedown)}renderComponent(){const{device:e}=this.environment,t=br.Z.state;return n()(R.ZP,{popupType:e.isMobileNative&&!e.isTablet?R.ZP.PopupType.SlideUp:R.ZP.PopupType.Popup,open:Boolean(t.open&&t.renderRect),originRect:t.open?t.renderRect:void 0,placementToOrigin:R.ZP.Placement.Top,alignmentToOrigin:R.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDefaultDismiss})}renderTitleForOptionType(e){return"preview"===e?n()(M.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"}):"mention"===e?n()(M.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"}):"link"===e?n()(M.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"}):"collection"===e?n()(M.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Paste as database"}):void(0,ri.t1)(e)}}const Cr=(0,M.injectIntl)(wr);class Tr extends r.Z{willMount(){this.environment.device.isMobile&&document.addEventListener("gesturestart",(function(e){e.preventDefault()}))}renderComponent(){const e=this.environment.currentUser.isLoggedIn(),{isMobile:t,isElectron:i}=this.environment.device,{currentSpaceStore:a}=d.default.state;return n()(s.Fragment,{},void 0,n()(aa,{}),n()(O,{}),n()(Le,{}),n()(Ys,{}),n()(Is,{}),n()(m.Z,{priority:-1,capture:!0}),n()(qo,{}),e&&!t&&n()(Jo,{}),e&&a&&n()(bs,{rootStore:a}),e&&(0,l.bq)()&&n()(pr,{}),e&&(0,l.bq)()&&n()(ur,{}),n()(st,{}),n()(ms,{}),n()(ie,{}),n()(Hs,{}),n()(Ns,{}),n()(ai,{}),n()(Me,{}),!t&&n()(yo,{}),n()(ea,{}),n()(ks,{}),n()(Wn,{}),n()(he.Z,{store:c.Z}),n()(he.Z,{store:u.Z}),n()(ds,{}),n()(ar,{}),n()(Lt,{}),n()(xt,{}),n()(Cr,{}),n()(na.ZP,{}),n()(Sr,{}),n()(ge,{}),n()(lr,{}),n()(Ua,{}),i&&n()(yt,{}),n()(et,{}),n()(He,{}),n()(Fs,{}),e&&n()(Hi,{}),n()(qi.s,{}))}}const kr=Tr},92811:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ct});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=i(77422),l=i.n(r),d=(i(33948),i(96486)),c=i.n(d),u=i(67294),m=i.n(u),p=i(73935),g=i.n(p),h=i(83355),f=i(41892),v=i(15070),y=i(53397),S=i(26825),M=i(27006),b=i(21202),w=i(77420),C=i(29369),T=i(19889),k=i(32739),Z=i(64684),A=i(97880),I=i(82990),P=i(5366),_=i(50906),x=i(25186),F=i(47307),B=i(76464),E=i(38363),D=i(93561),R=i(95477),L=i(617),O=i(28020),N=i(43250),U=i(4708),W=i(84210),V=i(86785),z=i(67669),G=i(75472),H=i(33665),q=i(38755),K=i(16639),j=i(21115),Y=i(23537),Q=i(77907),J=i(27832),X=i(49085);class $ extends X.Z{getInitialState(){return{selectedTab:0}}}const ee=$;var te=i(88632),ie=i(85834),ae=i(95155),ne=i(42330),se=i(80270),oe=i(41952),re=i(20431),le=i(20454),de=i(78291),ce=i(52878),ue=i(12318),me=i(14947),pe=i(2771),ge=i(29368),he=i(77701),fe=i(25735),ve=i(99224),ye=i(46247),Se=i(56109),Me=i(52377),be=i(480),we=i(28350),Ce=i(24405),Te=i(8848),ke=i(91376),Ze=i(81236),Ae=i(46951);function Ie(e){const{permissionItemWrapStyle:t,safePaddingRightCSS:i,safePaddingLeftCSS:a}=e,[{publicSpaceDataMap:n}]=(0,we.oR)(Ze.Z),s=(0,Ce.F)(),{isMobile:r}=(0,be.Fy)(),{canChangeSettings:l,currentSpaceId:d}=(0,we.VK)((()=>{var e,t;return{canChangeSettings:null===(e=J.default.state.currentSpaceStore)||void 0===e?void 0:e.canAdmin(),currentSpaceId:null===(t=J.default.state.currentSpaceStore)||void 0===t?void 0:t.id}}),[]);if(r)return null;if(!d)return null;const c=n[d];if(!c)return null;return c.domainIsAutogenerated&&l?o()("span",{style:{...t,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",padding:"8px 8px",paddingLeft:a,paddingRight:i,color:s.mediumTextColor,backgroundColor:s.inputBackground}},void 0,o()("div",{style:{display:"flex"}},void 0,o()(Ae.Z,{isSmall:!0,isMobile:!1,isSecondaryColor:!0,style:{paddingRight:"4px"}},void 0,o()(P.FormattedMessage,{defaultMessage:"Set a domain for your public links in",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.setDomainForPublicLinks"})),o()("span",{style:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",color:Te.ZP.inherit},onClick:()=>{ke.r({currentTab:"settings"})}},void 0,o()(Ae.Z,{isSmall:!0,isMobile:!1,isSecondaryColor:!1,style:{textDecoration:"underline"}},void 0,o()(P.FormattedMessage,{defaultMessage:"Settings",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.openSettingsCTA"}))))):null}var Pe=i(37181),_e=i(80527);function xe(){const e=(0,Ce.F)(),t=(0,be.O7)(),i={color:e.regularTextColor,cursor:"pointer"};return m().createElement(m().Fragment,null,o()("span",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexDirection:"row",textAlign:"center",padding:"8px",borderTop:"1px solid ".concat(e.tableLightDividerColor),color:e.mediumTextColor,backgroundColor:e.inputBackground}},void 0,o()(Ae.Z,{isSmall:!0,isMobile:!1,isSecondaryColor:!0,style:{flex:1,paddingRight:"4px",whiteSpace:"normal"}},void 0,o()(P.FormattedMessage,{defaultMessage:"Your integrations have moved to the ••• Page menu.",id:"blockPermissionsSettings.connectionsMoved.bannerMessage",description:"A message letting users know that the ability to manage connections has moved to the page menu."}),o()("br",{}),o()(P.FormattedMessage,{defaultMessage:"Learn more about <a>managing connections</a>.",id:"blockPermissionsSettings.learnAboutConnections.bannerMessage",description:"Learn about managing connections from the help center.",values:{a:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return o()("a",{href:"https://www.notion.so/help/add-and-manage-connections-with-the-api",target:"_blank",style:i},void 0,t)}}})),o()(_e.Z,{icon:y.Z.close,onClick:function(){const{currentUserSettingsStore:e}=J.default.state;if(!e)return;D.createAndCommit({userAction:"ShareMenu.BetterConnectionsBanner.handleClose",environment:t,perform:t=>{(0,Pe.d2)({userSettingsStore:e,data:{seen_share_menu_connections_banner:!0},transaction:t})}})}})))}var Fe=i(21523),Be=i(28240),Ee=i(71202),De=i(15282),Re=i(47966),Le=i(23596);function Oe(e){let{store:t,permissionStore:i,blockTeamPermission:a,isInherited:n,tooltip:s,isSubscribed:r}=e;return o()(Le.Z,{format:Le.Z.Format.Workspace,currentBlockStore:t,store:i,permissionItem:a.permissionItem,disabled:!0,icon:y.Z.privateTeam(),title:o()(P.FormattedMessage,{defaultMessage:"Members of a private teamspace",id:"blockPermissionsSettings.permissionItem.teamAccess.privateTeam",description:"All members of a private teamspace"}),tooltip:s,isSubscribed:r,isInherited:n,upgradeButtonName:"team_permission_item",onChange:()=>{}})}var Ne=i(94044),Ue=i(72693);class We extends h.Z{renderComponent(){return o()(me.Z,{hovered:this.props.hovered,onClick:this.props.onClick,disabled:this.props.disabled,disabledFeedback:!0,style:{...this.getButtonStyle(),...this.props.isLarge&&{height:32},...this.props.style},hoveredStyle:{background:this.theme.buttonHoveredBackground},pressedStyle:{background:this.theme.buttonPressedBackground},onMouseDown:this.props.onMouseDown,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,className:this.props.className},void 0,this.props.children)}getButtonStyle(){return{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:3,boxShadow:this.theme.plainButtonBoxShadow,background:this.theme.inputBackground,color:this.theme.mediumTextColor,fill:Te.ZP.white,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontSize:14}}}const Ve=We;var ze=i(37235);class Ge extends h.Z{renderComponent(){const{store:e}=this.props;let t,i;const a="on"===ae.default.getEligibleGroup({experimentId:"better_integrations",defaultGroup:"control"});return e.canEditMembership()?t=!0:(t=!1,i=o()(P.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."})),o()(ze.Z,{renderTooltip:()=>i,disableTooltip:t,render:e=>m().createElement("div",n()({style:{display:"flex",alignItems:"center",gap:Ne.p_}},e),o()(Ve,{onClick:this.props.onClick,disabled:!t&&!0,style:{flex:1,justifyContent:"flex-start",height:30,overflow:"hidden"}},void 0,o()("div",{style:{textOverflow:"ellipsis",overflow:"hidden"}},void 0,o()(P.FormattedMessage,a?{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots",description:"Placeholder text for the search input in the invite user modal"}:{defaultMessage:"Add emails, people, integrations…",id:"ContexualInvites.inviteUserModal.searchInput.placeholder",description:"Placeholder text for the search input in the invite user modal"}))),o()(Ue.Z,{isLarge:!0,onClick:this.props.onClick,disabled:!t&&!0,style:{minWidth:Ne.UF}},void 0,o()(P.FormattedMessage,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})))})}}const He=Ge;var qe=i(79029),Ke=i(33058);function je(e){const{showRestoreButton:t,store:i,type:a,confirmationModalStore:n}=e,{isMobile:s}=(0,be.Fy)(),r=(0,we.VK)((()=>V.uJ(i)[1]),[i]),l=(0,Ce.y)((e=>({container:{display:"flex",minHeight:20,marginLeft:-4,flexDirection:s?"column":"row",alignItems:s?"flex-start":"center",paddingTop:s?14:10,paddingBottom:8,paddingLeft:16,paddingRight:12},banner:{display:"flex",flexDirection:"row",width:"100%",fontSize:s?14:12},icon:{width:s?20:16,marginTop:s?3:2,marginRight:s?10:4,marginLeft:s?4:0,fill:e.mediumIconColor},messageContainer:{display:"flex",flexDirection:"column"},label:{marginLeft:s?5:2,marginBottom:s?2:0,color:s?e.regularTextColor:e.lightTextColor},restoreButton:{color:e.regularTextColor,fontWeight:I.Z.fontWeight.medium},divider:{opacity:"75%"}})),[s]);return s?m().createElement(m().Fragment,null,o()("div",{style:l.container},void 0,o()("div",{style:l.banner},void 0,Je[a](l.icon),o()("div",{style:l.messageContainer},void 0,o()(Ae.Z,{isMultiline:!0,isSmall:!0,style:l.label},void 0,o()(Qe,{type:a,navigableParentStore:r,showRestoreButton:t})),t&&o()(Ye,{store:i,type:a,confirmationModalStore:n})))),o()(ge.Z,{size:1,style:l.divider})):o()("div",{style:l.container},void 0,o()("div",{style:l.banner},void 0,Je[a](l.icon),o()(Ae.Z,{isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:l.label},void 0,o()(Qe,{type:a,navigableParentStore:r,showRestoreButton:t}),t&&o()(Ye,{store:i,type:a,confirmationModalStore:n}))))}function Ye(e){const{type:t,confirmationModalStore:i,store:a}=e,n=(0,Ce.y)((e=>({restoreButton:{color:e.regularTextColor,fontWeight:I.Z.fontWeight.medium}})),[]),s=(0,be.O7)();function r(){i.setState({open:!1,onClose:void 0})}let l;return"restore-team"===t?l=()=>{i.setState({open:!0,onClose:r,type:"restoreTeamPermissions",permissionChanges:[],onAccept:()=>{D.createAndCommit({userAction:"PermissionsRestoreBanner.restoreTeamPermissions",environment:s,perform:e=>{B.Kh({environment:s,store:a,transaction:e})}})}})}:"unrestrict"===t?l=()=>{const e=a.getPermissionItems(),t=V.Om(a),n=t?(0,S.Wo)(V.fJ(t)):[],o=(0,S.Xr)(e,n);i.setState({open:!0,onClose:r,type:"restore",permissionChanges:o,onAccept:()=>{a.getPermissionsStore().canAdmin()?D.createAndCommit({userAction:"PermissionsRestoreBanner.restoreRestrictedPermissions",environment:s,perform:e=>{B.MX({environment:s,store:a,transaction:e})}}):B.hs({environment:s,store:a})}})}:(0,A.t1)(t),l?o()(Ke.Z,{style:n.restoreButton,onClick:l},void 0,o()(P.FormattedMessage,{id:"permissionsRestoreBanner.restoreButton",defaultMessage:"Restore",description:"Action for when user wants to restore permissions to a page."})):m().createElement(m().Fragment,null)}function Qe(e){const{type:t,navigableParentStore:i,showRestoreButton:a}=e,{isMobile:n}=(0,be.Fy)(),s=(0,Ce.y)((e=>({linkBox:{color:e.mediumTextColor},title:{display:"inline"}})),[]),r=(0,we.VK)((()=>{if(i instanceof se.Z)return(0,W.Z)({store:i,fullyQualified:!1})}),[i]);switch(t){case"restore-team":{const e=n;return o()(P.FormattedMessage,{id:"pageShareMenu.restoreTeamPermissionsBanner.label",defaultMessage:"Page access is different from {linkBoxWithPageTitle}.",description:"This text tells the user that this permission setting for the page is not the same as the teamspace default page permissions.",values:{linkBoxWithPageTitle:o()(Be.Z,{disabled:e,style:e?void 0:s.linkBox,underline:!e,inline:!0,onClick:()=>(0,E.RF)(i.id)},void 0,o()(qe.Z,{style:s.title,shouldWrap:!0,maxLength:n||!a?void 0:28,store:i}))}})}case"unrestrict":{const e=n&&i.table===C.e0;return o()(P.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.label",defaultMessage:"Access restricted. May not be shared with everyone from {linkBoxWithPageTitle}.",description:"This text tells the user that this permission setting for the page is NOT inherited from the parent page.",values:{linkBoxWithPageTitle:o()(Be.Z,{disabled:e,style:e?void 0:s.linkBox,underline:!e,inline:!0,onClick:i.table===C.e0?()=>{i.table===C.e0&&(0,E.RF)(i.id)}:void 0,href:r},void 0,o()(qe.Z,{shouldWrap:!0,maxLength:n||!a?void 0:28,store:i,style:{display:"inline"}}))}})}default:(0,A.t1)(t)}}const Je={unrestrict:y.Z.eyeHide,"restore-team":y.Z.info};var Xe=i(42001),$e=i(40039),et=i(53009),tt=i(11082),it=i(62512),at=i(93686),nt=i(60442),st=i(80172),ot=i(49481),rt=i(52738);class lt extends h.Z{constructor(){super(...arguments),l()(this,"storeTypes",{restrictConfirmationModalStore:ue.default.of({open:!1,onClose:void 0}),blockPermissionsSettingsStore:ee,universalMemberInviteStore:ce.Z}),l()(this,"renderInShareMenu",this.createComputedStore((()=>!this.environment.device.isMobile))),l()(this,"contextualInviteMode",this.createComputedStore((()=>this.renderInShareMenu.state?(0,U.qb)(this.environment)?"milestone_2":"milestone_1":"modal"))),l()(this,"renderBotPermissionTooltip",(()=>o()(nt.Z,{imageWidth:240,caption:o()(P.FormattedMessage,{defaultMessage:"This is an integration in your workspace.",id:"blockPermissionsSettings.botPermission.tooltip"})}))),l()(this,"renderPublicPermissionTooltip",(()=>o()(nt.Z,{imageURL:f.Z.images.tooltips.share.publicPagePng,imageWidth:240,imageHeight:120,caption:o()(P.FormattedMessage,{defaultMessage:"Anybody with the link can access the page.",id:"blockPermissionsSettings.publicPermission.tooltip"})}))),l()(this,"renderSpacePermissionTooltip",(()=>o()(nt.Z,{imageURL:f.Z.images.tooltips.share.workspacePng,imageWidth:240,imageHeight:180,caption:o()(P.FormattedMessage,{defaultMessage:"For all members in your workspace, this page will show up in the <boldtext>Workspace</boldtext> section in their sidebar.",values:{boldtext:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return o()("span",{style:{fontWeight:I.Z.fontWeight.bold}},void 0,t)}},id:"blockPermissionsSettings.spacePermission.tooltip"})}))),l()(this,"renderTeamMemberPermissionTooltip",((e,t)=>o()(nt.Z,{imageURL:void 0,imageWidth:240,imageHeight:180,caption:o()(P.FormattedMessage,{defaultMessage:"Applies to all owners and non-guest teamspace members of {teamName}.",values:{teamName:e.name},id:"blockPermissionsSettings.teamPermission.tooltip",description:"A tooltip indicating that this permission item role applies to all owners and teamspace members of the given teamspace."})}))),l()(this,"renderTeamOwnerPermissionTooltip",((e,t)=>o()(nt.Z,{imageURL:void 0,imageWidth:240,imageHeight:180,caption:o()(P.FormattedMessage,{defaultMessage:"Applies to all owners of {teamName}.",values:{teamName:e.name},id:"blockPermissionsSettings.teamOwnerPermission.tooltip",description:"Tooltip indicating how many owners are being granted a specific level of access to a page."})}))),l()(this,"renderGroupPermissionTooltip",(e=>{const t=(0,K.kF)({intl:this.props.intl,group:e});return o()(fe.Y,{group:e,limit:15,noMembersMessage:o()(nt.Z,{imageURL:f.Z.images.tooltips.share.sharedPng,imageWidth:240,imageHeight:120,caption:o()(P.FormattedMessage,{defaultMessage:"For all members of the {groupName} group, this page will show up in the <boldtext>Shared</boldtext> section in their sidebar.",values:{boldtext:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return o()("span",{style:{fontWeight:I.Z.fontWeight.bold}},void 0,t)},groupName:t},id:"blockPermissionsSettings.groupPermission.tooltip"})})})})),l()(this,"renderUserPermissionItem",(e=>{const{store:t}=this.props,i=e.from.table===b.iU?se.Z.createChildStore(t,{table:b.iU,id:e.from.blockId}):re.Z.createChildStore(t,{table:C.e0,id:e.from.teamId}),a=le.Z.createChildStore(t,{table:T.KJ,id:e.permissionItem.user_id}).getValue(),n=i.id!==t.id,s=a?o()(rt.Z,{userValue:a,size:Le.Z.iconSize}):o()(dt,{style:{height:Le.Z.iconSize,width:Le.Z.iconSize,borderRadius:20},theme:this.theme}),{data:r}=de.default.state,l=(r?j.uF(r):[]).find((t=>t.userId===e.permissionItem.user_id)),d=Boolean(l&&!M.zz(l.role)&&!M.J5(l.role)),c=a&&a.email?d?o()("div",{style:I.Z.textOverflowStyle},void 0,o()(ve.B,{})," • ",a.email):a.email:void 0;return o()("div",{},e.permissionItem.user_id,o()(Le.Z,{format:Le.Z.Format.User,currentBlockStore:t,store:i,permissionItem:e.permissionItem,disabled:!this.canEdit(),icon:s,title:a?(0,T.Nz)(this.props.intl,a)||o()(P.FormattedMessage,{defaultMessage:"Invitation sent",id:"blockPermissionsSettings.sentInvitation.message"}):o()(dt,{style:{height:8,width:81,borderRadius:3},theme:this.theme}),subtitle:a?c:o()(dt,{style:{height:8,width:139,borderRadius:3,marginTop:10},theme:this.theme}),isSubscribed:this.isSubscribed(),isInherited:n,tooltip:n?this.renderInheritedPermissionTooltip(i):void 0,upgradeButtonName:"user_permission_item",onUpgradeButtonClick:this.props.onUpgradeButtonClick,onChange:async t=>{await this.handlePermissionItemChange({isInherited:n,oldPermissionItem:e.permissionItem,newPermissionItem:t})}}))})),l()(this,"maybeRenderBotPermissionItem",(e=>{const{store:t}=this.props,{currentUserRootStore:i,currentSpaceStore:a,mainEditorCurrentBlockStore:n}=J.default.state;if(!i||!a||!n)return;const s=e.from.table===b.iU?se.Z.createChildStore(t,{table:b.iU,id:e.from.blockId}):re.Z.createChildStore(t,{table:C.e0,id:e.from.teamId}),r=(0,oe.Kv)(t,{table:w.cZ,id:e.permissionItem.bot_id,spaceId:a.id}),l=r.getValue();if(l&&!l.alive)return;if(l&&(0,v.oA)(l)){if(l.parent_id!==i.id)return;{const t=n.getRole()||"none";if(!(0,S.yY)(t,e.permissionItem.role))return}}const d=s.id!==t.id,c=(null==l?void 0:l.name)||o()(dt,{style:{height:8,width:81,borderRadius:3},theme:this.theme}),u=o()(ot.Z,{botValue:l,size:Le.Z.iconSize});return o()("div",{},r.id,o()(Le.Z,{format:Le.Z.Format.Workspace,currentBlockStore:t,store:s,permissionItem:e.permissionItem,disabled:!this.canEdit(),icon:u,title:c,tooltip:d?this.renderInheritedPermissionTooltip(s):this.renderBotPermissionTooltip(),subtitle:l?o()("div",{style:I.Z.textOverflowStyle},void 0,y.Z.bot({width:12,display:"inline",verticalAlign:"middle",fill:this.theme.mediumIconColor})," ",o()(P.FormattedMessage,{defaultMessage:"Integration",id:"blockPermissionsSettings.permissionsForBot.label",description:"Inform user that this page is shared with a bot."})," · ",(0,v.oA)(l)?o()(P.FormattedMessage,{defaultMessage:"Only visible to you",id:"blockPermissionsSettings.permissionsForBot.personalBot.label"}):o()(P.FormattedMessage,{defaultMessage:"Shared with workspace",id:"blockPermissionsSettings.permissionsForBot.spaceBot.label"})):o()(dt,{style:{height:8,width:139,borderRadius:3,marginTop:10},theme:this.theme}),isSubscribed:this.isSubscribed(),isInherited:d,upgradeButtonName:"bot_permission_item",onUpgradeButtonClick:this.props.onUpgradeButtonClick,onChange:async t=>{await this.handlePermissionItemChange({isInherited:d,oldPermissionItem:e.permissionItem,newPermissionItem:t})}}))})),l()(this,"handleCopy",(()=>{const e=(0,W.Z)({store:this.props.store});x.RD({environment:this.environment,stringValue:e,copiedMessage:x.tq.copiedLinkToClipboard}),this.props.buttonPopupStore.setState({open:!1})})),l()(this,"handleMoveTo",(()=>{const e=g().findDOMNode(this);ne.Z.setState({isOpen:!0,rect:null==e?void 0:e.getBoundingClientRect(),targets:J.default.state.mainEditorCurrentBlockStore?[J.default.state.mainEditorCurrentBlockStore]:[],autocompleteQuery:"",moveToContext:"permission_settings",isAddTo:!1,lastPageId:ne.Z.state.lastPageId,needsConfirmation:!1}),this.props.buttonPopupStore.setState({open:!1})})),l()(this,"handleMobileNativeShareClick",(()=>{const{mobileNative:e}=this.environment,t=k.u5({schemeUrl:window.location.href,baseUrl:R.Z.domainBaseUrl});e&&e.share(t)})),l()(this,"handleCloseRestrictConfirmationModal",(()=>{this.stores.restrictConfirmationModalStore.setState({open:!1,onClose:void 0})})),l()(this,"handlePermissionItemChange",(async e=>{const{isInherited:t,oldPermissionItem:i,newPermissionItem:a}=e;if(!(0,S.Kf)(i,a))throw new Error("Permission type mismatch.");const n=(0,S.nl)(i.role,a.role);if(t&&n!==a.role)return void this.handleRestrictPermission(a);const s=this.props.store.isTopLevel();if(s&&M.ix(a)){const{data:e}=de.default.state,t=e?j.su(e):1;if(!(0,Y.bq)()&&M.YX(i.role)&&!M.YX(a.role)&&t>1){if(!(await F.confirmUserAction({message:o()("span",{},void 0,o()(P.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <semibold>Only you will be able to access it.</semibold>",values:{semibold:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return o()("span",{style:{fontWeight:I.Z.fontWeight.semibold}},void 0,t)}},id:"blockPermissionsSettings.confirmationDialog.private.message"})),acceptLabel:o()(P.FormattedMessage,{defaultMessage:"Move to Private",id:"blockPermissionsSettings.confirmationDialog.privateButton.label"})})))return}else if(!(0,Y.bq)()&&s&&!M.YX(i.role)&&M.YX(a.role)){if(!(await F.confirmUserAction({message:o()("span",{},void 0,o()(P.FormattedMessage,{defaultMessage:"Are you sure you want to share this page with the workspace? <semibold>It will be accessible by all {memberCount} members.</semibold>",id:"blockPermissionsSettings.confirmationDialog.workspace.message",values:{semibold:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return o()("span",{style:{fontWeight:I.Z.fontWeight.semibold}},void 0,t)},memberCount:t}})),acceptLabel:o()(P.FormattedMessage,{defaultMessage:"Move to workspace",id:"blockPermissionsSettings.confirmationDialog.workspaceButton.label"})})))return}}!s&&i.role!==a.role&&n!==i.role&&_.trackWidenPermission(this.environment),D.createAndCommit({userAction:"BlockPermissionsSettings.handlePermissionItemChange",environment:this.environment,perform:e=>{B.ep({environment:this.environment,store:this.props.store,permissionItems:[a],transaction:e})}})})),l()(this,"handleRestrictPermission",(e=>{const t=()=>{D.createAndCommit({userAction:"BlockPermissionsSettings.onAccept",environment:this.environment,perform:t=>{B.Pk({environment:this.environment,store:this.props.store,permissionItem:e,shouldInherit:!0,transaction:t})}})};"none"===e.role?this.stores.restrictConfirmationModalStore.setState({open:!0,onClose:this.handleCloseRestrictConfirmationModal,type:"remove",permissionItem:e,onAccept:t}):this.stores.restrictConfirmationModalStore.setState({open:!0,onClose:this.handleCloseRestrictConfirmationModal,type:"restrict",onAccept:t})})),l()(this,"handleInviteGuestButtonClick",(()=>{const{permissionsInviteStore:e,contextualInviteStore:t}=this.stores.universalMemberInviteStore.state,i=this.renderInShareMenu.state,a={environment:this.environment,permissionsInviteStore:e,store:this.props.store,isSubscribed:this.isSubscribed()};i?((0,G.z5)({...a,renderInShareModal:!0}),t.setState({...t.state,inviteStage:ie.TG.share_page,flowId:e.state.flowId})):(0,G.z5)({...a,renderInShareModal:!1})}))}renderComponent(){const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:Ee.Z.MenuType.Modal,title:o()(P.FormattedMessage,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"}),left:this.renderMobileHelpButton(),right:o()(De.DoneMenuText,{}),onClickRight:this.props.onClose}:{menuType:Ee.Z.MenuType.Popup,maxHeight:"90vh"},m().createElement(m().Fragment,null,m().createElement(et.Z,this.stores.restrictConfirmationModalStore.state),m().createElement(Ee.Z,n()({},t,{className:N.B8}),o()(Se.Z,{capture:!0,allowEsc:!0},void 0,o()(Me.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!1,focusOffscreenInput:!1,render:()=>{if(!te.Z.state.online)return this.renderOfflineMessage();const e=this.getSpaceStore();return e&&this.stores.universalMemberInviteStore.stage!==ie.TG.closed?this.renderPermissionsInviteInShareModal(e):this.renderPermissions()}}))))}renderMobileHelpButton(){return o()(ye.Z,{href:(0,H.UY)("guides.sharing"),analyticsFrom:"sharing"})}renderOfflineMessage(){const{device:e}=this.environment;return o()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:160}},void 0,o()(Ae.Z,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,o()(P.FormattedMessage,{defaultMessage:"Please go online to publish & share.",id:"blockPermissionsSettings.offline.prompt"})))}renderPermissions(){var e;const{device:t,WindowSizeStore:i}=this.environment,{currentSpaceStore:a,currentUserSettingsStore:n}=J.default.state,s="on"===ae.default.getEligibleGroup({experimentId:"better_integrations",defaultGroup:"control"}),r=Boolean(null==n||null===(e=n.getKeyStore("settings").getValue())||void 0===e?void 0:e.seen_share_menu_connections_banner),l=this.getInnerPermissionUIModel({currentSpaceStore:a,currentBlockStore:this.props.store,isBetterIntegrationsEnabled:s}),{showRestrictedPermissionBanner:d,mostPermissivePublicItem:c,permissionItemsCount:m}=l,p=this.shouldShowPublicPermissionItem(),g={};let h=st.Z.Y;if(t.isMobile)g.backgroundColor=this.theme.contentBackground,h=st.Z.None;else switch(g.maxHeight="calc(90vh - 370px)",m){case 0:break;case 1:g.minHeight=60;break;default:g.minHeight=90}return o()("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column"}},void 0,t.isMobile&&o()(u.Fragment,{},void 0,this.renderContentOnlyEditorEducationPill(),d?this.renderRestrictedPermissionBanner():this.maybeRenderRestoreTeamPermissionsBanner(),o()("div",{style:{display:"flex",paddingTop:8,paddingBottom:8,paddingRight:i.getSafePaddingRightCSS(14),background:this.theme.sidebarBackground}},void 0,this.renderPageLinkButton()),o()("div",{style:{borderBottom:"1px solid ".concat(this.theme.regularDividerColor)}})),this.renderInShareMenu.state&&this.renderAddGuests(),o()(tt.Z,{style:g,type:h},void 0,!t.isMobile&&this.renderContentOnlyEditorEducationPill(),!t.isMobile&&(d?this.renderRestrictedPermissionBanner():this.maybeRenderRestoreTeamPermissionsBanner()),this.renderVariousPermissions(l)),!t.isMobile&&this.renderShareToWeb(p,c,!t.isMobile),s&&!r&&l.mostPermissiveBotPermissions.length>0&&!t.isMobile&&o()(xe,{}),this.renderFooter())}renderInviteButton(){const{store:e}=this.props,{modalOpen:t}=this.stores.universalMemberInviteStore.state.permissionsInviteStore.state;return m().createElement(m().Fragment,null,t&&this.renderPermissionsInviteModal(),o()(He,{store:e,onClick:()=>{this.handleInviteGuestButtonClick()}}))}renderPageLinkButton(){const{device:e}=this.environment;return o()(ze.Z,{delayThreshold:0,placement:ze.Z.Placement.Bottom,renderTooltip:()=>this.getPageLinkInfoTooltip(),render:t=>m().createElement(Re.Z,n()({isLarge:!0,onClick:e.isMobileNative?this.handleMobileNativeShareClick:this.handleCopy,style:{marginLeft:12,flex:1,height:this.environment.device.isMobile?36:void 0,background:this.theme.contentBackground}},t),e.isMobileNative?o()(P.FormattedMessage,{id:"pageShareMenu.sharePageLinkButton.label",defaultMessage:"Share page link"}):o()(P.FormattedMessage,{id:"pageShareMenu.copyPageLinkButton.label",defaultMessage:"Copy page link"}))})}renderVariousPermissions(e){let{showPublicPermission:t,showTeamPermission:i,showSpacePermission:a,showUserPermissions:n,mostPermissivePublicItem:s,mostPermissiveTeamOwnerItem:r,mostPermissiveTeamMemberItem:l,mostPermissiveSpaceItem:d,mostPermissiveGroupPermissions:c,mostPermissiveTeamPermissions:m,mostPermissiveUserPermissions:p,mostPermissiveBotPermissions:g,permissionItemsCount:h,spacePermissionGroups:f}=e;const{device:v}=this.environment,y="on"===ae.default.getEligibleGroup({experimentId:"better_integrations",defaultGroup:"control"});return o()(u.Fragment,{},void 0,v.isMobile&&this.renderShareToWeb(t,s,v.isMobile),!this.renderInShareMenu.state&&this.renderAddGuests(),i&&r&&this.renderTeamOwnerPermissionItem(r),i&&l&&this.renderTeamMemberPermissionItem(l),a&&this.renderSpacePermissionItem(d),o()("div",{style:{...this.getPermissionItemWrapStyle(),paddingBottom:h>0?8:void 0}},void 0,this.renderGroupPermissions({spacePermissionGroups:f,mostPermissiveGroupPermissions:c}),this.renderTeamPermissions({mostPermissiveTeamPermissions:m}),n&&o()("div",{},void 0,p.map(this.renderUserPermissionItem)),!y&&g.map(this.maybeRenderBotPermissionItem).filter(A.$K)))}getMostPermissiveTeamMemberItem(e){let{mostPermissivePermissions:t,store:i,teamId:a}=e;if(!a)return;const n=t.find((e=>{let{permissionItem:t}=e;return(0,Z.J2)(t,a)}));return n||{permissionItem:{type:"explicit_team_permission",role:"none",team_id:a},from:{table:b.iU,blockId:i.id}}}getMostPermissiveTeamOwnerItem(e){let{mostPermissivePermissions:t,store:i,teamId:a}=e;if(!a)return;const n=t.find((e=>{let{permissionItem:t}=e;return(0,Z.jc)(t,a)}));return n||{permissionItem:{type:"explicit_team_owner_permission",role:"none",team_id:a},from:{table:b.iU,blockId:i.id}}}getMostPermissiveSpaceItem(e){let{mostPermissivePermissions:t,store:i,teamStore:a}=e;const n=t.find((e=>{let{permissionItem:t}=e;return M.ix(t)}));return n||{permissionItem:{type:"space_permission",role:"none"},from:a&&"none"===a.getSpacePermissionRole()?{table:C.e0,teamId:a.id}:{table:b.iU,blockId:i.id}}}getMostPermissivePublicItem(e){let{mostPermissivePermissions:t,store:i}=e;const a=t.find((e=>{let{permissionItem:t}=e;return M.$D(t)}));return a||{permissionItem:{type:"public_permission",role:"none"},from:{table:b.iU,blockId:i.id}}}maybeRenderRestoreTeamPermissionsBanner(){const{store:e}=this.props;if((0,Y.J5)()&&e.isTopLevelTeamPage()&&e.getPermissionItems().length>0&&e.canAdmin())return o()(je,{type:"restore-team",showRestoreButton:!0,store:e,confirmationModalStore:this.stores.restrictConfirmationModalStore})}renderRestrictedPermissionBanner(){const{device:e}=this.environment,{store:t}=this.props,i=V.uJ(t)[1],a=L.or([L.zz,L.xD([L.c2,L.ff(L.zz)])])({environment:this.environment,blocks:[t],publicEditMode:void 0});if(i&&i.canRead()){if((0,Y.J5)()){const e=i instanceof re.Z?i.hasFullAccess():a;return o()(je,{type:"unrestrict",showRestoreButton:e,store:t,confirmationModalStore:this.stores.restrictConfirmationModalStore})}return o()("div",{},void 0,o()("div",{style:{...this.getPermissionItemWrapStyle(),...this.getMenuItemStyle(),backgroundColor:e.isMobile?this.theme.darkBannerBackground:this.theme.sidebarSecondaryBackground,flexDirection:e.isMobile?"column":"row",alignItems:e.isMobile?"flex-start":"center",paddingTop:e.isMobile?14:10}},void 0,o()("div",{style:{display:"flex",alignItems:"flex-start",marginRight:e.isMobile?void 0:6}},void 0,y.Z.eyeHide({width:e.isMobile?20:16,marginTop:e.isMobile?3:2,marginRight:e.isMobile?10:8,marginLeft:e.isMobile?2:0,fill:this.theme.regularIconColor}),o()(Ae.Z,{isMultiline:!0,isMobile:e.isMobile,isSmall:!0,style:{color:this.theme.regularTextColor}},void 0,o()(P.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.label",defaultMessage:"Access restricted. May not be shared with everyone from {linkBoxWithPageTitle}.",description:"This text tells the user that this permission setting for the page is NOT inherited from the parent page.",values:{linkBoxWithPageTitle:o()(Be.Z,{style:{color:this.theme.mediumTextColor},underline:!0,inline:!0,disabled:i.table===C.e0&&e.isMobile,onClick:i.table===C.e0?()=>{i.table===C.e0&&(0,E.RF)(i.id)}:void 0,href:i.table===b.iU?(0,W.Z)({store:i,fullyQualified:!1}):void 0},void 0,o()(qe.Z,{shouldWrap:!0,maxLength:30,store:i,style:{display:"inline"}}))}}))),a&&o()(Xe.Z,{isSmall:!e.isMobile||void 0,style:{fontSize:e.isMobile?14:12,marginTop:e.isMobile?2:void 0,marginLeft:e.isMobile?24:void 0,fontWeight:e.isMobile?I.Z.fontWeight.medium:void 0},onClick:()=>{const e=t.getPermissionItems(),i=V.Om(t),a=i?(0,S.Wo)(V.fJ(i)):[],n=(0,S.Xr)(e,a);this.stores.restrictConfirmationModalStore.setState({open:!0,onClose:this.handleCloseRestrictConfirmationModal,type:"restore",permissionChanges:n,onAccept:()=>{t.getPermissionsStore().canAdmin()?D.createAndCommit({userAction:"BlockPermissionsSettings.renderRestrictedPermissionBanner",environment:this.environment,perform:e=>{B.MX({environment:this.environment,store:t,transaction:e})}}):B.hs({environment:this.environment,store:t})}})}},void 0,o()(P.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.restore",defaultMessage:"Restore",description:"Action for when user wants to remove restricted access to a page."}))),e.isMobile?o()(ge.Z,{size:1,style:{opacity:"75%"}}):void 0)}}renderShareToWeb(e,t,i){return i?o()("div",{},void 0,e&&this.renderPublicPermissionItem({publicPermission:t,shadowBottom:!0}),this.renderAutogeneratedDomainCTA({publicPermissionRole:t.permissionItem.role,shadowBottom:!0})):o()("div",{},void 0,this.renderAutogeneratedDomainCTA({publicPermissionRole:t.permissionItem.role,shadowBottom:!1}),e&&this.renderPublicPermissionItem({publicPermission:t,shadowBottom:!1}))}renderAutogeneratedDomainCTA(e){const{publicPermissionRole:t,shadowBottom:i}=e;if("none"===t)return;const{WindowSizeStore:a}=this.environment;return o()(Ie,{permissionItemWrapStyle:this.getPermissionItemWrapStyle(i),safePaddingLeftCSS:a.getSafePaddingLeftCSS(8),safePaddingRightCSS:a.getSafePaddingRightCSS(8)})}renderPublicPermissionItem(e){const{store:t}=this.props,{publicPermission:i,shadowBottom:a}=e,n=i.from.table===b.iU?se.Z.createChildStore(t,{table:b.iU,id:i.from.blockId}):re.Z.createChildStore(t,{table:C.e0,id:i.from.teamId}),s=n.id!==t.id;return o()("div",{style:this.getPermissionItemWrapStyle(a),className:N.a8},void 0,o()(Le.Z,{format:Le.Z.Format.Web,currentBlockStore:t,store:n,permissionItem:i.permissionItem,disabled:!this.canEdit(),icon:y.Z.globe({width:26,height:26,fill:this.theme.lightIconColor}),title:o()(P.FormattedMessage,{defaultMessage:"Share to web",id:"blockPermissionsSettings.permissionItem.linkSharing"}),subtitle:M.J5(i.permissionItem.role)?o()(P.FormattedMessage,{defaultMessage:"Anyone with the link can edit and comment",id:"blockPermissionsSettings.publicPermission.canEdit"}):M.RF(i.permissionItem.role)?o()(P.FormattedMessage,{defaultMessage:"Anyone with the link can comment",id:"blockPermissionsSettings.publicPermission.canComment"}):M.YX(i.permissionItem.role)?o()(P.FormattedMessage,{defaultMessage:"Anyone with the link can view",id:"blockPermissionsSettings.publicPermission.canRead"}):o()(P.FormattedMessage,{defaultMessage:"Publish and share link with anyone",id:"blockPermissionsSettings.publicPermission.none"}),tooltip:s?this.renderInheritedPermissionTooltip(n):this.renderPublicPermissionTooltip(),isSubscribed:this.isSubscribed(),isInherited:s,upgradeButtonName:"public_permission_item",onUpgradeButtonClick:this.props.onUpgradeButtonClick,switcherRole:"reader",onChange:async e=>{await this.handlePermissionItemChange({isInherited:s,oldPermissionItem:i.permissionItem,newPermissionItem:e})}}))}renderSpacePermissionItem(e){const{store:t}=this.props,i=e.from.table===b.iU?se.Z.createChildStore(t,{table:b.iU,id:e.from.blockId}):re.Z.createChildStore(t,{table:C.e0,id:e.from.teamId}),a=this.getSpaceStore();if(!a||!a.getValue())return;const n=(0,q.getSpacePermissionItems)(a).filter((e=>M.J5(M.cY(e)))),s=i.id!==t.id;return o()("div",{style:{width:"100%"},className:N.af},void 0,o()(Le.Z,{format:Le.Z.Format.Workspace,currentBlockStore:t,store:i,permissionItem:e.permissionItem,disabled:!this.canEdit(),icon:this.renderSpaceIcon(),title:o()(P.FormattedMessage,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:(0,q.getSpaceName)(this.environment,a)}}),tooltip:s?this.renderInheritedPermissionTooltip(i):!(0,Y.bq)()&&this.renderSpacePermissionTooltip(),subtitle:o()(P.FormattedMessage,{defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} person} other {{numberOfWorkspaceMembers} people}}",id:"blockPermissionsSettings.spacePermission.none",values:{numberOfWorkspaceMembers:n.length}}),isSubscribed:this.isSubscribed(),isInherited:s,upgradeButtonName:"space_permission_item",onUpgradeButtonClick:this.props.onUpgradeButtonClick,onChange:async t=>{await this.handlePermissionItemChange({isInherited:s,oldPermissionItem:e.permissionItem,newPermissionItem:t})}}))}renderTeamMemberPermissionItem(e){var t;const{store:i}=this.props,{permissionItem:a}=e,n=e.from.table===b.iU?se.Z.createChildStore(i,{table:b.iU,id:e.from.blockId}):re.Z.createChildStore(i,{table:C.e0,id:e.from.teamId}),s=this.getSpaceStore(),r=M.zU(a)?a.team_id:null===(t=V.VP(i))||void 0===t?void 0:t.id;if(!r||!s)return;const l=re.Z.createChildStore(s,{table:C.e0,id:r,spaceId:s.id}),d=s.getValue(),c=l.getValue();if(!d)return;const u=n.id!==i.id;if(!c)return o()("div",{style:{width:"100%"},className:N.YH},void 0,o()(Oe,{store:i,permissionStore:n,blockTeamPermission:e,tooltip:u&&this.renderInheritedPermissionTooltip(n),isSubscribed:this.isSubscribed(),isInherited:u}));const m=(0,Z.Xk)(c,d).length;return o()("div",{style:{width:"100%"},className:N.YH},void 0,o()(Le.Z,{format:Le.Z.Format.Workspace,currentBlockStore:i,store:n,permissionItem:e.permissionItem,disabled:!this.canEdit(),icon:this.renderTeamIcon(l),title:o()(P.FormattedMessage,{defaultMessage:"Members of {teamName}",id:"blockPermissionsSettings.permissionItem.teamAccess",description:"All teamspace members of the given teamspace name",values:{teamName:c.name}}),tooltip:u?this.renderInheritedPermissionTooltip(n):this.renderTeamMemberPermissionTooltip(c,m),subtitle:o()(P.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",description:"A sub-title indicating the number of members in the teamspace.",values:{membersCount:m}}),isSubscribed:this.isSubscribed(),isInherited:u,upgradeButtonName:"team_permission_item",onUpgradeButtonClick:this.props.onUpgradeButtonClick,onChange:async t=>{await this.handlePermissionItemChange({isInherited:u,oldPermissionItem:e.permissionItem,newPermissionItem:t})}}))}renderTeamOwnerPermissionItem(e){var t;const{store:i}=this.props,{permissionItem:a}=e,n=e.from.table===b.iU?se.Z.createChildStore(i,{table:b.iU,id:e.from.blockId}):re.Z.createChildStore(i,{table:C.e0,id:e.from.teamId}),s=this.getSpaceStore(),r=M.LW(a)?a.team_id:null===(t=V.VP(i))||void 0===t?void 0:t.id;if(!r||!s)return;const l=re.Z.createChildStore(s,{table:C.e0,id:r,spaceId:s.id}),d=s.getValue(),c=l.getValue();if(!d||!c)return;const u=(0,Z.XO)(c),m=u.length,p=u.map((e=>le.Z.createChildStore(i,{table:T.KJ,id:e}))),g=n.id!==i.id;return o()("div",{style:{width:"100%"},className:N.Zm},void 0,o()(Le.Z,{format:Le.Z.Format.Workspace,currentBlockStore:i,store:n,permissionItem:e.permissionItem,disabled:!this.canEdit(),icon:o()(it.n,{teamStore:l,ownerStores:p}),title:o()(P.FormattedMessage,{defaultMessage:"Owners of {teamName}",id:"blockPermissionsSettings.permissionItem.teamOwnerAccess",description:"The title for a permission item that defines the access given to all owners of a team",values:{teamName:c.name}}),tooltip:g?this.renderInheritedPermissionTooltip(n):this.renderTeamOwnerPermissionTooltip(c,m),subtitle:o()(P.FormattedMessage,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",description:"The sub-title for a permission item that defines the access given to all owners of a teamspace",values:{teamOwnersCount:m}}),isSubscribed:this.isSubscribed(),isInherited:g,upgradeButtonName:"team_owner_permission_item",onUpgradeButtonClick:this.props.onUpgradeButtonClick,onChange:async t=>{await this.handlePermissionItemChange({isInherited:g,oldPermissionItem:e.permissionItem,newPermissionItem:t})}}))}renderInheritedPermissionTooltip(e){const t=e.getIcon();return o()("div",{style:{whiteSpace:"normal",width:180}},void 0,o()(P.FormattedMessage,{defaultMessage:"This access is based on {inlineIconAndName}. Changing this access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissions.tooltip",values:{inlineIconAndName:o()("span",{style:{whiteSpace:"nowrap",fontWeight:I.Z.fontWeight.bold}},void 0,t&&o()($e.Z,{disabled:!0,icon:t,isEmptyPage:!1,size:12,style:{marginRight:4,display:"inline-block",verticalAlign:"middle"}}),o()(qe.Z,{store:e,style:{display:"inline"}}))}}))}renderSpaceIcon(){const{currentSpaceStore:e}=J.default.state;return e?o()(at.p,{disabled:!0,store:e,size:Le.Z.iconSize}):y.Z.team()}renderTeamIcon(e){return o()(at.p,{disabled:!0,store:e,size:Le.Z.iconSize})}renderTeamPermissions(e){const{mostPermissiveTeamPermissions:t}=e;return t.map((e=>M.LW(e.permissionItem)?this.renderTeamOwnerPermissionItem(e):this.renderTeamMemberPermissionItem(e)))}renderGroupPermissions(e){const{currentSpaceStore:t}=J.default.state,{spacePermissionGroups:i,mostPermissiveGroupPermissions:a}=e;return a.map((e=>{const a=e.permissionItem.group_id,n=i.find((e=>e.id===a));if(n&&t)return this.renderGroupPermissionItem(e,n,t.id)}))}renderGroupPermissionItem(e,t,i){const{store:a,intl:n}=this.props,s=e.from.table===b.iU?se.Z.createChildStore(a,{table:b.iU,id:e.from.blockId}):re.Z.createChildStore(a,{table:C.e0,id:e.from.teamId}),r=t.user_ids||[],l=(0,K.kF)({intl:n,group:t}),d=s.id!==a.id,c=t.icon&&o()($e.Z,{disabled:!0,title:l,icon:t.icon?{pointer:{table:"space",id:i},icon:t.icon}:void 0,isEmptyPage:!1,size:18});return o()("div",{style:{fontWeight:400},className:N.gG},t.id,o()(Le.Z,{format:Le.Z.Format.Workspace,currentBlockStore:a,store:s,permissionItem:e.permissionItem,disabled:!this.canEdit(),icon:o()(he.Z,{size:Le.Z.iconSize}),title:l,tag:c,tooltip:d?this.renderInheritedPermissionTooltip(s):this.renderGroupPermissionTooltip(t),subtitle:o()("div",{},void 0,o()(P.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label",description:"Indicates a group of members"})," · ",o()(P.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:r.length}})),isSubscribed:this.isSubscribed(),isInherited:d,upgradeButtonName:"group_permission_item",onUpgradeButtonClick:this.props.onUpgradeButtonClick,onChange:async t=>{await this.handlePermissionItemChange({isInherited:d,oldPermissionItem:e.permissionItem,newPermissionItem:t})}}))}renderAddGuests(){const{device:e,WindowSizeStore:t}=this.environment;return o()(me.Z,{mobileFeedback:e.isMobile,disabled:!0},void 0,o()("div",{style:{...this.getMenuItemStyle(),paddingTop:e.isMobile?12:10,paddingBottom:e.isMobile?12:10,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14)}},void 0,o()("div",{style:{width:"100%"}},void 0,this.renderInviteButton())))}renderContentOnlyEditorEducationPill(){const{store:e}=this.props,t=e.getRole();if(t&&M.WY(t))return o()(pe.V,{userSettingsStore:void 0,style:{margin:void 0,borderRadius:void 0}})}renderPermissionsInviteInShareModal(e){if(!this.renderInShareMenu.state)return null;const t=this.contextualInviteMode.state;if("modal"===t)return null;const{device:i}=this.environment,{store:a}=this.props,n=V.VP(a);return o()(Q.LazyUniversalMemberInvite,{universalInviteStore:this.stores.universalMemberInviteStore,mode:t,spaceStore:e,store:a,disabled:!this.canEdit(),membersOnly:Boolean(!n&&(null==e?void 0:e.getDisableGuests())||n&&n.getDisableGuests()),isSubscribed:this.isSubscribed(),onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:{height:i.isMobile?36:28}})}renderPermissionsInviteModal(){const{currentSpaceStore:e}=J.default.state,{device:t}=this.environment,{store:i}=this.props,a=V.VP(i);return o()(Q.LazyPermissionsInviteWithModal,{store:i,disabled:!this.canEdit(),membersOnly:Boolean(!a&&(null==e?void 0:e.getDisableGuests())||a&&a.getDisableGuests()),isSubscribed:this.isSubscribed(),onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:{height:t.isMobile?36:28},permissionsInviteStore:this.stores.universalMemberInviteStore.state.permissionsInviteStore})}getPermissionItemWrapStyle(){return{boxShadow:arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"0 -1px 0 ".concat(this.theme.regularDividerColor):"0 1px 0 ".concat(this.theme.regularDividerColor),width:"100%"}}getMenuItemStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",minHeight:52,paddingTop:8,paddingBottom:8,paddingLeft:e.getSafePaddingLeftCSS(16),paddingRight:e.getSafePaddingRightCSS(12)}}renderFooter(){const{device:e,WindowSizeStore:t}=this.environment,{store:i}=this.props,a={environment:this.environment,blocks:[i],publicEditMode:void 0},s=L.xD([L._z,L.zz,L.KE,L.Gg,L.jl,L.ff(L.uZ),L.ff(L.xw)])(a);return o()("div",{style:{display:"flex",alignItems:e.isMobile?"flex-start":"center",boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor),paddingLeft:t.getSafePaddingRightCSS(8),paddingRight:t.getSafePaddingRightCSS(8),flexDirection:"column-reverse",...!e.isMobile&&{flexDirection:"row",justifyContent:"space-between",padding:"4px 4px"}}},void 0,!e.isMobile&&o()(u.Fragment,{},void 0,o()(Fe.Z,{}),o()("div",{},void 0,(0,Y.bq)()&&s&&o()(Xe.Z,{isSmall:!0,onClick:this.handleMoveTo,mobileFeedback:e.isMobile,style:{height:24,paddingRight:8,color:this.theme.regularTextColor,marginRight:0}},void 0,y.Z.moveTo({width:14,height:14,fill:this.theme.regularIconColor,marginLeft:0,marginRight:6}),o()(Ae.Z,{isSmall:!0,isMobile:e.isMobile,style:{color:this.theme.regularTextColor}},void 0,o()(P.FormattedMessage,{id:"blockPermissionsSettings.moveToButton.label",defaultMessage:"Move to"}))),o()(ze.Z,{delayThreshold:0,placement:ze.Z.Placement.Bottom,renderTooltip:()=>this.getPageLinkInfoTooltip(),render:t=>m().createElement(Xe.Z,n()({isSmall:!0,onClick:e.isMobileNative?this.handleMobileNativeShareClick:this.handleCopy,mobileFeedback:e.isMobile,style:{height:e.isMobile?44:24,width:e.isMobile?"100%":void 0,paddingLeft:8,paddingRight:8,color:this.theme.regularTextColor}},t),y.Z.link({width:e.isMobile?16:14,height:e.isMobile?16:14,fill:this.theme.regularIconColor,marginLeft:e.isMobile?2:0,marginRight:e.isMobile?8:6}),o()(Ae.Z,{isSmall:!0,isMobile:e.isMobile,style:{color:this.theme.regularTextColor}},void 0,o()(P.FormattedMessage,{id:"blockPermissionsSettings.copyLinkButton.label",defaultMessage:"Copy link"})))}))))}getSpaceStore(){return V.Pj(this.props.store)||J.default.state.currentSpaceStore}isSubscribed(){const{data:e}=de.default.state;return Boolean(e&&j.YK(e))}canEdit(){return M.zz(this.props.store.getRole()||"editor")}shouldShowPublicPermissionItem(){const{currentSpaceStore:e}=J.default.state,t=V.VP(this.props.store);return Boolean(t&&!t.getDisablePublicAccess()||!t&&!(null!=e&&e.getDisablePublicAccess()))}getPageLinkInfoTooltip(){const e=(0,z.YO)(this.props.store).map((e=>{let{permissionItem:t}=e;return t})),t=e.find((e=>"public_permission"===e.type)),i=e.find((e=>"space_permission"===e.type)),a=e.filter((e=>"user_permission"===e.type)),n=e.filter((e=>"group_permission"===e.type||"team_permission"===e.type||"team_owner_permission"===e.type||"explicit_team_permission"===e.type||"explicit_team_owner_permission"===e.type));return t?o()("div",{},void 0,o()(P.FormattedMessage,{defaultMessage:"This page has public link access, so anyone{br}with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip",values:{br:o()("br",{})}})):i?o()("div",{},void 0,o()(P.FormattedMessage,{defaultMessage:"This page has workspace access, so anyone{br}in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip",values:{br:o()("br",{})}})):a.length>1||n.length>0?o()("div",{},void 0,o()(P.FormattedMessage,{defaultMessage:"Only you and other invited members{br}and guests will be able to view the link.",id:"blockPermissionsSettings.userPermissions.tooltip",values:{br:o()("br",{})}})):o()("div",{},void 0,o()(P.FormattedMessage,{defaultMessage:"Only you can access this page,{br}so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip",values:{br:o()("br",{})}}))}getInnerPermissionUIModel(e){let{currentSpaceStore:t,currentBlockStore:i,isBetterIntegrationsEnabled:a}=e;const n=(0,z.YO)(i);let s=[];if(t){const e=t.getValue();e&&e.permission_groups&&(s=e.permission_groups)}const o=V.VP(i),r=null==o?void 0:o.getValue(),l=this.getMostPermissivePublicItem({mostPermissivePermissions:n,store:i}),d=this.getMostPermissiveSpaceItem({mostPermissivePermissions:n,store:i,teamStore:o}),u=this.getMostPermissiveTeamMemberItem({mostPermissivePermissions:n,store:i,teamId:null==r?void 0:r.id}),m=this.getMostPermissiveTeamOwnerItem({mostPermissivePermissions:n,store:i,teamId:null==r?void 0:r.id});let p=n.filter((e=>{let{permissionItem:t}=e;return M.hV(t)}));p=c().sortBy(p,(e=>{if(t){const i=t.getValue();if(i&&i.permission_groups)return i.permission_groups.findIndex((t=>t.id===e.permissionItem.group_id))}return e.permissionItem.group_id}));let g=n.filter((e=>{let{permissionItem:t}=e;return(M.zU(t)||M.LW(t))&&t.team_id!==(null==r?void 0:r.id)}));const h=new Map;g.forEach(((e,t)=>{let{permissionItem:i}=e;h.has(i.team_id)||h.set(i.team_id,t)})),g=c().sortBy(g,[e=>{let{permissionItem:t}=e;return h.get(t.team_id)||0},e=>{let{permissionItem:t}=e;return"explicit_team_owner_permission"===t.type?0:1}]);const f=n.filter((e=>{let{permissionItem:t}=e;return M.jg(t)})),v=n.filter((e=>{let{permissionItem:t}=e;return M.FB(t)})),y=this.shouldShowPublicPermissionItem(),S=(0,O.k_)(this.environment).state,w=Boolean(r);let C=S&&S.showWorkspaceSection||t&&"team"===t.getPlanType()||"none"!==d.permissionItem.role;(0,Y.bq)()&&(C=t&&"team"===t.getPlanType()||"none"!==d.permissionItem.role);const T=C||w||f.length>1||f.length&&!M.zz(f[0].permissionItem.role)||p.length||M.YX(d.permissionItem.role);return{showRestrictedPermissionBanner:n.some((e=>M.Le(e.permissionItem)&&e.from.table===b.iU&&e.from.blockId===i.id)),showPublicPermission:y,showTeamPermission:w,showSpacePermission:C,showUserPermissions:T,mostPermissivePublicItem:l,mostPermissiveTeamOwnerItem:m,mostPermissiveTeamMemberItem:u,mostPermissiveSpaceItem:d,mostPermissiveGroupPermissions:p,mostPermissiveTeamPermissions:g,mostPermissiveUserPermissions:f,mostPermissiveBotPermissions:v,permissionItemsCount:(T?f.length:0)+(a?0:v.length)+(C?1:0)+(w?1:0),spacePermissionGroups:s}}}const dt=e=>o()("div",{style:{...e.style,background:e.theme.lightDividerColor}}),ct=(0,P.injectIntl)(lt)},85324:(e,t,i)=>{i.r(t),i.d(t,{default:()=>A});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=(i(41817),i(67294)),l=i.n(r),d=i(480),c=i(24405),u=i(41892),m=i(86658),p=i(82990),g=i(63143),h=i(5366),f=i(92108),v=i(36867),y=i(45293),S=i(72693),M=i(10182),b=i(92660),w=i(29551),C=i(42001);function T(){const e=(0,c.y)(Z,[]),t=(0,d.O7)();return o()(S.Z,{isLarge:!0,style:e.acceptAllButton,onClick:()=>{f.a9(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),y.Z.setState({open:!1}),(0,f.qo)()}},void 0,l().createElement(h.FormattedMessage,m.ze.acceptAllButtonLabel))}function k(){const e=(0,c.y)(Z,[]);return o()(M.Z,{hasDismissButton:!0,onDismiss:()=>{y.Z.setState({open:!1})},renderOrigin:t=>l().createElement(C.Z,n()({},t,{isLarge:!0,isGray:!0,style:e.moreOptionsButton}),l().createElement(h.FormattedMessage,m.ze.moreOptionsButtonLabel))})}function Z(e){return{modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.regularTextColor,fontWeight:p.Z.fontWeight.semibold,fontSize:18},description:{color:e.mediumTextColor,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}}}const A=(0,h.injectIntl)((function(){const e=(0,d.O7)().currentUser.id;(0,r.useEffect)((()=>{if(!e)return;(0,v._)(e);const t=window.setInterval((()=>{(0,v._)(e)}),g.A0);return()=>{window.clearInterval(t)}}),[e]);const t=(0,c.y)(Z,[]);return o()(b.Z,{onDismiss:()=>{},render:()=>o()("div",{style:t.modal},void 0,o()(w.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center"},void 0,o()("img",{style:t.image,src:u.Z.images.feedbackThankYouPng}),o()("div",{style:t.title},void 0,o()(h.FormattedMessage,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences",description:"Title of the modal shown when requesting cookie consent."})),o()("div",{style:t.description},void 0,(0,m.Fd)(f.Tz,"banner")),o()(T,{}),o()(k,{}))),requireOnline:!0,modalStore:y.Z})}))},42333:(e,t,i)=>{i.r(t),i.d(t,{default:()=>G});var a=i(77094),n=i.n(a),s=i(77422),o=i.n(s),r=(i(33948),i(96486)),l=i.n(r),d=i(67294),c=i.n(d),u=i(83355),m=i(18466),p=i(41892),g=i(53397),h=i(82990),f=i(51454),v=i(5366),y=i(54642),S=i(17215),M=i(73409),b=i(68989);function w(e,t,i){if(i){const{templateId:a}=i;return e.some((e=>e.milestone===t&&e.template_id===a))}return e.some((e=>e.milestone===t))}var C=i(33929),T=i(38755),k=i(21115),Z=i(27832),A=i(4926),I=i(49085);const P="rate",_="send",x="thanks";class F extends I.Z{getInitialState(){return{starRating:void 0,step:P}}}const B=F;var E=i(5188),D=i(13548),R=i(72693),L=i(14947),O=i(62727),N=i(89206),U=i(29551),W=i(40039);const V=(0,v.defineMessages)({additionalFeedbackPlaceholder:{id:"csatPopup.additionalFeedback.placeholder",defaultMessage:"Tell us more..."}});class z extends u.Z{constructor(){super(...arguments),o()(this,"storeTypes",{csatPopupStore:B}),o()(this,"renderCancel",(()=>n()(L.Z,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground}},void 0,g.Z.closeSmall({width:14,fill:this.theme.mediumTextColor})))),o()(this,"renderStep",(()=>{const{step:e}=this.stores.csatPopupStore.state,{currentSpaceStore:t}=Z.default.state;let i;if(t){const e=t.getKeyStore("initial_use_cases").getValue();e&&(i=l().sample(e))}return c().createElement(c().Fragment,null,n()(D.Z,{isVisible:e===P,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0,translateY:-120},render:()=>n()("div",{style:{paddingBottom:40}},void 0,this.renderIcon(),this.renderFeedbackPrompt(i))}),n()(D.Z,{isVisible:e===P||e===_,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>n()("div",{style:this.getSlideContainerStyle()},void 0,this.renderStars(i),this.renderInput(),this.renderSendButton())}),n()(D.Z,{isVisible:e===x,animationStyle:this.getAnimationStyle(e===x),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}))})),o()(this,"renderThanks",(()=>n()("div",{},void 0,n()("img",{style:{width:165,height:80},src:p.Z.images.feedbackThankYouPng}),n()("div",{style:this.getThanksHeaderStyle()},void 0,n()(v.FormattedMessage,{defaultMessage:"Thanks for your feedback!",id:"csatPopup.thanks.header"})),n()("div",{style:this.getThanksDescriptionStyle()},void 0,n()(v.FormattedMessage,{defaultMessage:"Your feedback will help us make Notion better.",id:"csatPopup.thanks.description"}))))),o()(this,"renderIcon",(()=>{const{mainEditorCurrentBlockStore:e}=Z.default.state;if(e){const t=e.getIcon();if(t)return n()(U.gq,{justifyContent:"center",alignItems:"center"},void 0,n()(W.Z,{icon:t,isEmptyPage:!1,size:32,disabled:!0}))}return n()(U.gq,{justifyContent:"center",alignItems:"center"},void 0,g.Z.notionLogo({width:32,height:32}))})),o()(this,"renderFeedbackPrompt",(e=>{switch(e){case"doc_notes":return n()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",n()(v.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for notes & docs?",id:"csatPopup.feedbackPrompt.docNotesLabel"}));case"project_management":return n()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",n()(v.FormattedMessage,{defaultMessage:"How satisfied are you with managing projects and tasks in Notion?",id:"csatPopup.feedbackPrompt.projManagementLabel"}));case"wiki":return n()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",n()(v.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for team wikis?",id:"csatPopup.feedbackPrompt.wikiLabel"}));default:const t=this.shouldRenderAsNPS(e);return n()("div",{style:this.getFeedbackPromptStyle()},"feedback-prompt",n()(v.FormattedMessage,t?{defaultMessage:"How likely are you to recommend Notion to a friend?",id:"csatPopup.feedbackPrompt.enterpriseDefaultLabel"}:{defaultMessage:"How satisfied are you with using Notion? ",id:"csatPopup.feedbackPrompt.defaultlabel"}))}})),o()(this,"renderInput",(()=>{const{step:e,additionalFeedback:t}=this.stores.csatPopupStore.state;return n()(N.Z,{capture:!0,onBackspace:l().identity,onLeft:l().identity,onRight:l().identity,onSelectAll:l().identity,onRedo:l().identity,onUndo:l().identity,onCut:l().identity,onCopy:l().identity,onPaste:l().identity,onKeypress:l().identity,onDelete:l().identity,onTab:l().identity},void 0,n()(O.Z,{textarea:!0,style:this.getInputContainerStyle(),focus:e===_,value:t,placeholder:C.default.formatMessage(V.additionalFeedbackPlaceholder),onChange:e=>{this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,additionalFeedback:e.target.value})}}))})),o()(this,"renderSendButton",(()=>n()(R.Z,{isLarge:!0,style:this.getButtonStyle(),onClick:this.handleSend},void 0,n()(v.FormattedMessage,{id:"csatPopup.sendButton.label",defaultMessage:"Send"})))),o()(this,"renderStars",(e=>{const{starRating:t,step:i}=this.stores.csatPopupStore.state,a=e=>{let{rating:a}=e;return n()("div",{style:this.getStarStyle(),onMouseEnter:()=>{i===P&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:a})},onClick:()=>{this.stores.csatPopupStore.setState({starRating:a,step:_})}},void 0,g.Z.star({width:18,fill:this.theme.mediumIconColor,position:"absolute",opacity:t&&t>=a?0:1}),g.Z.starFilled({width:18,fill:"#F6C050",position:"absolute",opacity:t&&t>=a?1:0}))},s=()=>{const i=this.shouldRenderAsNPS(e);switch(t){case 1:return n()(v.FormattedMessage,i?{defaultMessage:"Very unlikely",id:"csatPopup.stars.1StarLabelNps"}:{defaultMessage:"Very dissatisfied",id:"csatPopup.stars.1StarLabel"});case 2:return n()(v.FormattedMessage,i?{defaultMessage:"Somewhat unlikely",id:"csatPopup.stars.2StarLabelNps"}:{defaultMessage:"Somewhat dissatisfied",id:"csatPopup.stars.2StarLabel"});case 3:return n()(v.FormattedMessage,i?{defaultMessage:"Not likely nor unlikely",id:"csatPopup.stars.3StarLabelNps"}:{defaultMessage:"Not dissatisfied nor satisfied",id:"csatPopup.stars.3StarLabel"});case 4:return n()(v.FormattedMessage,i?{defaultMessage:"Somewhat likely",id:"csatPopup.stars.4StarLabelNps"}:{defaultMessage:"Somewhat satisfied",id:"csatPopup.stars.4StarLabel"});case 5:return n()(v.FormattedMessage,i?{defaultMessage:"Very likely",id:"csatPopup.stars.5StarLabelNps"}:{defaultMessage:"Very satisfied",id:"csatPopup.stars.5StarLabel"});default:return n()(v.FormattedMessage,{defaultMessage:"Select an option",id:"csatPopup.stars.notSpecifiedLabel"})}};return n()("div",{onMouseLeave:()=>{l().delay((()=>{this.stores.csatPopupStore.state.step===P&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:void 0})}),500)},style:this.getStarsContainerStyle()},void 0,n()("div",{style:this.getStarsStyle()},void 0,n()(a,{rating:1}),n()(a,{rating:2}),n()(a,{rating:3}),n()(a,{rating:4}),n()(a,{rating:5})),n()("div",{style:this.getStarLabelStyle()},void 0,n()(s,{})))})),o()(this,"handleCancel",(async()=>{const{state:e}=E.Z;if(!e.open)return;const{open:t,...i}=e;if(t&&"trigger"===i.type){const{currentSpaceStore:e}=Z.default.state;if(!e)return;await y.submitCsatFeedback(this.environment,{spaceId:e.id,rating:void 0,additionalFeedback:void 0,templateId:void 0,...i})}E.Z.setState({...E.Z,open:!1})})),o()(this,"handleSend",(async()=>{const{additionalFeedback:e,starRating:t}=this.stores.csatPopupStore.state,{currentSpaceStore:i}=Z.default.state;if(!i||!t)return;const{state:a}=E.Z;if(!a.open)return;const{open:n,...s}=a,o="passive"===s.type?await y.submitCsatFeedback(this.environment,{spaceId:i.id,rating:t,additionalFeedback:e,type:s.type,milestone:void 0,templateId:void 0}):await y.submitCsatFeedback(this.environment,{spaceId:i.id,rating:t,additionalFeedback:e,templateId:void 0,...s});if("success"!==o.type)throw o.error;this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,step:x}),l().delay((()=>{E.Z.setState({...E.Z,open:!1}),l().delay((()=>{this.stores.csatPopupStore.reset()}),1e3)}),2e3)})),o()(this,"flexCenteredStyle",{display:"flex",alignItems:"center",flexDirection:"column"})}willMount(){const{userSettingsStore:e,blockStore:t,spaceStore:i}=this.props;if(e&&t&&i){const a=this.environment;if("CsatMilestoneStore"in a){const n=m.Z.withListenerIgnored((()=>function(e,t){const{userSettingsStore:i,blockStore:a,spaceStore:n}=t,s=i.getSettings(),o=null==s?void 0:s.signup_time,{CsatMilestoneStore:r}=e,{data:d}=r.state,c=864e5,u=e=>Math.floor((Date.now()-e)/c),m=n.getValue();if(!m||!d)return;const{milestones:p}=d;if(!p)return;if(Math.max(...p.map((e=>e.created_time)))>Date.now()-24192e5)return;if(o){const e=u(o),t=l().sample(m.initial_use_cases)||"legacy";if(e>=180){if(!w(p,M.Hf))return{milestone:M.Hf,useCase:t}}else if(e>=90){if(!w(p,M.Vx))return{milestone:M.Vx,useCase:t}}else if(e>=28){if(!w(p,M.Sh))return{milestone:M.Sh,useCase:t}}else if(e>=7&&!w(p,M.zK))return{milestone:M.zK,useCase:t}}const g=a.getValue(),h=g?(0,S.zc)(g,"block"):void 0;return g&&h&&(0,b.JY)(h)&&u(g.created_time)>=7&&!w(p,M.a0,{templateId:h.id})?{milestone:M.a0,useCase:"legacy",templateId:h.id}:void 0}(a,{userSettingsStore:e,blockStore:t,spaceStore:i})));if(n){const{milestone:e,useCase:t,templateId:i}=n;l().delay((()=>{E.Z.setState({open:!0,milestone:e,type:"trigger",useCase:t,templateId:i})}),2e3)}}}}renderComponent(){const{device:e}=this.environment;if(e.isMobile)return;const{currentSpaceStore:t}=Z.default.state;return t&&!(0,T.isGuestOfSpace)(t)?n()(D.Z,{isVisible:E.Z.state.open,animationStyle:this.getAnimationStyle(E.Z.state.open),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),springConfig:this.getSpringConfig(),render:()=>n()("div",{style:this.getContainerStyle()},void 0,this.renderCancel(),n()("div",{style:this.getInnerContainerStyle()},void 0,this.renderStep()))}):void 0}shouldRenderAsNPS(e){const t=k.CM(this.environment),{state:i}=E.Z,a=i.open&&"trigger"===i.type;return"enterprise"===t&&!e&&a}getSpringConfig(){return{scale:{stiffness:58,damping:4.3}}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getThanksHeaderStyle(){return{color:this.theme.regularTextColor,fontWeight:h.Z.fontWeight.semibold,fontSize:14}}getThanksDescriptionStyle(){return{color:this.theme.mediumTextColor,fontSize:12}}getButtonStyle(){return{width:"calc(100% - 30px)"}}getInputContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{width:"calc(100% - 30px)",display:"block",background:this.theme.popoverBackground,height:80,marginTop:10,marginBottom:10,opacity:e===P?0:1}}getStarLabelStyle(){return{fontSize:12,color:this.theme.mediumTextColor,paddingTop:4}}getFeedbackPromptStyle(){return{paddingTop:12,paddingBottom:12,color:this.theme.regularTextColor,fontWeight:h.Z.fontWeight.semibold,fontSize:14,lineHeight:1.4,width:188}}getStarStyle(){return{display:"inline-flex",position:"relative",width:20,height:20,marginRight:3}}getSlideContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{...this.flexCenteredStyle,position:"absolute",transition:"transform 200ms ease",width:240,transform:e===P?"translateY(120px)":"translateY(0px)"}}getStarsContainerStyle(){return{width:"100%",...this.flexCenteredStyle}}getStarsStyle(){return{display:"flex",cursor:"pointer"}}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,position:"absolute",bottom:65+A.Z.state,right:16+A.Z.state,zIndex:f.hT}}getInnerContainerStyle(){return{...this.flexCenteredStyle,width:240,height:195,overflow:"hidden",position:"relative",padding:12,cursor:"default",textAlign:"center",justifyContent:"center"}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}}const G=(0,v.injectIntl)(z)},1459:(e,t,i)=>{i.r(t),i.d(t,{default:()=>$});var a=i(77094),n=i.n(a),s=i(77422),o=i.n(s),r=(i(33948),i(67294)),l=i.n(r),d=i(83355),c=i(5366),u=i(79257),m=i(11599),p=i(27832),g=i(85680),h=i(88923),f=i(97464),v=i.n(f),y=(i(85827),i(96486)),S=i.n(y),M=i(99036),b=i(6695),w=i(53397),C=i(82990),T=i(50906),k=i(96802),Z=i(93561),A=i(84210),I=i(29376),P=i(33665),_=i(92547),x=i(81870),F=i(26909),B=i(44514),E=i(61766),D=i(12318),R=i(43700),L=i(69872);class O extends d.Z{constructor(){super(...arguments),o()(this,"storeTypes",{hovered:D.default.of(!1),buttonPopupStore:D.default.of(new E.Z)})}renderComponent(){const{schema:e,property:t,format:i,showAsSectionMenu:a,handlePageSectionClick:s}=this.props,o=e[t];if(!o)return;const r=this.getPropertyVisibility(o);return n()(L.Z,{onMouseEnter:()=>this.stores.hovered.set(!0),onMouseLeave:()=>this.stores.hovered.set(!1),focused:this.stores.hovered.get(),showDragHandle:!this.environment.device.isMobile,showExtensionArrow:!1,propertySchema:o,format:L.Z.DisplayFormat.Name,dontShrinkRight:!0,ignoreLocalHoverState:!0,locked:this.props.locked,onClick:()=>{if(!this.props.locked){const e=this.stores.buttonPopupStore.get();e.setState({open:!e.state.open})}},right:n()(R.Z,a&&s?{buttonPopupStore:this.stores.buttonPopupStore.get(),visibility:r,visibilityLevels:["show","hide","hide_if_empty","inline","minimal"],locked:this.props.locked,onSelect:e=>s(e,t,i),onClose:()=>this.stores.hovered.set(!1),type:"relation_property",propertySchema:o,showAsMenu:!0}:{buttonPopupStore:this.stores.buttonPopupStore.get(),visibility:r,locked:this.props.locked,onSelect:e=>this.handleVisibilitySelectClick(e),onClose:()=>this.stores.hovered.set(!1),type:"property",propertySchema:o})},t)}getPropertyVisibility(e){const{visibility:t}=this.props;switch(t){case"hide_if_empty":return m.kq({propertySchema:e})?"hide_if_empty":"show";default:return t}}handleVisibilitySelectClick(e){const{property:t,format:i,store:a}=this.props;Z.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:this.environment,perform:n=>{u.M0({property:t,visibility:e,format:i,store:a,transaction:n})}})}}const N=O;var U=i(15510),W=i(28240),V=i(71202),z=i(86646),G=i(15282),H=i(42001),q=i(40039),K=i(79029),j=i(83071);class Y extends d.Z{constructor(){super(...arguments),o()(this,"storeTypes",{lockStore:_.Z}),o()(this,"handleDraggableDrop",(e=>{const t=this.getCollectionPageProperties();if(t){const i=e.map((e=>t.find((t=>t.property===e))));u.D2({environment:this.environment,properties:i,store:this.props.store})}})),o()(this,"handleDraggableDropSections",(e=>{const t=this.getCollectionPageSections();if(t){const i=e.map((e=>t.find((t=>t.section===e))));t&&Z.createAndCommit({userAction:"CustomizePageMenu.handleDraggableDropSections",environment:this.environment,perform:e=>{u.Do({environment:this.environment,pageSectionFormats:i,store:this.props.store,transaction:e})}})}})),o()(this,"handleShowAsClick",((e,t,i,a)=>{const n=m.$0();if(!n)return!1;let s=a.collection_page_sections||[];if(!i[t])return;const o=s.findIndex((e=>e.section===t));-1!==o?s[o]={section:t,visibility:e}:s=[...s,{section:t,visibility:e}];const r="inline"===e||"minimal"===e?"section":"show";s&&(Z.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:this.environment,perform:e=>{u.Do({environment:this.environment,pageSectionFormats:s,store:n,transaction:e}),u.M0({property:t,visibility:r,store:n,format:a,transaction:e})}}),T.trackRelationShowAs(this.environment,{from:"page_properties",mode:"inline"===e?"page_section":"minimal"===e?"minimal_page_section":"property"}))})),o()(this,"handleShowAsSectionMenuClick",((e,t,i)=>{const a=m.$0();if(!a)return;let n=i.collection_page_sections||[];if("inline"===e||"minimal"===e){const s=n.findIndex((e=>e.section===t));-1!==s?n[s]={section:t,visibility:e}:n=[...n,{section:t,visibility:e}];const o="inline"===e||"minimal"===e?"section":"show";n&&(Z.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPageSectionClick",environment:this.environment,perform:e=>{u.Do({environment:this.environment,pageSectionFormats:n,store:a,transaction:e}),u.M0({property:t,visibility:o,store:a,format:i,transaction:e})}}),T.trackRelationShowAs(this.environment,{from:"page_properties",mode:"minimal"===e?"minimal_page_section":"page_section"}))}else{const n=b.AX.find((t=>t===e));if(!n)return;Z.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPropertyClick",environment:this.environment,perform:e=>{u.M0({property:t,visibility:n,store:a,format:i,transaction:e})}}),T.trackRelationShowAs(this.environment,{from:"page_properties",mode:"property"})}})),o()(this,"handleToggleLockClick",(()=>{const e=m.$0();if(!e)return!1;const t=e.getParentBlockStore();t&&(Z.createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:this.environment,perform:e=>{k.Wq({environment:this.environment,store:t,isLocked:!m.p1(),transaction:e})}}),this.stores.lockStore.setState({justUnlocked:!this.stores.lockStore.state.justUnlocked}))}))}renderComponent(){const{device:e}=this.environment;let t;t=e.isMobile?{menuType:V.Z.MenuType.Modal,right:n()(G.DoneMenuText,{}),onClickRight:u.xv,title:this.props.intl.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:V.Z.MenuType.Popup,minWidth:400};const i=this.getNormalizedFormat();return l().createElement(V.Z,v()({},t,{header:this.renderHeader()}),(this.props.locked||this.stores.lockStore.state.justUnlocked)&&this.renderLockControls(),this.renderPageSectionsSectionMenuItem(i),this.renderPropertiesSectionMenuItem(i))}renderLockControls(){return n()("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:"1px solid ".concat(this.theme.regularDividerColor),borderBottom:"1px solid ".concat(this.theme.regularDividerColor),background:this.theme.sidebarBackground,color:this.theme.mediumTextColor,paddingTop:6,paddingBottom:6}},void 0,n()("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6}},void 0,this.stores.lockStore.state.justUnlocked?w.Z.unlocked({height:12,width:12,fill:this.theme.mediumIconColor}):w.Z.locked({height:12,width:12,fill:this.theme.mediumIconColor})),this.stores.lockStore.state.justUnlocked?n()(c.FormattedMessage,{id:"customizePageMenu.unlocked.header",defaultMessage:"Settings unlocked on parent database."}):n()(c.FormattedMessage,{id:"customizePageMenu.locked.header",defaultMessage:"Settings locked on parent database."}),n()(H.Z,{style:{fontSize:12,color:this.theme.mediumTextColor,fontWeight:C.Z.fontWeight.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:this.handleToggleLockClick},void 0,this.stores.lockStore.state.justUnlocked?n()(c.FormattedMessage,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):n()(c.FormattedMessage,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock"})))}renderPropertiesSectionMenuItem(e){const t=this.getSchema();if(!t||"page"===this.props.type)return;const i=this.getPageCustomization(e);if(!i)return;const{propertyVisibility:a}=i;if(!a)return;const s=a.reduce(((e,t)=>(e[t.property]=t.visibility,e)),{}),o=this.getCollectionPageSections().filter((e=>"inline"===e.visibility||"minimal"===e.visibility)).map((e=>e.section)),r=S().difference(this.getCollectionPageProperties().map((e=>e.property)),o);return n()(j.Z,{style:{opacity:this.props.locked?.5:1},title:n()(c.FormattedMessage,{id:"customizePageMenu.propertiesSection.header",defaultMessage:"Properties"})},void 0,n()(U.Z,{direction:U.K.Vertical,keys:r,renderKey:i=>{var a;const o=null===(a=t[i])||void 0===a?void 0:a.type;if("collection"===this.props.type)return"relation"===o&&(0,I.Lt)()?n()(N,{schema:t,visibility:s[i],property:i,format:e,store:this.props.store,locked:this.props.locked,showAsSectionMenu:!0,handlePageSectionClick:this.handleShowAsSectionMenuClick}):n()(N,{schema:t,visibility:s[i],property:i,format:e,store:this.props.store,locked:this.props.locked})},onDrop:this.handleDraggableDrop}))}renderPageSectionsSectionMenuItem(e){const t=this.getSchema();if(!t)return;const i=this.getPageCustomization(e);if(!i)return;const{pageSectionVisibility:a}=i;if(!a)return;const s=this.getCollectionPageSections().map((e=>e.section));return l().createElement(l().Fragment,null,n()(j.Z,{style:{opacity:this.props.locked?.5:1},title:n()(c.FormattedMessage,{id:"customizePageMenu.sectionsSection.header",defaultMessage:"Sections"}),topBorder:!this.props.locked&&!this.stores.lockStore.state.justUnlocked},void 0,n()("div",{style:{marginLeft:8}},void 0,s.length>0&&n()(j.Z,{style:{opacity:this.props.locked?.5:1,width:"100%",paddingBottom:0,paddingTop:0}},void 0,n()(U.Z,{direction:U.K.Vertical,keys:s,renderKey:i=>{var a;if("collection"===this.props.type&&"section_hide"!==(0,m.ab)(void 0,i))return n()("div",{style:{display:"inline-flex",width:"100%"}},void 0,n()(z.Z,{title:null===(a=t[i])||void 0===a?void 0:a.name,icon:w.Z.typesRelation({height:14,width:14,fill:this.theme.regularIconColor,fontWeight:C.Z.fontWeight.medium}),disabled:this.props.locked,showDragHandle:!this.environment.device.isMobile,right:n()(R.Z,{visibility:(0,m.ab)(void 0,i),visibilityLevels:["section_hide","inline","minimal"],locked:this.props.locked,onSelect:a=>{this.handleShowAsClick(a,i,t,e)},type:"page",showAsMenu:!0})}))},onDrop:this.handleDraggableDropSections})),n()(z.Z,{title:n()(c.FormattedMessage,{id:"customizePageMenu.pageSections.topLevelPageDiscussionsTitle",defaultMessage:"Top-level page discussions"}),icon:w.Z.speechBubbleThick({height:16,width:16}),right:n()(R.Z,{visibility:a.comments,visibilityLevels:["section_show","section_hide"],locked:this.props.locked,onSelect:t=>{u.W4({environment:this.environment,pageSection:"comments",visibility:t,store:this.props.store,format:e})},type:"page"})}),n()(z.Z,{title:n()(c.FormattedMessage,{id:"customizePageMenu.pageSections.backlinksTitle",defaultMessage:"Backlinks"}),icon:w.Z.alias({height:16,width:16,transform:"rotate(180deg)"}),right:n()(R.Z,{visibility:a.backlinks,locked:this.props.locked,visibilityLevels:["section_show","section_hide","section_collapsed"],onSelect:t=>{u.W4({environment:this.environment,pageSection:"backlinks",visibility:t,store:this.props.store,format:e})},type:"page"})}),n()(z.Z,{title:n()(c.FormattedMessage,{id:"customizePageMenu.pageSections.pageCommentsTitle",defaultMessage:"Page comments"}),icon:w.Z.speechBubbleThick({height:16,width:16}),right:n()(R.Z,{visibility:(0,m.ab)(a,"margin_comments"),visibilityLevels:["inline","minimal"],locked:this.props.locked,onSelect:t=>{u.W4({environment:this.environment,pageSection:"margin_comments",visibility:t,store:this.props.store,format:e})},type:"page"})}))))}renderHeader(){if(this.environment.device.isMobile)return;const{store:e}=this.props;if(e){const t=e.getIcon(),i="collection"===this.props.type?this.props.store.getParentBlockStore():void 0,a=t&&n()(q.Z,{icon:t,isEmptyPage:!1,size:14,disabled:!0,style:{display:"inline-flex",marginRight:2}}),s=n()(K.Z,{store:e,style:{display:"inline"}}),o=i?n()(B.Q,{prefix:n()(c.FormattedMessage,{id:"customizePageMenu.header.allPages.label",defaultMessage:"Customize all pages in",description:"Text to tell the user that their changes will apply to all pages in the database"}),viewName:i?l().createElement(l().Fragment,null,n()(W.Z,{onClick:u.xv,href:(0,A.Z)({store:i,fullyQualified:!1}),inline:!0},void 0,a,s)):l().createElement(l().Fragment,null,a,s)}):n()(c.FormattedMessage,{id:"customizePageMenu.header.singlePage.label",defaultMessage:"Customize this page view",description:"Header text showing in the customize page menu for pages that aren't part of a database"});return n()(z.Z,{style:{...F.ZP.headingStyle},title:o,right:n()(x.Z,{helpButtonContext:"customize_page_menu",href:(0,P.UY)("guides.customizePageView")})})}}getSchema(){if("collection"!==this.props.type)return this.props.store.getSchema();{const e=this.props.store.getValue();if(e)return M.oC(e)}}getNormalizedFormat(){const{store:e}=this.props,t=e.getFormat(),i=this.getSchema();if(!i)return{};const a=e.getSpaceId();return b.iB(t,i,void 0,b.j5.Collection,a)}getCollectionPageProperties(){if("collection"!==this.props.type)return[];return this.getNormalizedFormat().collection_page_properties||[]}getCollectionPageSections(){if("collection"!==this.props.type)return[];return this.getNormalizedFormat().collection_page_sections||[]}getPageCustomization(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}}const Q=Y;var J=i(66722);class X extends d.Z{constructor(){super(...arguments),o()(this,"renderModal",(()=>{if(!g.Z.state.isOpen)return;const e=m.$0(),{mainEditorCurrentBlockStore:t}=p.default.state,i=h.default.state.open&&h.default.state.target||t;return e?n()(Q,{store:e,type:"collection",intl:this.props.intl,locked:m.p1()}):i?n()(Q,{store:i,type:"page",intl:this.props.intl,locked:!1}):void 0}))}renderComponent(){const{device:e}=this.environment,t=g.Z.state;return n()(J.ZP,{popupType:e.isMobile?J.ZP.PopupType.SlideUp:J.ZP.PopupType.Popup,alignmentToOrigin:J.ZP.Alignment.Center,open:t.isOpen,render:this.renderModal,originRect:t.isOpen?t.rect:void 0,onDismiss:()=>u.xv()})}}const $=(0,c.injectIntl)(X)},20115:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ne});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=i(77422),l=i.n(r),d=(i(33948),i(96486)),c=i.n(d),u=i(67294),m=i.n(u),p=i(83355),g=i(13991),h=i(8848),f=i(57269),v=i(32918),y=i(85114),S=i(31942),M=i(11843),b=i(53397);const w=c().memoize((e=>({"Africa/Abidjan":e.formatMessage({id:"allTimeZones.Africa/Abidjan",defaultMessage:"Africa/Abidjan"}),"Africa/Accra":e.formatMessage({id:"allTimeZones.Africa/Accra",defaultMessage:"Africa/Accra"}),"Africa/Addis_Ababa":e.formatMessage({id:"allTimeZones.Africa/Addis_Ababa",defaultMessage:"Africa/Addis_Ababa"}),"Africa/Algiers":e.formatMessage({id:"allTimeZones.Africa/Algiers",defaultMessage:"Africa/Algiers"}),"Africa/Asmara":e.formatMessage({id:"allTimeZones.Africa/Asmara",defaultMessage:"Africa/Asmara"}),"Africa/Asmera":e.formatMessage({id:"allTimeZones.Africa/Asmera",defaultMessage:"Africa/Asmera"}),"Africa/Bamako":e.formatMessage({id:"allTimeZones.Africa/Bamako",defaultMessage:"Africa/Bamako"}),"Africa/Bangui":e.formatMessage({id:"allTimeZones.Africa/Bangui",defaultMessage:"Africa/Bangui"}),"Africa/Banjul":e.formatMessage({id:"allTimeZones.Africa/Banjul",defaultMessage:"Africa/Banjul"}),"Africa/Bissau":e.formatMessage({id:"allTimeZones.Africa/Bissau",defaultMessage:"Africa/Bissau"}),"Africa/Blantyre":e.formatMessage({id:"allTimeZones.Africa/Blantyre",defaultMessage:"Africa/Blantyre"}),"Africa/Brazzaville":e.formatMessage({id:"allTimeZones.Africa/Brazzaville",defaultMessage:"Africa/Brazzaville"}),"Africa/Bujumbura":e.formatMessage({id:"allTimeZones.Africa/Bujumbura",defaultMessage:"Africa/Bujumbura"}),"Africa/Cairo":e.formatMessage({id:"allTimeZones.Africa/Cairo",defaultMessage:"Africa/Cairo"}),"Africa/Casablanca":e.formatMessage({id:"allTimeZones.Africa/Casablanca",defaultMessage:"Africa/Casablanca"}),"Africa/Ceuta":e.formatMessage({id:"allTimeZones.Africa/Ceuta",defaultMessage:"Africa/Ceuta"}),"Africa/Conakry":e.formatMessage({id:"allTimeZones.Africa/Conakry",defaultMessage:"Africa/Conakry"}),"Africa/Dakar":e.formatMessage({id:"allTimeZones.Africa/Dakar",defaultMessage:"Africa/Dakar"}),"Africa/Dar_es_Salaam":e.formatMessage({id:"allTimeZones.Africa/Dar_es_Salaam",defaultMessage:"Africa/Dar_es_Salaam"}),"Africa/Djibouti":e.formatMessage({id:"allTimeZones.Africa/Djibouti",defaultMessage:"Africa/Djibouti"}),"Africa/Douala":e.formatMessage({id:"allTimeZones.Africa/Douala",defaultMessage:"Africa/Douala"}),"Africa/El_Aaiun":e.formatMessage({id:"allTimeZones.Africa/El_Aaiun",defaultMessage:"Africa/El_Aaiun"}),"Africa/Freetown":e.formatMessage({id:"allTimeZones.Africa/Freetown",defaultMessage:"Africa/Freetown"}),"Africa/Gaborone":e.formatMessage({id:"allTimeZones.Africa/Gaborone",defaultMessage:"Africa/Gaborone"}),"Africa/Harare":e.formatMessage({id:"allTimeZones.Africa/Harare",defaultMessage:"Africa/Harare"}),"Africa/Johannesburg":e.formatMessage({id:"allTimeZones.Africa/Johannesburg",defaultMessage:"Africa/Johannesburg"}),"Africa/Juba":e.formatMessage({id:"allTimeZones.Africa/Juba",defaultMessage:"Africa/Juba"}),"Africa/Kampala":e.formatMessage({id:"allTimeZones.Africa/Kampala",defaultMessage:"Africa/Kampala"}),"Africa/Khartoum":e.formatMessage({id:"allTimeZones.Africa/Khartoum",defaultMessage:"Africa/Khartoum"}),"Africa/Kigali":e.formatMessage({id:"allTimeZones.Africa/Kigali",defaultMessage:"Africa/Kigali"}),"Africa/Kinshasa":e.formatMessage({id:"allTimeZones.Africa/Kinshasa",defaultMessage:"Africa/Kinshasa"}),"Africa/Lagos":e.formatMessage({id:"allTimeZones.Africa/Lagos",defaultMessage:"Africa/Lagos"}),"Africa/Libreville":e.formatMessage({id:"allTimeZones.Africa/Libreville",defaultMessage:"Africa/Libreville"}),"Africa/Lome":e.formatMessage({id:"allTimeZones.Africa/Lome",defaultMessage:"Africa/Lome"}),"Africa/Luanda":e.formatMessage({id:"allTimeZones.Africa/Luanda",defaultMessage:"Africa/Luanda"}),"Africa/Lubumbashi":e.formatMessage({id:"allTimeZones.Africa/Lubumbashi",defaultMessage:"Africa/Lubumbashi"}),"Africa/Lusaka":e.formatMessage({id:"allTimeZones.Africa/Lusaka",defaultMessage:"Africa/Lusaka"}),"Africa/Malabo":e.formatMessage({id:"allTimeZones.Africa/Malabo",defaultMessage:"Africa/Malabo"}),"Africa/Maputo":e.formatMessage({id:"allTimeZones.Africa/Maputo",defaultMessage:"Africa/Maputo"}),"Africa/Maseru":e.formatMessage({id:"allTimeZones.Africa/Maseru",defaultMessage:"Africa/Maseru"}),"Africa/Mbabane":e.formatMessage({id:"allTimeZones.Africa/Mbabane",defaultMessage:"Africa/Mbabane"}),"Africa/Mogadishu":e.formatMessage({id:"allTimeZones.Africa/Mogadishu",defaultMessage:"Africa/Mogadishu"}),"Africa/Monrovia":e.formatMessage({id:"allTimeZones.Africa/Monrovia",defaultMessage:"Africa/Monrovia"}),"Africa/Nairobi":e.formatMessage({id:"allTimeZones.Africa/Nairobi",defaultMessage:"Africa/Nairobi"}),"Africa/Ndjamena":e.formatMessage({id:"allTimeZones.Africa/Ndjamena",defaultMessage:"Africa/Ndjamena"}),"Africa/Niamey":e.formatMessage({id:"allTimeZones.Africa/Niamey",defaultMessage:"Africa/Niamey"}),"Africa/Nouakchott":e.formatMessage({id:"allTimeZones.Africa/Nouakchott",defaultMessage:"Africa/Nouakchott"}),"Africa/Ouagadougou":e.formatMessage({id:"allTimeZones.Africa/Ouagadougou",defaultMessage:"Africa/Ouagadougou"}),"Africa/Porto-Novo":e.formatMessage({id:"allTimeZones.Africa/Porto-Novo",defaultMessage:"Africa/Porto-Novo"}),"Africa/Sao_Tome":e.formatMessage({id:"allTimeZones.Africa/Sao_Tome",defaultMessage:"Africa/Sao_Tome"}),"Africa/Timbuktu":e.formatMessage({id:"allTimeZones.Africa/Timbuktu",defaultMessage:"Africa/Timbuktu"}),"Africa/Tripoli":e.formatMessage({id:"allTimeZones.Africa/Tripoli",defaultMessage:"Africa/Tripoli"}),"Africa/Tunis":e.formatMessage({id:"allTimeZones.Africa/Tunis",defaultMessage:"Africa/Tunis"}),"Africa/Windhoek":e.formatMessage({id:"allTimeZones.Africa/Windhoek",defaultMessage:"Africa/Windhoek"}),"America/Adak":e.formatMessage({id:"allTimeZones.America/Adak",defaultMessage:"America/Adak"}),"America/Anchorage":e.formatMessage({id:"allTimeZones.America/Anchorage",defaultMessage:"America/Anchorage"}),"America/Anguilla":e.formatMessage({id:"allTimeZones.America/Anguilla",defaultMessage:"America/Anguilla"}),"America/Antigua":e.formatMessage({id:"allTimeZones.America/Antigua",defaultMessage:"America/Antigua"}),"America/Araguaina":e.formatMessage({id:"allTimeZones.America/Araguaina",defaultMessage:"America/Araguaina"}),"America/Argentina/Buenos_Aires":e.formatMessage({id:"allTimeZones.America/Argentina/Buenos_Aires",defaultMessage:"America/Argentina/Buenos_Aires"}),"America/Argentina/Catamarca":e.formatMessage({id:"allTimeZones.America/Argentina/Catamarca",defaultMessage:"America/Argentina/Catamarca"}),"America/Argentina/ComodRivadavia":e.formatMessage({id:"allTimeZones.America/Argentina/ComodRivadavia",defaultMessage:"America/Argentina/ComodRivadavia"}),"America/Argentina/Cordoba":e.formatMessage({id:"allTimeZones.America/Argentina/Cordoba",defaultMessage:"America/Argentina/Cordoba"}),"America/Argentina/Jujuy":e.formatMessage({id:"allTimeZones.America/Argentina/Jujuy",defaultMessage:"America/Argentina/Jujuy"}),"America/Argentina/La_Rioja":e.formatMessage({id:"allTimeZones.America/Argentina/La_Rioja",defaultMessage:"America/Argentina/La_Rioja"}),"America/Argentina/Mendoza":e.formatMessage({id:"allTimeZones.America/Argentina/Mendoza",defaultMessage:"America/Argentina/Mendoza"}),"America/Argentina/Rio_Gallegos":e.formatMessage({id:"allTimeZones.America/Argentina/Rio_Gallegos",defaultMessage:"America/Argentina/Rio_Gallegos"}),"America/Argentina/Salta":e.formatMessage({id:"allTimeZones.America/Argentina/Salta",defaultMessage:"America/Argentina/Salta"}),"America/Argentina/San_Juan":e.formatMessage({id:"allTimeZones.America/Argentina/San_Juan",defaultMessage:"America/Argentina/San_Juan"}),"America/Argentina/San_Luis":e.formatMessage({id:"allTimeZones.America/Argentina/San_Luis",defaultMessage:"America/Argentina/San_Luis"}),"America/Argentina/Tucuman":e.formatMessage({id:"allTimeZones.America/Argentina/Tucuman",defaultMessage:"America/Argentina/Tucuman"}),"America/Argentina/Ushuaia":e.formatMessage({id:"allTimeZones.America/Argentina/Ushuaia",defaultMessage:"America/Argentina/Ushuaia"}),"America/Aruba":e.formatMessage({id:"allTimeZones.America/Aruba",defaultMessage:"America/Aruba"}),"America/Asuncion":e.formatMessage({id:"allTimeZones.America/Asuncion",defaultMessage:"America/Asuncion"}),"America/Atikokan":e.formatMessage({id:"allTimeZones.America/Atikokan",defaultMessage:"America/Atikokan"}),"America/Atka":e.formatMessage({id:"allTimeZones.America/Atka",defaultMessage:"America/Atka"}),"America/Bahia":e.formatMessage({id:"allTimeZones.America/Bahia",defaultMessage:"America/Bahia"}),"America/Bahia_Banderas":e.formatMessage({id:"allTimeZones.America/Bahia_Banderas",defaultMessage:"America/Bahia_Banderas"}),"America/Barbados":e.formatMessage({id:"allTimeZones.America/Barbados",defaultMessage:"America/Barbados"}),"America/Belem":e.formatMessage({id:"allTimeZones.America/Belem",defaultMessage:"America/Belem"}),"America/Belize":e.formatMessage({id:"allTimeZones.America/Belize",defaultMessage:"America/Belize"}),"America/Blanc-Sablon":e.formatMessage({id:"allTimeZones.America/Blanc-Sablon",defaultMessage:"America/Blanc-Sablon"}),"America/Boa_Vista":e.formatMessage({id:"allTimeZones.America/Boa_Vista",defaultMessage:"America/Boa_Vista"}),"America/Bogota":e.formatMessage({id:"allTimeZones.America/Bogota",defaultMessage:"America/Bogota"}),"America/Boise":e.formatMessage({id:"allTimeZones.America/Boise",defaultMessage:"America/Boise"}),"America/Buenos_Aires":e.formatMessage({id:"allTimeZones.America/Buenos_Aires",defaultMessage:"America/Buenos_Aires"}),"America/Cambridge_Bay":e.formatMessage({id:"allTimeZones.America/Cambridge_Bay",defaultMessage:"America/Cambridge_Bay"}),"America/Campo_Grande":e.formatMessage({id:"allTimeZones.America/Campo_Grande",defaultMessage:"America/Campo_Grande"}),"America/Cancun":e.formatMessage({id:"allTimeZones.America/Cancun",defaultMessage:"America/Cancun"}),"America/Caracas":e.formatMessage({id:"allTimeZones.America/Caracas",defaultMessage:"America/Caracas"}),"America/Catamarca":e.formatMessage({id:"allTimeZones.America/Catamarca",defaultMessage:"America/Catamarca"}),"America/Cayenne":e.formatMessage({id:"allTimeZones.America/Cayenne",defaultMessage:"America/Cayenne"}),"America/Cayman":e.formatMessage({id:"allTimeZones.America/Cayman",defaultMessage:"America/Cayman"}),"America/Chicago":e.formatMessage({id:"allTimeZones.America/Chicago",defaultMessage:"America/Chicago"}),"America/Chihuahua":e.formatMessage({id:"allTimeZones.America/Chihuahua",defaultMessage:"America/Chihuahua"}),"America/Coral_Harbour":e.formatMessage({id:"allTimeZones.America/Coral_Harbour",defaultMessage:"America/Coral_Harbour"}),"America/Cordoba":e.formatMessage({id:"allTimeZones.America/Cordoba",defaultMessage:"America/Cordoba"}),"America/Costa_Rica":e.formatMessage({id:"allTimeZones.America/Costa_Rica",defaultMessage:"America/Costa_Rica"}),"America/Creston":e.formatMessage({id:"allTimeZones.America/Creston",defaultMessage:"America/Creston"}),"America/Cuiaba":e.formatMessage({id:"allTimeZones.America/Cuiaba",defaultMessage:"America/Cuiaba"}),"America/Curacao":e.formatMessage({id:"allTimeZones.America/Curacao",defaultMessage:"America/Curacao"}),"America/Danmarkshavn":e.formatMessage({id:"allTimeZones.America/Danmarkshavn",defaultMessage:"America/Danmarkshavn"}),"America/Dawson":e.formatMessage({id:"allTimeZones.America/Dawson",defaultMessage:"America/Dawson"}),"America/Dawson_Creek":e.formatMessage({id:"allTimeZones.America/Dawson_Creek",defaultMessage:"America/Dawson_Creek"}),"America/Denver":e.formatMessage({id:"allTimeZones.America/Denver",defaultMessage:"America/Denver"}),"America/Detroit":e.formatMessage({id:"allTimeZones.America/Detroit",defaultMessage:"America/Detroit"}),"America/Dominica":e.formatMessage({id:"allTimeZones.America/Dominica",defaultMessage:"America/Dominica"}),"America/Edmonton":e.formatMessage({id:"allTimeZones.America/Edmonton",defaultMessage:"America/Edmonton"}),"America/Eirunepe":e.formatMessage({id:"allTimeZones.America/Eirunepe",defaultMessage:"America/Eirunepe"}),"America/El_Salvador":e.formatMessage({id:"allTimeZones.America/El_Salvador",defaultMessage:"America/El_Salvador"}),"America/Ensenada":e.formatMessage({id:"allTimeZones.America/Ensenada",defaultMessage:"America/Ensenada"}),"America/Fort_Nelson":e.formatMessage({id:"allTimeZones.America/Fort_Nelson",defaultMessage:"America/Fort_Nelson"}),"America/Fort_Wayne":e.formatMessage({id:"allTimeZones.America/Fort_Wayne",defaultMessage:"America/Fort_Wayne"}),"America/Fortaleza":e.formatMessage({id:"allTimeZones.America/Fortaleza",defaultMessage:"America/Fortaleza"}),"America/Glace_Bay":e.formatMessage({id:"allTimeZones.America/Glace_Bay",defaultMessage:"America/Glace_Bay"}),"America/Godthab":e.formatMessage({id:"allTimeZones.America/Godthab",defaultMessage:"America/Godthab"}),"America/Goose_Bay":e.formatMessage({id:"allTimeZones.America/Goose_Bay",defaultMessage:"America/Goose_Bay"}),"America/Grand_Turk":e.formatMessage({id:"allTimeZones.America/Grand_Turk",defaultMessage:"America/Grand_Turk"}),"America/Grenada":e.formatMessage({id:"allTimeZones.America/Grenada",defaultMessage:"America/Grenada"}),"America/Guadeloupe":e.formatMessage({id:"allTimeZones.America/Guadeloupe",defaultMessage:"America/Guadeloupe"}),"America/Guatemala":e.formatMessage({id:"allTimeZones.America/Guatemala",defaultMessage:"America/Guatemala"}),"America/Guayaquil":e.formatMessage({id:"allTimeZones.America/Guayaquil",defaultMessage:"America/Guayaquil"}),"America/Guyana":e.formatMessage({id:"allTimeZones.America/Guyana",defaultMessage:"America/Guyana"}),"America/Halifax":e.formatMessage({id:"allTimeZones.America/Halifax",defaultMessage:"America/Halifax"}),"America/Havana":e.formatMessage({id:"allTimeZones.America/Havana",defaultMessage:"America/Havana"}),"America/Hermosillo":e.formatMessage({id:"allTimeZones.America/Hermosillo",defaultMessage:"America/Hermosillo"}),"America/Indiana/Indianapolis":e.formatMessage({id:"allTimeZones.America/Indiana/Indianapolis",defaultMessage:"America/Indiana/Indianapolis"}),"America/Indiana/Knox":e.formatMessage({id:"allTimeZones.America/Indiana/Knox",defaultMessage:"America/Indiana/Knox"}),"America/Indiana/Marengo":e.formatMessage({id:"allTimeZones.America/Indiana/Marengo",defaultMessage:"America/Indiana/Marengo"}),"America/Indiana/Petersburg":e.formatMessage({id:"allTimeZones.America/Indiana/Petersburg",defaultMessage:"America/Indiana/Petersburg"}),"America/Indiana/Tell_City":e.formatMessage({id:"allTimeZones.America/Indiana/Tell_City",defaultMessage:"America/Indiana/Tell_City"}),"America/Indiana/Vevay":e.formatMessage({id:"allTimeZones.America/Indiana/Vevay",defaultMessage:"America/Indiana/Vevay"}),"America/Indiana/Vincennes":e.formatMessage({id:"allTimeZones.America/Indiana/Vincennes",defaultMessage:"America/Indiana/Vincennes"}),"America/Indiana/Winamac":e.formatMessage({id:"allTimeZones.America/Indiana/Winamac",defaultMessage:"America/Indiana/Winamac"}),"America/Indianapolis":e.formatMessage({id:"allTimeZones.America/Indianapolis",defaultMessage:"America/Indianapolis"}),"America/Inuvik":e.formatMessage({id:"allTimeZones.America/Inuvik",defaultMessage:"America/Inuvik"}),"America/Iqaluit":e.formatMessage({id:"allTimeZones.America/Iqaluit",defaultMessage:"America/Iqaluit"}),"America/Jamaica":e.formatMessage({id:"allTimeZones.America/Jamaica",defaultMessage:"America/Jamaica"}),"America/Jujuy":e.formatMessage({id:"allTimeZones.America/Jujuy",defaultMessage:"America/Jujuy"}),"America/Juneau":e.formatMessage({id:"allTimeZones.America/Juneau",defaultMessage:"America/Juneau"}),"America/Kentucky/Louisville":e.formatMessage({id:"allTimeZones.America/Kentucky/Louisville",defaultMessage:"America/Kentucky/Louisville"}),"America/Kentucky/Monticello":e.formatMessage({id:"allTimeZones.America/Kentucky/Monticello",defaultMessage:"America/Kentucky/Monticello"}),"America/Knox_IN":e.formatMessage({id:"allTimeZones.America/Knox_IN",defaultMessage:"America/Knox_IN"}),"America/Kralendijk":e.formatMessage({id:"allTimeZones.America/Kralendijk",defaultMessage:"America/Kralendijk"}),"America/La_Paz":e.formatMessage({id:"allTimeZones.America/La_Paz",defaultMessage:"America/La_Paz"}),"America/Lima":e.formatMessage({id:"allTimeZones.America/Lima",defaultMessage:"America/Lima"}),"America/Los_Angeles":e.formatMessage({id:"allTimeZones.America/Los_Angeles",defaultMessage:"America/Los_Angeles"}),"America/Louisville":e.formatMessage({id:"allTimeZones.America/Louisville",defaultMessage:"America/Louisville"}),"America/Lower_Princes":e.formatMessage({id:"allTimeZones.America/Lower_Princes",defaultMessage:"America/Lower_Princes"}),"America/Maceio":e.formatMessage({id:"allTimeZones.America/Maceio",defaultMessage:"America/Maceio"}),"America/Managua":e.formatMessage({id:"allTimeZones.America/Managua",defaultMessage:"America/Managua"}),"America/Manaus":e.formatMessage({id:"allTimeZones.America/Manaus",defaultMessage:"America/Manaus"}),"America/Marigot":e.formatMessage({id:"allTimeZones.America/Marigot",defaultMessage:"America/Marigot"}),"America/Martinique":e.formatMessage({id:"allTimeZones.America/Martinique",defaultMessage:"America/Martinique"}),"America/Matamoros":e.formatMessage({id:"allTimeZones.America/Matamoros",defaultMessage:"America/Matamoros"}),"America/Mazatlan":e.formatMessage({id:"allTimeZones.America/Mazatlan",defaultMessage:"America/Mazatlan"}),"America/Mendoza":e.formatMessage({id:"allTimeZones.America/Mendoza",defaultMessage:"America/Mendoza"}),"America/Menominee":e.formatMessage({id:"allTimeZones.America/Menominee",defaultMessage:"America/Menominee"}),"America/Merida":e.formatMessage({id:"allTimeZones.America/Merida",defaultMessage:"America/Merida"}),"America/Metlakatla":e.formatMessage({id:"allTimeZones.America/Metlakatla",defaultMessage:"America/Metlakatla"}),"America/Mexico_City":e.formatMessage({id:"allTimeZones.America/Mexico_City",defaultMessage:"America/Mexico_City"}),"America/Miquelon":e.formatMessage({id:"allTimeZones.America/Miquelon",defaultMessage:"America/Miquelon"}),"America/Moncton":e.formatMessage({id:"allTimeZones.America/Moncton",defaultMessage:"America/Moncton"}),"America/Monterrey":e.formatMessage({id:"allTimeZones.America/Monterrey",defaultMessage:"America/Monterrey"}),"America/Montevideo":e.formatMessage({id:"allTimeZones.America/Montevideo",defaultMessage:"America/Montevideo"}),"America/Montreal":e.formatMessage({id:"allTimeZones.America/Montreal",defaultMessage:"America/Montreal"}),"America/Montserrat":e.formatMessage({id:"allTimeZones.America/Montserrat",defaultMessage:"America/Montserrat"}),"America/Nassau":e.formatMessage({id:"allTimeZones.America/Nassau",defaultMessage:"America/Nassau"}),"America/New_York":e.formatMessage({id:"allTimeZones.America/New_York",defaultMessage:"America/New_York"}),"America/Nipigon":e.formatMessage({id:"allTimeZones.America/Nipigon",defaultMessage:"America/Nipigon"}),"America/Nome":e.formatMessage({id:"allTimeZones.America/Nome",defaultMessage:"America/Nome"}),"America/Noronha":e.formatMessage({id:"allTimeZones.America/Noronha",defaultMessage:"America/Noronha"}),"America/North_Dakota/Beulah":e.formatMessage({id:"allTimeZones.America/North_Dakota/Beulah",defaultMessage:"America/North_Dakota/Beulah"}),"America/North_Dakota/Center":e.formatMessage({id:"allTimeZones.America/North_Dakota/Center",defaultMessage:"America/North_Dakota/Center"}),"America/North_Dakota/New_Salem":e.formatMessage({id:"allTimeZones.America/North_Dakota/New_Salem",defaultMessage:"America/North_Dakota/New_Salem"}),"America/Ojinaga":e.formatMessage({id:"allTimeZones.America/Ojinaga",defaultMessage:"America/Ojinaga"}),"America/Panama":e.formatMessage({id:"allTimeZones.America/Panama",defaultMessage:"America/Panama"}),"America/Pangnirtung":e.formatMessage({id:"allTimeZones.America/Pangnirtung",defaultMessage:"America/Pangnirtung"}),"America/Paramaribo":e.formatMessage({id:"allTimeZones.America/Paramaribo",defaultMessage:"America/Paramaribo"}),"America/Phoenix":e.formatMessage({id:"allTimeZones.America/Phoenix",defaultMessage:"America/Phoenix"}),"America/Port-au-Prince":e.formatMessage({id:"allTimeZones.America/Port-au-Prince",defaultMessage:"America/Port-au-Prince"}),"America/Port_of_Spain":e.formatMessage({id:"allTimeZones.America/Port_of_Spain",defaultMessage:"America/Port_of_Spain"}),"America/Porto_Acre":e.formatMessage({id:"allTimeZones.America/Porto_Acre",defaultMessage:"America/Porto_Acre"}),"America/Porto_Velho":e.formatMessage({id:"allTimeZones.America/Porto_Velho",defaultMessage:"America/Porto_Velho"}),"America/Puerto_Rico":e.formatMessage({id:"allTimeZones.America/Puerto_Rico",defaultMessage:"America/Puerto_Rico"}),"America/Punta_Arenas":e.formatMessage({id:"allTimeZones.America/Punta_Arenas",defaultMessage:"America/Punta_Arenas"}),"America/Rainy_River":e.formatMessage({id:"allTimeZones.America/Rainy_River",defaultMessage:"America/Rainy_River"}),"America/Rankin_Inlet":e.formatMessage({id:"allTimeZones.America/Rankin_Inlet",defaultMessage:"America/Rankin_Inlet"}),"America/Recife":e.formatMessage({id:"allTimeZones.America/Recife",defaultMessage:"America/Recife"}),"America/Regina":e.formatMessage({id:"allTimeZones.America/Regina",defaultMessage:"America/Regina"}),"America/Resolute":e.formatMessage({id:"allTimeZones.America/Resolute",defaultMessage:"America/Resolute"}),"America/Rio_Branco":e.formatMessage({id:"allTimeZones.America/Rio_Branco",defaultMessage:"America/Rio_Branco"}),"America/Rosario":e.formatMessage({id:"allTimeZones.America/Rosario",defaultMessage:"America/Rosario"}),"America/Santa_Isabel":e.formatMessage({id:"allTimeZones.America/Santa_Isabel",defaultMessage:"America/Santa_Isabel"}),"America/Santarem":e.formatMessage({id:"allTimeZones.America/Santarem",defaultMessage:"America/Santarem"}),"America/Santiago":e.formatMessage({id:"allTimeZones.America/Santiago",defaultMessage:"America/Santiago"}),"America/Santo_Domingo":e.formatMessage({id:"allTimeZones.America/Santo_Domingo",defaultMessage:"America/Santo_Domingo"}),"America/Sao_Paulo":e.formatMessage({id:"allTimeZones.America/Sao_Paulo",defaultMessage:"America/Sao_Paulo"}),"America/Scoresbysund":e.formatMessage({id:"allTimeZones.America/Scoresbysund",defaultMessage:"America/Scoresbysund"}),"America/Shiprock":e.formatMessage({id:"allTimeZones.America/Shiprock",defaultMessage:"America/Shiprock"}),"America/Sitka":e.formatMessage({id:"allTimeZones.America/Sitka",defaultMessage:"America/Sitka"}),"America/St_Barthelemy":e.formatMessage({id:"allTimeZones.America/St_Barthelemy",defaultMessage:"America/St_Barthelemy"}),"America/St_Johns":e.formatMessage({id:"allTimeZones.America/St_Johns",defaultMessage:"America/St_Johns"}),"America/St_Kitts":e.formatMessage({id:"allTimeZones.America/St_Kitts",defaultMessage:"America/St_Kitts"}),"America/St_Lucia":e.formatMessage({id:"allTimeZones.America/St_Lucia",defaultMessage:"America/St_Lucia"}),"America/St_Thomas":e.formatMessage({id:"allTimeZones.America/St_Thomas",defaultMessage:"America/St_Thomas"}),"America/St_Vincent":e.formatMessage({id:"allTimeZones.America/St_Vincent",defaultMessage:"America/St_Vincent"}),"America/Swift_Current":e.formatMessage({id:"allTimeZones.America/Swift_Current",defaultMessage:"America/Swift_Current"}),"America/Tegucigalpa":e.formatMessage({id:"allTimeZones.America/Tegucigalpa",defaultMessage:"America/Tegucigalpa"}),"America/Thule":e.formatMessage({id:"allTimeZones.America/Thule",defaultMessage:"America/Thule"}),"America/Thunder_Bay":e.formatMessage({id:"allTimeZones.America/Thunder_Bay",defaultMessage:"America/Thunder_Bay"}),"America/Tijuana":e.formatMessage({id:"allTimeZones.America/Tijuana",defaultMessage:"America/Tijuana"}),"America/Toronto":e.formatMessage({id:"allTimeZones.America/Toronto",defaultMessage:"America/Toronto"}),"America/Tortola":e.formatMessage({id:"allTimeZones.America/Tortola",defaultMessage:"America/Tortola"}),"America/Vancouver":e.formatMessage({id:"allTimeZones.America/Vancouver",defaultMessage:"America/Vancouver"}),"America/Virgin":e.formatMessage({id:"allTimeZones.America/Virgin",defaultMessage:"America/Virgin"}),"America/Whitehorse":e.formatMessage({id:"allTimeZones.America/Whitehorse",defaultMessage:"America/Whitehorse"}),"America/Winnipeg":e.formatMessage({id:"allTimeZones.America/Winnipeg",defaultMessage:"America/Winnipeg"}),"America/Yakutat":e.formatMessage({id:"allTimeZones.America/Yakutat",defaultMessage:"America/Yakutat"}),"America/Yellowknife":e.formatMessage({id:"allTimeZones.America/Yellowknife",defaultMessage:"America/Yellowknife"}),"Antarctica/Casey":e.formatMessage({id:"allTimeZones.Antarctica/Casey",defaultMessage:"Antarctica/Casey"}),"Antarctica/Davis":e.formatMessage({id:"allTimeZones.Antarctica/Davis",defaultMessage:"Antarctica/Davis"}),"Antarctica/DumontDUrville":e.formatMessage({id:"allTimeZones.Antarctica/DumontDUrville",defaultMessage:"Antarctica/DumontDUrville"}),"Antarctica/Macquarie":e.formatMessage({id:"allTimeZones.Antarctica/Macquarie",defaultMessage:"Antarctica/Macquarie"}),"Antarctica/Mawson":e.formatMessage({id:"allTimeZones.Antarctica/Mawson",defaultMessage:"Antarctica/Mawson"}),"Antarctica/McMurdo":e.formatMessage({id:"allTimeZones.Antarctica/McMurdo",defaultMessage:"Antarctica/McMurdo"}),"Antarctica/Palmer":e.formatMessage({id:"allTimeZones.Antarctica/Palmer",defaultMessage:"Antarctica/Palmer"}),"Antarctica/Rothera":e.formatMessage({id:"allTimeZones.Antarctica/Rothera",defaultMessage:"Antarctica/Rothera"}),"Antarctica/South_Pole":e.formatMessage({id:"allTimeZones.Antarctica/South_Pole",defaultMessage:"Antarctica/South_Pole"}),"Antarctica/Syowa":e.formatMessage({id:"allTimeZones.Antarctica/Syowa",defaultMessage:"Antarctica/Syowa"}),"Antarctica/Troll":e.formatMessage({id:"allTimeZones.Antarctica/Troll",defaultMessage:"Antarctica/Troll"}),"Antarctica/Vostok":e.formatMessage({id:"allTimeZones.Antarctica/Vostok",defaultMessage:"Antarctica/Vostok"}),"Arctic/Longyearbyen":e.formatMessage({id:"allTimeZones.Arctic/Longyearbyen",defaultMessage:"Arctic/Longyearbyen"}),"Asia/Aden":e.formatMessage({id:"allTimeZones.Asia/Aden",defaultMessage:"Asia/Aden"}),"Asia/Almaty":e.formatMessage({id:"allTimeZones.Asia/Almaty",defaultMessage:"Asia/Almaty"}),"Asia/Amman":e.formatMessage({id:"allTimeZones.Asia/Amman",defaultMessage:"Asia/Amman"}),"Asia/Anadyr":e.formatMessage({id:"allTimeZones.Asia/Anadyr",defaultMessage:"Asia/Anadyr"}),"Asia/Aqtau":e.formatMessage({id:"allTimeZones.Asia/Aqtau",defaultMessage:"Asia/Aqtau"}),"Asia/Aqtobe":e.formatMessage({id:"allTimeZones.Asia/Aqtobe",defaultMessage:"Asia/Aqtobe"}),"Asia/Ashgabat":e.formatMessage({id:"allTimeZones.Asia/Ashgabat",defaultMessage:"Asia/Ashgabat"}),"Asia/Ashkhabad":e.formatMessage({id:"allTimeZones.Asia/Ashkhabad",defaultMessage:"Asia/Ashkhabad"}),"Asia/Atyrau":e.formatMessage({id:"allTimeZones.Asia/Atyrau",defaultMessage:"Asia/Atyrau"}),"Asia/Baghdad":e.formatMessage({id:"allTimeZones.Asia/Baghdad",defaultMessage:"Asia/Baghdad"}),"Asia/Bahrain":e.formatMessage({id:"allTimeZones.Asia/Bahrain",defaultMessage:"Asia/Bahrain"}),"Asia/Baku":e.formatMessage({id:"allTimeZones.Asia/Baku",defaultMessage:"Asia/Baku"}),"Asia/Bangkok":e.formatMessage({id:"allTimeZones.Asia/Bangkok",defaultMessage:"Asia/Bangkok"}),"Asia/Barnaul":e.formatMessage({id:"allTimeZones.Asia/Barnaul",defaultMessage:"Asia/Barnaul"}),"Asia/Beirut":e.formatMessage({id:"allTimeZones.Asia/Beirut",defaultMessage:"Asia/Beirut"}),"Asia/Bishkek":e.formatMessage({id:"allTimeZones.Asia/Bishkek",defaultMessage:"Asia/Bishkek"}),"Asia/Brunei":e.formatMessage({id:"allTimeZones.Asia/Brunei",defaultMessage:"Asia/Brunei"}),"Asia/Calcutta":e.formatMessage({id:"allTimeZones.Asia/Calcutta",defaultMessage:"Asia/Calcutta"}),"Asia/Chita":e.formatMessage({id:"allTimeZones.Asia/Chita",defaultMessage:"Asia/Chita"}),"Asia/Choibalsan":e.formatMessage({id:"allTimeZones.Asia/Choibalsan",defaultMessage:"Asia/Choibalsan"}),"Asia/Chongqing":e.formatMessage({id:"allTimeZones.Asia/Chongqing",defaultMessage:"Asia/Chongqing"}),"Asia/Chungking":e.formatMessage({id:"allTimeZones.Asia/Chungking",defaultMessage:"Asia/Chungking"}),"Asia/Colombo":e.formatMessage({id:"allTimeZones.Asia/Colombo",defaultMessage:"Asia/Colombo"}),"Asia/Dacca":e.formatMessage({id:"allTimeZones.Asia/Dacca",defaultMessage:"Asia/Dacca"}),"Asia/Damascus":e.formatMessage({id:"allTimeZones.Asia/Damascus",defaultMessage:"Asia/Damascus"}),"Asia/Dhaka":e.formatMessage({id:"allTimeZones.Asia/Dhaka",defaultMessage:"Asia/Dhaka"}),"Asia/Dili":e.formatMessage({id:"allTimeZones.Asia/Dili",defaultMessage:"Asia/Dili"}),"Asia/Dubai":e.formatMessage({id:"allTimeZones.Asia/Dubai",defaultMessage:"Asia/Dubai"}),"Asia/Dushanbe":e.formatMessage({id:"allTimeZones.Asia/Dushanbe",defaultMessage:"Asia/Dushanbe"}),"Asia/Famagusta":e.formatMessage({id:"allTimeZones.Asia/Famagusta",defaultMessage:"Asia/Famagusta"}),"Asia/Gaza":e.formatMessage({id:"allTimeZones.Asia/Gaza",defaultMessage:"Asia/Gaza"}),"Asia/Harbin":e.formatMessage({id:"allTimeZones.Asia/Harbin",defaultMessage:"Asia/Harbin"}),"Asia/Hebron":e.formatMessage({id:"allTimeZones.Asia/Hebron",defaultMessage:"Asia/Hebron"}),"Asia/Ho_Chi_Minh":e.formatMessage({id:"allTimeZones.Asia/Ho_Chi_Minh",defaultMessage:"Asia/Ho_Chi_Minh"}),"Asia/Hong_Kong":e.formatMessage({id:"allTimeZones.Asia/Hong_Kong",defaultMessage:"Asia/Hong_Kong"}),"Asia/Hovd":e.formatMessage({id:"allTimeZones.Asia/Hovd",defaultMessage:"Asia/Hovd"}),"Asia/Irkutsk":e.formatMessage({id:"allTimeZones.Asia/Irkutsk",defaultMessage:"Asia/Irkutsk"}),"Asia/Istanbul":e.formatMessage({id:"allTimeZones.Asia/Istanbul",defaultMessage:"Asia/Istanbul"}),"Asia/Jakarta":e.formatMessage({id:"allTimeZones.Asia/Jakarta",defaultMessage:"Asia/Jakarta"}),"Asia/Jayapura":e.formatMessage({id:"allTimeZones.Asia/Jayapura",defaultMessage:"Asia/Jayapura"}),"Asia/Jerusalem":e.formatMessage({id:"allTimeZones.Asia/Jerusalem",defaultMessage:"Asia/Jerusalem"}),"Asia/Kabul":e.formatMessage({id:"allTimeZones.Asia/Kabul",defaultMessage:"Asia/Kabul"}),"Asia/Kamchatka":e.formatMessage({id:"allTimeZones.Asia/Kamchatka",defaultMessage:"Asia/Kamchatka"}),"Asia/Karachi":e.formatMessage({id:"allTimeZones.Asia/Karachi",defaultMessage:"Asia/Karachi"}),"Asia/Kashgar":e.formatMessage({id:"allTimeZones.Asia/Kashgar",defaultMessage:"Asia/Kashgar"}),"Asia/Kathmandu":e.formatMessage({id:"allTimeZones.Asia/Kathmandu",defaultMessage:"Asia/Kathmandu"}),"Asia/Katmandu":e.formatMessage({id:"allTimeZones.Asia/Katmandu",defaultMessage:"Asia/Katmandu"}),"Asia/Khandyga":e.formatMessage({id:"allTimeZones.Asia/Khandyga",defaultMessage:"Asia/Khandyga"}),"Asia/Kolkata":e.formatMessage({id:"allTimeZones.Asia/Kolkata",defaultMessage:"Asia/Kolkata"}),"Asia/Krasnoyarsk":e.formatMessage({id:"allTimeZones.Asia/Krasnoyarsk",defaultMessage:"Asia/Krasnoyarsk"}),"Asia/Kuala_Lumpur":e.formatMessage({id:"allTimeZones.Asia/Kuala_Lumpur",defaultMessage:"Asia/Kuala_Lumpur"}),"Asia/Kuching":e.formatMessage({id:"allTimeZones.Asia/Kuching",defaultMessage:"Asia/Kuching"}),"Asia/Kuwait":e.formatMessage({id:"allTimeZones.Asia/Kuwait",defaultMessage:"Asia/Kuwait"}),"Asia/Macao":e.formatMessage({id:"allTimeZones.Asia/Macao",defaultMessage:"Asia/Macao"}),"Asia/Macau":e.formatMessage({id:"allTimeZones.Asia/Macau",defaultMessage:"Asia/Macau"}),"Asia/Magadan":e.formatMessage({id:"allTimeZones.Asia/Magadan",defaultMessage:"Asia/Magadan"}),"Asia/Makassar":e.formatMessage({id:"allTimeZones.Asia/Makassar",defaultMessage:"Asia/Makassar"}),"Asia/Manila":e.formatMessage({id:"allTimeZones.Asia/Manila",defaultMessage:"Asia/Manila"}),"Asia/Muscat":e.formatMessage({id:"allTimeZones.Asia/Muscat",defaultMessage:"Asia/Muscat"}),"Asia/Nicosia":e.formatMessage({id:"allTimeZones.Asia/Nicosia",defaultMessage:"Asia/Nicosia"}),"Asia/Novokuznetsk":e.formatMessage({id:"allTimeZones.Asia/Novokuznetsk",defaultMessage:"Asia/Novokuznetsk"}),"Asia/Novosibirsk":e.formatMessage({id:"allTimeZones.Asia/Novosibirsk",defaultMessage:"Asia/Novosibirsk"}),"Asia/Omsk":e.formatMessage({id:"allTimeZones.Asia/Omsk",defaultMessage:"Asia/Omsk"}),"Asia/Oral":e.formatMessage({id:"allTimeZones.Asia/Oral",defaultMessage:"Asia/Oral"}),"Asia/Phnom_Penh":e.formatMessage({id:"allTimeZones.Asia/Phnom_Penh",defaultMessage:"Asia/Phnom_Penh"}),"Asia/Pontianak":e.formatMessage({id:"allTimeZones.Asia/Pontianak",defaultMessage:"Asia/Pontianak"}),"Asia/Pyongyang":e.formatMessage({id:"allTimeZones.Asia/Pyongyang",defaultMessage:"Asia/Pyongyang"}),"Asia/Qatar":e.formatMessage({id:"allTimeZones.Asia/Qatar",defaultMessage:"Asia/Qatar"}),"Asia/Qostanay":e.formatMessage({id:"allTimeZones.Asia/Qostanay",defaultMessage:"Asia/Qostanay"}),"Asia/Qyzylorda":e.formatMessage({id:"allTimeZones.Asia/Qyzylorda",defaultMessage:"Asia/Qyzylorda"}),"Asia/Rangoon":e.formatMessage({id:"allTimeZones.Asia/Rangoon",defaultMessage:"Asia/Rangoon"}),"Asia/Riyadh":e.formatMessage({id:"allTimeZones.Asia/Riyadh",defaultMessage:"Asia/Riyadh"}),"Asia/Saigon":e.formatMessage({id:"allTimeZones.Asia/Saigon",defaultMessage:"Asia/Saigon"}),"Asia/Sakhalin":e.formatMessage({id:"allTimeZones.Asia/Sakhalin",defaultMessage:"Asia/Sakhalin"}),"Asia/Samarkand":e.formatMessage({id:"allTimeZones.Asia/Samarkand",defaultMessage:"Asia/Samarkand"}),"Asia/Seoul":e.formatMessage({id:"allTimeZones.Asia/Seoul",defaultMessage:"Asia/Seoul"}),"Asia/Shanghai":e.formatMessage({id:"allTimeZones.Asia/Shanghai",defaultMessage:"Asia/Shanghai"}),"Asia/Singapore":e.formatMessage({id:"allTimeZones.Asia/Singapore",defaultMessage:"Asia/Singapore"}),"Asia/Srednekolymsk":e.formatMessage({id:"allTimeZones.Asia/Srednekolymsk",defaultMessage:"Asia/Srednekolymsk"}),"Asia/Taipei":e.formatMessage({id:"allTimeZones.Asia/Taipei",defaultMessage:"Asia/Taipei"}),"Asia/Tashkent":e.formatMessage({id:"allTimeZones.Asia/Tashkent",defaultMessage:"Asia/Tashkent"}),"Asia/Tbilisi":e.formatMessage({id:"allTimeZones.Asia/Tbilisi",defaultMessage:"Asia/Tbilisi"}),"Asia/Tehran":e.formatMessage({id:"allTimeZones.Asia/Tehran",defaultMessage:"Asia/Tehran"}),"Asia/Tel_Aviv":e.formatMessage({id:"allTimeZones.Asia/Tel_Aviv",defaultMessage:"Asia/Tel_Aviv"}),"Asia/Thimbu":e.formatMessage({id:"allTimeZones.Asia/Thimbu",defaultMessage:"Asia/Thimbu"}),"Asia/Thimphu":e.formatMessage({id:"allTimeZones.Asia/Thimphu",defaultMessage:"Asia/Thimphu"}),"Asia/Tokyo":e.formatMessage({id:"allTimeZones.Asia/Tokyo",defaultMessage:"Asia/Tokyo"}),"Asia/Tomsk":e.formatMessage({id:"allTimeZones.Asia/Tomsk",defaultMessage:"Asia/Tomsk"}),"Asia/Ujung_Pandang":e.formatMessage({id:"allTimeZones.Asia/Ujung_Pandang",defaultMessage:"Asia/Ujung_Pandang"}),"Asia/Ulaanbaatar":e.formatMessage({id:"allTimeZones.Asia/Ulaanbaatar",defaultMessage:"Asia/Ulaanbaatar"}),"Asia/Ulan_Bator":e.formatMessage({id:"allTimeZones.Asia/Ulan_Bator",defaultMessage:"Asia/Ulan_Bator"}),"Asia/Urumqi":e.formatMessage({id:"allTimeZones.Asia/Urumqi",defaultMessage:"Asia/Urumqi"}),"Asia/Ust-Nera":e.formatMessage({id:"allTimeZones.Asia/Ust-Nera",defaultMessage:"Asia/Ust-Nera"}),"Asia/Vientiane":e.formatMessage({id:"allTimeZones.Asia/Vientiane",defaultMessage:"Asia/Vientiane"}),"Asia/Vladivostok":e.formatMessage({id:"allTimeZones.Asia/Vladivostok",defaultMessage:"Asia/Vladivostok"}),"Asia/Yakutsk":e.formatMessage({id:"allTimeZones.Asia/Yakutsk",defaultMessage:"Asia/Yakutsk"}),"Asia/Yangon":e.formatMessage({id:"allTimeZones.Asia/Yangon",defaultMessage:"Asia/Yangon"}),"Asia/Yekaterinburg":e.formatMessage({id:"allTimeZones.Asia/Yekaterinburg",defaultMessage:"Asia/Yekaterinburg"}),"Asia/Yerevan":e.formatMessage({id:"allTimeZones.Asia/Yerevan",defaultMessage:"Asia/Yerevan"}),"Atlantic/Azores":e.formatMessage({id:"allTimeZones.Atlantic/Azores",defaultMessage:"Atlantic/Azores"}),"Atlantic/Bermuda":e.formatMessage({id:"allTimeZones.Atlantic/Bermuda",defaultMessage:"Atlantic/Bermuda"}),"Atlantic/Canary":e.formatMessage({id:"allTimeZones.Atlantic/Canary",defaultMessage:"Atlantic/Canary"}),"Atlantic/Cape_Verde":e.formatMessage({id:"allTimeZones.Atlantic/Cape_Verde",defaultMessage:"Atlantic/Cape_Verde"}),"Atlantic/Faeroe":e.formatMessage({id:"allTimeZones.Atlantic/Faeroe",defaultMessage:"Atlantic/Faeroe"}),"Atlantic/Faroe":e.formatMessage({id:"allTimeZones.Atlantic/Faroe",defaultMessage:"Atlantic/Faroe"}),"Atlantic/Jan_Mayen":e.formatMessage({id:"allTimeZones.Atlantic/Jan_Mayen",defaultMessage:"Atlantic/Jan_Mayen"}),"Atlantic/Madeira":e.formatMessage({id:"allTimeZones.Atlantic/Madeira",defaultMessage:"Atlantic/Madeira"}),"Atlantic/Reykjavik":e.formatMessage({id:"allTimeZones.Atlantic/Reykjavik",defaultMessage:"Atlantic/Reykjavik"}),"Atlantic/South_Georgia":e.formatMessage({id:"allTimeZones.Atlantic/South_Georgia",defaultMessage:"Atlantic/South_Georgia"}),"Atlantic/St_Helena":e.formatMessage({id:"allTimeZones.Atlantic/St_Helena",defaultMessage:"Atlantic/St_Helena"}),"Atlantic/Stanley":e.formatMessage({id:"allTimeZones.Atlantic/Stanley",defaultMessage:"Atlantic/Stanley"}),"Australia/ACT":e.formatMessage({id:"allTimeZones.Australia/ACT",defaultMessage:"Australia/ACT"}),"Australia/Adelaide":e.formatMessage({id:"allTimeZones.Australia/Adelaide",defaultMessage:"Australia/Adelaide"}),"Australia/Brisbane":e.formatMessage({id:"allTimeZones.Australia/Brisbane",defaultMessage:"Australia/Brisbane"}),"Australia/Broken_Hill":e.formatMessage({id:"allTimeZones.Australia/Broken_Hill",defaultMessage:"Australia/Broken_Hill"}),"Australia/Canberra":e.formatMessage({id:"allTimeZones.Australia/Canberra",defaultMessage:"Australia/Canberra"}),"Australia/Currie":e.formatMessage({id:"allTimeZones.Australia/Currie",defaultMessage:"Australia/Currie"}),"Australia/Darwin":e.formatMessage({id:"allTimeZones.Australia/Darwin",defaultMessage:"Australia/Darwin"}),"Australia/Eucla":e.formatMessage({id:"allTimeZones.Australia/Eucla",defaultMessage:"Australia/Eucla"}),"Australia/Hobart":e.formatMessage({id:"allTimeZones.Australia/Hobart",defaultMessage:"Australia/Hobart"}),"Australia/LHI":e.formatMessage({id:"allTimeZones.Australia/LHI",defaultMessage:"Australia/LHI"}),"Australia/Lindeman":e.formatMessage({id:"allTimeZones.Australia/Lindeman",defaultMessage:"Australia/Lindeman"}),"Australia/Lord_Howe":e.formatMessage({id:"allTimeZones.Australia/Lord_Howe",defaultMessage:"Australia/Lord_Howe"}),"Australia/Melbourne":e.formatMessage({id:"allTimeZones.Australia/Melbourne",defaultMessage:"Australia/Melbourne"}),"Australia/NSW":e.formatMessage({id:"allTimeZones.Australia/NSW",defaultMessage:"Australia/NSW"}),"Australia/North":e.formatMessage({id:"allTimeZones.Australia/North",defaultMessage:"Australia/North"}),"Australia/Perth":e.formatMessage({id:"allTimeZones.Australia/Perth",defaultMessage:"Australia/Perth"}),"Australia/Queensland":e.formatMessage({id:"allTimeZones.Australia/Queensland",defaultMessage:"Australia/Queensland"}),"Australia/South":e.formatMessage({id:"allTimeZones.Australia/South",defaultMessage:"Australia/South"}),"Australia/Sydney":e.formatMessage({id:"allTimeZones.Australia/Sydney",defaultMessage:"Australia/Sydney"}),"Australia/Tasmania":e.formatMessage({id:"allTimeZones.Australia/Tasmania",defaultMessage:"Australia/Tasmania"}),"Australia/Victoria":e.formatMessage({id:"allTimeZones.Australia/Victoria",defaultMessage:"Australia/Victoria"}),"Australia/West":e.formatMessage({id:"allTimeZones.Australia/West",defaultMessage:"Australia/West"}),"Australia/Yancowinna":e.formatMessage({id:"allTimeZones.Australia/Yancowinna",defaultMessage:"Australia/Yancowinna"}),"Brazil/Acre":e.formatMessage({id:"allTimeZones.Brazil/Acre",defaultMessage:"Brazil/Acre"}),"Brazil/DeNoronha":e.formatMessage({id:"allTimeZones.Brazil/DeNoronha",defaultMessage:"Brazil/DeNoronha"}),"Brazil/East":e.formatMessage({id:"allTimeZones.Brazil/East",defaultMessage:"Brazil/East"}),"Brazil/West":e.formatMessage({id:"allTimeZones.Brazil/West",defaultMessage:"Brazil/West"}),CET:e.formatMessage({id:"allTimeZones.CET",defaultMessage:"CET"}),CST6CDT:e.formatMessage({id:"allTimeZones.CST6CDT",defaultMessage:"CST6CDT"}),"Canada/Atlantic":e.formatMessage({id:"allTimeZones.Canada/Atlantic",defaultMessage:"Canada/Atlantic"}),"Canada/Central":e.formatMessage({id:"allTimeZones.Canada/Central",defaultMessage:"Canada/Central"}),"Canada/Eastern":e.formatMessage({id:"allTimeZones.Canada/Eastern",defaultMessage:"Canada/Eastern"}),"Canada/Mountain":e.formatMessage({id:"allTimeZones.Canada/Mountain",defaultMessage:"Canada/Mountain"}),"Canada/Newfoundland":e.formatMessage({id:"allTimeZones.Canada/Newfoundland",defaultMessage:"Canada/Newfoundland"}),"Canada/Pacific":e.formatMessage({id:"allTimeZones.Canada/Pacific",defaultMessage:"Canada/Pacific"}),"Canada/Saskatchewan":e.formatMessage({id:"allTimeZones.Canada/Saskatchewan",defaultMessage:"Canada/Saskatchewan"}),"Canada/Yukon":e.formatMessage({id:"allTimeZones.Canada/Yukon",defaultMessage:"Canada/Yukon"}),"Chile/Continental":e.formatMessage({id:"allTimeZones.Chile/Continental",defaultMessage:"Chile/Continental"}),"Chile/EasterIsland":e.formatMessage({id:"allTimeZones.Chile/EasterIsland",defaultMessage:"Chile/EasterIsland"}),Cuba:e.formatMessage({id:"allTimeZones.Cuba",defaultMessage:"Cuba"}),EET:e.formatMessage({id:"allTimeZones.EET",defaultMessage:"EET"}),EST:e.formatMessage({id:"allTimeZones.EST",defaultMessage:"EST"}),EST5EDT:e.formatMessage({id:"allTimeZones.EST5EDT",defaultMessage:"EST5EDT"}),Egypt:e.formatMessage({id:"allTimeZones.Egypt",defaultMessage:"Egypt"}),Eire:e.formatMessage({id:"allTimeZones.Eire",defaultMessage:"Eire"}),"Etc/GMT":e.formatMessage({id:"allTimeZones.Etc/GMT",defaultMessage:"Etc/GMT"}),"Etc/GMT+0":e.formatMessage({id:"allTimeZones.Etc/GMT+0",defaultMessage:"Etc/GMT+0"}),"Etc/GMT+1":e.formatMessage({id:"allTimeZones.Etc/GMT+1",defaultMessage:"Etc/GMT+1"}),"Etc/GMT+10":e.formatMessage({id:"allTimeZones.Etc/GMT+10",defaultMessage:"Etc/GMT+10"}),"Etc/GMT+11":e.formatMessage({id:"allTimeZones.Etc/GMT+11",defaultMessage:"Etc/GMT+11"}),"Etc/GMT+12":e.formatMessage({id:"allTimeZones.Etc/GMT+12",defaultMessage:"Etc/GMT+12"}),"Etc/GMT+2":e.formatMessage({id:"allTimeZones.Etc/GMT+2",defaultMessage:"Etc/GMT+2"}),"Etc/GMT+3":e.formatMessage({id:"allTimeZones.Etc/GMT+3",defaultMessage:"Etc/GMT+3"}),"Etc/GMT+4":e.formatMessage({id:"allTimeZones.Etc/GMT+4",defaultMessage:"Etc/GMT+4"}),"Etc/GMT+5":e.formatMessage({id:"allTimeZones.Etc/GMT+5",defaultMessage:"Etc/GMT+5"}),"Etc/GMT+6":e.formatMessage({id:"allTimeZones.Etc/GMT+6",defaultMessage:"Etc/GMT+6"}),"Etc/GMT+7":e.formatMessage({id:"allTimeZones.Etc/GMT+7",defaultMessage:"Etc/GMT+7"}),"Etc/GMT+8":e.formatMessage({id:"allTimeZones.Etc/GMT+8",defaultMessage:"Etc/GMT+8"}),"Etc/GMT+9":e.formatMessage({id:"allTimeZones.Etc/GMT+9",defaultMessage:"Etc/GMT+9"}),"Etc/GMT-0":e.formatMessage({id:"allTimeZones.Etc/GMT-0",defaultMessage:"Etc/GMT-0"}),"Etc/GMT-1":e.formatMessage({id:"allTimeZones.Etc/GMT-1",defaultMessage:"Etc/GMT-1"}),"Etc/GMT-10":e.formatMessage({id:"allTimeZones.Etc/GMT-10",defaultMessage:"Etc/GMT-10"}),"Etc/GMT-11":e.formatMessage({id:"allTimeZones.Etc/GMT-11",defaultMessage:"Etc/GMT-11"}),"Etc/GMT-12":e.formatMessage({id:"allTimeZones.Etc/GMT-12",defaultMessage:"Etc/GMT-12"}),"Etc/GMT-13":e.formatMessage({id:"allTimeZones.Etc/GMT-13",defaultMessage:"Etc/GMT-13"}),"Etc/GMT-14":e.formatMessage({id:"allTimeZones.Etc/GMT-14",defaultMessage:"Etc/GMT-14"}),"Etc/GMT-2":e.formatMessage({id:"allTimeZones.Etc/GMT-2",defaultMessage:"Etc/GMT-2"}),"Etc/GMT-3":e.formatMessage({id:"allTimeZones.Etc/GMT-3",defaultMessage:"Etc/GMT-3"}),"Etc/GMT-4":e.formatMessage({id:"allTimeZones.Etc/GMT-4",defaultMessage:"Etc/GMT-4"}),"Etc/GMT-5":e.formatMessage({id:"allTimeZones.Etc/GMT-5",defaultMessage:"Etc/GMT-5"}),"Etc/GMT-6":e.formatMessage({id:"allTimeZones.Etc/GMT-6",defaultMessage:"Etc/GMT-6"}),"Etc/GMT-7":e.formatMessage({id:"allTimeZones.Etc/GMT-7",defaultMessage:"Etc/GMT-7"}),"Etc/GMT-8":e.formatMessage({id:"allTimeZones.Etc/GMT-8",defaultMessage:"Etc/GMT-8"}),"Etc/GMT-9":e.formatMessage({id:"allTimeZones.Etc/GMT-9",defaultMessage:"Etc/GMT-9"}),"Etc/GMT0":e.formatMessage({id:"allTimeZones.Etc/GMT0",defaultMessage:"Etc/GMT0"}),"Etc/Greenwich":e.formatMessage({id:"allTimeZones.Etc/Greenwich",defaultMessage:"Etc/Greenwich"}),"Etc/UCT":e.formatMessage({id:"allTimeZones.Etc/UCT",defaultMessage:"Etc/UCT"}),"Etc/UTC":e.formatMessage({id:"allTimeZones.Etc/UTC",defaultMessage:"Etc/UTC"}),"Etc/Universal":e.formatMessage({id:"allTimeZones.Etc/Universal",defaultMessage:"Etc/Universal"}),"Etc/Zulu":e.formatMessage({id:"allTimeZones.Etc/Zulu",defaultMessage:"Etc/Zulu"}),"Europe/Amsterdam":e.formatMessage({id:"allTimeZones.Europe/Amsterdam",defaultMessage:"Europe/Amsterdam"}),"Europe/Andorra":e.formatMessage({id:"allTimeZones.Europe/Andorra",defaultMessage:"Europe/Andorra"}),"Europe/Astrakhan":e.formatMessage({id:"allTimeZones.Europe/Astrakhan",defaultMessage:"Europe/Astrakhan"}),"Europe/Athens":e.formatMessage({id:"allTimeZones.Europe/Athens",defaultMessage:"Europe/Athens"}),"Europe/Belfast":e.formatMessage({id:"allTimeZones.Europe/Belfast",defaultMessage:"Europe/Belfast"}),"Europe/Belgrade":e.formatMessage({id:"allTimeZones.Europe/Belgrade",defaultMessage:"Europe/Belgrade"}),"Europe/Berlin":e.formatMessage({id:"allTimeZones.Europe/Berlin",defaultMessage:"Europe/Berlin"}),"Europe/Bratislava":e.formatMessage({id:"allTimeZones.Europe/Bratislava",defaultMessage:"Europe/Bratislava"}),"Europe/Brussels":e.formatMessage({id:"allTimeZones.Europe/Brussels",defaultMessage:"Europe/Brussels"}),"Europe/Bucharest":e.formatMessage({id:"allTimeZones.Europe/Bucharest",defaultMessage:"Europe/Bucharest"}),"Europe/Budapest":e.formatMessage({id:"allTimeZones.Europe/Budapest",defaultMessage:"Europe/Budapest"}),"Europe/Busingen":e.formatMessage({id:"allTimeZones.Europe/Busingen",defaultMessage:"Europe/Busingen"}),"Europe/Chisinau":e.formatMessage({id:"allTimeZones.Europe/Chisinau",defaultMessage:"Europe/Chisinau"}),"Europe/Copenhagen":e.formatMessage({id:"allTimeZones.Europe/Copenhagen",defaultMessage:"Europe/Copenhagen"}),"Europe/Dublin":e.formatMessage({id:"allTimeZones.Europe/Dublin",defaultMessage:"Europe/Dublin"}),"Europe/Gibraltar":e.formatMessage({id:"allTimeZones.Europe/Gibraltar",defaultMessage:"Europe/Gibraltar"}),"Europe/Guernsey":e.formatMessage({id:"allTimeZones.Europe/Guernsey",defaultMessage:"Europe/Guernsey"}),"Europe/Helsinki":e.formatMessage({id:"allTimeZones.Europe/Helsinki",defaultMessage:"Europe/Helsinki"}),"Europe/Isle_of_Man":e.formatMessage({id:"allTimeZones.Europe/Isle_of_Man",defaultMessage:"Europe/Isle_of_Man"}),"Europe/Istanbul":e.formatMessage({id:"allTimeZones.Europe/Istanbul",defaultMessage:"Europe/Istanbul"}),"Europe/Jersey":e.formatMessage({id:"allTimeZones.Europe/Jersey",defaultMessage:"Europe/Jersey"}),"Europe/Kaliningrad":e.formatMessage({id:"allTimeZones.Europe/Kaliningrad",defaultMessage:"Europe/Kaliningrad"}),"Europe/Kiev":e.formatMessage({id:"allTimeZones.Europe/Kyiv",defaultMessage:"Europe/Kyiv"}),"Europe/Kirov":e.formatMessage({id:"allTimeZones.Europe/Kirov",defaultMessage:"Europe/Kirov"}),"Europe/Lisbon":e.formatMessage({id:"allTimeZones.Europe/Lisbon",defaultMessage:"Europe/Lisbon"}),"Europe/Ljubljana":e.formatMessage({id:"allTimeZones.Europe/Ljubljana",defaultMessage:"Europe/Ljubljana"}),"Europe/London":e.formatMessage({id:"allTimeZones.Europe/London",defaultMessage:"Europe/London"}),"Europe/Luxembourg":e.formatMessage({id:"allTimeZones.Europe/Luxembourg",defaultMessage:"Europe/Luxembourg"}),"Europe/Madrid":e.formatMessage({id:"allTimeZones.Europe/Madrid",defaultMessage:"Europe/Madrid"}),"Europe/Malta":e.formatMessage({id:"allTimeZones.Europe/Malta",defaultMessage:"Europe/Malta"}),"Europe/Mariehamn":e.formatMessage({id:"allTimeZones.Europe/Mariehamn",defaultMessage:"Europe/Mariehamn"}),"Europe/Minsk":e.formatMessage({id:"allTimeZones.Europe/Minsk",defaultMessage:"Europe/Minsk"}),"Europe/Monaco":e.formatMessage({id:"allTimeZones.Europe/Monaco",defaultMessage:"Europe/Monaco"}),"Europe/Moscow":e.formatMessage({id:"allTimeZones.Europe/Moscow",defaultMessage:"Europe/Moscow"}),"Europe/Nicosia":e.formatMessage({id:"allTimeZones.Europe/Nicosia",defaultMessage:"Europe/Nicosia"}),"Europe/Oslo":e.formatMessage({id:"allTimeZones.Europe/Oslo",defaultMessage:"Europe/Oslo"}),"Europe/Paris":e.formatMessage({id:"allTimeZones.Europe/Paris",defaultMessage:"Europe/Paris"}),"Europe/Podgorica":e.formatMessage({id:"allTimeZones.Europe/Podgorica",defaultMessage:"Europe/Podgorica"}),"Europe/Prague":e.formatMessage({id:"allTimeZones.Europe/Prague",defaultMessage:"Europe/Prague"}),"Europe/Riga":e.formatMessage({id:"allTimeZones.Europe/Riga",defaultMessage:"Europe/Riga"}),"Europe/Rome":e.formatMessage({id:"allTimeZones.Europe/Rome",defaultMessage:"Europe/Rome"}),"Europe/Samara":e.formatMessage({id:"allTimeZones.Europe/Samara",defaultMessage:"Europe/Samara"}),"Europe/San_Marino":e.formatMessage({id:"allTimeZones.Europe/San_Marino",defaultMessage:"Europe/San_Marino"}),"Europe/Sarajevo":e.formatMessage({id:"allTimeZones.Europe/Sarajevo",defaultMessage:"Europe/Sarajevo"}),"Europe/Saratov":e.formatMessage({id:"allTimeZones.Europe/Saratov",defaultMessage:"Europe/Saratov"}),"Europe/Simferopol":e.formatMessage({id:"allTimeZones.Europe/Simferopol",defaultMessage:"Europe/Simferopol"}),"Europe/Skopje":e.formatMessage({id:"allTimeZones.Europe/Skopje",defaultMessage:"Europe/Skopje"}),"Europe/Sofia":e.formatMessage({id:"allTimeZones.Europe/Sofia",defaultMessage:"Europe/Sofia"}),"Europe/Stockholm":e.formatMessage({id:"allTimeZones.Europe/Stockholm",defaultMessage:"Europe/Stockholm"}),"Europe/Tallinn":e.formatMessage({id:"allTimeZones.Europe/Tallinn",defaultMessage:"Europe/Tallinn"}),"Europe/Tirane":e.formatMessage({id:"allTimeZones.Europe/Tirane",defaultMessage:"Europe/Tirane"}),"Europe/Tiraspol":e.formatMessage({id:"allTimeZones.Europe/Tiraspol",defaultMessage:"Europe/Tiraspol"}),"Europe/Ulyanovsk":e.formatMessage({id:"allTimeZones.Europe/Ulyanovsk",defaultMessage:"Europe/Ulyanovsk"}),"Europe/Uzhgorod":e.formatMessage({id:"allTimeZones.Europe/Uzhgorod",defaultMessage:"Europe/Uzhgorod"}),"Europe/Vaduz":e.formatMessage({id:"allTimeZones.Europe/Vaduz",defaultMessage:"Europe/Vaduz"}),"Europe/Vatican":e.formatMessage({id:"allTimeZones.Europe/Vatican",defaultMessage:"Europe/Vatican"}),"Europe/Vienna":e.formatMessage({id:"allTimeZones.Europe/Vienna",defaultMessage:"Europe/Vienna"}),"Europe/Vilnius":e.formatMessage({id:"allTimeZones.Europe/Vilnius",defaultMessage:"Europe/Vilnius"}),"Europe/Volgograd":e.formatMessage({id:"allTimeZones.Europe/Volgograd",defaultMessage:"Europe/Volgograd"}),"Europe/Warsaw":e.formatMessage({id:"allTimeZones.Europe/Warsaw",defaultMessage:"Europe/Warsaw"}),"Europe/Zagreb":e.formatMessage({id:"allTimeZones.Europe/Zagreb",defaultMessage:"Europe/Zagreb"}),"Europe/Zaporozhye":e.formatMessage({id:"allTimeZones.Europe/Zaporozhye",defaultMessage:"Europe/Zaporozhye"}),"Europe/Zurich":e.formatMessage({id:"allTimeZones.Europe/Zurich",defaultMessage:"Europe/Zurich"}),GB:e.formatMessage({id:"allTimeZones.GB",defaultMessage:"GB"}),"GB-Eire":e.formatMessage({id:"allTimeZones.GB-Eire",defaultMessage:"GB-Eire"}),GMT:e.formatMessage({id:"allTimeZones.GMT",defaultMessage:"GMT"}),"GMT+0":e.formatMessage({id:"allTimeZones.GMT+0",defaultMessage:"GMT+0"}),"GMT-0":e.formatMessage({id:"allTimeZones.GMT-0",defaultMessage:"GMT-0"}),GMT0:e.formatMessage({id:"allTimeZones.GMT0",defaultMessage:"GMT0"}),Greenwich:e.formatMessage({id:"allTimeZones.Greenwich",defaultMessage:"Greenwich"}),HST:e.formatMessage({id:"allTimeZones.HST",defaultMessage:"HST"}),Hongkong:e.formatMessage({id:"allTimeZones.Hongkong",defaultMessage:"Hongkong"}),Iceland:e.formatMessage({id:"allTimeZones.Iceland",defaultMessage:"Iceland"}),"Indian/Antananarivo":e.formatMessage({id:"allTimeZones.Indian/Antananarivo",defaultMessage:"Indian/Antananarivo"}),"Indian/Chagos":e.formatMessage({id:"allTimeZones.Indian/Chagos",defaultMessage:"Indian/Chagos"}),"Indian/Christmas":e.formatMessage({id:"allTimeZones.Indian/Christmas",defaultMessage:"Indian/Christmas"}),"Indian/Cocos":e.formatMessage({id:"allTimeZones.Indian/Cocos",defaultMessage:"Indian/Cocos"}),"Indian/Comoro":e.formatMessage({id:"allTimeZones.Indian/Comoro",defaultMessage:"Indian/Comoro"}),"Indian/Kerguelen":e.formatMessage({id:"allTimeZones.Indian/Kerguelen",defaultMessage:"Indian/Kerguelen"}),"Indian/Mahe":e.formatMessage({id:"allTimeZones.Indian/Mahe",defaultMessage:"Indian/Mahe"}),"Indian/Maldives":e.formatMessage({id:"allTimeZones.Indian/Maldives",defaultMessage:"Indian/Maldives"}),"Indian/Mauritius":e.formatMessage({id:"allTimeZones.Indian/Mauritius",defaultMessage:"Indian/Mauritius"}),"Indian/Mayotte":e.formatMessage({id:"allTimeZones.Indian/Mayotte",defaultMessage:"Indian/Mayotte"}),"Indian/Reunion":e.formatMessage({id:"allTimeZones.Indian/Reunion",defaultMessage:"Indian/Reunion"}),Iran:e.formatMessage({id:"allTimeZones.Iran",defaultMessage:"Iran"}),Israel:e.formatMessage({id:"allTimeZones.Israel",defaultMessage:"Israel"}),Jamaica:e.formatMessage({id:"allTimeZones.Jamaica",defaultMessage:"Jamaica"}),Japan:e.formatMessage({id:"allTimeZones.Japan",defaultMessage:"Japan"}),Kwajalein:e.formatMessage({id:"allTimeZones.Kwajalein",defaultMessage:"Kwajalein"}),Libya:e.formatMessage({id:"allTimeZones.Libya",defaultMessage:"Libya"}),MET:e.formatMessage({id:"allTimeZones.MET",defaultMessage:"MET"}),MST:e.formatMessage({id:"allTimeZones.MST",defaultMessage:"MST"}),MST7MDT:e.formatMessage({id:"allTimeZones.MST7MDT",defaultMessage:"MST7MDT"}),"Mexico/BajaNorte":e.formatMessage({id:"allTimeZones.Mexico/BajaNorte",defaultMessage:"Mexico/BajaNorte"}),"Mexico/BajaSur":e.formatMessage({id:"allTimeZones.Mexico/BajaSur",defaultMessage:"Mexico/BajaSur"}),"Mexico/General":e.formatMessage({id:"allTimeZones.Mexico/General",defaultMessage:"Mexico/General"}),NZ:e.formatMessage({id:"allTimeZones.NZ",defaultMessage:"NZ"}),"NZ-CHAT":e.formatMessage({id:"allTimeZones.NZ-CHAT",defaultMessage:"NZ-CHAT"}),Navajo:e.formatMessage({id:"allTimeZones.Navajo",defaultMessage:"Navajo"}),PRC:e.formatMessage({id:"allTimeZones.PRC",defaultMessage:"PRC"}),PST8PDT:e.formatMessage({id:"allTimeZones.PST8PDT",defaultMessage:"PST8PDT"}),"Pacific/Apia":e.formatMessage({id:"allTimeZones.Pacific/Apia",defaultMessage:"Pacific/Apia"}),"Pacific/Auckland":e.formatMessage({id:"allTimeZones.Pacific/Auckland",defaultMessage:"Pacific/Auckland"}),"Pacific/Bougainville":e.formatMessage({id:"allTimeZones.Pacific/Bougainville",defaultMessage:"Pacific/Bougainville"}),"Pacific/Chatham":e.formatMessage({id:"allTimeZones.Pacific/Chatham",defaultMessage:"Pacific/Chatham"}),"Pacific/Chuuk":e.formatMessage({id:"allTimeZones.Pacific/Chuuk",defaultMessage:"Pacific/Chuuk"}),"Pacific/Easter":e.formatMessage({id:"allTimeZones.Pacific/Easter",defaultMessage:"Pacific/Easter"}),"Pacific/Efate":e.formatMessage({id:"allTimeZones.Pacific/Efate",defaultMessage:"Pacific/Efate"}),"Pacific/Enderbury":e.formatMessage({id:"allTimeZones.Pacific/Enderbury",defaultMessage:"Pacific/Enderbury"}),"Pacific/Fakaofo":e.formatMessage({id:"allTimeZones.Pacific/Fakaofo",defaultMessage:"Pacific/Fakaofo"}),"Pacific/Fiji":e.formatMessage({id:"allTimeZones.Pacific/Fiji",defaultMessage:"Pacific/Fiji"}),"Pacific/Funafuti":e.formatMessage({id:"allTimeZones.Pacific/Funafuti",defaultMessage:"Pacific/Funafuti"}),"Pacific/Galapagos":e.formatMessage({id:"allTimeZones.Pacific/Galapagos",defaultMessage:"Pacific/Galapagos"}),"Pacific/Gambier":e.formatMessage({id:"allTimeZones.Pacific/Gambier",defaultMessage:"Pacific/Gambier"}),"Pacific/Guadalcanal":e.formatMessage({id:"allTimeZones.Pacific/Guadalcanal",defaultMessage:"Pacific/Guadalcanal"}),"Pacific/Guam":e.formatMessage({id:"allTimeZones.Pacific/Guam",defaultMessage:"Pacific/Guam"}),"Pacific/Honolulu":e.formatMessage({id:"allTimeZones.Pacific/Honolulu",defaultMessage:"Pacific/Honolulu"}),"Pacific/Johnston":e.formatMessage({id:"allTimeZones.Pacific/Johnston",defaultMessage:"Pacific/Johnston"}),"Pacific/Kiritimati":e.formatMessage({id:"allTimeZones.Pacific/Kiritimati",defaultMessage:"Pacific/Kiritimati"}),"Pacific/Kosrae":e.formatMessage({id:"allTimeZones.Pacific/Kosrae",defaultMessage:"Pacific/Kosrae"}),"Pacific/Kwajalein":e.formatMessage({id:"allTimeZones.Pacific/Kwajalein",defaultMessage:"Pacific/Kwajalein"}),"Pacific/Majuro":e.formatMessage({id:"allTimeZones.Pacific/Majuro",defaultMessage:"Pacific/Majuro"}),"Pacific/Marquesas":e.formatMessage({id:"allTimeZones.Pacific/Marquesas",defaultMessage:"Pacific/Marquesas"}),"Pacific/Midway":e.formatMessage({id:"allTimeZones.Pacific/Midway",defaultMessage:"Pacific/Midway"}),"Pacific/Nauru":e.formatMessage({id:"allTimeZones.Pacific/Nauru",defaultMessage:"Pacific/Nauru"}),"Pacific/Niue":e.formatMessage({id:"allTimeZones.Pacific/Niue",defaultMessage:"Pacific/Niue"}),"Pacific/Norfolk":e.formatMessage({id:"allTimeZones.Pacific/Norfolk",defaultMessage:"Pacific/Norfolk"}),"Pacific/Noumea":e.formatMessage({id:"allTimeZones.Pacific/Noumea",defaultMessage:"Pacific/Noumea"}),"Pacific/Pago_Pago":e.formatMessage({id:"allTimeZones.Pacific/Pago_Pago",defaultMessage:"Pacific/Pago_Pago"}),"Pacific/Palau":e.formatMessage({id:"allTimeZones.Pacific/Palau",defaultMessage:"Pacific/Palau"}),"Pacific/Pitcairn":e.formatMessage({id:"allTimeZones.Pacific/Pitcairn",defaultMessage:"Pacific/Pitcairn"}),"Pacific/Pohnpei":e.formatMessage({id:"allTimeZones.Pacific/Pohnpei",defaultMessage:"Pacific/Pohnpei"}),"Pacific/Ponape":e.formatMessage({id:"allTimeZones.Pacific/Ponape",defaultMessage:"Pacific/Ponape"}),"Pacific/Port_Moresby":e.formatMessage({id:"allTimeZones.Pacific/Port_Moresby",defaultMessage:"Pacific/Port_Moresby"}),"Pacific/Rarotonga":e.formatMessage({id:"allTimeZones.Pacific/Rarotonga",defaultMessage:"Pacific/Rarotonga"}),"Pacific/Saipan":e.formatMessage({id:"allTimeZones.Pacific/Saipan",defaultMessage:"Pacific/Saipan"}),"Pacific/Samoa":e.formatMessage({id:"allTimeZones.Pacific/Samoa",defaultMessage:"Pacific/Samoa"}),"Pacific/Tahiti":e.formatMessage({id:"allTimeZones.Pacific/Tahiti",defaultMessage:"Pacific/Tahiti"}),"Pacific/Tarawa":e.formatMessage({id:"allTimeZones.Pacific/Tarawa",defaultMessage:"Pacific/Tarawa"}),"Pacific/Tongatapu":e.formatMessage({id:"allTimeZones.Pacific/Tongatapu",defaultMessage:"Pacific/Tongatapu"}),"Pacific/Truk":e.formatMessage({id:"allTimeZones.Pacific/Truk",defaultMessage:"Pacific/Truk"}),"Pacific/Wake":e.formatMessage({id:"allTimeZones.Pacific/Wake",defaultMessage:"Pacific/Wake"}),"Pacific/Wallis":e.formatMessage({id:"allTimeZones.Pacific/Wallis",defaultMessage:"Pacific/Wallis"}),"Pacific/Yap":e.formatMessage({id:"allTimeZones.Pacific/Yap",defaultMessage:"Pacific/Yap"}),Poland:e.formatMessage({id:"allTimeZones.Poland",defaultMessage:"Poland"}),Portugal:e.formatMessage({id:"allTimeZones.Portugal",defaultMessage:"Portugal"}),ROC:e.formatMessage({id:"allTimeZones.ROC",defaultMessage:"ROC"}),ROK:e.formatMessage({id:"allTimeZones.ROK",defaultMessage:"ROK"}),Singapore:e.formatMessage({id:"allTimeZones.Singapore",defaultMessage:"Singapore"}),Turkey:e.formatMessage({id:"allTimeZones.Turkey",defaultMessage:"Turkey"}),UCT:e.formatMessage({id:"allTimeZones.UCT",defaultMessage:"UCT"}),"US/Alaska":e.formatMessage({id:"allTimeZones.US/Alaska",defaultMessage:"US/Alaska"}),"US/Aleutian":e.formatMessage({id:"allTimeZones.US/Aleutian",defaultMessage:"US/Aleutian"}),"US/Arizona":e.formatMessage({id:"allTimeZones.US/Arizona",defaultMessage:"US/Arizona"}),"US/Central":e.formatMessage({id:"allTimeZones.US/Central",defaultMessage:"US/Central"}),"US/East-Indiana":e.formatMessage({id:"allTimeZones.US/East-Indiana",defaultMessage:"US/East-Indiana"}),"US/Eastern":e.formatMessage({id:"allTimeZones.US/Eastern",defaultMessage:"US/Eastern"}),"US/Hawaii":e.formatMessage({id:"allTimeZones.US/Hawaii",defaultMessage:"US/Hawaii"}),"US/Indiana-Starke":e.formatMessage({id:"allTimeZones.US/Indiana-Starke",defaultMessage:"US/Indiana-Starke"}),"US/Michigan":e.formatMessage({id:"allTimeZones.US/Michigan",defaultMessage:"US/Michigan"}),"US/Mountain":e.formatMessage({id:"allTimeZones.US/Mountain",defaultMessage:"US/Mountain"}),"US/Pacific":e.formatMessage({id:"allTimeZones.US/Pacific",defaultMessage:"US/Pacific"}),"US/Pacific-New":e.formatMessage({id:"allTimeZones.US/Pacific-New",defaultMessage:"US/Pacific-New"}),"US/Samoa":e.formatMessage({id:"allTimeZones.US/Samoa",defaultMessage:"US/Samoa"}),UTC:e.formatMessage({id:"allTimeZones.UTC",defaultMessage:"UTC"}),Universal:e.formatMessage({id:"allTimeZones.Universal",defaultMessage:"Universal"}),"W-SU":e.formatMessage({id:"allTimeZones.W-SU",defaultMessage:"W-SU"}),WET:e.formatMessage({id:"allTimeZones.WET",defaultMessage:"WET"}),Zulu:e.formatMessage({id:"allTimeZones.Zulu",defaultMessage:"Zulu"})})));var C=i(65917),T=i(2911),k=i(39336);function Z(e,t){const i=k.default.tz(t),a=w(e)[t];return a?"GMT".concat(i.format("Z")," - ").concat(a," (").concat(i.format("z"),")"):(C.log({level:"error",from:"timeZoneHelpers",type:"localizedName",error:(0,T.Ui)("Missing ".concat(t," from timeZoneToLocalizedTimeZone"))}),"GMT".concat(i.format("Z")))}var A=i(92555),I=i(63143),P=i(51454),_=i(5366),x=i(50906),F=i(33800),B=i(17256),E=i(33665),D=i(77907),R=i(76150),L=i(12318),O=i(48762),N=i(46167),U=i(41101),W=i(1464),V=i(83182),z=i(46247),G=i(80527),H=i(56109),q=i(62727),K=i(73581),j=i(71202),Y=i(25584),Q=i(16328),J=i(15282),X=i(83071),$=i(79583),ee=i(47714),te=i(37235),ie=i(46951);class ae extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{store:R.ZP,timezoneQuery:L.default.of("")}),l()(this,"renderNavbarElement",(e=>{let{onPreviousClick:t,onNextClick:i}=e;const{device:a}=this.environment;return o()("div",{style:a.isMobile?ae.mobileNavStyle:ae.desktopNavStyle},void 0,o()(G.Z,{mobileFeedback:a.isMobile,icon:b.Z.chevronLeft,onClick:()=>t()}),o()(G.Z,{mobileFeedback:a.isMobile,icon:b.Z.chevronRight,onClick:()=>i()}))})),l()(this,"handleDateFormatChange",(e=>{this.props.onChangeDateFormat(e)})),l()(this,"handleTimeFormatChange",(e=>{const t=this.getTimeFormatOptions()[e];this.props.onChangeTimeFormat(t)})),l()(this,"handleChangeReminder",(e=>{const t=this.getDateValue();e?v.vJ(e)?this.props.onChangeValue({...t,reminder:e}):"datetime"!==t.type&&"datetimerange"!==t.type||this.props.onChangeValue({...t,reminder:e}):this.props.onChangeValue({...t,reminder:e}),x.trackSetReminder(this.environment,{date:t,reminder:e})})),l()(this,"handleInputChange",(e=>{const{device:t}=this.environment,{store:i}=this.stores;i.setState({...i.state,inputTemporaryValue:{...i.state.inputTemporaryValue,[i.state.focus]:e.target.value||""}}),t.isAndroid&&this.handleInputBlur()})),l()(this,"handleStartDateInputChange",(()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startDate;if(!t)return;const i=this.parseInputDateValue(t);if(!i)return R.pd.InvalidDate;const a=this.getDateValue();if(v.h(a)||v.qg(a)){const{newDate:e,currentMonth:t}=v.KZ({previous:a,updatedStartDate:i});this.applyValidDateState({newDate:e,currentMonth:t,resetField:R.Hv.StartDate})}else{const e={...a,start_date:i},t=v.pI(e);this.applyValidDateState({newDate:e,currentMonth:t.start,resetField:R.Hv.StartDate})}})),l()(this,"handleStartTimeInputChange",(()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startTime;if(!t)return;const i=this.parseInputTimeValue(t);if(!i)return R.pd.InvalidTime;const a=this.getDateValue();if(v.qg(a)){const{newDate:e,currentMonth:t}=v.vz({previous:a,updatedStartTime:i});this.applyValidDateState({newDate:e,currentMonth:t,resetField:R.Hv.StartTime}),this.resetInputState(R.Hv.EndDate),this.resetInputState(R.Hv.EndTime)}else{const e={...a,start_time:i},t=v.pI(e);this.applyValidDateState({newDate:e,currentMonth:t.start,resetField:R.Hv.StartTime})}})),l()(this,"handleEndDateInputChange",(()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endDate;if(!t)return;const i=this.parseInputDateValue(t);if(!i)return R.pd.InvalidDate;const a={...this.getDateValue(),end_date:i},n=v.pI(a);if(!n)return R.pd.InvalidRange;this.applyValidDateState({newDate:a,currentMonth:n.end,resetField:R.Hv.EndDate})})),l()(this,"handleEndTimeInputChange",(()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endTime;if(!t)return;const i=this.parseInputTimeValue(t);if(!i)return R.pd.InvalidTime;const a={...this.getDateValue(),end_time:i},n=v.pI(a);if(!n)return R.pd.InvalidRange;this.applyValidDateState({newDate:a,currentMonth:n.end,resetField:R.Hv.EndTime})})),l()(this,"handleInputBlur",(e=>{const{focus:t}=this.stores.store.state;let i;t===R.Hv.StartDate?i=this.handleStartDateInputChange():t===R.Hv.StartTime?i=this.handleStartTimeInputChange():t===R.Hv.EndDate?i=this.handleEndDateInputChange():t===R.Hv.EndTime&&(i=this.handleEndTimeInputChange()),i?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[t]:i}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})})),l()(this,"handleInputSubmit",(()=>{const{focus:e}=this.stores.store.state;let t;e===R.Hv.StartDate?t=this.handleStartDateInputChange():e===R.Hv.StartTime?t=this.handleStartTimeInputChange():e===R.Hv.EndDate?t=this.handleEndDateInputChange():e===R.Hv.EndTime&&(t=this.handleEndTimeInputChange()),t?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[e]:t}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})})),l()(this,"handleDayPickerDayClick",(e=>{if(this.props.disabled)return;const t=c().cloneDeep(this.getDateValue()),{focus:i}=this.stores.store.state,a=(0,B.Z)(e).locale(v.ah).format(v.Q1);if("daterange"===t.type||"datetimerange"===t.type){const e=i===R.Hv.StartDate||i===R.Hv.StartTime?R.Hv.EndDate:R.Hv.StartDate;if(a===t[e===R.Hv.StartDate?"start_date":"end_date"])return void this.stores.store.setState({...this.stores.store.state,focus:e});i===R.Hv.StartDate||i===R.Hv.StartTime?t.start_date=a:i!==R.Hv.EndDate&&i!==R.Hv.EndTime||(t.end_date=a);const n=v.iS(t,v.x7);if(n.end&&n.end.isBefore(n.start)){if("datetimerange"===t.type){const{start_date:e,start_time:i,end_date:a,end_time:n}=t;t.start_date=a,t.start_time=n,t.end_date=e,t.end_time=i}else{const{start_date:e,end_date:i}=t;t.start_date=i,t.end_date=e}this.stores.store.setState({...this.stores.store.state,focus:i===R.Hv.StartDate||i===R.Hv.StartTime?R.Hv.EndDate:R.Hv.StartDate})}this.props.onChangeValue(t),this.resetInputState(i)}else t.start_date=a,this.props.onChangeValue(t),this.resetInputState(i)})),l()(this,"handleDayPickerMonthChange",(e=>{this.stores.store.setState({...this.stores.store.state,currentMonth:(0,B.Z)(e)})})),l()(this,"handleEndDateControlChange",(()=>{const e=this.getDateValue();if("datetimerange"===e.type){const t={type:"datetime",start_date:e.start_date,start_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};this.props.onChangeValue(t)}else if("daterange"===e.type){const t={type:"date",start_date:e.start_date,reminder:e.reminder};this.props.onChangeValue(t)}else if("datetime"===e.type){const t={type:"datetimerange",start_date:e.start_date,start_time:e.start_time,end_date:e.start_date,end_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};this.props.onChangeValue(t),this.stores.store.setState({...this.stores.store.state,focus:R.Hv.EndDate})}else{const t={type:"daterange",start_date:e.start_date,end_date:e.start_date,reminder:e.reminder};this.props.onChangeValue(t),this.stores.store.setState({...this.stores.store.state,focus:R.Hv.EndDate})}})),l()(this,"handleAllDayChange",(()=>{const e=this.getDateValue();if("date"===e.type){const t={type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:v.x7,reminder:e.reminder&&v.AE(e.reminder)};this.props.onChangeValue(t)}else if("daterange"===e.type){const t={type:"datetimerange",start_date:e.start_date,start_time:"00:00",end_date:e.end_date,end_time:"00:00",time_zone:v.x7,reminder:e.reminder&&v.AE(e.reminder)};this.props.onChangeValue(t)}else if("datetime"===e.type){const t={type:"date",start_date:e.start_date,reminder:e.reminder&&v.wg(e.reminder)};this.props.onChangeValue(t)}else{const t={type:"daterange",start_date:e.start_date,end_date:e.end_date,reminder:e.reminder&&v.wg(e.reminder)};this.props.onChangeValue(t)}})),l()(this,"handleTimeZoneChange",(e=>{const t=A.ZV().find((t=>t.name===e));if(!t)return;const i=t.name,a=this.getDateValue();if("datetime"===a.type||"datetimerange"===a.type){const e={...a,time_zone:i};this.props.onChangeValue(e)}})),l()(this,"handleStartInputDateFocus",(()=>{const e=this.getDateValue(),t=v.iS(e,v.x7);this.stores.store.setState({...this.stores.store.state,focus:R.Hv.StartDate,inputIsFocused:!0,currentMonth:t.start})})),l()(this,"handleStartInputTimeFocus",(()=>{const e=this.getDateValue(),t=v.iS(e,v.x7);this.stores.store.setState({...this.stores.store.state,focus:R.Hv.StartTime,inputIsFocused:!0,currentMonth:t.start})})),l()(this,"handleEndInputDateFocus",(()=>{const e=this.getDateValue(),t=v.iS(e,v.x7);t.end&&this.stores.store.setState({...this.stores.store.state,focus:R.Hv.EndDate,inputIsFocused:!0,currentMonth:t.end})})),l()(this,"handleEndInputTimeFocus",(()=>{const e=this.getDateValue(),t=v.iS(e,v.x7);t.end&&this.stores.store.setState({...this.stores.store.state,focus:R.Hv.EndTime,inputIsFocused:!0,currentMonth:t.end})})),l()(this,"handleClearClick",(()=>{this.props.onChangeValue(void 0)})),l()(this,"getTimeFormatOptions",(()=>(0,M.E)(g.SP).time)),l()(this,"getSelectedTimeFormatType",(()=>{const e=this.getTimeFormat(),t=this.getTimeFormatOptions();for(const i in t)if(t[i]===e)return i;return"12h"})),l()(this,"getTimeZoneItemsSync",(e=>(0,S.ZP)(e,A.ZV(),(e=>c().compact([e.name,Z(this.props.intl,e.name)]).join(" "))).map(((e,t)=>({key:e.name,render:t=>m().createElement(O.Z,n()({},t,{title:Z(this.props.intl,e.name)})),action:()=>{this.handleTimeZoneChange(e.name)}}))))),l()(this,"tooltipOriginGap",12)}willMount(e){super.willMount(e),this.openTimeFormat=v.Lg(v.x7)}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,{disabled:i,canConfigureCollection:a,shouldShowReminder:n}=this.props,{inputIsFocused:s}=this.stores.store.state,r=this.getDateValue(),l="datetime"===r.type||"datetimerange"===r.type,d="daterange"===r.type||"datetimerange"===r.type,c=o()("div",{style:{paddingTop:e.isMobile?16:8,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:l?"block":"flex",...e.isMobile&&{boxShadow:"\n\t\t\t\t\t\t\t0 1px 0 ".concat(this.theme.regularDividerColor,"\n\t\t\t\t\t\t"),position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0}},void 0,this.renderStartInput(),d&&o()("div",{style:{width:12,height:8}}),this.renderEndInput(),this.renderTimeZone());let u;return u=e.isMobile?{menuType:j.Z.MenuType.Modal,title:o()(_.FormattedMessage,{defaultMessage:"Date",id:"datePropertyMenu.mobileDate.title"}),right:o()(_.FormattedMessage,{defaultMessage:"Done",id:"datePropertyMenu.mobileDoneButton.label"}),left:n?this.renderRemindersHelp():void 0,onClickRight:this.props.onDismiss,header:c}:{menuType:j.Z.MenuType.Popup,maxHeight:"none",width:270},o()(H.Z,{capture:s,allowEsc:!0,allowTabUntab:this.props.allowTabUntab},void 0,o()(H.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:this.props.allowTabUntab},void 0,m().createElement(j.Z,u,o()(U.Z,{show:s}),o()(X.Z,{},void 0,!e.isMobile&&c,o()("div",{style:{padding:e.isMobile?"16px 14px 16px":"4px 0 4px",textAlign:"center",...e.isMobile&&{borderBottom:"1px solid ".concat(this.theme.regularDividerColor),background:this.theme.popoverBackground}}},void 0,this.renderCalendar())),!i&&this.renderControls(),!i&&a&&o()(X.Z,{topBorder:!0},void 0,this.renderFormatPopup()),!i&&o()(X.Z,{topBorder:!0},void 0,this.renderClearButton()),!i&&!e.isMobile&&n&&o()(X.Z,{topBorder:!0},void 0,this.renderRemindersHelp()))))}renderStartInput(){const{device:e}=this.environment,{disabled:t}=this.props,{focus:i,inputTemporaryValue:a,error:n}=this.stores.store.state,s=this.getDateValue(),r=v.iS(s,v.x7),l=Boolean(n.startDate||n.startTime),d="datetime"===s.type||"datetimerange"===s.type,c="daterange"===s.type||"datetimerange"===s.type,u=i===R.Hv.StartDate||i===R.Hv.StartTime,m=this.getSelectedTimeFormatType(),p=(0,I.z4)(a.startDate)?r.start.locale(!1).format(this.getDateDisplayFormat()):a.startDate,g=(0,I.z4)(a.startTime)?r.start.locale(!1).format(this.getTimeFormatOptions()[m]):a.startTime,h=(0,I.z4)(a.startDate)?r.start.format(v.Q1):a.startDate,f=(0,I.z4)(a.startTime)?r.start.format(v.jK):a.startTime;return o()("div",{style:{...l?this.getInputWrapErrorStyle():u&&c?this.getInputWrapActiveStyle():this.getInputWrapInactiveStyle(),fontSize:e.isMobile?16:14}},void 0,o()(te.Z,{renderTooltip:()=>this.getInputErrorMessage(n.startDate),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(n.startDate),placement:te.Z.Placement.Left,render:()=>e.isMobile?o()(q.Z,{type:"date",format:q.B.Transparent,value:h,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1}):o()(q.Z,{format:q.B.Transparent,value:p,focusInitial:i===R.Hv.StartDate,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1})}),d&&this.getInputSeparator(),d&&o()(te.Z,{renderTooltip:()=>this.getInputErrorMessage(n.startTime),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(n.startTime),placement:te.Z.Placement.Right,render:()=>e.isMobile?o()(q.Z,{type:"time",format:q.B.Transparent,value:f,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):o()(q.Z,{format:q.B.Transparent,value:g,focusInitial:i===R.Hv.StartTime,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}))}renderEndInput(){const{device:e}=this.environment,{disabled:t}=this.props,i=this.getDateValue(),a=v.iS(i,v.x7),n="datetime"===i.type||"datetimerange"===i.type;if(a.end){const{focus:i,error:s,inputTemporaryValue:r}=this.stores.store.state,l=Boolean(s.endDate||s.endTime),d=i===R.Hv.EndDate||i===R.Hv.EndTime,c=this.getSelectedTimeFormatType(),u=(0,I.z4)(r.endDate)?a.end.locale(!1).format(this.getDateDisplayFormat()):r.endDate,m=(0,I.z4)(r.endTime)?a.end.locale(!1).format(this.getTimeFormatOptions()[c]):r.endTime,p=(0,I.z4)(r.endDate)?a.end.format(v.Q1):r.endDate,g=(0,I.z4)(r.endTime)?a.end.format(v.jK):r.endTime,h=this.getDateRangeBounds(),f=h&&h.earliestValidEnd;return o()("div",{style:{...l?this.getInputWrapErrorStyle():d?this.getInputWrapActiveStyle():this.getInputWrapInactiveStyle(),fontSize:e.isMobile?16:14}},void 0,o()(te.Z,{renderTooltip:()=>this.getInputErrorMessage(s.endDate),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(s.endDate),placement:te.Z.Placement.Left,render:()=>e.isMobile?o()(q.Z,{type:"date",format:q.B.Transparent,value:p,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t,inputElementAttributes:{min:f}}):o()(q.Z,{format:q.B.Transparent,value:u,focusInitial:i===R.Hv.EndDate,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}),n&&this.getInputSeparator(),n&&o()(te.Z,{renderTooltip:()=>this.getInputErrorMessage(s.endTime),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(s.endTime),placement:te.Z.Placement.Right,render:()=>e.isMobile?o()(q.Z,{type:"time",format:q.B.Transparent,value:g,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):o()(q.Z,{format:q.B.Transparent,value:m,focusInitial:i===R.Hv.EndTime,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}))}}renderTimeZone(){const{device:e}=this.environment,t=this.getDateValue(),i=v.iS(t,v.x7),a=B.Z.tz(i.start,v.x7);if(("datetime"===t.type||"datetimerange"===t.type)&&a.utcOffset()!==i.start.utcOffset()){const i=A.ZV().find((e=>e.name===t.time_zone));if(i)return o()(ie.Z,{isSmall:!0,isMobile:e.isMobile,style:{marginTop:8}},void 0,Z(this.props.intl,i.name))}}renderCalendar(){const{firstDayOfWeek:e}=this.props,t=this.getDateValueForceCurrentTimeZone(),i=v.iS(t,v.x7),a=this.stores.store.state.currentMonth||i.start,{focus:n}=this.stores.store.state;if(i.end){const t=i.start.toDate(),s=i.end.toDate(),r=n===R.Hv.StartDate||n===R.Hv.StartTime;return o()(D.LazyDayPicker,{className:"notion-calendar-picker notranslate",firstDayOfWeek:e,numberOfMonths:1,initialMonth:a.toDate(),month:a.toDate(),locale:g.SP,localeUtils:F.q,modifiers:{range:{from:t,to:s},...r?{end:s,start:t}:{start:t,end:s}},modifiersStyles:{range:ae.dayPickerRangeDayStyle,start:r?this.getDayPickerActiveDayStyle():this.getDayPickerInactiveDayStyle(),end:r?this.getDayPickerInactiveDayStyle():this.getDayPickerActiveDayStyle()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,navbarElement:this.renderNavbarElement,onMonthChange:this.handleDayPickerMonthChange})}{const t=i.start.toDate();return o()(D.LazyDayPicker,{className:"notion-calendar-picker notranslate",numberOfMonths:1,firstDayOfWeek:e,initialMonth:a.toDate(),month:a.toDate(),locale:g.SP,localeUtils:F.q,selectedDays:[t],modifiers:{start:t},modifiersStyles:{start:this.getDayPickerActiveDayStyle()},showOutsideDays:!0,fixedWeeks:!0,navbarElement:this.renderNavbarElement,onDayClick:this.handleDayPickerDayClick,onMonthChange:this.handleDayPickerMonthChange})}}renderControls(){const{device:e}=this.environment,{shouldShowReminder:t}=this.props;return e.isMobile?o()(X.Z,{topBorder:!0},void 0,t&&this.renderReminderControl(),this.renderEndDateControl(),this.renderAllDayControl()):o()(u.Fragment,{},void 0,t&&o()(X.Z,{topBorder:!0},void 0,this.renderReminderControl()),o()(X.Z,{topBorder:!0},void 0,this.renderEndDateControl(),this.renderAllDayControl()))}renderEndDateControl(){const{device:e}=this.environment,t=this.getDateValue();return o()(O.Z,{focused:!1,onClick:this.handleEndDateControlChange,title:o()(_.FormattedMessage,{defaultMessage:"End date",id:"datePropertyMenu.menuItem.endDate.label"}),right:o()(ee.Z,{on:"daterange"===t.type||"datetimerange"===t.type,onClick:this.handleEndDateControlChange,isAndroid:e.isAndroid})})}renderAllDayControl(){const{device:e}=this.environment,t=this.getDateValue();return o()(O.Z,{focused:!1,onClick:this.handleAllDayChange,title:o()(_.FormattedMessage,{defaultMessage:"Include time",id:"datePropertyMenu.menuItem.includeTime.label",description:"Shown in the date property menu as an option for whether this date includes a time."}),right:o()(ee.Z,{on:"date"!==t.type&&"daterange"!==t.type,onClick:this.handleAllDayChange,isAndroid:e.isAndroid})})}renderReminderControl(){const{device:e}=this.environment,{intl:t}=this.props,i=this.getDateValue();return o()(N.Z,{popupType:e.isMobile?N.Z.PopupType.SlideUp:N.Z.PopupType.Popup,placementToOrigin:N.Z.Placement.Right,renderOrigin:a=>m().createElement(W.Z,n()({},a,{icon:b.Z.alarmClock({width:14}),title:o()(_.FormattedMessage,{defaultMessage:"Remind",id:"datePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:e.isMobile,right:(0,f.nN)({reminder:i.reminder,intl:t})})),render:a=>{let s;s=e.isMobile?{menuType:j.Z.MenuType.Modal,title:o()(_.FormattedMessage,{defaultMessage:"Remind",id:"datePropertyMenu.mobileRemindModal.title"}),right:o()(_.FormattedMessage,{defaultMessage:"Done",id:"datePropertyMenu.mobileDoneReminderButton.label"}),onClickRight:a.close}:{menuType:j.Z.MenuType.Popup,width:250};const r=("date"===i.type||"daterange"===i.type?v.PI:v.dG).map((e=>{const i=(0,f.nN)({reminder:e,shouldShowTime:!0,intl:t});return{key:i,action:t=>{this.handleChangeReminder(e),a.close()},render:(e,t)=>m().createElement(O.Z,n()({},e,{title:i}))}}));return m().createElement(j.Z,s,o()(Y.Z,{type:Y.Z.Type.Vertical,sections:[{key:"reminder section",render:e=>m().createElement(X.Z,e),items:r}],initialFocus:void 0}))}})}renderFormatPopup(){const{device:e}=this.environment;return o()(N.Z,{popupType:e.isMobile?N.Z.PopupType.SlideUp:N.Z.PopupType.Popup,placementToOrigin:N.Z.Placement.Right,renderOrigin:t=>m().createElement(O.Z,n()({},t,{icon:b.Z.sidebarSettings({width:14}),title:o()(_.FormattedMessage,{defaultMessage:"Date format & timezone",id:"datePropertyMenu.menuItem.formatAndTimezone.label"}),focused:!1,showExtensionArrow:e.isMobile})),render:t=>{let i;return i=e.isMobile?{menuType:j.Z.MenuType.Modal,title:o()(_.FormattedMessage,{defaultMessage:"Date format",id:"datePropertyMenu.mobileDateFormatModal.title"}),right:o()(_.FormattedMessage,{defaultMessage:"Done",id:"datePropertyMenu.mobileDoneButton.label"}),onClickRight:t.close}:{menuType:j.Z.MenuType.Popup,width:250},m().createElement(j.Z,i,o()(X.Z,{},void 0,this.renderDateFormatControl(),this.renderTimeFormatControl(),this.renderTimeZoneControl()))}})}renderDateFormatControl(){const e=this.props.dateFormat||v.sF,{intl:t}=this.props,i={menuTitle:t.formatMessage({defaultMessage:"Date format",id:"datePropertyMenu.dateFormatDropdownButton.label"}),items:v.Zy,getKey:e=>e,selectedItem:e,onSelect:this.handleDateFormatChange,renderItem:e=>m().createElement(O.Z,n()({},e,{title:t.formatMessage(v.fy[e.value])})),renderOrigin:i=>m().createElement(W.Z,n()({focused:!1,title:o()(_.FormattedMessage,{defaultMessage:"Date format",id:"datePropertyMenu.menuItem.format.label"}),right:e?t.formatMessage(v.fy[e]):o()(_.FormattedMessage,{defaultMessage:"Empty",id:"datePropertyMenu.formatMenu.emptyButton.label"})},i))};return m().createElement($.Z,i)}renderTimeFormatControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,i=this.getTimeFormat(),{intl:a}=this.props,s=this.getSelectedTimeFormatType(),r={menuTitle:a.formatMessage({defaultMessage:"Time format",id:"datePropertyMenu.timeFormatMenu.title"}),items:v.L7,getKey:e=>e,selectedItem:s,onSelect:this.handleTimeFormatChange,renderItem:e=>m().createElement(O.Z,n()({},e,{title:a.formatMessage(v.Fi[e.value])})),disabled:t,renderOrigin:e=>m().createElement(W.Z,n()({focused:!1,title:o()(_.FormattedMessage,{defaultMessage:"Time format",id:"datePropertyMenu.menuItem.timeFormat.label"}),disabled:t,right:!t&&(i?a.formatMessage(v.Fi[s]):o()(_.FormattedMessage,{defaultMessage:"Empty",id:"datePropertyMenu.timeFormatMenu.emptyButton.label"}))},e))};return m().createElement($.Z,r)}renderTimeZoneControl(){const{device:e}=this.environment,t=this.getDateValue(),i="date"===t.type||"daterange"===t.type,a=this.getCurrentTimeZone(),s=A.ZV().find((e=>e.name===a)),{intl:r}=this.props;if(s)return o()(N.Z,{popupType:e.isMobile?N.Z.PopupType.SlideUp:N.Z.PopupType.Popup,disabled:i,onClick:()=>this.stores.timezoneQuery.set(""),renderOrigin:e=>m().createElement(W.Z,n()({focused:!1,title:o()(_.FormattedMessage,{defaultMessage:"Timezone",id:"datePropertyMenu.menuItem.time.label"}),disabled:i,right:!i&&B.Z.tz.zone(s.name).abbr(Date.now())},e)),render:t=>{const i=this.stores.timezoneQuery.get(),a=this.getTimeZoneItemsSync(i),s=o()(X.Z,{isInput:!0},void 0,o()(K.Z,{focus:!e.isMobile||void 0,focusAfterAnimation:!0,value:this.stores.timezoneQuery.get(),onChange:e=>this.stores.timezoneQuery.set(e.target.value),placeholder:r.formatMessage({defaultMessage:"Search for a timezone…",id:"datePropertyMenu.timeSearch.placeholder"})}));let l;return l=e.isMobile?{menuType:j.Z.MenuType.Modal,title:o()(_.FormattedMessage,{defaultMessage:"Timezone",id:"datePropertyMenu.mobileTimezoneMenu.title"}),right:o()(J.CancelMenuText,{}),onClickRight:t.close,header:s}:{menuType:j.Z.MenuType.Popup,header:s},m().createElement(j.Z,l,0===a.length?o()(X.Z,{title:o()(_.FormattedMessage,{defaultMessage:"Select a timezone",id:"datePropertyMenu.timezoneMenu.select.placeholder"})},void 0,o()(Q.Z,{title:o()(_.FormattedMessage,{defaultMessage:"No results",id:"datePropertyMenu.timezoneMenu.noResults"})})):o()(Y.Z,{type:Y.Z.Type.Vertical,initialFocus:0,sections:[{key:"timezone section",render:e=>m().createElement(X.Z,n()({},e,{title:o()(_.FormattedMessage,{defaultMessage:"Select a timezone",id:"datePropertyMenu.menuItem.select.title"})})),items:a}],onAccept:t.close}))}})}renderClearButton(){return o()(O.Z,{focused:!1,onClick:this.handleClearClick,title:o()(_.FormattedMessage,{defaultMessage:"Clear",id:"datePropertyMenu.clearButton.label"})})}renderRemindersHelp(){const{device:e}=this.environment;return e.isMobile?o()(z.Z,{href:(0,E.UY)("guides.reminders"),analyticsFrom:"date_selector"}):o()(V.Z,{title:o()(_.FormattedMessage,{defaultMessage:"Learn about reminders",id:"datePropertyMenu.learnMore.helpButton.label"}),href:(0,E.UY)("guides.reminders"),analyticsFrom:"date_selector"})}getDateValue(){const{value:e}=this.props;return e&&!c().isNaN(e)?e:this.openTimeFormat}getDateRangeBounds(){const e=this.getDateValue();if(v.h(e)||v.qg(e)){const t=v.iS(e,v.x7);return{earliestValidEnd:t.start.format(v.Q1),latestValidStart:t.end.format(v.Q1)}}}getDateValueForceCurrentTimeZone(){const{value:e}=this.props;return e&&!c().isNaN(e)?"datetime"===e.type||"datetimerange"===e.type?{...e,time_zone:v.x7}:e:this.openTimeFormat}getDateDisplayFormat(){const e=this.props.dateFormat||v.sF;return"relative"===e?v.sF:e}getTimeFormat(){return this.props.timeFormat||v.c_}getCurrentTimeZone(){const e=this.getDateValue();return"datetime"===e.type||"datetimerange"===e.type?e.time_zone:v.x7}parseInputDateValue(e){const{intl:t}=this.props;return this.environment.device.isMobile?(0,y.f_)(e,v.Q1,t):(0,y.f_)(e,this.getDateDisplayFormat(),t)}parseInputTimeValue(e){const t=(0,B.Z)(e,this.getTimeFormat(),!0);return t.isValid()?t.locale(v.ah).format(v.jK):(0,y.TD)(e,this.props.intl)}applyValidDateState(e){const{newDate:t,currentMonth:i,resetField:a}=e;this.props.onChangeValue(t),this.stores.store.setState({...this.stores.store.state,currentMonth:i}),this.resetInputState(a)}resetInputState(e){const{state:t}=this.stores.store;this.stores.store.setState({...t,error:{...t.error,[t.focus]:void 0},inputTemporaryValue:{...t.inputTemporaryValue,[t.focus]:void 0}})}getInputErrorMessage(e){const{intl:t}=this.props;switch(e){case R.pd.InvalidDate:return t.formatMessage({id:"datePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case R.pd.InvalidRange:return t.formatMessage({id:"datePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case R.pd.InvalidTime:return t.formatMessage({id:"datePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}getInputSeparator(){return o()("div",{style:{height:14,width:1,background:this.theme.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})}getInputWrapStyle(){return{display:"flex",alignItems:"center",borderRadius:3,height:28,lineHeight:1.2,background:this.theme.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%"}}getInputWrapInactiveStyle(){return{...this.getInputWrapStyle(),boxShadow:this.theme.inputBoxShadow,flexGrow:1}}getInputWrapErrorStyle(){return{...this.getInputWrapStyle(),boxShadow:"inset 0 0 0 2px ".concat(h.ZP.red),background:h.ZP.redWithAlpha(.15),flexGrow:1}}getInputWrapActiveStyle(){return{...this.getInputWrapStyle(),boxShadow:"inset 0 0 0 2px ".concat(h.ZP.blue),background:h.ZP.blueWithAlpha(.15),flexGrow:1}}getDayPickerActiveDayStyle(){return{backgroundColor:h.ZP.blue,color:h.ZP.white}}getDayPickerInactiveDayStyle(){return{backgroundColor:h.ZP.blueWithAlpha(.5)}}}l()(ae,"dayPickerRangeDayStyle",{backgroundColor:h.ZP.blueWithAlpha(.15)}),l()(ae,"desktopNavStyle",{display:"flex",position:"absolute",top:0,right:4,zIndex:P.mJ}),l()(ae,"mobileNavStyle",{display:"flex",position:"absolute",top:-2,right:4,zIndex:P.mJ});const ne=(0,_.injectIntl)(ae)},92660:(e,t,i)=>{i.d(t,{Z:()=>l});var a=i(77094),n=i.n(a),s=(i(67294),i(83355)),o=i(15102),r=i(66722);class l extends s.Z{renderComponent(){const{render:e}=this.props,{device:t}=this.environment,i=this.props.modalStore.state;return t.isMobile?n()(r.ZP,{open:i.open,popupType:r.ZP.PopupType.SlideUp,origin:this.props.origin,onDismiss:this.props.onDismiss,render:e,style:this.props.style}):n()(o.Z,{open:i.open,preventHideChildrenWhileOpening:!0,render:e,onDismiss:this.props.onDismiss,style:this.props.style})}}},29345:(e,t,i)=>{i.r(t),i.d(t,{default:()=>W});var a=i(77094),n=i.n(a),s=i(77422),o=i.n(s),r=(i(33948),i(96486)),l=i.n(r),d=i(67294),c=i.n(d),u=i(83355),m=i(41892),p=i(8848),g=i(53397),h=i(30845),f=i(82990),v=i(5366),y=i(50906),S=i(33929),M=i(49085);class b extends M.Z{getInitialState(){return{step:"initial"}}}const w=b;var C=i(66205),T=i(13548),k=i(72693),Z=i(14947),A=i(97464),I=i.n(A),P=i(48762),_=i(47966),x=i(79583);class F extends u.Z{renderComponent(){const{intl:e,question:t}=this.props,i={setup_trial:n()(v.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial"}),live_demo:n()(v.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.live_demo",defaultMessage:"Schedule a live demo"}),plan_help:n()(v.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.plan_help",defaultMessage:"Need help choosing a plan"}),other:n()(v.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.other",defaultMessage:"Other"})},a={menuTitle:e.formatMessage({defaultMessage:"Your question",id:"enterpriseContactModal.yourQuestion.title"}),items:["setup_trial","live_demo","plan_help","other"],width:280,getKey:e=>e,selectedItem:t,originGap:4,onSelect:e=>{this.props.onSelect(e)},renderItem:e=>c().createElement(P.Z,I()({title:i[e.key]},e)),renderOrigin:e=>c().createElement(_.Z,I()({},e,{isLarge:!0,style:{...this.getInputStyle(),...this.props.invalid&&{border:"1px solid ".concat(p.ZP.red)}}}),n()("div",{style:{display:"flex",alignItems:"center",color:t?this.theme.regularTextColor:this.theme.lightTextColor}},void 0,t?i[t]:n()(v.FormattedMessage,{defaultMessage:"Select question",id:"enterpriseContactModal.selectQuestion.label"})),g.Z.expand({width:10,fill:this.theme.lightIconColor}))};return c().createElement(x.Z,I()({key:"onboarding"},a))}getInputStyle(){const{device:e}=this.environment;return{backgroundColor:this.theme.whiteButtonBackground,height:31,...e.isMobile&&{height:42},padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:3,border:0,transition:"box-shadow 0.3s ease",boxShadow:"0 0 0 1px ".concat(this.theme.outlineButtonBorder),background:this.theme.buttonBackground}}}const B=(0,v.injectIntl)(F);var E=i(62727),D=i(89206),R=i(29551),L=i(15102),O=i(42001);const N=(0,v.defineMessages)({additionalFeedbackPlaceholder:{id:"enterpriseContactModal.additionalFeedback.placeholder",defaultMessage:"What would you like to learn more about?"}});class U extends u.Z{constructor(){super(...arguments),o()(this,"storeTypes",{store:w}),o()(this,"renderMenu",(()=>n()("div",{style:this.getContainerStyle()},void 0,this.renderCancel(),n()(R.gq,{style:this.getInnerContainerStyle(),alignItems:"center",alignContent:"center"},void 0,this.renderStep())))),o()(this,"renderInitial",(()=>{const{invalidField:e}=this.stores.store.state;if(C.Z.state.open)return n()("div",{style:{...this.getSlideUpStyle(),padding:20}},void 0,g.Z.speechBubbleThin({width:"100%",height:24}),n()("div",{style:{fontSize:14,fontWeight:f.Z.fontWeight.semibold,paddingTop:6,paddingBottom:4}},void 0,n()(v.FormattedMessage,{id:"enterpriseContactModal.initial.header",defaultMessage:"Get in touch with sales"})),n()("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:200,margin:"0 auto"}},void 0,n()(v.FormattedMessage,{id:"enterpriseContactModal.initial.caption",defaultMessage:"We'll work with you on your setup and help you land on the best plan."})),n()("div",{style:{...this.getLabelStyle(),marginTop:24}},void 0,n()(v.FormattedMessage,{id:"enterpriseContactModal.initial.nameLabel",defaultMessage:"Your name"})),n()(E.Z,{focusInitial:!0,value:this.getName(),placeholder:"Ada Lovelace",style:{marginRight:4,...this.getInputStyle(),..."name"===e&&this.getInvalidInputStyle()},onChange:e=>{C.Z.setState({...C.Z.state,open:!0,name:void 0}),this.stores.store.setState({...this.stores.store.state,name:e.target.value}),y.trackEnterpriseSalesContactUpdated(this.environment,{contactFieldType:"name",contactFieldValue:e.target.value})}}),n()("div",{style:this.getLabelStyle()},void 0,n()(v.FormattedMessage,{id:"enterpriseContactModal.initial.emailLabel",defaultMessage:"Your work email"})),n()(E.Z,{value:this.getEmail(),placeholder:"ada@lovelace.app",type:"email",style:{marginRight:4,...this.getInputStyle(),..."email"===e&&this.getInvalidInputStyle()},onChange:e=>{C.Z.setState({...C.Z.state,open:!0,email:void 0}),this.stores.store.setState({...this.stores.store.state,email:e.target.value}),y.trackEnterpriseSalesContactUpdated(this.environment,{contactFieldType:"email",contactFieldValue:e.target.value})}}),n()("div",{style:this.getLabelStyle()},void 0,n()(v.FormattedMessage,{id:"enterpriseContactModal.initial.companySizeLabel",defaultMessage:"Company size"})),n()(R.gq,{},void 0,this.getCompanySizeButtonData().map((e=>{let{type:t,message:i,style:a}=e;return n()(O.Z,{isLightGray:!0,isLarge:!0,style:{...this.getBaseButtonStyle(),...this.stores.store.state.companySize===t&&this.getSelectedButtonStyle(),...a},onClick:()=>{this.stores.store.setState({...this.stores.store.state,companySize:t}),y.trackEnterpriseSalesContactUpdated(this.environment,{contactFieldType:"companySize",contactFieldValue:t})}},void 0,i)}))),n()("div",{style:this.getLabelStyle()},void 0,n()(v.FormattedMessage,{id:"enterpriseContactModal.initial.questionLabel",defaultMessage:"Your question"})),n()(B,{question:this.stores.store.state.question,invalid:"question"===e,onSelect:e=>{this.stores.store.setState({...this.stores.store.state,question:e,step:"other"===e?"additional_input":"initial"}),y.trackEnterpriseSalesContactUpdated(this.environment,{contactFieldType:"question",contactFieldValue:"other"===e?"additional_input":"initial"})}}),n()(E.Z,{textarea:!0,textareaElementAttributes:{style:this.getInnerTextAreaStyle()},style:this.getTextAreaStyle(),focus:"additional_input"===this.stores.store.state.step,value:this.stores.store.state.additionalFeedback,placeholder:S.default.formatMessage(N.additionalFeedbackPlaceholder),onChange:e=>{this.stores.store.setState({...this.stores.store.state,additionalFeedback:e.target.value}),y.trackEnterpriseSalesContactUpdated(this.environment,{contactFieldType:"additionalFeedback",contactFieldValue:e.target.value})}}))})),o()(this,"renderCancel",(()=>n()(Z.Z,{onClick:()=>{y.trackEnterpriseSalesContactDismissed(this.environment),this.handleCancel()},style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground}},void 0,g.Z.closeSmall({width:14,fill:this.theme.mediumTextColor})))),o()(this,"renderThanks",(()=>n()("div",{},void 0,n()("img",{style:{width:165,height:80},src:m.Z.images.feedbackThankYouPng}),n()("div",{style:this.getThanksHeaderStyle()},void 0,n()(v.FormattedMessage,{id:"enterpriseContactModal.thanks.caption",defaultMessage:"We've received your inquiry and will be contacting you via email shortly."}))))),o()(this,"handleCancel",(()=>{C.Z.setState({open:!1})}))}renderComponent(){return n()(L.Z,{preventHideChildrenWhileOpening:!0,open:C.Z.state.open,render:this.renderMenu,onDismiss:this.handleCancel})}renderStep(){const{step:e}=this.stores.store.state;return c().createElement(c().Fragment,null,n()(T.Z,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>n()(D.Z,{capture:!0,onBackspace:l().identity,onLeft:l().identity,onRight:l().identity,onSelectAll:l().identity,onRedo:l().identity,onUndo:l().identity,onCut:l().identity,onCopy:l().identity,onPaste:l().identity,onKeypress:l().identity,onDelete:l().identity,onTab:l().identity},void 0,this.renderInitial())}),n()(T.Z,{isVisible:"thanks"===e,animationStyle:this.getAnimationStyle("thanks"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}),n()(T.Z,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>n()(k.Z,{isLarge:!0,style:{marginTop:17,width:284,position:"absolute",bottom:20},onClick:()=>{const e=this.getInvalidField();if(e){const{question:t}=this.stores.store.state;this.stores.store.setState({...this.stores.store.state,step:"initial",invalidField:e,question:"other"===t?void 0:t})}else this.stores.store.setState({...this.stores.store.state,invalidField:void 0,step:"thanks"}),C.Z.state.open&&y.trackEnterpriseSalesContact(this.environment,{email:C.Z.state.email,name:C.Z.state.name,...this.stores.store.state}),l().delay((()=>{C.Z.reset(),l().delay((()=>{this.stores.store.reset()}),1e3)}),2e3)}},void 0,n()(v.FormattedMessage,{id:"enterpriseContactModal.initial.sendLabel",defaultMessage:"Send"}))}))}getName(){if(C.Z.state.open)return this.stores.store.state.name||C.Z.state.name}getEmail(){if(C.Z.state.open)return this.stores.store.state.email||C.Z.state.email}getInvalidField(){const e=this.getEmail(),t=this.getName(),{question:i,companySize:a}=this.stores.store.state;return t?e&&h.B(e,"email")?a?i?void 0:"question":"company_size":"email":"name"}getCompanySizeButtonData(){return[{type:"1_100",message:n()(v.FormattedMessage,{id:"enterpriseContactModal.initial.1_100Label",defaultMessage:"1-100"})},{type:"101_1000",message:n()(v.FormattedMessage,{id:"enterpriseContactModal.initial.101_1000Label",defaultMessage:"101-1,000"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:n()(v.FormattedMessage,{id:"enterpriseContactModal.initial.1000PlusLabel",defaultMessage:"1,001+"})}]}getThanksHeaderStyle(){return{color:this.theme.regularTextColor,fontWeight:f.Z.fontWeight.semibold,fontSize:14}}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}getInnerContainerStyle(){return{width:320,height:470,overflow:"hidden",position:"relative",padding:20,cursor:"default",textAlign:"center",justifyContent:"center"}}getLabelStyle(){return{marginTop:17,fontSize:12,color:this.theme.mediumTextColor,fontWeight:f.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}getInputStyle(){return{backgroundColor:this.theme.whiteButtonBackground,height:31}}getInvalidInputStyle(){return{border:"1px solid ".concat(p.ZP.red)}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getBaseButtonStyle(){return{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center"}}getSelectedButtonStyle(){return{color:p.ZP.blue,border:"1px solid ".concat(p.ZP.blue)}}getSlideUpStyle(){const{step:e}=this.stores.store.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(153px)":"translateY(-180px)"}}getInnerTextAreaStyle(){return{width:"100%",height:"100%",background:"none",border:"none",resize:"none"}}getTextAreaStyle(){return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:"7px 10px",height:310,marginTop:17,marginBottom:17,transition:"opacity 200ms ease-in",opacity:"additional_input"===this.stores.store.state.step?1:.001}}}const W=U},75765:(e,t,i)=>{i.r(t),i.d(t,{default:()=>J});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=i(77422),l=i.n(r),d=(i(33948),i(96486)),c=i.n(d),u=i(67294),m=i.n(u),p=i(83355),g=i(41892),h=i(43593),f=i(32056),v=i(98459),y=i(75246),S=i(5366),M=i(70630),b=i(93678),w=i(87279),C=i(98742),T=i(61766),k=i(88632),Z=i(71071),A=i(72693),I=i(48762),P=i(92660),_=i(56109),x=i(62727),F=i(71202),B=i(25584),E=i(42001),D=i(83071),R=i(20083),L=i(6202),O=i(47714),N=i(50987),U=i(92166),W=i(37235),V=i(60442),z=i(46951),G=i(42115);const H=["pdf","html","markdown"],q=["currentView","all"],K=e=>e>.1&&e<2,j=["everything","no_files"];class Y extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{includeContentsPopupStore:T.Z,exportTypePopupStore:T.Z,pdfFormatPopupStore:T.Z,collectionViewExportTypePopupStore:T.Z}),l()(this,"renderMenu",(()=>{const{device:e}=this.environment;if(!k.Z.state.online)return this.renderOffline();const t=Z.ZP.state;return t.open&&e.isMobile?this.renderMobileModal(t):t.open?this.renderDesktopModal(t):void 0})),l()(this,"handleSelectExportType",((e,t)=>{const i=Z.ZP.state;if(!i.open)return;const{exportOptions:a}=i;if(e===a.exportType)return;let n;n="pdf"===e?{...a,exportType:"pdf",pdfFormat:M.GI(t)}:{...a,exportType:e},M.BO(this.environment,{...i,exportOptions:n})})),l()(this,"handleSelectPaperFormat",(e=>{const t=Z.ZP.state;t.open&&Z.Sw(t)&&M.BO(this.environment,{...t,exportOptions:{...t.exportOptions,pdfFormat:e}})})),l()(this,"handleSelectIncludeContents",(e=>{const t=Z.ZP.state;t.open&&M.BO(this.environment,{...t,exportOptions:{...t.exportOptions,includeContents:e}})})),l()(this,"handleSelectCollectionExportType",(e=>{const t=Z.ZP.state;t.open&&M.BO(this.environment,{...t,exportOptions:{...t.exportOptions,collectionViewExportType:e}})})),l()(this,"handleToggleFlattenExportFiletree",(()=>{const e=Z.ZP.state;e.open&&M.BO(this.environment,{...e,exportOptions:{...e.exportOptions,flattenExportFiletree:!e.exportOptions.flattenExportFiletree}})})),l()(this,"handleToggleRecursive",(()=>{const e=Z.ZP.state;if(e.open){if(Z.Sw(e)&&!M.y1(this.environment))return b.y(this.environment,{from:"export_modal",for:"enterprise"}),void this.handleUpgrade();M.BO(this.environment,{...e,recursive:!e.recursive})}})),l()(this,"handleSetScalePercent",(e=>{const t=Z.ZP.state;t.open&&Z.Sw(t)&&M.BO(this.environment,{...t,exportOptions:{...t.exportOptions,scale:e}})})),l()(this,"handleCancel",(()=>{M.Qr()})),l()(this,"handleSubmit",(()=>{if(!this.canSubmit())return;const e=Z.ZP.state;e.open&&(M.Qr(),e.root.table===y.bx?M.AW(this.environment,{spaceId:e.root.id,exportOptions:e.exportOptions}):M.ZO(this.environment,{block:{id:e.root.id,spaceId:(0,v.CG)(e.root.spaceId)},recursive:e.recursive,exportOptions:e.exportOptions}))})),l()(this,"handleUpgrade",(()=>{M.Qr()}))}renderComponent(){return o()(P.Z,{onDismiss:this.handleCancel,render:this.renderMenu,requireOnline:!0,modalStore:Z.ZP})}renderOffline(){return o()("div",{style:this.getOfflineStyle()},void 0,o()(S.FormattedMessage,{defaultMessage:"Please go online to export.",id:"exportModal.offlineMessage.description"}))}renderMobileModal(e){const t={menuType:w.o.Modal,title:o()(S.FormattedMessage,{id:"exportModal.title",defaultMessage:"Export"}),right:o()(S.FormattedMessage,{id:"exportModal.closeButton.label",defaultMessage:"Close"}),onClickRight:this.handleCancel};return m().createElement(F.Z,t,o()(B.Z,{type:B.Z.Type.Vertical,initialFocus:void 0,sections:[{key:"exportOptions",render:e=>m().createElement(D.Z,e),items:this.getMobileExportOptionsMenuItems(e)},{key:"actions",render:e=>{let{children:t,...i}=e;return m().createElement(D.Z,n()({isSubmitButton:!0},i),t)},items:[{key:"submit",render:e=>{const{onClick:t,...i}=e;return m().createElement(L.Z,n()({},i,{onClick:t||this.handleSubmit,disabled:!this.canSubmit(),title:o()(S.FormattedMessage,{id:"exportModal.exportButton.label",defaultMessage:"Export"})}))},action:this.handleSubmit}]}]}))}renderDesktopModal(e){const{device:t,currentUser:i}=this.environment,a=Z.Sw(e)&&!M.y1(this.environment),s=this.environment.device.isWindows;return o()("div",{style:this.getModalWrapStyle()},void 0,o()(R.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:o()(S.FormattedMessage,{id:"exportModal.exportFormat.description",defaultMessage:"Export format"}),selectedTitle:this.getBlockExportTypeTitle(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>m().createElement(D.Z,e),items:H.map((t=>this.getBlockExportTypeMenuListItem(t,e,i.id)))}]}),e.exportOptions.collectionViewId&&o()(R.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.collectionViewExportTypePopupStore,label:o()(S.FormattedMessage,{id:"exportModal.includeDatabases.description",defaultMessage:"Include databases",description:"Shown if user is exporting a collection, to let the user select if they want to export everything in the collection or not."}),selectedTitle:this.getCollectionViewExportTypeTitle(e.exportOptions.collectionViewExportType||"currentView"),renderMenuSections:e=>[{key:"exportCollection",render:e=>m().createElement(D.Z,e),items:q.map((t=>this.getCollectionViewExportTypeMenuListItem(t,e)))}]}),o()(R.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.includeContentsPopupStore,label:o()(S.FormattedMessage,{id:"exportModal.includeContents.description",defaultMessage:"Include content"}),selectedTitle:this.getBlockIncludeContentsTitle(e.exportOptions.includeContents||"everything"),renderMenuSections:e=>[{key:"includeContents",render:e=>m().createElement(D.Z,e),items:j.map((t=>this.getIncludeContentsMenuListItem(t,e)))}]}),Z.Sw(e)&&m().createElement(m().Fragment,null,o()(R.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:o()(S.FormattedMessage,{id:"exportModal.pageFormat.description",defaultMessage:"Page format"}),selectedTitle:this.getPDFFormatTitle(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>m().createElement(D.Z,e),items:h.lJ.map((t=>this.getPaperFormatMenuListItem(t,e)))},{key:"otherPaperFormats",render:e=>m().createElement(D.Z,n()({topBorder:!0},e)),items:h.bY.map((t=>this.getPaperFormatMenuListItem(t,e)))}]}),this.renderScalePercent()),"space"!==e.root.table&&o()(G.Z,{requireUpgradeToTier:a&&"enterprise",analyticsName:"export_modal",onClick:this.handleToggleRecursive,render:(i,s)=>m().createElement("div",n()({},i,{style:{display:"flex",alignItems:"center",height:32}}),o()("div",{style:{display:"flex",alignItems:"center",marginRight:"auto",color:this.theme.lightTextColor,fontSize:14}},void 0,o()(S.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",s&&o()("div",{style:{marginLeft:8}},void 0,s)),o()(O.Z,{on:e.recursive,isAndroid:t.isAndroid,disabled:a})),renderUpgradeTooltip:()=>o()(V.Z,{imageURL:g.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:o()(S.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:o()(S.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:W.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2},onUpgradeClick:this.handleUpgrade}),o()(N.Z,{title:o()(S.FormattedMessage,{id:"exportModal.flattenExportFiletree.description",defaultMessage:"Create folders for subpages",description:"Toggle for whether or not to creates folders for each block hierarchy in recursive export"}),subtitle:"",style:{color:this.theme.lightTextColor,fontSize:14,display:"flex",alignItems:"center",marginRight:"auto",height:32},on:void 0===e.exportOptions.flattenExportFiletree?!s:!e.exportOptions.flattenExportFiletree,disabled:!e.recursive,onChange:()=>this.handleToggleFlattenExportFiletree()}),o()("div",{style:{display:"flex",alignItems:"center",marginTop:16}},void 0,o()(E.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleCancel},void 0,o()(S.FormattedMessage,{defaultMessage:"Cancel",id:"exportModal.cancelButton.label"})),o()(A.Z,{onClick:this.handleSubmit,disabled:!this.canSubmit()},void 0,o()(S.FormattedMessage,{defaultMessage:"Export",id:"exportModal.exportButton.label"}))))}renderScalePercent(){const e=this.getScalePercent();return m().createElement(m().Fragment,null,o()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",height:32}},void 0,o()(z.Z,{style:{color:this.theme.lightTextColor}},void 0,o()(S.FormattedMessage,{id:"exportModal.pageScale.description",defaultMessage:"Scale percent"})),o()(Q,{value:e,onChange:this.handleSetScalePercent})),!K(e)&&o()(U.Z,{show:!0,showDelay:500,showHold:100,render:e=>e&&o()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:32,padding:"4px 0"}},void 0,o()(z.Z,{isSmall:!0,isMultiline:!0,style:{color:this.theme.errorText}},void 0,o()(S.FormattedMessage,{id:"exportModal.pageScale.invalidScaleError",defaultMessage:"Scale percent must be a number between 10 and 200",description:"Shown if the scale percent for pdf export is outside of range."})))}))}getMobileExportOptionsMenuItems(e){const{currentUser:t,device:i}=this.environment;return c().compact([{key:"export type",render:a=>m().createElement(R.Z,n()({},a,{isMenuItem:i.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:o()(S.FormattedMessage,{defaultMessage:"Export format",id:"exportModal.exportFormat.description"}),selectedTitle:this.getBlockExportTypeTitle(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>m().createElement(D.Z,e),items:H.map((i=>this.getBlockExportTypeMenuListItem(i,e,t.id)))}]})),action:()=>{this.stores.exportTypePopupStore.setState({open:!0})}},Z.Sw(e)&&{key:"pdf format",render:t=>m().createElement(R.Z,n()({},t,{isMenuItem:i.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:o()(S.FormattedMessage,{defaultMessage:"Page format",id:"exportModal.pageFormat.description"}),selectedTitle:this.getPDFFormatTitle(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>m().createElement(D.Z,e),items:h.lJ.map((t=>this.getPaperFormatMenuListItem(t,e)))},{key:"otherPaperFormats",render:e=>m().createElement(D.Z,n()({topBorder:!0},e)),items:h.bY.map((t=>this.getPaperFormatMenuListItem(t,e)))}]})),action:()=>{this.stores.pdfFormatPopupStore.setState({open:!0})}},"space"!==e.root.table&&{key:"recursive",render:t=>{let{onClick:a,key:s,...r}=t;const l=Z.Sw(e)&&!M.y1(this.environment);return o()(G.Z,{requireUpgradeToTier:l&&"enterprise",analyticsName:"export_modal",onClick:a,render:(t,a)=>{const s=(0,C.Z)(r,t);return m().createElement(I.Z,n()({},s,{title:o()("div",{style:{display:"flex",alignItems:"center"}},void 0,o()(S.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",a&&o()("div",{style:{marginLeft:8}},void 0,a)),right:m().createElement(O.Z,n()({},s,{on:e.recursive,isAndroid:i.isAndroid,disabled:l}))}))},renderUpgradeTooltip:()=>o()(V.Z,{imageURL:g.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:o()(S.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:o()(S.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:W.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2},onUpgradeClick:this.handleUpgrade},s)},action:this.handleToggleRecursive}])}getBlockExportTypeTitle(e){switch(e){case"pdf":return o()(S.FormattedMessage,{id:"exportModal.exportFormatButton.pdf.label",defaultMessage:"PDF"});case"markdown":return o()(S.FormattedMessage,{id:"exportModal.exportFormatButton.markdownAndCSV.label",defaultMessage:"Markdown & CSV"});case"html":return o()(S.FormattedMessage,{id:"exportModal.exportFormatButton.html.label",defaultMessage:"HTML"})}}getBlockIncludeContentsTitle(e){switch(e){case"everything":return o()(S.FormattedMessage,{id:"exportModal.includeContentTypes.everything.label",defaultMessage:"Everything"});case"no_files":return o()(S.FormattedMessage,{id:"exportModal.includeContentTypes.no_files.label",defaultMessage:"No files or images"})}}getCollectionViewExportTypeTitle(e){switch(e){case"all":return o()(S.FormattedMessage,{id:"exportModal.includeDatabases.all.label",defaultMessage:"Everything",description:"Shown if user is choosing to export every page in the collection."});case"currentView":return o()(S.FormattedMessage,{id:"exportModal.includeDatabases.currentView.label",defaultMessage:"Current view",description:"Shown if user is choosing to export only the pages in the current view of the collection."})}}getPDFFormatTitle(e){switch(e){case"Letter":return o()(S.FormattedMessage,{id:"exportModal.pageFormatButton.letter.label",defaultMessage:"Letter"});case"A3":return o()(S.FormattedMessage,{id:"exportModal.pageFormatButton.a3.label",defaultMessage:"A3"});case"A4":return o()(S.FormattedMessage,{id:"exportModal.pageFormatButton.a4.label",defaultMessage:"A4"});case"Legal":return o()(S.FormattedMessage,{id:"exportModal.pageFormatButton.legal.label",defaultMessage:"Legal"});case"Tabloid":return o()(S.FormattedMessage,{id:"exportModal.pageFormatButton.tabloid.label",defaultMessage:"Tabloid"})}}getBlockExportTypeMenuListItem(e,t,i){const a=Z.ZP.state,s=a.open&&"pdf"===e&&"space"===a.root.table&&!M.y1(this.environment);return{key:e,action:()=>{if(t.close(),s)return b.y(this.environment,{from:"export_modal",for:"enterprise"}),void this.handleUpgrade();this.handleSelectExportType(e,i)},render:i=>{let{onClick:a,key:r,...l}=i;return o()(G.Z,{requireUpgradeToTier:s&&"enterprise",analyticsName:"export_modal",onClick:a,onUpgradeClick:()=>{t.close(),this.handleUpgrade()},render:(t,i)=>m().createElement(I.Z,n()({},(0,C.Z)(l,t),{title:this.getBlockExportTypeTitle(e),right:i})),renderUpgradeTooltip:()=>o()(V.Z,{imageURL:g.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:o()(S.FormattedMessage,{defaultMessage:"Upgrade to export the workspace as PDFs",id:"exportModal.workspacePdfUpgradeTooltip.title"}),caption:o()(S.FormattedMessage,{defaultMessage:"Creates a zip file containing all pages in the workspace as PDF files.",id:"exportModal.workspacePdfUpgradeTooltip.caption"})}),tooltipPlacement:W.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2}},r)}}}getIncludeContentsMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectIncludeContents(e)},render:t=>m().createElement(I.Z,n()({},t,{title:this.getBlockIncludeContentsTitle(e)}))}}getCollectionViewExportTypeMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectCollectionExportType(e)},render:t=>m().createElement(I.Z,n()({},t,{title:this.getCollectionViewExportTypeTitle(e)}))}}getPaperFormatMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectPaperFormat(e)},render:t=>m().createElement(I.Z,n()({},t,{title:this.getPDFFormatTitle(e)}))}}getScalePercent(){const e=Z.ZP.state;return e.open&&Z.Sw(e)?void 0===e.exportOptions.scale?1:e.exportOptions.scale:1}canSubmit(){return K(this.getScalePercent())}getModalWrapStyle(){return{width:320,padding:24,fontSize:14}}getOfflineStyle(){return{...this.getModalWrapStyle(),color:this.theme.mediumTextColor}}}function Q(e){let{value:t,onChange:i}=e;const a=(0,S.useIntl)(),n=m().useCallback((e=>{const t=e.target.value,a=(0,f._g)(t)||(0,f.p3)(t);let n;"object"==typeof a?n="percent"===a.format?a.value:a.value/100:"number"==typeof a&&(n=a/100),void 0!==n&&i(n)}),[i]),[s,r]=m().useState(!1),l=m().useMemo((()=>(0,f.uf)(Math.round(100*t),"number",a)),[t,a]);return o()(_.Z,{capture:s},void 0,o()(x.Z,{value:l,onChange:n,onFocus:()=>r(!0),onBlur:()=>r(!1),style:{width:60},inputStyle:{textAlign:"right"}}))}const J=Y},79027:(e,t,i)=>{i.r(t),i.d(t,{default:()=>S});var a=i(77094),n=i.n(a),s=i(77422),o=i.n(s),r=(i(33948),i(67294)),l=i(83355),d=i(41892),c=i(82990),u=i(5366),m=i(91376),p=i(17311),g=i(7844),h=i(72693),f=i(15102),v=i(33058);class y extends l.Z{constructor(){super(...arguments),o()(this,"handleModalDismiss",(()=>{g.Z.state.open&&g.Z.state.onDecline&&g.Z.state.onDecline(),g.Z.setState({open:!1})})),o()(this,"handleConnectClick",(()=>{g.Z.state.open&&g.Z.state.onConfirm(),g.Z.setState({open:!1})})),o()(this,"handleConnectedAppsClick",(()=>{this.handleModalDismiss(),m.r({currentTab:"connected_apps"})}))}renderComponent(){const{device:e}=this.environment,t=g.Z.state;return n()(f.Z,{open:t.open,innerStyle:y.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>n()(r.Fragment,{},void 0,n()("div",{style:y.modalHeaderWrapStyle},void 0,n()("img",{src:d.Z.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),n()("div",{style:this.getModalMessageStyle()},void 0,n()(u.FormattedMessage,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})),e.isMobileNative?n()("div",{style:this.getModalMessageStyle()},void 0,n()(u.FormattedMessage,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})):n()(h.Z,{isLarge:!0,onClick:this.handleConnectClick},void 0,n()(u.FormattedMessage,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})),!e.isMobile&&this.renderConnectedAccountsLink())),onDismiss:this.handleModalDismiss})}renderConnectedAccountsLink(){return n()("div",{style:{display:"block",marginTop:p.Z.vertical.tiny}},void 0,n()(v.Z,{underlined:!0,onClick:this.handleConnectedAppsClick},void 0,n()(u.FormattedMessage,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})))}getModalMessageStyle(){return{fontSize:16,lineHeight:1.5,fontWeight:c.Z.fontWeight.medium,marginTop:15,marginBottom:20,color:this.theme.mediumTextColor}}}o()(y,"wrapStyle",{padding:"24px 36px 24px",minWidth:300,maxWidth:400}),o()(y,"modalHeaderWrapStyle",{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"});const S=y},39069:(e,t,i)=>{i.r(t),i.d(t,{default:()=>qe});var a=i(77094),n=i.n(a),s=i(77422),o=i.n(s),r=(i(33948),i(67294)),l=i.n(r),d=i(83355),c=i(53397),u=i(82990),m=i(5366),p=i(50906),g=i(26111),h=i(33665),f=i(27832),v=i(47593),y=i(97464),S=i.n(y),M=i(41892),b=(i(65069),i(96486)),w=i.n(b),C=i(41432),T=i(7406);const k=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],Z=["text/plain",".md",".mdown",".markdown",".mkdn",".mkd",".Rmd",".md.txt"],A={markdown:Z,csv:["text/plain",".csv"],html:["text/html"],docx:k,gdocs:k,dropbox:k,quip:["text/html",Z],workflowy:["text/plain"],confluence:["application/zip"]};var I=i(29477),P=i(98459),_=i(21202),x=i(72340),F=i(33954),B=i(33929),E=i(17256),D=i(46190),R=i(90365),L=i(82066),O=i(80270),N=i(54642),U=i(47307),W=i(94419),V=i(92625),z=i(9953),G=i(29974),H=i(93561),q=i(53471);const K=(0,m.defineMessages)({uploadingOneFile:{id:"importActions.uploadingOneFile.loadingMessage",defaultMessage:"Uploading… ({percentComplete}%)"},uploadingMultipleFilesNotStarted:{id:"importActions.uploadingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Uploaded 0 of {totalNumberOfFiles}"},uploadingMultipleFilesInProgress:{id:"importActions.uploadingMultipleFilesInProgress.loadingMessage",defaultMessage:"Uploaded {numberOfUploadedFiles} of {totalNumberOfFiles}"},uploadingMultipleFilesComplete:{id:"importActions.uploadingMultipleFilesComplete.loadingMessage",defaultMessage:"Uploaded {totalNumberOfFiles} of {totalNumberOfFiles}"},importingOneFile:{id:"importActions.importingOneFile.loadingMessage",defaultMessage:"Importing…"},importingMultipleFilesNotStarted:{id:"importActions.importingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Imported 0 of {totalNumberOfFiles}"},importingMultipleFilesInProgress:{id:"importActions.importingMultipleFilesInProgress.loadingMessage",defaultMessage:"Imported {numberOfImportedFiles} of {totalNumberOfFiles}"},importingMultipleFilesComplete:{id:"importActions.importingMultipleFilesComplete.loadingMessage",defaultMessage:"Imported {totalNumberOfFiles} of {totalNumberOfFiles}"},importingFromTrelloMessage:{id:"importActions.importingFromTrello.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} board from Trello} other {Importing {importingCount} boards from Trello}}"},importingFromAsanaMessage:{id:"importActions.importingFromAsana.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} project from Asana} other {Importing {importingCount} projects from Asana}}"},importingFromEvernoteMessage:{id:"importActions.importingFromEvernote.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} notebook from Evernote} other {Importing {importingCount} notebooks from Evernote}}"},importFailed:{id:"importActions.importFailedError.message",defaultMessage:"Import failed."},fileImportFailedSizeTooLarge:{id:"importActions.fileImportFailedError.sizeTooLarge.message",defaultMessage:"Import failed: file exceeds 5MB.",description:"importFile failure message when file exceeds 5MB"},trelloImportFailed:{id:"importActions.trelloImportFailedError.message",defaultMessage:"Trello import failed."},asanaImportFailed:{id:"importActions.asanaImportFailedError.message",defaultMessage:"Asana import failed."},evernoteImportFailed:{id:"importActions.evernoteImportFailedError.message",defaultMessage:"Evernote import failed."},importTitle:{id:"importActions.importTitle",defaultMessage:"Import {date}",description:"'Import' is a noun"}});function j(e){const{environment:t,spaceStore:i,spaceViewStore:a}=e,{performResult:n}=H.createAndCommit({userAction:"importActions.result",environment:t,perform:e=>{const n=B.default.formatMessage(K.importTitle,{date:(0,E.Z)().format("ll")}),s=G.KE({environment:t,spaceStore:i,spaceViewStore:a,isPrivate:!0,prepend:!0,title:"".concat(n," Logs"),transaction:e}),o=I.UZ();return e.postSubmitCallbacks.push((e=>{e?o.reject(e):o.resolve()})),{deferred:o,pageId:s.id}}});return n}async function Y(e){const{environment:t,spaceStore:i,spaceViewStore:a,notebooks:n,userSettingsStore:s}=e;if(0===n.length)throw new Error("Expected at least one notebook");V.j({message:K.importingFromEvernoteMessage,interpolatedValues:{importingCount:n.length}}),R.Z.setState({open:!1});const o=await async function(e){const{environment:t,spaceStore:i,spaceViewStore:a,notebooks:n}=e,{serverCommitResult:s,performResult:{blockStores:o}}=H.createAndCommit({userAction:"importActions.createStacks",environment:t,perform:e=>{const s=w().uniq(w().compact(n.map((e=>e.stack)))).sort().reverse(),o={};let r=e=>!0;return n.length>1&&s.length>0&&(s.forEach((s=>{const r=G.KE({environment:t,spaceStore:i,spaceViewStore:a,isPrivate:!0,prepend:!0,loading:!1,title:s,transaction:e}),l=r.getContentStore();n.filter((e=>e.stack===s)).forEach((i=>{const a=z.j4({environment:t,type:C.ZP.copyIndicator,inMemoryRecordCache:r.inMemoryRecordCache,transaction:e,spaceId:l.pointer.spaceId});W.R3({parent:l,append:a,transaction:e}),o[i.guid]=a}))})),r=e=>!Boolean(e.stack)),n.filter(r).reverse().forEach((n=>{const s=G.KE({environment:t,spaceStore:i,spaceViewStore:a,isPrivate:!0,prepend:!0,loading:!0,title:n.title,transaction:e});o[n.guid]=s})),{blockStores:o}}});return await s,o}({environment:t,spaceStore:i,spaceViewStore:a,notebooks:n}),r=o[n[0].guid];try{return await async function(e){const{environment:t,spaceStore:i,spaceViewStore:a,notebooks:n,waitForNotebook:s,notebookMapping:o,userSettingsStore:r}=e;let l;if(I.dC(n,2,(async e=>{await Promise.all(e.map((async e=>{const i=o[e.guid];if(!i)throw new Error("Missing notebook page ".concat(e.guid));const a=I.UZ();i===s&&(l=a),await async function(e){const{environment:t,notebookStore:i,notebook:a,firstCompleted:n}=e,s=N.importEvernote(t,{notebookId:a.guid,block:{id:i.id,spaceId:(0,P.CG)(i.pointer.spaceId)},timestamp:Date.now(),parentTable:_.iU}),{value:o}=await s.next();if(o.error)throw console.error(o.error),H.createAndCommit({userAction:"importActions.importEvernoteNotebook",environment:t,perform:e=>{const t=i.getParentBlockStore();if(t){const a=t.getContentStore();W.Od({parent:a,remove:i,transaction:e})}}}),o.error;n.resolve(void 0)}({environment:t,notebookStore:i,notebook:e,firstCompleted:a})})))})),!l)throw new Error("waitForNotebookFirstCompleted not defined.");const d=r.getSettings();null!=d&&d.created_evernote_getting_started||await G.FI({environment:t,type:"evernote",spaceStore:i,spaceViewStore:a,userSettingsStore:r});await l.promise}({environment:t,waitForNotebook:r,notebookMapping:o,notebooks:n,spaceStore:i,spaceViewStore:a,userSettingsStore:s}),V.x(),r}catch(l){throw U.showErrorMessage(B.default.formatMessage(K.evernoteImportFailed)),V.x(),l}}async function Q(e){const t=await N.getTrelloBoards(e,{});return"success"===t.type?t.data:(console.error(t.error),{boards:[]})}async function J(e){const t=await N.getAsanaWorkspaces(e,{});if("success"===t.type){const{account:e}=t.data;return e?t.data:{workspaces:[],projects:{}}}return console.error(t.error),{workspaces:[],projects:{}}}async function X(e){try{const t=await N.getEvernoteNotebooks(e,{});if("success"===t.type){const{notebooks:e,userInfo:i}=t.data;return{notebooks:e,userInfo:i}}return console.error(t.error),{notebooks:[],userInfo:void 0}}catch(t){return console.error(t),{notebooks:[],userInfo:void 0}}}var $=i(88632),ee=i(72087),te=i(51582),ie=i(46167),ae=i(8848),ne=i(14947);class se extends d.Z{renderComponent(){const{title:e,actionButton:t,onClick:i}=this.props;return n()(ne.Z,{onClick:i,style:this.getButtonStyle()},void 0,this.renderIcon(),n()("div",{style:{minWidth:0,width:"100%"}},void 0,n()("div",{style:{display:"flex"}},void 0,n()("div",{style:se.titleStyle},void 0,e),n()("div",{style:{marginLeft:"auto"}},void 0,t)),this.renderCaption()))}renderIcon(){const{icon:e,logo:t}=this.props;return t?n()("img",{style:se.imageIconStyle,src:t}):e?n()("div",{style:this.getIconWrapStyle()},void 0,e(this.getIconStyle())):void 0}renderCaption(){const{caption:e}=this.props;if(e)return n()("div",{style:this.getCaptionStyle()},void 0,e)}getButtonStyle(){return{display:"flex",alignItems:"center",padding:10,paddingRight:8,borderRadius:3,marginBottom:12,cursor:"pointer",boxShadow:this.theme.lightBoxShadow,transition:"background 200ms ease-out",background:this.theme.importOptionsButtonBackground}}getIconWrapStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",width:se.iconSize,height:se.iconSize,borderRadius:3,marginRight:8,color:this.theme.mediumTextColor,background:this.theme.importOptionsIconWrapBackground}}getIconStyle(){return{flexShrink:0,width:se.iconSize,height:se.iconSize}}getCaptionStyle(){return{fontSize:12,color:this.theme.mediumTextColor,wordBreak:"keep-all",...!this.props.shouldWrapCaption&&{...u.Z.textOverflowStyle}}}}o()(se,"iconSize",28),o()(se,"imageIconStyle",{flexShrink:0,width:se.iconSize,height:se.iconSize,borderRadius:3,marginRight:10,background:ae.ZP.white}),o()(se,"titleStyle",{fontSize:16,fontWeight:u.Z.fontWeight.medium});const oe=se;var re=i(31942),le=i(82970),de=i(49085);class ce extends de.Z{getInitialState(){return{searchQuery:"",selection:new Set}}}const ue=ce;var me=i(72693),pe=i(48762);class ge extends d.Z{renderComponent(){return n()("div",{style:this.getStyle()},void 0,"·")}getStyle(){return{display:"inline-block",textAlign:"center",color:this.props.disabled?this.theme.lightTextColor:this.theme.mediumTextColor,userSelect:"none",WebkitUserSelect:"none",width:8}}}const he=ge;var fe=i(73581),ve=i(71202),ye=i(86646),Se=i(25584),Me=i(16328),be=i(83071),we=i(33058),Ce=i(46951);class Te extends d.Z{constructor(){super(...arguments),o()(this,"storeTypes",{store:ue}),o()(this,"handleSelectAllClick",(()=>{const{sections:e,analyticsName:t}=this.props,{store:i}=this.stores,{selection:a}=i.state;for(const n of e)for(const e of n.items)a.add(e.key);i.emit(),p.trackIntegrationSelectAll(this.environment,{integration_name:t})})),o()(this,"handleDeselectAllClick",(()=>{const{analyticsName:e}=this.props,{store:t}=this.stores,{selection:i}=t.state;i.clear(),t.emit(),p.trackIntegrationDeselectAll(this.environment,{integration_name:e})})),o()(this,"handleToggleItem",(e=>{const{analyticsName:t}=this.props,{store:i}=this.stores,{selection:a}=i.state;a.has(e.key)?(a.delete(e.key),p.trackIntegrationSelectItem(this.environment,{integration_name:t})):(a.add(e.key),p.trackIntegrationDeselectItem(this.environment,{integration_name:t})),i.emit()})),o()(this,"handleImport",(()=>{const{sections:e}=this.props,{selection:t}=this.stores.store.state,i=w().flatten(e.map((e=>e.items))),a=[];t.forEach((e=>{const t=i.find((t=>t.key===e));t&&a.push(t)})),this.props.onComplete(a)}))}willMount(e){const t=this.stores.store.state.selection,[i]=e.sections;if(i){const[e]=i.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return n()(ve.Z,{menuType:ve.Z.MenuType.Popup,header:this.renderMenuHeader(),footer:this.renderMenuFooter(),width:280,maxHeight:350},void 0,this.renderMenuList())}renderMenuHeader(){const{searchInputPlaceholder:e}=this.props,{searchQuery:t}=this.stores.store.state,i=Boolean(t);return n()(be.Z,{isInput:!0,desktopStyle:{paddingBottom:2}},void 0,n()(fe.Z,{focus:!0,focusAfterAnimation:!0,value:t,onChange:e=>{const{store:t}=this.stores;t.setState({...t.state,searchQuery:e.target.value})},placeholder:e}),n()(ye.Z,{isTokenTitle:!0,style:{marginTop:2},title:n()("div",{style:{marginLeft:-3}},void 0,n()(we.Z,{onClick:this.handleSelectAllClick,disabled:i,disabledFeedback:!0},void 0,n()(m.FormattedMessage,{id:"importPopup.selectAll",defaultMessage:"Select all"})),n()(he,{disabled:i}),n()(we.Z,{onClick:this.handleDeselectAllClick,disabled:i,disabledFeedback:!0},void 0,n()(m.FormattedMessage,{id:"importPopup.deselectAll",defaultMessage:"Deselect all"})))}))}renderMenuFooter(){const e=0===this.stores.store.state.selection.size;return n()(be.Z,{topBorder:!0,desktopStyle:{paddingTop:8,paddingBottom:8}},void 0,n()(ye.Z,{title:n()(me.Z,{disabled:e,onClick:this.handleImport},void 0,n()(m.FormattedMessage,{id:"integrationImportPopup.importButton.label",defaultMessage:"Import"}))}))}renderMenuList(){const{sections:e,noSearchResultsPlaceholder:t}=this.props,{store:i}=this.stores,{searchQuery:a,selection:s}=i.state,o=e.map((e=>{const t=(0,re.ZP)(a,e.items,(t=>"".concat(t.name," ").concat(e.name)));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===o.length)return n()(be.Z,{},void 0,n()(Me.Z,{title:t}));const r=o.map((t=>({key:t.name,render:i=>l().createElement(be.Z,S()({},i,{title:e.length>1?t.name:void 0})),items:t.items.map((e=>{const t=()=>this.handleToggleItem(e);return{key:e.key,render:i=>l().createElement(pe.Z,S()({},i,{title:e.name,icon:n()(le.Z,{checked:s.has(e.key),size:16,onClick:t}),right:void 0!==e.count&&n()(Ce.Z,{isSmall:!0},void 0,e.count)})),action:t}}))})));return n()(Se.Z,{type:Se.Z.Type.Vertical,initialFocus:void 0,sections:r})}}const ke=Te;class Ze extends d.Z{constructor(){super(...arguments),o()(this,"handleClickImportAsana",(()=>{p.trackClickImportButton(this.environment,{import_source:"asana",from:this.props.analyticsFrom})})),o()(this,"handleAsanaAuth",(async()=>{await te.w({environment:this.environment,requestStore:this.props.requestStore})})),o()(this,"handleRemoveAsana",(async()=>{await N.disconnectAsana(this.environment,{}),await this.props.requestStore.refresh(),p.trackRemoveIntegration(this.environment,{integration_name:"asana"})})),o()(this,"handleImportAsanaComplete",(async(e,t)=>{const i=w().flatten(w().values(e.projects)).filter((e=>Boolean(t.find((t=>t.key===e.gid.toString())))));p.trackImportIntegration(this.environment,{integration_name:"asana",count:t.length});const a=await async function(e){const{environment:t,projects:i,spaceStore:a,spaceViewStore:n}=e;V.j({message:K.importingFromAsanaMessage,interpolatedValues:{importingCount:i.length}}),D.Z.setState({open:!1});const{serverCommitResult:s,performResult:{pages:o}}=H.createAndCommit({userAction:"importActions.importAsana",environment:t,perform:e=>({pages:i.map((i=>G.KE({environment:t,spaceStore:a,spaceViewStore:n,isPrivate:!0,prepend:!0,loading:!0,title:i.name,transaction:e})))})});await s;try{return await Promise.all(o.map((async(e,a)=>{const n=i[a],{value:s}=await N.importAsana(t,{block:{id:e.id,spaceId:(0,P.CG)(e.pointer.spaceId)},projectId:n.gid}).next();if(s.error)throw s.error}))),V.x(),o[0]}catch(r){throw H.createAndCommit({userAction:"importActions.importAsana",environment:t,perform:e=>{for(const t of o)W.Od({parent:a.getPagesStore(),remove:t,transaction:e})}}),U.showErrorMessage(B.default.formatMessage(K.asanaImportFailed)),V.x(),new Error((0,T.tg)(r).message)}}({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,projects:i});this.props.onComplete(a)}))}renderComponent(){const{asanaResult:e,intl:t}=this.props,{account:i,workspaces:a,projects:s}=e,o=a.map((e=>{const t=s[e.gid]||[];return{key:e.gid.toString(),name:e.name,items:t.map((e=>({key:e.gid.toString(),name:e.name})))}})),r={title:"Asana",logo:M.Z.images.import.asanaPng,caption:i&&i,actionButton:i&&this.props.renderItemActionsButton([{name:t.formatMessage({id:"asanaImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>D.Z.setState({open:!0})},{name:t.formatMessage({id:"asanaImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleAsanaAuth},{name:t.formatMessage({id:"asanaImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveAsana}]),onClick:()=>{}},{device:d}=this.environment;return n()(ie.Z,{popupType:d.isMobile?ie.Z.PopupType.SlideUp:ie.Z.PopupType.Popup,buttonPopupStore:D.Z,onClick:this.handleClickImportAsana,render:()=>n()(ke,{searchInputPlaceholder:t.formatMessage({id:"asanaImportOption.search.placeholder",defaultMessage:"Search for a project…",description:"'Project' is an Asana term."}),noSearchResultsPlaceholder:t.formatMessage({id:"asanaImportOption.search.noResultsPlaceholder",defaultMessage:"No projects",description:"'Project' is an Asana term."}),analyticsName:"asana",sections:o,onComplete:t=>this.handleImportAsanaComplete(e,t)}),renderOrigin:e=>{let{onClick:t}=e;return l().createElement(oe,S()({},r,{onClick:i?t:this.handleAsanaAuth}))}})}}const Ae=(0,m.injectIntl)(Ze);var Ie=i(83805),Pe=i(78291);class _e extends d.Z{constructor(){super(...arguments),o()(this,"handleClickImportEvernote",(()=>{p.trackClickImportButton(this.environment,{import_source:"evernote",from:this.props.analyticsFrom})})),o()(this,"handleRemoveEvernote",(async()=>{await N.disconnectEvernote(this.environment,{}),await this.props.requestStore.refresh(),p.trackRemoveIntegration(this.environment,{integration_name:"evernote"})})),o()(this,"handleEvernoteAuth",(async()=>{await Ie.e({environment:this.environment,requestStore:this.props.requestStore})})),o()(this,"handleImportEvernoteComplete",(async(e,t)=>{const{notebooks:i}=e,a=i.filter((e=>Boolean(t.find((t=>t.key===e.guid)))));p.trackImportIntegration(this.environment,{integration_name:"evernote",count:t.length});const n=await Y({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore,notebooks:a});this.props.onComplete(n)})),o()(this,"handleEvernoteHelpClick",(()=>{g.navigateToExternalURL({environment:this.environment,url:(0,h.UY)("guides.importEvernote")})}))}renderComponent(){const{device:e}=this.environment,{evernoteResult:t,intl:i}=this.props,{userInfo:a,notebooks:s}=t,o=w().groupBy(s,(e=>e.stack||"")),r=Object.keys(o).map((e=>{const t=e||"Top-Level";return{key:t,name:t,items:(o[e]||[]).map((e=>({key:e.guid,name:e.title,count:e.noteCount})))}})),{data:d}=Pe.default.state,c=Boolean(d&&d.credits.find((e=>"import_evernote"===e.type&&e.activated))),u={title:"Evernote",logo:M.Z.images.import.evernotePng,shouldWrapCaption:!a&&!c,caption:a?a.name||a.username||a.email:c?void 0:i.formatMessage({id:"evernoteImportOption.caption.getCredit",defaultMessage:"Get $5 in credit on import"}),actionButton:a?this.props.renderItemActionsButton([{name:i.formatMessage({id:"evernoteImportOption.actionsMenu.learnMore",defaultMessage:"Learn more"}),action:this.handleEvernoteHelpClick},{name:i.formatMessage({id:"evernoteImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>R.Z.setState({open:!0})},{name:i.formatMessage({id:"evernoteImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleEvernoteAuth},{name:i.formatMessage({id:"evernoteImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveEvernote}]):this.props.defaultActionButton,onClick:()=>{}};return n()(ie.Z,{popupType:e.isMobile?ie.Z.PopupType.SlideUp:ie.Z.PopupType.Popup,buttonPopupStore:R.Z,onClick:this.handleClickImportEvernote,render:()=>n()(ke,{searchInputPlaceholder:i.formatMessage({id:"evernoteImportOption.search.placeholder",defaultMessage:"Search for a notebook…",description:"'Notebook' is an Evernote term."}),noSearchResultsPlaceholder:i.formatMessage({id:"evernoteImportOption.search.noResultsPlaceholder",defaultMessage:"No notebooks",description:"'Notebook' is an Evernote term."}),analyticsName:"evernote",sections:r,onComplete:e=>this.handleImportEvernoteComplete(t,e)}),renderOrigin:e=>{let{onClick:t}=e;return l().createElement(oe,S()({},u,{onClick:a?t:this.handleEvernoteAuth}))}})}}const xe=(0,m.injectIntl)(_e);var Fe=i(80527),Be=i(86512),Ee=i(68932),De=i(66722),Re=i(7765),Le=i(37235),Oe=i(52192);class Ne extends d.Z{constructor(){super(...arguments),o()(this,"handleClickImportTrello",(()=>{p.trackClickImportButton(this.environment,{import_source:"trello",from:this.props.analyticsFrom})})),o()(this,"handleTrelloAuth",(async()=>{await Oe.M({environment:this.environment,requestStore:this.props.requestStore})})),o()(this,"handleRemoveTrello",(async()=>{await N.disconnectTrello(this.environment,{}),await this.props.requestStore.refresh(),p.trackRemoveIntegration(this.environment,{integration_name:"trello"})})),o()(this,"handleImportTrelloComplete",(async(e,t)=>{const{boards:i}=e,a=i.filter((e=>Boolean(t.find((t=>t.key===e.id)))));p.trackImportIntegration(this.environment,{integration_name:"trello",count:t.length});const n=await async function(e){const{environment:t,boards:i,spaceStore:a,spaceViewStore:n}=e;V.j({message:K.importingFromTrelloMessage,interpolatedValues:{importingCount:i.length}}),L.Z.setState({open:!1});const{performResult:{deferred:s,pages:o}}=H.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{const s=i.map((i=>G.KE({environment:t,spaceStore:a,spaceViewStore:n,isPrivate:!0,prepend:!0,loading:!0,title:i.name,transaction:e}))),o=I.UZ();return e.postSubmitCallbacks.push((e=>{e?o.reject(e):o.resolve()})),{deferred:o,pages:s}}});await s.promise;try{return await Promise.all(o.map((async(e,a)=>{const n=i[a],{value:s}=await N.importTrello(t,{boardId:n.id,block:{id:e.id,spaceId:(0,P.CG)(e.pointer.spaceId)}}).next();if(s.error)throw s.error}))),V.x(),o[0]}catch(r){throw H.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{for(const t of o)W.Od({parent:a.getPagesStore(),remove:t,transaction:e})}}),U.showErrorMessage(B.default.formatMessage(K.trelloImportFailed)),V.x(),new Error((0,T.tg)(r).message)}}({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,boards:a});this.props.onComplete(n)}))}renderComponent(){const{device:e}=this.environment,{trelloResult:t,intl:i}=this.props,{account:a,boards:s}=t,o={key:"default",name:i.formatMessage({id:"trelloImportOption.boardProperty.defaultName",defaultMessage:"Boards"}),items:s.map((e=>({key:e.id,name:e.name})))},r={title:"Trello",logo:M.Z.images.import.trelloPng,actionButton:a&&this.props.renderItemActionsButton([{name:i.formatMessage({id:"trelloImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>L.Z.setState({open:!0})},{name:i.formatMessage({id:"trelloImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleTrelloAuth},{name:i.formatMessage({id:"trelloImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveTrello}]),onClick:()=>{}};return n()(ie.Z,{popupType:e.isMobile?ie.Z.PopupType.SlideUp:ie.Z.PopupType.Popup,buttonPopupStore:L.Z,onClick:this.handleClickImportTrello,render:()=>n()(ke,{searchInputPlaceholder:i.formatMessage({id:"trelloImportOption.search.placeholder",defaultMessage:"Search for a board…",description:"'Board' is a Trello term."}),noSearchResultsPlaceholder:i.formatMessage({id:"trelloImportOption.search.noResultsPlaceholder",defaultMessage:"No boards",description:"'Board' is a Trello term."}),analyticsName:"trello",sections:[o],onComplete:e=>this.handleImportTrelloComplete(t,e)}),renderOrigin:e=>{let{onClick:t}=e;return l().createElement(oe,S()({},r,{onClick:a?t:this.handleTrelloAuth}))}})}}const Ue=(0,m.injectIntl)(Ne);class We extends d.Z{constructor(){super(...arguments),o()(this,"storeTypes",{trelloRequestStore:ee.Z,asanaRequestStore:ee.Z,evernoteRequestStore:ee.Z}),o()(this,"handleFileUploadClick",(async e=>{p.trackClickImportButton(this.environment,{import_source:e,from:this.props.analyticsFrom});const t=await async function(e){const{environment:t,pageStore:i,spaceStore:a,isTeamPage:n,spaceViewStore:s,uploadType:o}=e;let r;try{const e=await q.y({multiple:!0,accept:A[o].join(",")});if(0===e.length)return;const l=1===e.length,d=await new Promise(((i,a)=>{q.IL({environment:t,uploadType:o,files:e,bucket:"temporary",preventLimitFreeFileSize:!0,onBatchStart:()=>{V.j({message:l?K.uploadingOneFile:K.uploadingMultipleFilesNotStarted,interpolatedValues:{totalNumberOfFiles:e.length,percentComplete:0}})},onBatchProgress:t=>{let{uploadedFiles:i,progressPercent:a}=t;V.j({message:l?K.uploadingOneFile:K.uploadingMultipleFilesInProgress,interpolatedValues:{numberOfUploadedFiles:i,totalNumberOfFiles:e.length,percentComplete:a}})},onBatchComplete:t=>{V.j({message:l?K.uploadingOneFile:K.uploadingMultipleFilesComplete,interpolatedValues:{totalNumberOfFiles:e.length,percentComplete:100}}),i(t)},onBatchError:a})}));let c,u;if(i&&i.isEmptyPage())e.length>1||i.isInsideCollection()?(c=i.id,u="AppendToBlock"):(c=i.id,u="ReplaceBlock");else{const{performResult:i}=H.createAndCommit({userAction:"importActions.result",environment:t,perform:i=>{const o=B.default.formatMessage(K.importTitle,{date:(0,E.Z)().format("ll")}),r=G.KE({environment:t,spaceStore:a,spaceViewStore:s,isPrivate:!n,prepend:!n,title:o,transaction:i});let l;l=e.length>1?"AppendToBlock":"ReplaceBlock";const d=I.UZ();return i.postSubmitCallbacks.push((e=>{e?d.reject(e):d.resolve()})),{deferred:d,createdPage:r,pageId:r.id,importType:l}}});r=i.createdPage,c=i.pageId,u=i.importType,await i.deferred.promise}const m=d.map(((t,i)=>({fileURL:t,fileName:e[i].name})));let p=0;V.j({message:l?K.importingOneFile:K.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:p,totalNumberOfFiles:e.length}});for(const{fileURL:i,fileName:n}of m){if("confluence"===o){let e;if((0,x.f)(t)){const i=j({environment:t,spaceStore:a,spaceViewStore:s});await i.deferred.promise,e=i.pageId}const o=N.importConfluenceExport(t,{fileURL:i,fileName:n,page:{id:c,spaceId:a.id},...e&&{loggerPageId:e}});for await(const t of o){if(t.error)throw t.error;t.value.isComplete||V.j(t.value.status)}}else if("AppendToBlock"===u){const{value:e}=await N.importFile(t,{fileURL:i,fileName:n,importType:u,block:{id:c,spaceId:a.id}}).next();if(e.error)throw e.error}else if("ReplaceBlock"===u){const{value:e}=await N.importFile(t,{fileURL:i,fileName:n,importType:u,block:{id:c,spaceId:a.id}}).next();if(e.error)throw e.error}p++,V.j({message:l?K.importingOneFile:K.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:p,totalNumberOfFiles:e.length}})}return V.x(),O.Z.createChildStore(a,{table:_.iU,id:c})}catch(l){let e;throw V.x(),H.createAndCommit({userAction:"importActions.importFiles",environment:t,perform:e=>{r&&W.Od({parent:a.getPagesStore(),remove:r,transaction:e})}}),e=l instanceof T.hm&&l.clientData&&l.clientData.type&&F.zP[l.clientData.type]?B.default.formatMessage(F.zP[l.clientData.type],l.clientData.messageValues):"ImportFileSizeTooLargeError"===(0,T.tg)(l).message?B.default.formatMessage(K.fileImportFailedSizeTooLarge):B.default.formatMessage(K.importFailed),U.showErrorMessage(e),l}}({environment:this.environment,pageStore:this.props.pageStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,uploadType:e});t&&this.props.onComplete(t)}))}renderComponent(){if(!$.Z.state.online)return n()("div",{style:{...We.wrapStyle,fontSize:14,color:this.theme.mediumTextColor}},void 0,n()(m.FormattedMessage,{id:"importOptions.offlineErrorMessage",defaultMessage:"Please go online to import."}));const{analyticsFrom:e}=this.props;return this.renderRequests((t=>t?n()("div",{style:We.wrapStyle},void 0,this.renderOptions(t)):n()("div",{style:"onboarding"===e?{}:We.wrapStyle},void 0,n()(Ee.Z,{}))))}renderOptions(e){return n()("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"}},void 0,this.renderEvernoteImportOption(e.evernoteResult),this.renderTrelloImportOption(e.trelloResult),this.renderAsanaImportOption(e.asanaResult),this.renderConfluenceImportOption(),n()(oe,{title:n()(m.FormattedMessage,{id:"importOptions.textMarkdown.title",defaultMessage:"Text & Markdown",description:"Button title for importing plain text and/or Markdown content into Notion"}),icon:c.Z.importText,onClick:()=>this.handleFileUploadClick("markdown")}),n()(oe,{title:"CSV",icon:c.Z.importCSV,onClick:()=>this.handleFileUploadClick("csv")}),n()(oe,{title:"HTML",icon:c.Z.importHTML,onClick:()=>this.handleFileUploadClick("html")}),n()(oe,{title:"Word",logo:M.Z.images.import.wordPng,onClick:()=>this.handleFileUploadClick("docx")}),n()(oe,{title:"Google Docs",logo:M.Z.images.import.googleDocsPng,actionButton:this.renderHelpButtonToURL((0,h.UY)("guides.importGoogleDocs")),onClick:()=>this.handleFileUploadClick("gdocs")}),n()(oe,{title:"Dropbox Paper",logo:M.Z.images.import.dropboxPaperPng,actionButton:this.renderHelpButtonToURL((0,h.UY)("guides.importDropboxPaper")),onClick:()=>this.handleFileUploadClick("dropbox")}),n()(oe,{title:"Quip",logo:M.Z.images.import.quipPng,actionButton:this.renderHelpButtonToURL((0,h.UY)("guides.importQuip")),onClick:()=>this.handleFileUploadClick("quip")}),n()(oe,{title:"Workflowy",logo:M.Z.images.import.workflowyPng,actionButton:this.renderHelpButtonToURL((0,h.UY)("guides.importWorkflowy")),onClick:()=>this.handleFileUploadClick("workflowy")}))}renderRequests(e){return n()(Re.Z,{request:this.environment,performRequest:Q,requestStore:this.stores.trelloRequestStore,render:(t,i)=>n()(Re.Z,{request:this.environment,performRequest:J,requestStore:this.stores.asanaRequestStore,render:(t,a)=>n()(Re.Z,{request:this.environment,performRequest:X,requestStore:this.stores.evernoteRequestStore,render:(t,n)=>e(i&&a&&n?{trelloResult:i,asanaResult:a,evernoteResult:n}:void 0)})})})}renderTrelloImportOption(e){return n()(Ue,{trelloResult:e,analyticsFrom:this.props.analyticsFrom,renderItemActionsButton:this.renderItemActionsButton,onComplete:this.props.onComplete,requestStore:this.stores.trelloRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderAsanaImportOption(e){return n()(Ae,{asanaResult:e,analyticsFrom:"onboarding",renderItemActionsButton:this.renderItemActionsButton,onComplete:this.props.onComplete,requestStore:this.stores.asanaRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderConfluenceImportOption(){return n()(oe,{title:"Confluence",logo:M.Z.images.import.confluencePng,onClick:()=>this.handleFileUploadClick("confluence"),actionButton:this.renderHelpButtonToURL((0,h.UY)("guides.importConfluence"))})}renderEvernoteImportOption(e){return n()(xe,{evernoteResult:e,analyticsFrom:"onboarding",renderItemActionsButton:this.renderItemActionsButton,defaultActionButton:this.renderHelpButtonToURL((0,h.UY)("guides.importEvernote")),onComplete:this.props.onComplete,requestStore:this.stores.evernoteRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderHelpButtonToURL(e){return n()(Le.Z,{renderTooltip:()=>n()(m.FormattedMessage,{id:"importOptions.helpButton.tooltip",defaultMessage:"Learn about how to import"}),render:t=>l().createElement(Be.Z,S()({external:!0,href:e,style:{marginLeft:"auto"}},t),n()(Fe.Z,{icon:c.Z.help}))})}renderItemActionsButton(e){return n()(ie.Z,{popupType:De.kQ.Popup,renderOrigin:e=>l().createElement(Fe.Z,S()({icon:c.Z.dots},e)),render:t=>{const i={key:"section",render:e=>l().createElement(be.Z,e),items:e.map((e=>{let{name:i,action:a}=e;return{key:i,render:e=>l().createElement(pe.Z,S()({},e,{title:i})),action:()=>{a(),t.close()}}}))};return n()(ve.Z,{menuType:ve.Z.MenuType.Popup,width:200},void 0,n()(Se.Z,{type:Se.Z.Type.Vertical,initialFocus:void 0,sections:[i]}))}})}}o()(We,"wrapStyle",{display:"flex",alignItems:"center",justifyContent:"center",width:752,minHeight:240}),o()(We,"optionsColumnStyle",{width:240});const Ve=We;var ze=i(15102),Ge=i(42001);class He extends d.Z{constructor(){super(...arguments),o()(this,"handleModalDismiss",(()=>{v.Z.setState({open:!1})})),o()(this,"handleImportComplete",(e=>{v.Z.setState({open:!1}),g.navigateToBlock({environment:this.environment,store:e})}))}renderComponent(){const e=v.Z.state;return n()(ze.Z,{open:e.open,innerStyle:He.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>n()(r.Fragment,{},void 0,n()("div",{style:He.modalTopbarWrapStyle},void 0,n()("div",{style:He.modalTopbarHeaderStyle},void 0,n()(m.FormattedMessage,{id:"importModal.importButton.label",defaultMessage:"Import"})),this.renderHelpButton()),n()("div",{},void 0,this.renderImportOptions(e))),onDismiss:this.handleModalDismiss})}renderHelpButton(){return n()(Be.Z,{href:(0,h.UY)("guides.import"),onClick:()=>p.trackClickHelpButton(this.environment,{from:"import"}),external:!0},void 0,n()(Ge.Z,{isSmall:!0,icon:c.Z.help,isGray:!0},void 0,n()(m.FormattedMessage,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})))}renderImportOptions(e){const{mainEditorCurrentBlockStore:t,currentSpaceStore:i,currentSpaceViewStore:a,currentUserSettingsStore:s}=f.default.state;if(t&&i&&a&&s)return n()(Ve,{pageStore:e.open&&e.pageStore?e.pageStore:t,spaceStore:i,spaceViewStore:a,userSettingsStore:s,analyticsFrom:"modal",onComplete:this.handleImportComplete,readOnlyCreditButton:!1})}}o()(He,"wrapStyle",{padding:"24px 36px 24px",minWidth:300}),o()(He,"modalTopbarWrapStyle",{display:"flex",alignItems:"center",marginTop:8,marginBottom:18}),o()(He,"modalTopbarHeaderStyle",{fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:u.Z.fontWeight.bold,marginRight:"auto"});const qe=He},21523:(e,t,i)=>{i.d(t,{Z:()=>h});var a=i(77094),n=i.n(a),s=(i(67294),i(83355)),o=i(53397),r=i(5366),l=i(50906),d=i(33665),c=i(23537),u=i(86512),m=i(42001),p=i(46951);class g extends s.Z{renderComponent(){const{device:e,WindowSizeStore:t}=this.environment;return n()(u.Z,{href:(0,d.UY)("guides.sharing"),onClick:()=>l.trackClickHelpButton(this.environment,{from:"sharing"}),style:{width:e.isMobile?"100%":void 0},external:!0},void 0,n()(m.Z,{mobileFeedback:e.isMobile,isSmall:!0,style:{display:"flex",alignItems:"center",width:e.isMobile?"100%":void 0,height:e.isMobile?44:24,paddingTop:e.isMobile?12:4,paddingBottom:e.isMobile?12:4,paddingLeft:t.getSafePaddingLeftCSS(8),paddingRight:t.getSafePaddingRightCSS(12),...this.props.style},disabled:Boolean(this.props.disableHover)},void 0,n()("div",{style:{marginLeft:e.isMobile?2:0,marginRight:e.isMobile?8:6}},void 0,o.Z.help({width:e.isMobile?16:14,height:e.isMobile?16:14,fill:e.isMobile?this.theme.mediumIconColor:this.theme.lightIconColor})),n()(p.Z,{isSmall:!0,isMobile:e.isMobile,isSecondaryColor:!e.isMobile},void 0,(0,c.bq)()?n()(r.FormattedMessage,{defaultMessage:"Learn more",id:"blockPermissionsSettings.learnMore.prompt"}):n()(r.FormattedMessage,{defaultMessage:"Learn about sharing",id:"blockPermissionsSettings.learnAboutSharing.prompt"}))))}}const h=g},67719:(e,t,i)=>{i.d(t,{Z:()=>c});var a=i(77094),n=i.n(a),s=(i(67294),i(83355)),o=i(80503),r=i(15102),l=i(66722);class d extends s.Z{renderComponent(){const{device:e}=this.environment;return e.isMobile?n()(l.ZP,{popupType:l.ZP.PopupType.SlideUp,open:this.props.open,render:this.props.renderContent,preventSlideUpTransition:this.props.disableAnimation,onDismiss:this.props.onDismiss,origin:this.props.origin}):n()(r.Z,{open:this.props.open,preventHideChildrenWhileOpening:!0,style:{alignItems:"flex-start"},innerStyle:this.getModalStyle(),onDismiss:this.props.onDismiss,render:this.props.renderContent,origin:this.props.origin,disableAnimation:this.props.disableAnimation})}getModalStyle(){const{modalStyle:e}=this.props;return{top:2*o.R6(this.environment.device.isElectronMac),borderRadius:6,overflow:"hidden",boxShadow:this.theme.largeBoxShadow,background:this.theme.contentBackground,...e}}}const c=d},93187:(e,t,i)=>{i.r(t),i.d(t,{default:()=>v});var a=i(77094),n=i.n(a),s=i(77422),o=i.n(s),r=(i(33948),i(67294),i(83355)),l=i(5366),d=i(11302),c=i(93561),u=i(90447),m=i(23537),p=i(42330),g=i(23566),h=i(66722);class f extends r.Z{constructor(){super(...arguments),o()(this,"renderModal",(()=>{const e=p.Z.state;if(e.isOpen)return n()(g.Z,{captureSelection:!0,restoreSelection:!this.environment.device.isMobile,autocompleteQuery:e.autocompleteQuery,targets:e.targets,onAutocompleteQueryChange:this.handleAutocompleteQueryChange,onAccept:this.handleAccept,onCancel:this.handleCancel,desktopWidth:(0,m.bq)()?330:220,isAddTo:e.isAddTo,isCreateIn:!1})})),o()(this,"completeMoveTransaction",(async e=>{await c.createAndCommitAsync({environment:this.environment,userAction:"MoveToMenuRenderer.completeMoveTransaction",waitForServerCommit:!1,perform:async t=>{await d.RL({environment:this.environment,value:e,transaction:t})}})})),o()(this,"handleAccept",(async e=>{const t=p.Z.state.isOpen&&p.Z.state.needsConfirmation,i=p.Z.state.isOpen&&p.Z.state.targets||[];let a=!0;t&&(a=await(0,u.vW)({environment:this.environment,moveToLocation:(0,u.WH)(e),movedItems:i})),a?this.completeMoveTransaction(e):this.handleCancel()})),o()(this,"handleCancel",(()=>{d.xv(this.environment)})),o()(this,"handleAutocompleteQueryChange",(e=>{p.Z.state.isOpen&&p.Z.setState({...p.Z.state,autocompleteQuery:e})}))}renderComponent(){const{device:e}=this.environment,t=p.Z.state;return n()(h.ZP,{popupType:e.isMobile?h.ZP.PopupType.SlideUp:h.ZP.PopupType.Popup,alignmentToOrigin:h.ZP.Alignment.Start,open:t.isOpen,render:this.renderModal,originRect:t.isOpen?t.rect:void 0,onDismiss:()=>d.xv(this.environment)})}}const v=(0,l.injectIntl)(f)},79590:(e,t,i)=>{i.r(t),i.d(t,{default:()=>w});var a=i(77094),n=i.n(a),s=i(67294),o=i.n(s),r=i(24405),l=(i(33948),i(480)),d=i(28350),c=i(59054),u=i(63143),m=i(5366),p=i(31299),g=i(65452),h=i(28020),f=i(35026),v=i(27832),y=i(12318),S=i(68128),M=i(54124);const b=function(e){const{teamId:t}=e,i=(0,l.O7)(),[{currentSpaceStore:a,currentSpaceViewStore:r,currentUserSettingsStore:b,currentUserStore:w}]=(0,d.oR)(v.default),C=(0,d.VK)((()=>{if(!t)return;const e=(0,h.k_)(i).state;if(r&&e){var a;const i=null==r||null===(a=r.getTeamsStores())||void 0===a?void 0:a.find((e=>e.id===t));if(i){var n;const a=e.teamPagesMap.get(t),s=a?Array.from(a.values()):[],o=null!==(n=i.getPinnedPagesStore().getValue())&&void 0!==n?n:[];return{type:"team",teamStore:i,teamPages:s,pinnedPages:o}}}}),[i,r,t]),T=(0,s.useMemo)((()=>({query:"",filter:"all",numPagesShown:S.k4})),[]),[k,Z]=o().useState(T),[{status:A}]=(0,c.r5)((async()=>{const e=null==a?void 0:a.id,t=null==w?void 0:w.id;t&&e&&await(0,g.l)({environment:i,spaceId:e,userId:t})}),[i,a,w],{debounce:p.vp,interval:30*u.C0}),I=(0,m.useIntl)(),P=(0,d.VK)((()=>{if(!C)return[];const e=(0,f.l6)({allSharedPages:C.teamPages,state:k,intl:I,teamStore:C.teamStore});return(0,f.vs)({sharedPageItems:e})}),[C,k,I]),_=(0,s.useMemo)((()=>new y.default(!1)),[]);return o().useEffect((()=>{var e;null===(e=i.mobileNative)||void 0===e||e.markTransitionReady({type:"modal",id:"NativeTeamsOutlinerViewAllPopover"})})),a&&r&&b&&C?n()(M.Z,{isLoading:"pending"===A,state:k,setState:Z,type:"team",spaceStore:a,spaceViewStore:r,sharedPages:P,allSharedPageIds:C.teamPages.map((e=>{let{id:t}=e;return t})),visiblePageIds:C.pinnedPages,openStore:_,teamStore:C.teamStore}):null};const w=function(e){const{route:t}=e,i=(0,r.F)();return"teamOutlinerViewAll"===t.tab?n()("div",{style:{background:i.popoverBackground}},void 0,n()(b,{teamId:t.teamId})):null}},7811:(e,t,i)=>{i.r(t),i.d(t,{default:()=>H});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=i(77422),l=i.n(r),d=(i(33948),i(67294)),c=i.n(d),u=i(83355),m=i(53397),p=i(89101),g=i(68989),h=i(82990),f=i(5366),v=i(50906),y=i(54564),S=i(47307),M=i(85997),b=i(26111),w=i(93561),C=i(43250),T=i(27832),k=i(88632),Z=i(95155),A=i(56638),I=i(88923),P=i(50795),_=i(72693),x=i(14947),F=i(6958),B=i(68932),E=i(15282),D=i(15102),R=i(89302),L=i(31792),O=i(14694);class N extends u.Z{constructor(){super(...arguments),l()(this,"storeTypes",{mouseStore:L.Z,labelMouseStore:L.Z}),l()(this,"handleToggleClick",(()=>{const{section:e}=this.props;v.trackToggleTemplateSection(this.environment,{section_name:e.sectionName,action:this.isOpen()?"close":"open"}),this.isOpen()?M.Jj(e.sectionName):M.GS(e.sectionName)})),l()(this,"handleMouseMove",(()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}))),l()(this,"handleMouseLeave",(()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1}))),l()(this,"handleLabelMouseMove",(()=>{const{labelMouseStore:e}=this.stores;e.setState({...e.state,mouseEntered:!0})})),l()(this,"handleLabelMouseLeave",(()=>{const{labelMouseStore:e}=this.stores;e.setState({...e.state,mouseEntered:!1})}))}renderComponent(){const{renderSection:e}=this.props,t=!this.isOpen();return o()("div",{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,style:this.getButtonContainerStyle()},void 0,this.renderLabel(),!t&&e())}renderLabel(){const e=!this.isOpen();return o()(O.Z,{isMobile:this.props.isMobile,disableMobileBorder:e,shouldShowMobileMarginBottom:e,style:this.getSectionSidebarItemStyle(),childrenStyle:{overflow:"visible"}},void 0,o()("div",{style:{display:"flex",alignItems:"center"}},void 0,o()(x.Z,{onClick:this.handleToggleClick,onMouseMove:this.handleLabelMouseMove,onMouseLeave:this.handleLabelMouseLeave,style:this.getLabelButtonStyle()},void 0,!Boolean(this.props.forceOpen)&&m.Z.triangle(this.getArrowStyle()),o()("span",{style:this.getToggleButtonStyle()},void 0,this.props.icon&&o()("span",{style:{paddingRight:4,display:"inline-block"}},void 0,this.props.icon),this.props.section.name))))}isOpen(){const{section:e,expandedSections:t}=this.props;return!!t&&-1!==t.indexOf(e.sectionName)}getSectionSidebarItemStyle(){return{minHeight:24,padding:0}}getSectionLabelStyle(){return{lineHeight:1,marginBottom:1,color:this.theme.sidebarTextColor,fontWeight:h.Z.fontWeight.semibold,marginLeft:9}}getMobileSectionLabelStyle(){return{lineHeight:1,color:this.theme.sidebarTextColor,fontWeight:h.Z.fontWeight.semibold,marginLeft:9}}getLabelButtonStyle(){return{display:"flex",alignItems:"center",paddingBottom:12,paddingTop:12,paddingLeft:25,...this.props.isMobile&&{marginBottom:8},width:"100%"}}getToggleButtonStyle(){const{labelMouseStore:e}=this.stores,{mouseEntered:t}=e.state;return{...this.props.isMobile?this.getMobileSectionLabelStyle():this.getSectionLabelStyle(),color:t?this.theme.regularTextColor:this.theme.mediumTextColor,transition:"color 100ms ease-out"}}getButtonContainerStyle(){const e=!this.isOpen(),{first:t}=this.props;return{...t?{borderTop:"1px solid ".concat(this.theme.regularDividerColor)}:{},borderBottom:"1px solid ".concat(this.theme.regularDividerColor),width:"100%",paddingBottom:e?0:10}}getArrowStyle(){return{width:"0.6875em",height:"0.6875em",transition:"transform 200ms ease-out",transform:"rotateZ(".concat(this.isOpen()?180:90,"deg)"),fill:this.theme.regularIconColor}}}const U=N;var W=i(66722),V=i(11082),z=i(80172);class G extends u.Z{constructor(){super(...arguments),l()(this,"storeTypes",{templateRecordCacheStore:P.$}),l()(this,"renderMobilePopup",(()=>{const e=A.Z.state;if(e.open)return o()(E.default,{title:o()(f.FormattedMessage,{defaultMessage:"Try this template",id:"pageTemplateModal.mobileModal.title"}),left:o()(E.CancelMenuText,{}),onClickLeft:this.handleDismiss,right:e.isLoading?o()(B.Z,{}):o()(f.FormattedMessage,{defaultMessage:"Use",id:"pageTemplateModal.mobileModal.useButton.label",description:"'Use' is utilized as a verb for a button label on the top right of a mobile menu, indicating to the user to click on the button to use the template they are previewing."}),onClickRight:this.handleUseTemplateClick,forceFullScreenSlideUp:!0},void 0,this.renderPreview(e))})),l()(this,"renderModal",(()=>{const e=A.Z.state;if(e.open)return o()("div",{style:G.modalStyle,className:C.fH},void 0,this.renderPreview(e),this.renderSidebar(e))})),l()(this,"handleDismiss",(async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.close()}else this.close()})),l()(this,"handleUseTemplateClick",(async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.accept(!1)}else this.accept(!1)})),l()(this,"handleItemClick",(async e=>{const{inMemoryRecordCache:t}=this.stores.templateRecordCacheStore.state;if(t.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.setCurrentItem(e)}else this.setCurrentItem(e);v.trackTemplateModalItemClick(this.environment,{template_name:e.name})}))}willMountOrUpdate(){const e=A.Z.state,{currentSpaceViewStore:t}=T.default.state;e.open&&t&&w.createAndCommit({userAction:"PageTemplateModal.willMountOrUpdate",environment:this.environment,perform:i=>{M.GF({item:e.item,spaceViewStore:t,transaction:i})}})}renderComponent(){const{device:e}=this.environment,t=A.Z.state;return e.isMobile?o()(W.GI,{open:t.open,render:this.renderMobilePopup,forceFullScreenSlideUp:!0,onDismiss:this.handleDismiss,popupType:e.isMobile?W.GI.PopupType.SlideUp:W.GI.PopupType.Popup}):o()(D.Z,{open:t.open,render:this.renderModal,onDismiss:this.handleDismiss})}renderSidebar(e){const{currentSpaceViewStore:t,currentSpaceStore:i}=T.default.state;if(!t||!i)return;const a=M.YH(),s=(0,g.dz)(this.props.intl),r="on"===Z.default.getGroup("suggested-templates");return o()("div",{style:this.getSidebarStyle()},void 0,o()(_.Z,{isLarge:!0,onClick:this.handleUseTemplateClick,style:G.useTemplateButtonStyle,disabled:e.isLoading||!k.Z.state.online},void 0,e.isLoading&&o()(B.Z,{isWhite:!0,style:{marginRight:6}}),o()(f.FormattedMessage,{defaultMessage:"Use this template",id:"pageTemplateModal.useTemplateButton.label"})),o()(V.Z,{style:G.scrollerStyle,type:z.Z.Y},void 0,r&&o()(U,{isMobile:!1,section:s,expandedSections:[...a||[],"suggested"],spaceStore:i,spaceViewStore:t,showAddPageButton:!1,first:!0,forceOpen:!0,icon:m.Z.sparkles({width:12}),renderSection:()=>o()(d.Fragment,{},void 0,s.items.map(((t,i)=>{const a=e.item.rootId===t.rootId,s=a?this.hoveredButtonStyle():{};return c().createElement(x.Z,n()({hovered:a,style:s,key:i},this.props,{onClick:()=>this.handleItemClick(t)}),this.renderSidebarItem(t))})))},"suggested"),e.sections.map(((s,l)=>o()(U,{isMobile:!1,section:s,expandedSections:a,spaceStore:i,spaceViewStore:t,showAddPageButton:!1,first:!r&&0===l,renderSection:()=>o()(d.Fragment,{},void 0,s.items.map(((t,i)=>{const a=e.item.rootId===t.rootId,s=a?this.hoveredButtonStyle():{};return c().createElement(x.Z,n()({hovered:a,style:s,key:i},this.props,{onClick:()=>this.handleItemClick(t)}),this.renderSidebarItem(t))})))},s.sectionName))),o()(x.Z,{onClick:()=>{v.trackBrowseMoreTemplatesLink(this.environment),(0,b.navigateToExternalURL)({environment:this.environment,url:p._j.templates})},style:this.fixedLinkStyle(),hoveredStyle:{background:this.theme.sidebarHideButtonHoveredBackground},pressedStyle:{background:this.theme.sidebarHideButtonPressedBackground}},void 0,m.Z.typesRelation(this.fixedLinkIconStyle()),o()(f.FormattedMessage,{defaultMessage:"Browse more templates",id:"pageTemplateModal.goToFullTemplateGalleryButton.label"}))))}renderSidebarItem(e){return o()(O.Z,{style:{paddingLeft:30,fontWeight:h.Z.fontWeight.semibold},isMobile:!1,icon:o()("div",{style:this.getIconWrapStyle()},void 0,o()(F.Z,{size:20,emoji:e.emoji}))},void 0,e.name)}renderPreview(e){const{device:t}=this.environment;return o()(R.Z,{previewRootId:e.item.previewRootId,isFrontPage:!1,style:t.isMobile?G.previewMobileStyle:G.previewStyle,templateRecordCacheStore:this.stores.templateRecordCacheStore,disabled:!1},e.item.previewRootId)}accept(e){const{inMemoryRecordCache:t}=this.stores.templateRecordCacheStore.state,i=A.Z.state,{currentSpaceViewStore:a,currentSpaceStore:n,mainEditorCurrentBlockStore:s}=T.default.state;if(i.open&&a&&n){const o=s&&s.isEmptyPage()?s:void 0,r=I.default.state.open&&I.default.state.target&&I.default.state.target.isEmptyPage()?I.default.state.target:void 0;M.RL({environment:this.environment,item:i.item,spaceStore:n,spaceViewStore:a,useRecordCache:e?t:void 0,initializeStore:i.createNewPage?void 0:o||r,isPrivate:i.isPrivate,from:i.createNewPage?"sidebar":"newPage"})}}close(){M.xv(this.environment),y.LZ()}setCurrentItem(e){A.Z.state.open&&M.zO({templateItem:e,currentUserId:this.environment.currentUser.id})}showEditConfirmDialog(){return new Promise(((e,t)=>{S.showDialog({message:o()(f.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:o()(f.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:o()(f.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})}))}getSidebarStyle(){return{width:G.sidebarWidth,color:this.theme.mediumTextColor,background:"dark"===this.theme.mode?this.theme.popoverBackground:this.theme.sidebarBackground,display:"flex",flexDirection:"column",borderTopRightRadius:G.borderRadius,borderBottomRightRadius:G.borderRadius}}getIconWrapStyle(){return{color:this.theme.regularTextColor,position:"relative"}}hoveredButtonStyle(){return{color:this.theme.regularTextColor,fontWeight:h.Z.fontWeight.medium}}fixedLinkStyle(){return{padding:12,color:this.theme.mediumTextColor,background:"dark"===this.theme.mode?this.theme.popoverBackground:this.theme.sidebarBackground,fontSize:13,fontWeight:h.Z.fontWeight.medium,display:"flex",alignItems:"center",position:"absolute",bottom:0,right:0,height:45,width:G.sidebarWidth,borderTop:"1px solid ".concat(this.theme.regularDividerColor)}}fixedLinkIconStyle(){return{width:12,height:12,marginLeft:8,marginRight:10,marginBottom:0,fill:this.theme.regularIconColor,fontWeight:h.Z.fontWeight.medium}}}l()(G,"sidebarWidth",240),l()(G,"borderRadius",3),l()(G,"modalStyle",{display:"flex",width:"85vw",height:"85vh",borderRadius:G.borderRadius}),l()(G,"useTemplateButtonStyle",{position:"relative",marginTop:16,marginLeft:20,marginRight:20,marginBottom:16,whiteSpace:"nowrap"}),l()(G,"previewStyle",{width:"calc(100% - ".concat(G.sidebarWidth,"px)"),flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"}),l()(G,"previewMobileStyle",{width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"}),l()(G,"scrollerStyle",{flexGrow:1,flexShrink:1,paddingBottom:44});const H=(0,f.injectIntl)(G)},23596:(e,t,i)=>{i.d(t,{Z:()=>ce});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=i(77422),l=i.n(r),d=(i(33948),i(96486)),c=i.n(d),u=i(67294),m=i.n(u),p=i(83355),g=i(41892),h=i(53397),f=i(27006),v=i(98459),y=i(21202),S=i(29369),M=i(5366),b=i(50906),w=i(25186),C=i(38363),T=i(95477),k=i(84210),Z=i(21115),A=i(61766),I=i(81236),P=i(12318),_=i(14947),x=i(62727),F=i(28240),B=i(47966),E=i(7567),D=i(42001),R=i(13991),L=i(480),O=i(28350),N=i(24405),U=i(39336),W=i(63143),V=i(28020),z=i(43250),G=i(60709),H=i(48762),q=i(46167),K=i(93289),j=i(82902),Y=i(71202),Q=i(25584),J=i(83071),X=i(46951);function $(e){const t=(0,L.Fy)(),[,,i]=(0,O.oR)(void 0,A.Z),a=(0,N.F)(),s=(0,L.O7)(),r=(0,O.VK)((()=>(0,Z.y$)(s)),[s]);return m().createElement(q.Z,n()({},e.upsellEvents,{disablePopup:!r,popupType:t.isMobile?q.Z.PopupType.SlideUp:q.Z.PopupType.Popup,buttonPopupStore:i,renderOrigin:t=>m().createElement(H.Z,n()({},t,{focused:!1,title:o()(X.Z,{},void 0,o()(M.FormattedMessage,{id:"publicPermissionItem.expirationTime.label",defaultMessage:"Link expires"})," ",e.upgradeLabel),right:m().createElement(D.Z,n()({},t,{ignoreLocalHoverState:!0,style:{paddingLeft:0,paddingRight:0}}),o()(ee,{expirationTimestamp:e.permissionItem.expiration_timestamp}),h.Z.chevronDown({width:10,marginLeft:4,fill:a.lightIconColor}))})),placementToOrigin:G.Iw.Bottom,render:i=>{const a=[{key:"options",render:e=>m().createElement(J.Z,e),items:ie().map((t=>({key:t.type,action:()=>{te(e,s,t.time),i.close()},render:e=>m().createElement(H.Z,n()({},e,{focused:e.focused,disabled:!1,title:t.title,caption:t.caption}))})))},{key:"custom",render:e=>m().createElement(J.Z,n()({},e,{topBorder:!0})),items:[{key:"custom",action:()=>{i.close()},render:(t,a)=>m().createElement(j.Z,n()({},t,{renderOrigin:e=>m().createElement(H.Z,n()({},e,{disabled:!1,title:o()(M.FormattedMessage,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"})})),onFocus:a.onFocus,disableDefaultClick:!0,renderExtension:(t,a)=>o()("div",{style:{padding:"18px 14px 14px"}},void 0,m().createElement(K.Z,n()({},t,{firstDayOfWeek:V.AK.state,value:e.permissionItem.expiration_timestamp||(new Date).getTime(),onChange:t=>{te(e,s,t),a.close(),i.close()},disabledDays:{before:new Date}})))}))}]}];let r;return r=t.isMobile?{menuType:Y.Z.MenuType.Modal,title:o()(M.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.title",defaultMessage:"Expiration time"}),right:o()(M.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.label",defaultMessage:"Done"}),onClickRight:i.close}:{menuType:Y.Z.MenuType.Popup,width:264},m().createElement(Y.Z,n()({className:z.Ip},r),o()(Q.Z,{type:Q.Z.Type.Vertical,initialFocus:void 0,sections:a}))}}))}function ee(e){return e.expirationTimestamp?o()(X.Z,{},void 0,(0,U.default)(e.expirationTimestamp).fromNow()):o()(M.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"})}function te(e,t,i){const{permissionItem:a,onChange:n}=e;if("public_permission"!==a.type)return;if(void 0!==i&&i<=(new Date).getTime())return;const s=a,o=c().clone(s),r=i;o.expiration_timestamp=r,n(o),(0,b.trackSetExpirationTimeOnPublicPage)(t,{expiration_time:r})}function ie(){const e=(new Date).getTime()+W.U6,t=(new Date).getTime()+W.A0,i=(new Date).getTime()+7*W.A0;return[{type:"never",time:void 0,title:o()(M.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"})},{type:"hour",time:e,title:o()(M.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.hour",defaultMessage:"In an hour"}),caption:new Intl.DateTimeFormat(R.SP,{hour:"numeric",minute:"numeric"}).format(e)},{type:"day",time:t,title:o()(M.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.day",defaultMessage:"In a day"}),caption:new Intl.DateTimeFormat(R.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(t)},{type:"week",time:i,title:o()(M.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.week",defaultMessage:"In a week"}),caption:new Intl.DateTimeFormat(R.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(i)}]}var ae=i(79029),ne=i(47714),se=i(37235),oe=i(60442),re=i(42115);let le;!function(e){e[e.Web=0]="Web",e[e.Workspace=1]="Workspace",e[e.User=2]="User"}(le||(le={}));class de extends p.Z{constructor(){super(...arguments),l()(this,"copiedLinkTimeout",void 0),l()(this,"copiedLink",new P.default(!1)),l()(this,"showLinkOptions",new P.default(!1)),l()(this,"storeTypes",{buttonPopupStore:A.Z}),l()(this,"renderLinkOptionsButton",(()=>o()(D.Z,{onClick:this.handleShowLinkOptionsClick,style:{...this.getPublicAccessOptionStyle()}},void 0,o()(X.Z,{isSmall:!0},void 0,o()(M.FormattedMessage,{defaultMessage:"Show link options",id:"pagePermissionItem.showLinkOptions.label"}),h.Z.chevronDown({width:9,height:9,marginLeft:4,display:"inline"}))))),l()(this,"renderAllowEditsTooltip",(()=>o()(oe.Z,{caption:o()(M.FormattedMessage,{defaultMessage:"Any logged in Notion user can edit this page. Share the secret link with people you trust.",id:"pagePermissionItem.allowEdits.tooltip"}),imageHeight:120,imageWidth:240,imageURL:g.Z.images.tooltips.share.allowEditingPng}))),l()(this,"renderAllowCommentsTooltip",(()=>o()(oe.Z,{caption:o()(M.FormattedMessage,{defaultMessage:"Any logged in Notion user can comment on this page.",id:"pagePermissionItem.allowComments.tooltip"}),imageHeight:120,imageWidth:240,imageURL:g.Z.images.tooltips.share.allowCommentsPng}))),l()(this,"renderAllowSearchEngineTooltip",(()=>o()(oe.Z,{caption:o()(M.FormattedMessage,{defaultMessage:"If allowed, your public page may appear in search engines such as Google, but only if you or someone else links to it elsewhere on the web.",id:"pagePermissionItem.allowSearchEngine.tooltip"}),imageHeight:120,imageWidth:240,imageURL:g.Z.images.tooltips.share.allowSearchEnginesPng}))),l()(this,"renderAllowSearchEngineUpgradeTooltip",(()=>o()(oe.Z,{imageURL:g.Z.images.tooltips.upsells.searchEngineIndexingPng,imageWidth:240,imageHeight:100,title:o()(M.FormattedMessage,{defaultMessage:"Upgrade for search engine indexing",id:"pagePermissionItem.searchEngineUpgradeTooltip.title"}),caption:o()(M.FormattedMessage,{defaultMessage:"Have your page appear in search engine results.",id:"pagePermissionItem.searchEngineUpgradeTooltip.caption"})}))),l()(this,"renderAllowDuplicateTooltip",(()=>o()(oe.Z,{caption:o()(M.FormattedMessage,{defaultMessage:"If allowed, this will allow other people to duplicate your public page to their workspace.",id:"pagePermissionItem.allowDuplicateTemplate.tooltip"}),imageHeight:120,imageWidth:240,imageURL:g.Z.images.tooltips.share.allowDuplicatePng}))),l()(this,"handleCopy",(()=>{const e=(0,k.Z)({store:this.props.currentBlockStore,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=I.Z.getPublicSpaceData(this.environment,(0,v.CG)(this.props.currentBlockStore.getSpaceId())))||void 0===e?void 0:e.domain}});w.RD({environment:this.environment,stringValue:e,copiedMessage:w.tq.copiedLinkToClipboard}),clearTimeout(this.copiedLinkTimeout),this.copiedLink.set(!0),this.copiedLinkTimeout=window.setTimeout((()=>{this.copiedLink.set(!1)}),1e3)})),l()(this,"handleShowLinkOptionsClick",(()=>{this.showLinkOptions.set(!0)})),l()(this,"handleToggleAllowEdits",(()=>{const{permissionItem:e}=this.props;"public_permission"===e.type&&this.props.onChange({...e,role:"read_and_write"===e.role?"comment_only":"read_and_write"})})),l()(this,"handleToggleAllowComments",(()=>{const{permissionItem:e}=this.props;"public_permission"===e.type&&this.props.onChange({...e,role:"comment_only"===e.role||"read_and_write"===e.role?"reader":"comment_only"})})),l()(this,"handleToggleSearchEngine",(()=>{const{permissionItem:e}=this.props;if("public_permission"===e.type){const t=e,i=Boolean(t.allow_search_engine_indexing),a=c().clone(t),n=!i;a.allow_search_engine_indexing=n,this.props.onChange(a),b.trackToggleAllowSearchEngineIndexing(this.environment,{allow_search_engine_indexing:n})}})),l()(this,"handleToggleDuplicate",(()=>{const{permissionItem:e}=this.props;if("public_permission"===e.type){const t=e,i=void 0===t.allow_duplicate||!0===t.allow_duplicate,a=c().clone(t),n=!i;a.allow_duplicate=n,this.props.onChange(a),b.trackToggleAllowDuplicate(this.environment,{allow_duplicate:n})}})),l()(this,"handleRoleSelect",(e=>{const t=c().clone(this.props.permissionItem);t.role=e,this.props.onChange(t)})),l()(this,"handleSwitcherButtonClick",(()=>{"none"===this.role?this.handleRoleSelect(this.props.switcherRole||"editor"):this.handleRoleSelect("none")})),l()(this,"handleUserItemClick",(()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!0})}))}willMount(e){super.willMount(e),f.$D(e.permissionItem)&&"none"===e.permissionItem.role&&this.showLinkOptions.set(!0)}renderComponent(){const{device:e}=this.environment,{tooltip:t}=this.props,i=this.isUserItem()||!this.isPublicPermissionItem?this.handleUserItemClick:this.handleSwitcherButtonClick;return o()(u.Fragment,{},void 0,t?o()(se.Z,{delayThreshold:0,renderTooltip:()=>t,render:t=>m().createElement(_.Z,n()({disabled:this.props.disabled,mobileFeedback:e.isMobile,style:{...this.props.disabled?{cursor:"not-allowed"}:{}},onClick:i},t),this.renderMenuItem()),placement:se.Z.Placement.Left}):o()(_.Z,{disabled:this.props.disabled,style:{...this.props.disabled?{cursor:"not-allowed"}:{}},onClick:i},void 0,this.renderMenuItem()),this.renderPublicPermissionSettings())}renderMenuItem(){const{device:e}=this.environment,{isInherited:t,permissionItem:i}=this.props,a=this.isUserItem(),n=this.isBotPermissionItem(),s=!a&&!n,r=f.ix(i)||f.hV(i),l=!(this.isPublicPermissionItem||r&&"none"===this.role);return o()("div",{className:"notranslate",style:this.getMenuItemStyle(a)},void 0,o()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,marginRight:e.isMobile?12:10}},void 0,this.props.icon),o()("div",{style:{marginRight:"auto",minWidth:0}},void 0,o()("div",{style:{display:"flex",flexDirection:"row"}},void 0,o()(X.Z,{style:{...!a&&{fontWeight:400}}},void 0,this.props.title),this.props.tag&&o()("div",{style:{marginLeft:4}},void 0,this.props.tag)),this.props.subtitle&&o()(X.Z,{isSmall:!0},void 0,this.props.subtitle),t&&this.renderInheritedRecordTitle()),o()("div",{style:{display:"flex",alignItems:"center",flexShrink:0,marginLeft:8}},void 0,this.isPublicPermissionItem?m().createElement(m().Fragment,null,l&&!r&&o()(E.Z,{role:this.role,table:y.iU,blockType:this.props.currentBlockStore.getType(),type:i.type,disabled:this.props.disabled,isSubscribed:this.props.isSubscribed,isUserPermission:this.permissionItemIsUserItem(i),onChange:this.handleRoleSelect,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonPopupStore:this.stores.buttonPopupStore,buttonStyle:{marginRight:e.isMobile||a||n?-6:8,color:this.theme.mediumTextColor,fontSize:e.isMobile?14:12}}),s&&o()(ne.Z,{on:"none"!==this.role,onClick:this.handleSwitcherButtonClick,disabled:this.props.disabled,isAndroid:e.isAndroid})):o()(E.Z,{role:this.role,table:y.iU,blockType:this.props.currentBlockStore.getType(),type:i.type,disabled:this.props.disabled,isSubscribed:this.props.isSubscribed,isUserPermission:this.permissionItemIsUserItem(i),onChange:this.handleRoleSelect,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonPopupStore:this.stores.buttonPopupStore,buttonStyle:{marginRight:-6,color:this.theme.mediumTextColor,fontSize:e.isMobile?14:12},showPermissionOverrideWarning:this.props.isInherited})))}getPublicPermissionSettingsHeight(e){const{device:t}=this.environment;return e?0:t.isMobile?this.showLinkOptions.get()?240:94:this.showLinkOptions.get()?200:88}renderPublicPermissionSettings(){const{device:e}=this.environment,{permissionItem:t}=this.props;if(f.$D(t)){const i="none"===this.role;return o()("div",{style:{maxHeight:this.getPublicPermissionSettingsHeight(i),transition:"max-height ease 200ms, padding-bottom ease 200ms",overflow:"hidden",paddingBottom:i?0:this.showLinkOptions.get()?12:8}},void 0,this.renderPageLinkButton(),this.showLinkOptions.get()?m().createElement(m().Fragment,null,m().createElement(m().Fragment,null,"production"!==T.Z.env&&o()(re.Z,{alwaysAllowClick:Boolean(t.expiration_timestamp),onClick:()=>{},analyticsName:"public_permission_item_expiration",requireUpgradeToTier:!(0,Z.y$)(this.environment)&&(0,Z.M9)(this.environment),tooltipPlacement:se.Z.Placement.Left,renderTooltip:this.renderAllowSearchEngineTooltip,renderUpgradeTooltip:this.renderAllowSearchEngineUpgradeTooltip,onUpgradeClick:this.props.onUpgradeButtonClick,render:(e,i)=>o()($,{upsellEvents:e,upgradeLabel:i,permissionItem:t,onChange:e=>{this.props.onChange(e)}})}),o()(se.Z,{placement:se.Z.Placement.Left,renderTooltip:this.renderAllowEditsTooltip,render:i=>m().createElement(_.Z,n()({onClick:this.handleToggleAllowEdits,style:this.getPublicAccessOptionStyle(),disabled:this.props.disabled},i),o()(X.Z,{style:this.getPublicAccessOptionLabelStyle(this.props.disabled)},void 0,o()(M.FormattedMessage,{defaultMessage:"Allow editing",id:"pagePermissionItem.allowEdits.setting"})),o()(ne.Z,{on:"read_and_write"===t.role,onClick:this.handleToggleAllowEdits,disabled:this.props.disabled,isAndroid:e.isAndroid}))}),o()(se.Z,{placement:se.Z.Placement.Left,renderTooltip:this.renderAllowCommentsTooltip,render:t=>m().createElement(_.Z,n()({onClick:this.handleToggleAllowComments,style:this.getPublicAccessOptionStyle(),disabled:this.props.disabled},t),o()(X.Z,{style:this.getPublicAccessOptionLabelStyle(this.props.disabled)},void 0,o()(M.FormattedMessage,{defaultMessage:"Allow comments",id:"pagePermissionItem.allowComments.setting"})),o()(ne.Z,{on:"comment_only"===this.role||"read_and_write"===this.role,onClick:this.handleToggleAllowComments,disabled:this.props.disabled,isAndroid:e.isAndroid}))})),o()(se.Z,{placement:se.Z.Placement.Left,renderTooltip:this.renderAllowDuplicateTooltip,render:i=>m().createElement(_.Z,n()({onClick:this.handleToggleDuplicate,disabled:this.props.disabled,style:this.getPublicAccessOptionStyle()},i),o()(X.Z,{style:this.getPublicAccessOptionLabelStyle(this.props.disabled)},void 0,o()(M.FormattedMessage,{defaultMessage:"Allow duplicate as template",id:"pagePermissionItem.allowDuplicateTemplate.setting"})),o()(ne.Z,{on:!1!==t.allow_duplicate,onClick:this.handleToggleDuplicate,disabled:this.props.disabled,isAndroid:e.isAndroid}))}),o()(re.Z,{requireUpgradeToTier:!(0,Z.f3)(this.environment)&&(0,Z.M9)(this.environment),alwaysAllowClick:t.allow_search_engine_indexing,analyticsName:"allow_search_engine_indexing",onClick:this.handleToggleSearchEngine,onUpgradeClick:this.props.onUpgradeButtonClick,tooltipPlacement:se.Z.Placement.Left,renderTooltip:this.renderAllowSearchEngineTooltip,renderUpgradeTooltip:this.renderAllowSearchEngineUpgradeTooltip,render:(i,a)=>m().createElement(_.Z,n()({style:this.getPublicAccessOptionStyle(),disabled:this.props.disabled},i),o()(X.Z,{style:this.getPublicAccessOptionLabelStyle(this.props.disabled)},void 0,o()(M.FormattedMessage,{defaultMessage:"Search engine indexing",id:"pagePermissionItem.allowSearchEngines.setting"})," ",a),o()(ne.Z,{on:Boolean(t.allow_search_engine_indexing),onClick:this.handleToggleSearchEngine,disabled:this.props.disabled||Boolean(a),isAndroid:e.isAndroid}))})):this.renderLinkOptionsButton())}}renderPageLinkButton(){const e=(0,k.Z)({store:this.props.currentBlockStore,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=I.Z.getPublicSpaceData(this.environment,(0,v.CG)(this.props.currentBlockStore.getSpaceId())))||void 0===e?void 0:e.domain}});return o()("div",{style:{...this.getPublicAccessOptionStyle(),height:"auto"}},void 0,o()("div",{style:{flex:1}},void 0,o()("div",{style:{display:"flex",padding:"1px 0"}},void 0,o()(x.Z,{value:e,disabled:!0,style:{flex:1,borderTopRightRadius:0,borderBottomRightRadius:0,paddingRight:0}}),o()(B.Z,{onClick:()=>this.handleCopy(),style:{height:28,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:"none"}},void 0,this.copiedLink.get()?o()(M.FormattedMessage,{id:"pageShareMenu.copiedLinkButton.label",defaultMessage:"✓ Copied"}):o()(M.FormattedMessage,{id:"pageShareMenu.copyMaybePublicLinkButton.label.web",defaultMessage:"Copy web link",description:"Button text for copying public link of the page"})))))}renderInheritedRecordTitle(){const e=this.props.store,t=e.table===y.iU?(0,k.Z)({store:e,fullyQualified:!1}):void 0,i=e.table===S.e0?()=>{e.table===S.e0&&(0,C.RF)(e.id)}:void 0,{device:a}=this.environment;return o()(X.Z,{isSmall:!0,style:{lineHeight:1.4}},void 0,o()(M.FormattedMessage,{defaultMessage:"Based on {linkBoxWithPageTitle}",description:"This text tells the user that this permission setting for the page is inherited from the parent page or team.",id:"pagePermissionItem.inheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:o()(F.Z,{disabled:a.isMobile,underline:!a.isMobile,inline:!0,href:t,onClick:i},void 0,o()(ae.Z,{store:e,style:{display:"inline"}}))}}))}permissionItemIsUserItem(e){const t=this.environment.currentUser.id;return"user_permission"===e.type&&e.user_id===t}isUserItem(){return this.props.format===le.User}get role(){const{permissionItem:e,isInherited:t,store:i,currentBlockStore:a}=this.props;if("content_only_editor"===e.role&&t){const t=a.getParentCollectionStore(),n=null==t?void 0:t.getParentBlockStore();return n&&n.table===i.table&&n.id===i.id?e.role:"read_and_write"}return e.role}get isPublicPermissionItem(){return f.$D(this.props.permissionItem)}isBotPermissionItem(){return f.FB(this.props.permissionItem)}getMenuItemStyle(e){const{WindowSizeStore:t}=this.environment;return{display:"flex",alignItems:"center",minHeight:52,paddingTop:8,paddingBottom:8,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14)}}getPublicAccessOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;let i;return i=e.isMobile?36:30,{display:"flex",alignItems:"center",width:"100%",height:i,paddingTop:5,paddingBottom:5,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14)}}getPublicAccessOptionLabelStyle(e){return{marginRight:"auto",opacity:e?.6:1}}}l()(de,"Format",le),l()(de,"iconSize",32);const ce=de},99444:(e,t,i)=>{i.r(t),i.d(t,{PermissionsInviteBase:()=>Me,default:()=>be});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=i(77422),l=i.n(r),d=(i(33948),i(96486)),c=i.n(d),u=i(67294),m=i.n(u),p=i(83355),g=i(8848),h=i(94044),f=i(5366),v=i(50906),y=i(95209),S=i(21325),M=i(43250),b=i(75472),w=i(65598),C=i(33665),T=i(23537),k=i(85834),Z=i(1903),A=i(29677),I=i(80270),P=i(83182),_=i(71202),x=i(15282),F=i(7567),B=i(480),E=i(28350),D=i(67669),R=i(86785);const L=function(e){return(0,E.VK)((()=>{var t,i;if(!(0,w.NZ)(e))return{teamAllowsGuests:!0,spaceAllowsGuests:!0};const a=(0,R.VP)(e),n=(0,R.Pj)(e);return{teamAllowsGuests:!(null!=a&&null!==(t=a.state.value)&&void 0!==t&&t.settings.disable_guests),spaceAllowsGuests:!(null!=n&&null!==(i=n.state.value)&&void 0!==i&&i.disable_guests)}}),[e])};function O(e){const{teamAllowsGuests:t,spaceAllowsGuests:i}=L(e);return!t&&i?m().createElement(m().Fragment,null,o()("div",{},void 0,o()(f.FormattedMessage,{id:"contextualInvite.buttonAndTokenTooltip.teamDisablesGuestsAlertLine1",defaultMessage:"This teamspace doesn't allow guests.",description:"Tooltip message shown when hovering above the guest invitee or invite button when guests are disabled on the teamspace"})),o()("div",{},void 0,o()(f.FormattedMessage,{id:"contextualInvite.buttonAndTokenTooltip.teamDisablesGuestsAlertLine2",defaultMessage:"Remove any guests to continue.",description:"Tooltip message telling the user the action needed to continue with invite form."}))):!t&&!i&&m().createElement(m().Fragment,null,o()("div",{},void 0,o()(f.FormattedMessage,{id:"contextualInvite.buttonAndTokenTooltip.spaceDisablesGuestsAlertLine1",defaultMessage:"This workspace doesn't allow guests.",description:"Tooltip message shown when hovering above the guest invitee or invite button when guests are disabled on the teamspace"})),o()("div",{},void 0,o()(f.FormattedMessage,{id:"contextualInvite.buttonAndTokenTooltip.spaceDisablesGuestsAlertLine2",defaultMessage:"Remove any guests to continue.",description:"Tooltip message telling the user the action needed to continue with invite form."})))}var N=i(19757),U=i(72693),W=i(37235);const V=function(e){const{store:t,permissionsInviteStore:i,handleUpgradeClick:a,handleInviteClick:s,isLarge:r}=e,l=(0,B.O7)(),[d]=(0,E.oR)(i),c=(0,E.VK)((()=>d.inviteTargets.some((e=>b.OA(e)))),[d]),u=O(t),p=(0,E.VK)((()=>{const e=d.inviteTargets,t=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),i=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return D.dA(l,[...t,...i])}),[l,d]),g=c?u:void 0;return o()(W.Z,{alignment:N.v2.Center,disableTooltip:!(p||g),renderTooltip:()=>p?m().createElement(m().Fragment,null,o()("div",{},void 0,o()(f.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine1",defaultMessage:"Your plan allows up to 5 unique guests.",description:"Guest limit shown when users attempts to invite a guest from the invite user button."})),o()("div",{},void 0,o()(f.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine2",defaultMessage:"Upgrade to go unlimited.",description:"Upgrade message shown when users attempts to invite a guest from the invite user button."}))):g,render:e=>m().createElement(U.Z,n()({isLarge:r,style:{minWidth:h.UF},disabled:Boolean(g),onClick:p?a:s},e),o()(f.FormattedMessage,p?{id:"inviteUserModal.inviteButton.upgradeLabel",defaultMessage:"Upgrade"}:{id:"inviteUserModal.inviteButton.label",defaultMessage:"Invite"}))})};var z=i(95155),G=i(91487),H=i(47082);function q(e){return(0,b.OA)(e)?"rgba(246, 192, 80, 0.26)":void 0}const K=function(e){const{origin:t,permissionsInviteStore:i,store:a,handleClickRemoveToken:s,handleInputChange:r,handleInputSubmit:l,defaultRoleForNonBot:d,isTeamsEnabled:c,right:u,focus:p,handleFocus:g}=e,h=(0,E.VK)((()=>"on"===z.default.getEligibleGroup({experimentId:"better_integrations",defaultGroup:"control"})),[]),v="share_menu"===t,[y,S]=(0,E.oR)(i),M=(0,B.O7)(),{device:C}=M,T=(0,f.useIntl)(),{tokenQuery:k}=y,Z=O(a),A=y.inviteTargets.map((e=>{const t="newUser"===e.type?e.value.email:"".concat(e.type,"-").concat(e.value.id),i=(0,b.OA)(e),a="newUser"===e.type||"existingUser"===e.type?e.value.email:void 0,r=i?Z:void 0,l={key:t,target:e,onClickRemove:s,role:y.inviteRole,shouldWrap:v,showInfoIcon:Boolean(r)};return v&&a?o()(W.Z,{placement:N.ug.Top,renderTooltip:()=>i?r||o()(f.FormattedMessage,{defaultMessage:"{email} will be invited as a guest",id:"ContextualInvite.permissions_invites.guest.tooltip",description:"Tooltip for inviting a guest",values:{email:a}}):a,render:i=>m().createElement("span",n()({},i,{key:t}),m().createElement(G.Z,n()({},l,{backgroundColor:q(e)})))}):m().createElement(G.Z,l)}));return m().createElement(H.Z,n()({focus:C.isMobile?void 0:p,focusInitial:C.isMobile,focusAfterAnimation:!0,onClick:()=>{C.isMobile||null==g||g()},format:H.Z.Format.Share,value:k,onChange:r,type:"email",tokens:A,disabled:!1,autoComplete:"off",placeholder:function(e){return v?c?T.formatMessage({defaultMessage:"Add people, groups, or emails…",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithTeams",description:"Placeholder text for the search input in the invite user modal"}):e?T.formatMessage({defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots",description:"Placeholder text for the search input in the invite user modal"}):T.formatMessage({defaultMessage:"Add emails, people, integrations…",id:"ContexualInvites.inviteUserModal.searchInput.placeholder",description:"Placeholder text for the search input in the invite user modal"}):(0,w.Mm)(a)?T.formatMessage({id:"inviteUserModal.searchInput.placeholder",defaultMessage:"Search name or emails"}):T.formatMessage({id:"permissionsInvite.searchInput.placeholder",defaultMessage:"Search emails, names, or groups"})}(h),onRemoveLastToken:()=>{const e={...y};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=d),S(y)},right:u,inputAndTokenWrapRightStyle:{paddingTop:M.device.isMobile?0:y.isInviteTargetsEmpty?5:6,paddingBottom:M.device.isMobile||v?0:4},onEmptySubmit:()=>l(),dontShowBorderBottom:C.isAndroid,showBorder:v},v&&{style:{borderRadius:3,paddingTop:y.isInviteTargetsEmpty?3:0,paddingBottom:0,...p&&{background:"none"}}}))};i(73210);var j=i(24405),Y=i(33728),Q=i(53397),J=i(21202),X=i(75246),$=i(19889),ee=i(97880),te=i(82990),ie=i(4708),ae=i(16639),ne=i(21115),se=i(27832),oe=i(78291),re=i(12133),le=i(48762),de=i(77701),ce=i(25584),ue=i(16328),me=i(40039),pe=i(7765),ge=i(69507),he=i(83071),fe=i(97680);const ve=(0,f.defineMessages)({invited_page:{id:"PermissionsInviteSearchRequest.userTooltip.invited_page",defaultMessage:"{userNameAndEmail} is invited to this page already",description:"A label that shows the user is invited to the page already"},invited_space:{id:"PermissionsInviteSearchRequest.userTooltip.invited_space",defaultMessage:"{userNameAndEmail} is invited to this workspace already",description:"A label that shows the user is invited to the workspace already"},not_in_space:{id:"PermissionsInviteSearchRequest.userTooltip.admin",defaultMessage:"Click to invite {userNameAndEmail}",description:"A tooltip explains that the user has not been invited, therefore they have no access to the workspace"}});function ye(e,t){return e.filter(((e,i)=>i<t))}const Se=function(e){const{store:t,defaultRoleForSpaceBot:i,shouldShowBots:a,shouldShowGroups:s,sectionRenderLimit:r,membersOnly:l}=e,[d,c,p]=(0,E.oR)(e.permissionsInviteStore),g=(0,B.O7)(),{device:h}=g,y=(0,f.useIntl)(),{tokenQuery:S}=d,M=(0,u.useMemo)((()=>b.ZK({environment:{device:h}})),[h]),C=(0,j.y)((e=>({roleBadge:{...M},invitedBadge:{...M,backgroundColor:e.defaultBadgeBackground}})),[M]),T=(0,E.VK)((()=>(0,ie._6)(g)?"invitee-popup-closed":"invitee"),[g]),k={request:S,performRequest:e=>(0,b.jL)({query:e,sectionLimit:10,shouldShowBots:a,shouldShowGroups:s,membersOnly:l,environment:g,intl:y}),render:(e,a,l)=>{if(e)return o()(ge.l,{loading:!l},void 0,o()(ue.Z,{title:o()(f.FormattedMessage,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})}));const u=a&&(null==S?void 0:S.length)>0,{inviteUsers:h,inviteBots:M,inviteGroups:k}=u?a:(0,b.NN)({currentInviteActors:a,permissionsInviteStore:p,targetStore:t}),Z=ye(h,r).map(((e,i)=>{const a="newUser"===e.type?e.value.email:e.value.id,s=function(e){if("existingUser"!==e.type)return;const{data:t}=oe.default.state,i=(t?ne.uF(t):[]).find((t=>t.userId===e.value.id));return i?i.role:"not_in_space"}(e),r=Boolean(u&&(0,b.cm)({permissionsInviteStore:p,userTarget:e,targetStore:t}));return{key:a,render:i=>{const{tooltip:a,userTypeToken:l}=function(e){const{userTarget:t,targetStore:i,isInvited:a,userSpaceRole:n,styles:s,intl:r}=e,l="newUser"!==t.type&&t.value.name?"".concat(t.value.name," (").concat(t.value.email,")"):t.value.email,d=n&&"not_in_space"!==n;if(a)return{tooltip:(0,w.Mm)(i)?r.formatMessage(ve.invited_space,{userNameAndEmail:l}):r.formatMessage(ve.invited_page,{userNameAndEmail:l}),userTypeToken:o()("div",{style:{...s.invitedBadge}},void 0,o()(f.FormattedMessage,{id:"inviteUserModal.userRole.invitedBadge.label",defaultMessage:"Invited",description:"A label that shows the user is invited already"}))};if(d){const e=b.Ji({role:n,intl:r,nameOrEmail:l});return{tooltip:e.tooltip,userTypeToken:o()("div",{style:{...s.roleBadge}},void 0,e.userRoleBadge)}}return{tooltip:r.formatMessage(ve.not_in_space,{userNameAndEmail:l}),userTypeToken:void 0}}({userTarget:e,targetStore:t,userSpaceRole:s,isInvited:r,styles:C,intl:y});return"existingUser"===e.type?m().createElement(fe.Z,n()({},i,{user:e.value,tooltip:a,right:l})):o()(W.Z,{placement:W.Z.Placement.Bottom,alignment:W.Z.Alignment.Start,render:t=>m().createElement(le.Z,n()({},i,t,{icon:Q.Z.mail({width:24,height:24}),right:l,title:e.value.email.trim()})),disableTooltip:!a,renderTooltip:()=>a})},action:()=>{if(r)return;if(!d.isInviteTargetsEmpty&&(0,A.ow)(d))return;const t={...e,..."existingUser"===e.type&&{spaceRole:s}};v.trackInviteSelectTarget(g,{...b.a_(g,d),invite_token_query:S,selected_user_token:e,selected_user_token_rank:i}),p.setState({...d,inviteTargets:[...d.inviteTargets,t],isInviteTargetsEmpty:!1,tokenQuery:"",inputFocus:T})}}})),{currentUserRootStore:I}=se.default.state,P=ye(M,r).map((e=>{const{value:t}=e;if(I&&(t.parent_table!==$.KJ||t.parent_id===I.id))return{key:t.id,render:e=>m().createElement(re.Z,n()({},e,{bot:t})),action:()=>{(d.isInviteTargetsEmpty||(0,A.ow)(d))&&(d.table===J.iU?c({...d,inviteTargets:[...d.inviteTargets,e],inviteRole:void 0,isInviteTargetsEmpty:!1,tokenQuery:"",table:d.table,inputFocus:T}):d.table===X.bx&&c({...d,inviteTargets:[...d.inviteTargets,e],inviteRole:i,isInviteTargetsEmpty:!1,tokenQuery:"",table:d.table,inputFocus:"invitee"}))}}})).filter(ee.$K),{currentSpaceStore:_}=se.default.state,x=ye(k,r).map((e=>{const{value:t}=e,i=(0,ae.kF)({intl:y,group:t}),a=_&&t.icon?{pointer:{table:_.table,id:_.id},icon:t.icon}:void 0;return{key:t.id,render:e=>m().createElement(le.Z,n()({},e,{icon:a?o()(me.Z,{disabled:!0,size:22,icon:a,isEmptyPage:!1,title:i}):o()(de.Z,{size:22}),title:i})),action:()=>{!d.isInviteTargetsEmpty&&(0,A.ow)(d)||p.setState({...d,inviteTargets:[...d.inviteTargets,e],isInviteTargetsEmpty:!1,tokenQuery:"",inputFocus:T})}}})),F=[],B=!("on"===z.default.getEligibleGroup({experimentId:"better_integrations",defaultGroup:"control"}))&&(d.isInviteTargetsEmpty||(0,A.ow)(d)),E=d.isInviteTargetsEmpty||!(0,A.ow)(d);if(Z.length>0&&E&&F.push({key:"user results",render:e=>m().createElement(ge.l,n()({},e,{loading:!l})),items:Z}),s&&x.length>0&&E&&F.push({key:"group results",render:e=>m().createElement(he.Z,n()({},e,{title:o()(f.FormattedMessage,{id:"inviteUserModal.searchDropdown.selectGroupTitle",defaultMessage:"Select a group"}),loading:!l})),items:x}),P.length>0&&B&&F.push({key:"bot results",render:e=>m().createElement(he.Z,n()({},e,{title:y.formatMessage({id:"permissionsInvite.integration.select.message",defaultMessage:"Select an integration"}),loading:!l})),items:P}),0===F.length&&E){const e=(0,Y.H3)(d.tokenQuery);if((0,Y.oH)(e)){const i={type:"newUser",value:{email:e}},n=(0,b.Nd)({target:i,permissionsInviteStore:p});if(!n)return;if(n)return o()(ge.l,{loading:!l},void 0,o()(ue.Z,{title:o()(f.FormattedMessage,{id:"inviteUserModal.userAlreadyInvitedMessage",defaultMessage:"Already inviting {user}.",values:{user:o()("span",{style:{fontWeight:te.Z.fontWeight.bold}},void 0,(0,b.DF)({intl:y,target:n}))}})}));const s=(a&&a.inviteUsers||[]).find((t=>"existingUser"===t.type&&t.value.email===e));if(s&&"existingUser"===s.type&&(0,b.Zp)({store:t,target:s}))return o()(ge.l,{loading:!l},void 0,o()(ue.Z,{title:o()(f.FormattedMessage,{id:"inviteUserModal.userAlreadyHasPermissionMessage",defaultMessage:"{user} already has permission.",values:{user:o()("span",{style:{fontWeight:te.Z.fontWeight.bold}},void 0,(0,$.Nz)(y,s.value))}})}))}else{if(!d.tokenQuery)return o()(ge.l,{loading:!l},void 0,o()(ue.Z,{title:o()(f.FormattedMessage,{id:"inviteUserModal.searchPersonDropdown.noSearchResultsMessage",defaultMessage:"Type or paste in emails above, separated by commas."})}));F.push({key:"user results",render:e=>m().createElement(ge.l,n()({},e,{loading:!l,title:o()(f.FormattedMessage,{id:"inviteUserModal.searchDropdown.addPeople",description:"Header in invite menu, asking user to add a people's email.",defaultMessage:"Keep typing to invite email"})})),items:[{key:d.tokenQuery,render:e=>m().createElement(le.Z,n()({icon:Q.Z.mail({width:24,height:24}),title:d.tokenQuery},e)),action:()=>{}}]})}}return o()(ce.Z,{type:ce.Z.Type.Vertical,initialFocus:S.length>0?0:void 0,sections:F})}};return m().createElement(pe.Z,k)};class Me extends p.Z{constructor(){super(...arguments),l()(this,"renderInShareMenu",this.createComputedStore((()=>Boolean(this.props.renderInShareMenu&&!this.environment.device.isMobile)))),l()(this,"inviteOrigin",this.createComputedStore((()=>this.props.store instanceof I.Z?this.renderInShareMenu.state?"page_share_modal":"page_permission_modal":"space_share_modal"))),l()(this,"defaultRoleForSpaceBot",this.createComputedStore((()=>"editor"))),l()(this,"defaultRoleForNonBot",this.createComputedStore((()=>{const{store:e,isSubscribed:t}=this.props;return b.xT({environment:this.environment,store:e,isSubscribed:t})}))),l()(this,"inputDebounce",void 0),l()(this,"storeTypes",{permissionsInviteStore:Z.Z,contextualInviteStore:k.ZP}),l()(this,"handleUpgradeClick",(()=>{y.Vu({environment:this.environment,upgradeButtonName:this.props.upgradeButtonName,onUpgradeButtonClick:this.props.onUpgradeButtonClick})})),l()(this,"handleModalDismiss",(async()=>{await y.kL({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore})})),l()(this,"handleInputChange",(e=>{var t;null===(t=this.inputDebounce)||void 0===t||t.cancel(),this.inputDebounce=c().debounce((()=>{v.trackInviteTyped(this.environment,{...b.a_(this.environment,this.stores.permissionsInviteStore.state)})}),1e3),this.inputDebounce(),y.jC({event:e,permissionsInviteStore:this.stores.permissionsInviteStore})})),l()(this,"handleClickRemoveToken",(e=>{y.PV({targetToRemove:e,permissionsInviteStore:this.stores.permissionsInviteStore,defaultRoleForNonBot:this.defaultRoleForNonBot.state})}))}async willMount(){await S.bi(this.environment)}willUnmount(){var e;null===(e=this.inputDebounce)||void 0===e||e.flush()}renderComponent(){if(this.renderInShareMenu.state)return this.renderComponentInShareMenu();const e=this.renderHeader(),t=this.renderSearchRequest();return this.renderComponentOriginal(e,t)}renderHeader(){const{permissionsInviteStore:e}=this.stores,{device:t}=this.environment;return o()(K,{permissionsInviteStore:e,store:this.props.store,handleClickRemoveToken:e=>{this.handleClickRemoveToken(e)},handleInputChange:e=>{this.handleInputChange(e)},handleInputSubmit:async()=>{await this.handleInviteInputSubmit()},origin:Boolean(this.renderInShareMenu.state)?"share_menu":"share_modal",defaultRoleForNonBot:this.defaultRoleForNonBot.state,isTeamsEnabled:(0,T.bq)(),right:!t.isMobile&&this.renderDesktopInputRightInner(),focus:"invitee"===e.state.inputFocus||"invitee-popup-closed"===e.state.inputFocus,handleFocus:()=>{t.isMobile||e.setState({...e.state,inputFocus:"invitee"})}})}renderSearchRequest(){const{permissionsInviteStore:e}=this.stores,t=(0,w.NZ)(this.props.store),i=(0,w.NZ)(this.props.store);return o()(Se,{permissionsInviteStore:e,store:this.props.store,defaultRoleForSpaceBot:this.defaultRoleForSpaceBot.state,shouldShowBots:t,shouldShowGroups:i,sectionRenderLimit:this.renderInShareMenu.state?5:10,membersOnly:this.props.membersOnly})}renderComponentOriginal(e,t){const{device:i}=this.environment;let a;return a=i.isMobile?{menuType:_.Z.MenuType.Modal,title:(0,w.Mm)(this.props.store)?o()(f.FormattedMessage,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):o()(f.FormattedMessage,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:o()("div",{style:{color:g.ZP.blue}},void 0,o()(f.FormattedMessage,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})),left:o()(x.CancelMenuText,{}),onClickLeft:this.handleModalDismiss,onClickRight:async()=>{await this.handleInviteClick()},header:e}:{menuType:_.Z.MenuType.Popup,width:480,height:"60vh",header:e,tokenInputHeader:!0,footer:this.renderHelpButton(),disableScroller:!1},m().createElement(_.Z,n()({},a,{className:M.FJ}),i.isMobile&&o()(he.Z,{title:o()(f.FormattedMessage,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"})},void 0,this.renderDesktopInputRightInnerSelect()),o()("div",{},void 0,t),i.isMobile&&this.renderHelpButton())}renderHelpButton(){return this.renderInShareMenu.state?null:o()(he.Z,{topBorder:!0,disableDesktopPadding:!0},void 0,o()(P.Z,{title:o()(f.FormattedMessage,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,C.UY)("guides.invitePerson"),analyticsFrom:"invite_person"}))}renderDesktopInputRightInner(){return o()("div",{style:{marginLeft:h.p_,display:"flex",alignItems:"center"}},void 0,this.renderDesktopInputRightInnerSelect(),!this.renderInShareMenu.state&&this.renderDesktopInputRightInnerButton({isLarge:!0}))}renderDesktopInputRightInnerButton(e){const{isLarge:t}=e;return o()(V,{store:this.props.store,permissionsInviteStore:this.stores.permissionsInviteStore,handleUpgradeClick:()=>this.handleUpgradeClick(),handleInviteClick:()=>this.handleInviteClick(),disabled:this.props.disabled,isLarge:t})}renderDesktopInputRightInnerSelect(){const{device:e}=this.environment,{isSubscribed:t,store:i}=this.props,{permissionsInviteStore:a}=this.stores;if(a.state.isInviteTargetsEmpty||!(0,A.ow)(a.state))return o()(F.Z,{disabled:(0,w.Mm)(i)&&!i.canAdmin(),role:a.state.inviteRole,table:a.state.table,type:"user_permission",blockType:(0,w.NZ)(i)?i.getType():void 0,isSubscribed:t,isInvite:!0,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonStyle:{display:"flex",whiteSpace:"nowrap",height:26,color:g.ZP.uiGray,...this.renderInShareMenu.state&&{marginTop:e.isMobile?4:a.state.isInviteTargetsEmpty?1:6,marginBottom:e.isMobile?4:a.state.isInviteTargetsEmpty?1:6,marginRight:0}},isMenuItem:e.isMobile,onChange:e=>{y.XC({environment:this.environment,newRole:e,permissionsInviteStore:this.stores.permissionsInviteStore})}})}renderComponentInShareMenu(){const e={menuType:_.Z.MenuType.Popup,header:o()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"top",marginLeft:12,marginRight:12,gap:10}},void 0,this.renderHeader(),this.renderDesktopInputRightInnerButton({isLarge:!0})),footer:this.renderHelpButton(),disableScroller:!1};return o()("div",{style:{paddingTop:14,paddingBottom:14,paddingLeft:2,paddingRight:2}},void 0,m().createElement(_.Z,e,this.renderSearchRequest()))}async handleInviteInputSubmit(){await this.handleInviteClick()}async handleInviteClick(){await y.qg({environment:this.environment,store:this.props.store,permissionsInviteStore:this.stores.permissionsInviteStore,contextualInviteStore:this.stores.contextualInviteStore,onInviteClick:this.props.onInviteClick,onInviteComplete:this.props.onInviteComplete,inviteOrigin:this.inviteOrigin.state})}}const be=(0,f.injectIntl)(Me)},7378:(e,t,i)=>{i.r(t),i.d(t,{default:()=>A});var a=i(77094),n=i.n(a),s=i(97464),o=i.n(s),r=i(77422),l=i.n(r),d=(i(33948),i(67294)),c=i.n(d),u=i(83355),m=i(41892),p=i(5366),g=i(21325),h=i(93678),f=i(75472),v=i(65598),y=i(21115),S=i(1903),M=i(78291),b=i(72693),w=i(67719),C=i(99444),T=i(37235),k=i(60442);class Z extends u.Z{constructor(){super(...arguments),l()(this,"storeTypes",{permissionsInviteStore:S.Z}),l()(this,"renderOverlay",(()=>c().createElement(C.default,o()({},this.props,{permissionsInviteStore:this.stores.permissionsInviteStore})))),l()(this,"handleTrialClick",(()=>{h.y(this.environment,{from:this.props.upgradeButtonName,for:"team_free"}),this.props.onUpgradeButtonClick&&this.props.onUpgradeButtonClick()})),l()(this,"handleButtonClick",(()=>{(0,f.z5)({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore,store:this.props.store,renderInShareModal:!1,isSubscribed:this.props.isSubscribed})})),l()(this,"handleModalDismiss",(async()=>{const{permissionsInviteStore:e}=this.stores;await(0,f.Aw)(this.environment,e.state)||e.reset()}))}async willMount(){await g.bi(this.environment)}renderComponent(){const{store:e}=this.props,{modalOpen:t}=this.stores.permissionsInviteStore.state;let i,a,s=!1;return e.canEditMembership()?e.canEditMembership()&&(0,v.Mm)(e)&&M.default.state.data&&!y.qF(this.environment)?(i=!1,s=!0,a=n()(k.Z,{imageURL:m.Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:n()(p.FormattedMessage,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:n()(p.FormattedMessage,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})})):i=!0:(i=!1,a=(0,v.Mm)(e)?n()(p.FormattedMessage,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."}):n()(p.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."})),n()("div",{},void 0,(0,v.Mm)(e)?n()(w.Z,{open:t,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:n()(T.Z,{renderTooltip:()=>a,disableTooltip:i,render:e=>c().createElement(b.Z,o()({isLarge:!0,onClick:s?this.handleTrialClick:this.handleButtonClick,disabled:!i&&!s,style:{flex:this.props.shouldGrow?1:0,...this.props.buttonStyle}},e),n()(p.FormattedMessage,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"}))})}):n()(w.Z,{open:t,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:null}))}}const A=(0,p.injectIntl)(Z)},79627:(e,t,i)=>{i.r(t),i.d(t,{default:()=>z});var a=i(77094),n=i.n(a),s=i(77422),o=i.n(s),r=(i(33948),i(96486)),l=i.n(r),d=i(67294),c=i.n(d),u=i(83355),m=i(480),p=i(28350),g=i(24405),h=i(41892),f=i(8848),v=i(53397),y=i(89101),S=i(82990),M=i(5366),b=i(50906),w=i(93561),C=i(37181),T=i(36867),k=i(27832),Z=i(4926),A=i(95155),I=i(5188),P=i(49085);class _ extends P.Z{getInitialState(){return{open:!1,step:"prompt"}}}const x=new _;var F=i(36324),B=i(13548),E=i(72693),D=i(14947),R=i(42402),L=i(89206),O=i(29551),N=i(63784),U=i(42001),W=i(66722);class V extends u.Z{constructor(){super(...arguments),o()(this,"hasSeenInitial",!1),o()(this,"renderMenu",(()=>n()("div",{style:this.getContainerStyle()},void 0,this.renderCancel(),n()(O.gq,{style:this.getInnerContainerStyle(),alignItems:"center",alignContent:"center"},void 0,this.renderStep())))),o()(this,"renderInitial",(()=>{const e=this.environment.currentUser.id;if(!x.state.open||!e)return;this.hasSeenInitial||((0,b.trackPersonaCollectionStep)(this.environment,{user_id:e,event:"initial"}),this.hasSeenInitial=!0);const{invalidField:t}=x.state;return n()("div",{style:{...this.getSlideUpStyle(),padding:8}},void 0,n()("img",{style:{width:40,height:32},src:h.Z.images.chatButtonSmallPng}),n()("div",{style:{fontSize:14,fontWeight:S.Z.fontWeight.semibold,paddingTop:0,paddingBottom:8}},void 0,n()(M.FormattedMessage,{id:"PersonaCollectionModal.initial.header",defaultMessage:"Tell us more about yourself",description:"Header for the initial modal"})),n()("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:270,margin:"0 auto"}},void 0,n()(M.FormattedMessage,{id:"PersonaCollectionModal.initial.caption",defaultMessage:"We would love to learn more about you so we can make our product better serve you",description:"Caption for the initial modal"})),n()("div",{style:{...this.getLabelStyle(),marginTop:10}},void 0,n()(M.FormattedMessage,{id:"PersonaCollectionModal.initial.roleLabel",defaultMessage:"What is your role?",description:"Question for the role form selection"})),n()(N.Z,{questionType:"role",title:n()(M.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.roleLabel",defaultMessage:"Role",description:"Label for role form"}),question:x.state.role,invalid:"role"===t,onSelect:e=>{x.state.open&&x.setState({...x.state,role:e,step:"initial"})}}),n()("div",{style:this.getLabelStyle()},void 0,n()(M.FormattedMessage,{id:"PersonaCollectionModal.initial.workLabel",defaultMessage:"What kind of work do you do?",description:"Title for work form"})),n()(N.Z,{questionType:"work",title:n()(M.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.workLabel",defaultMessage:"Work",description:"Label for work form"}),question:x.state.work,invalid:"work"===t,onSelect:e=>{x.state.open&&x.setState({...x.state,work:e,step:"initial"})}}),n()("div",{style:this.getLabelStyle()},void 0,n()(M.FormattedMessage,{id:"PersonaCollectionModal.initial.questionLabel",defaultMessage:"What are you planning to use Notion for?",description:"Title for use form"})),n()(N.Z,{questionType:"use",title:n()(M.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.useLabel",defaultMessage:"Use",description:"Label for use form"}),question:x.state.use,invalid:"use"===t,onSelect:e=>{x.state.open&&x.setState({...x.state,use:e,step:"initial"})}}),n()("div",{style:this.getLabelStyle()},void 0,n()(M.FormattedMessage,{id:"PersonaCollectionModal.initial.companySizeLabel",defaultMessage:"Company size",description:"Label for asking company size"})),n()(O.gq,{},void 0,this.getCompanySizeButtonData().map((e=>{let{type:t,message:i,style:a}=e;return n()(U.Z,{isLightGray:!0,isLarge:!0,style:{...this.getBaseButtonStyle(),...x.state.open&&x.state.companySize===t&&this.getSelectedButtonStyle(),...a},onClick:()=>{x.state.open&&x.setState({...x.state,companySize:t,step:"initial"})}},void 0,i)}))))})),o()(this,"renderCancel",(()=>n()(D.Z,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground}},void 0,v.Z.closeSmall({width:14,fill:this.theme.mediumTextColor})))),o()(this,"renderThanks",(()=>{const e=this.environment.currentUser.id;if(e)return n()(H,{userId:e})})),o()(this,"renderPrompt",(()=>{const e=this.environment.currentUser.id;if(e)return n()(G,{userId:e})})),o()(this,"handleCancel",(()=>{const{currentUserSettingsStore:e}=k.default.state,t=this.environment.currentUser.id;e&&t&&((0,b.trackPersonaCollectionAction)(this.environment,{user_id:t,event:"cancel"}),w.createAndCommit({userAction:"PersonaCollectionModal.handleCancel",environment:this.environment,perform:t=>{(0,C.d2)({userSettingsStore:e,data:{seen_persona_collection:!0},transaction:t})}}),x.reset())}))}willMountOrUpdate(){var e;if(x.state.open)return;const t=this.environment,i=t.currentUser.id,a=(0,T.g)(i),{currentUserSettingsStore:n}=k.default.state;if(!n||t.device.isMobile)return;const s=n.getSettings();if(!s)return;const o=Boolean(s.seen_persona_collection||(null===(e=s.persona_version)||void 0===e?void 0:e.version)),r="on"===A.default.getEligibleGroup({experimentId:"persona_collection",defaultGroup:"unassigned"});a>=3&&!o&&r&&!F.default.state.isOnboarding&&"closed"!==x.state.step&&!1===I.Z.state.open&&x.setState({...x.state,open:!0})}renderComponent(){return n()(W.GI,{keepFocus:!1,open:x.state.open,render:this.renderMenu,onDismiss:this.handleCancel,popupType:W.kQ.Popup,disableDarkOverlayBackground:!0,disableMouseCapture:!0})}renderStep(){if(!1===x.state.open)return;const{step:e}=x.state;return c().createElement(c().Fragment,null,n()(B.Z,{isVisible:"initial"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>n()(L.Z,{capture:!0,onBackspace:l().identity,onLeft:l().identity,onRight:l().identity,onSelectAll:l().identity,onRedo:l().identity,onUndo:l().identity,onCut:l().identity,onCopy:l().identity,onPaste:l().identity,onKeypress:l().identity,onDelete:l().identity,onTab:l().identity},void 0,this.renderInitial())}),n()(B.Z,{isVisible:"prompt"===e,animationStyle:this.getAnimationStyle("prompt"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderPrompt}),n()(B.Z,{isVisible:"thanks"===e,animationStyle:this.getAnimationStyle("thanks"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}),n()(B.Z,{isVisible:"initial"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>n()(E.Z,{isLarge:!0,style:{marginTop:17,width:270,position:"absolute",bottom:20},onClick:()=>this.handleSubmitClick()},void 0,n()(M.FormattedMessage,{id:"PersonaCollectionModal.initial.sendLabel",defaultMessage:"Submit",description:"Button to submit survey results"}))}))}getInvalidField(){if(!x.state.open)return"closed";const{use:e,role:t,work:i,companySize:a}=x.state;return a?e?t?i?void 0:"work":"role":"use":"company_size"}getCompanySizeButtonData(){return[{type:"1_100",message:n()(M.FormattedMessage,{id:"PersonaCollectionModal.initial.1_100Label",defaultMessage:"1-100",description:"Button to select 1-100 employees"})},{type:"101_1000",message:n()(M.FormattedMessage,{id:"PersonaCollectionModal.initial.101_1000Label",defaultMessage:"101-1,000",description:"Button to select 101-1000 employees"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:n()(M.FormattedMessage,{id:"PersonaCollectionModal.initial.1000PlusLabel",defaultMessage:"1,001+",description:"Button to select 1,001+ employees"})}]}handleSubmitClick(){const e=this.environment.currentUser.id;if(!x.state.open||!e)return;const t=this.getInvalidField();if(t)return void x.setState({...x.state,step:"initial",invalidField:t});(0,b.trackPersonaCollectionAction)(this.environment,{user_id:e,event:"submit"});const{currentUserSettingsStore:i}=k.default.state;if(i&&x.state.open){const e=x.state;(0,w.createAndCommit)({userAction:"PersonaCollectionModal.handleSubmitClick",environment:this.environment,perform:t=>{(0,C.d2)({userSettingsStore:i,data:{seen_persona_collection:!0,persona:e.work,team_role:e.role,type:e.companySize,use_case:e.use,source:"persona_collection",persona_version:{version:"V3",timestamp:(new Date).getTime()}},transaction:t})}})}x.setState({...x.state,invalidField:void 0,step:"thanks"}),l().delay((()=>{x.reset()}),6e3)}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,position:"fixed",bottom:65+Z.Z.state,right:16+Z.Z.state}}getBackgroundStyle(){return{backgroundColor:"transparent",pointerEvents:"none"}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}getInnerContainerStyle(){return{width:320,height:"prompt"===x.state.step||"thanks"===x.state.step?200:450,overflow:"hidden",position:"relative",right:"auto",padding:30,paddingTop:0,cursor:"default",textAlign:"center",justifyContent:"center"}}getLabelStyle(){return{marginTop:10,fontSize:12,color:this.theme.mediumTextColor,fontWeight:S.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getBaseButtonStyle(){return{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center"}}getSelectedButtonStyle(){return{color:f.ZP.blue,border:"1px solid ".concat(f.ZP.blue)}}getSlideUpStyle(){if(!x.state.open)return{};const{step:e}=x.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(0px)":"translateY(-180px)"}}}const z=V;function G(e){const[t,i]=(0,p.oR)(x),a=(0,g.y)((e=>({promptHeaderStyle:{color:e.regularTextColor,fontWeight:S.Z.fontWeight.semibold,fontSize:14},promptTextStyle:{fontSize:12,color:e.mediumTextColor,width:270,margin:"0 auto"}})),[]),s=(0,m.O7)();return(0,d.useEffect)((()=>{(0,b.trackPersonaCollectionStep)(s,{user_id:e.userId,event:"prompt"})}),[s,e.userId]),n()("div",{style:{paddingTop:24}},void 0,n()("img",{style:{width:40,height:56,paddingTop:24},src:h.Z.images.chatButtonSmallPng}),n()("div",{style:a.promptHeaderStyle},void 0,n()(M.FormattedMessage,{id:"PersonaCollectionModal.prompt.header",defaultMessage:"Tell us more about yourself",description:"Title on survey modal"})),n()("div",{style:a.promptTextStyle},void 0,n()(M.FormattedMessage,{id:"PersonaCollectionModal.prompt.caption",defaultMessage:"We would love to learn more about you so we can make our product better serve you",description:"Explains rationale for survey modal"})),n()(E.Z,{isLarge:!0,style:{marginTop:6,width:260,bottom:20},onClick:()=>{!0===t.open&&i({...t,step:"initial"});const{currentUserSettingsStore:e}=k.default.state;e&&w.createAndCommit({userAction:"PersonaCollectionModal.PersonaCollectionPrompt",environment:s,perform:t=>{(0,C.d2)({userSettingsStore:e,data:{seen_persona_collection:!0},transaction:t})}})}},void 0,n()(M.FormattedMessage,{id:"PersonaCollectionModal.prompt.survey",defaultMessage:"Take the 20 second survey",description:"Button to prompt users to take a short survey"})),n()(U.Z,{isLightGray:!0,isLarge:!0,onClick:()=>{const{currentUserSettingsStore:t}=k.default.state;t&&e.userId&&(w.createAndCommit({userAction:"PersonaCollectionModal.PersonaCollectionPrompt",environment:s,perform:e=>{(0,C.d2)({userSettingsStore:t,data:{seen_persona_collection:!0},transaction:e})}}),(0,b.trackPersonaCollectionAction)(s,{user_id:e.userId,event:"skip"}),x.setState({open:!1,step:"closed"}))}},void 0,n()(M.FormattedMessage,{id:"PersonaCollectionModal.prompt.skipLabel",defaultMessage:"Skip",description:"Button to allow users to skip taking the survey and close out of the modal"})))}function H(e){const t=(0,g.y)((e=>({thanksHeaderStyle:{color:e.regularTextColor,fontWeight:S.Z.fontWeight.semibold,fontSize:14}})),[]),i=(0,m.O7)();return(0,d.useEffect)((()=>{(0,b.trackPersonaCollectionStep)(i,{user_id:e.userId,event:"thanks"})}),[i,e.userId]),n()("div",{},void 0,n()("img",{style:{width:208,height:89,paddingTop:30},src:h.Z.images.heroIllustrationPng}),n()("div",{style:t.thanksHeaderStyle},void 0,n()(M.FormattedMessage,{id:"PersonaCollectionModal.thanks.caption",defaultMessage:"Thank you! Discover new ways to use Notion in the <textlink>Template Gallery</textlink>",description:"Text on thanks modal",values:{textlink:function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return n()(R.Z,{disableUnderline:!0,disableHover:!0,href:y._j.templates,external:!0,style:{color:f.ZP.blue,fontSize:S.Z.fontSize.UIRegular.desktop,fontWeight:500},onClick:()=>{e.userId&&(0,b.trackPersonaCollectionAction)(i,{user_id:e.userId,event:"template_gallery"})}},void 0,a)}}})))}},26200:(e,t,i)=>{i.r(t),i.d(t,{default:()=>U});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=i(77422),l=i.n(r),d=i(67294),c=i.n(d),u=i(83355),m=i(8848),p=i(53397),g=i(46562),h=i(5366);const f=(0,h.defineMessages)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"}});var v=i(82990),y=i(54642),S=i(47307),M=i(360),b=i(28020),w=i(33929),C=i(87279),T=i(33665),k=i(88632),Z=i(25399),A=i(92660),I=i(74523),P=i(69972),_=i(62727),x=i(71202),F=i(86646),B=i(25584),E=i(14598),D=i(47966),R=i(83071),L=i(6202);const O=(0,h.defineMessages)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Add additional information (optional)"}});class N extends u.Z{constructor(e){super(e),l()(this,"handleCancel",(()=>{(0,M.q)()})),l()(this,"renderContent",(()=>{const{device:e}=this.environment;if(!k.Z.state.online)return this.renderOffline();const t=Z.Z.state;return t.open?e.isMobile?this.renderMobileModal(t):this.renderDesktopModal(t):void 0})),l()(this,"onSubmit",(async()=>{const e=this.environment,t=Z.Z.getState();if(!t.open)return;const{additionalInformation:i,reason:a}=t,n=(0,b.Fv)();if(!a||null==n||!n.id)return void S.showErrorMessage(o()(h.FormattedMessage,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const s=await(r=(0,g.OP)(),(0,y.reportPage)(e,{reason:a,page:n,intercomVisitorId:r,additionalInformation:i}));var r;"failed"===s.type?S.showError(s):(Z.Z.setState({open:!1}),S.showMessage({message:c().createElement(c().Fragment,null,o()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},void 0,p.Z.thanksShield({width:40}),o()("div",{style:{paddingTop:12,paddingBottom:8,fontSize:"large",textAlign:"center"}},void 0,o()(h.FormattedMessage,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."}))))}))})),l()(this,"modalTitleStyle",{fontSize:16,marginBottom:12,fontWeight:v.Z.fontWeight.medium})}renderComponent(){return o()(A.Z,{onDismiss:this.handleCancel,render:this.renderContent,requireOnline:!0,modalStore:Z.Z})}renderOptionButtons(e){const{reason:t}=e;return c().createElement(c().Fragment,null,o()(E.Z,{title:o()(h.FormattedMessage,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===t,onClick:()=>Z.Z.setState({...e,reason:"phishing_or_spam"})},"phishing_or_spam"),o()(E.Z,{title:w.default.formatMessage(f.inappropriate_content),isSelected:"inappropriate_content"===t,onClick:()=>Z.Z.setState({...e,reason:"inappropriate_content"})},"inappropriate_content"),o()(E.Z,{title:o()(h.FormattedMessage,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===t,onClick:()=>Z.Z.setState({...e,reason:"other_content_policy_violation"})},"other_content_policy_violation"))}renderMobileModal(e){if(!e.open)return;const{reason:t}=e,i={menuType:C.o.Modal,title:o()(h.FormattedMessage,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:o()(h.FormattedMessage,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:this.handleCancel};return c().createElement(x.Z,i,o()(B.Z,{type:B.Z.Type.Vertical,initialFocus:void 0,sections:[{key:"help",render:e=>{let{children:t,...i}=e;return c().createElement(R.Z,i,t)},items:[{key:"help",render:()=>o()(F.Z,{title:o()(I.Z,{title:o()(h.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,T.UY)("contentPolicy"),analyticsFrom:"report_page"}),right:c().createElement(c().Fragment,null),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...i}=e;return c().createElement(R.Z,i,t)},items:[{key:"options",render:()=>this.renderOptionButtons(e),action:()=>{}},{key:"additionalInfo",render:()=>t&&o()(_.Z,{textarea:!0,style:this.getTextAreaStyle(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:w.default.formatMessage(O.additionalInformationPlaceholder),onChange:t=>{Z.Z.setState({...e,additionalInformation:t.target.value})}}),action:()=>{}}]},{key:"actions",render:e=>{let{children:t,...i}=e;return c().createElement(R.Z,n()({isSubmitButton:!0},i),t)},items:[{key:"submit",render:e=>{const{onClick:t,...i}=e;return c().createElement(L.Z,n()({},i,{disabled:!this.canSubmit(),title:o()("div",{style:{color:m.ZP.red}},void 0,o()(h.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})),onClick:t||this.onSubmit}))},action:this.onSubmit}]}]},"main list"))}canSubmit(){const{state:e}=Z.Z;if(e.open){const{reason:t}=e;return void 0!==t}return!1}renderDesktopModal(e){if(!e.open)return;const{reason:t}=e;return o()(P.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>o()("div",{style:this.getModalWrapStyle()},void 0,o()("div",{style:this.modalTitleStyle},void 0,o()(h.FormattedMessage,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})),o()("div",{style:{paddingBottom:12}},void 0,o()(I.Z,{title:o()(h.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,T.UY)("contentPolicy"),analyticsFrom:"report_page"})),o()("div",{},void 0,this.renderOptionButtons(e)),t&&o()(_.Z,{textarea:!0,style:this.getTextAreaStyle(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:w.default.formatMessage(O.additionalInformationPlaceholder),onChange:t=>{Z.Z.setState({...e,additionalInformation:t.target.value})}}),o()("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18}},void 0,o()(D.Z,{isLarge:!0,onClick:this.handleCancel,style:{marginRight:12}},void 0,o()(h.FormattedMessage,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})),o()(D.Z,{isRed:!0,isLarge:!0,onClick:this.onSubmit,disabled:!this.canSubmit(),disabledFeedback:!0},void 0,o()(h.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"}))))})}renderOffline(){return o()("div",{style:this.getOfflineStyle()},void 0,o()(h.FormattedMessage,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"}))}getModalWrapStyle(){return{width:360,padding:24,fontSize:14}}getOfflineStyle(){return{...this.getModalWrapStyle(),color:this.theme.mediumTextColor}}getTextAreaStyle(){const{device:e}=this.environment;return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:e.isMobile?16:"10px 12px",height:e.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:e.isMobile?16:14}}}const U=N},77155:(e,t,i)=>{i.r(t),i.d(t,{MembersTabTitle:()=>Rt,PeopleRow:()=>Et,SettingToggle:()=>Lt,SidebarTeamModal:()=>Dt});var a=i(77094),n=i.n(a),s=(i(33948),i(96486)),o=i.n(s),r=i(67294),l=i.n(r),d=i(480),c=i(28350),u=i(24405),m=i(97880),p=i(82990),g=i(5366),h=i(50906),f=i(93678),v=i(43250),y=i(23537),S=i(92350),M=i(73643),b=i(27832),w=i(20431),C=i(20454),T=i(48690),k=i(89206),Z=i(15102),A=i(79029),I=i(11082),P=i(13490),_=i(47714),x=i(66957),F=i(31430),B=i(58260),E=i(97464),D=i.n(E),R=(i(41817),i(73210),i(64964)),L=i(38363),O=i(93561),N=i(78122),U=i(35901),W=i(72693),V=i(29368),z=i(69972),G=i(62727),H=i(47966),q=i(37235),K=i(46951),j=i(51923),Y=i(93686);function Q(e){let{title:t,subtitle:i,style:a}=e;const s=(0,u.y)((e=>({base:{width:"100%"},title:{fontWeight:p.Z.fontWeight.medium,color:e.regularTextColor,fontSize:14},subtitle:{fontWeight:p.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:12}})),[]);return n()("div",{style:{...s.base,...a}},void 0,n()("div",{style:s.title},void 0,t),i&&n()("div",{style:s.subtitle},void 0,i))}var J=i(45660),X=i(61543);function $(e){let{teamStore:t}=e;const{currentSpaceStore:i}=(0,c.Kw)(b.default),a=(0,d.O7)(),s=(0,J.D)(),o=(0,M.Z)(),r=(0,y.HC)(),m=a.currentUser.id,p=(0,u.y)((e=>({header:{marginBottom:4}})),[]),h=(0,c.VK)((()=>{var e,a,n;return{disable_public_access:{spaceIsDisabled:null!==(e=null==i?void 0:i.getDisablePublicAccess())&&void 0!==e&&e,teamIsDisabled:t.getDisablePublicAccess()},disable_export:{spaceIsDisabled:null!==(a=null==i?void 0:i.getDisableExport())&&void 0!==a&&a,teamIsDisabled:t.getDisableExport()},disable_guests:{spaceIsDisabled:null!==(n=null==i?void 0:i.getDisableGuests())&&void 0!==n&&n,teamIsDisabled:t.getDisableGuests()},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits()}}}),[i,t]),f=(0,S.ql)(t),v=(0,c.VK)((()=>{var e;return null!==(e=null==i?void 0:i.canAdmin())&&void 0!==e&&e}),[i]);if(!i)return null;if(!m)return null;const w=e=>s&&!h[e].teamIsDisabled,C=e=>{if(w(e))return!1;if(!f)return!1;return!(e=>h[e].spaceIsDisabled&&h[e].teamIsDisabled)(e)||v},T=e=>w(e)&&v,k=e=>{const{teamIsDisabled:i,spaceIsDisabled:n}=h[e],s=!i;(0,L.d)({environment:a,store:t,settingName:e,newTeamSettingValue:te(s),spaceSettingValue:void 0===n?void 0:te(n)})},Z=e=>{if((e=>h[e].spaceIsDisabled)(e))return(e=>h[e].teamIsDisabled)(e)?n()(g.FormattedMessage,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",description:"Text explaining that a setting is inherited from the workspace settings.",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("span",{style:{textDecoration:"underline"}},void 0,t)}}}):n()(g.FormattedMessage,{id:"teamSettingsSecurity.overridesWorkspaceSettings",description:"Text explaining that a setting overrides the workspace settings.",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("span",{style:{textDecoration:"underline"}},void 0,t)}}})},A=n()(X.Z,{subscriptionTier:o,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),I=n()(g.FormattedMessage,"business"===o?{id:"teamSettingsSecurity.setting.businessGateToggleTooltip",defaultMessage:"Upgrade to Business Plan to change security settings",description:"Shown when a user requires upgrade to change security setting."}:{id:"teamSettingsSecurity.setting.enterpriseGateToggleTooltip",defaultMessage:"Upgrade to Enterprise Plan to change security settings",description:"Shown when a user requires upgrade to change security setting."});return l().createElement(l().Fragment,null,n()(Q,{style:p.header,title:n()(g.FormattedMessage,{id:"TeamSettingsSecurity.title",defaultMessage:"Security",description:"Teamspace security menu."})}),n()(Lt,{on:h.disable_public_access.teamIsDisabled,disabled:!C("disable_public_access"),onChange:()=>k("disable_public_access"),shouldTriggerUpsell:T("disable_public_access"),secondCaption:Z("disable_public_access"),title:l().createElement(l().Fragment,null,n()(g.FormattedMessage,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable public page sharing",description:"Disable public page sharing for the teamspace"}),w("disable_public_access")&&A),caption:n()(g.FormattedMessage,{id:"teamSettingsSecurity.setting.shareCaption",defaultMessage:"Disable the Share to web option in the Share menu for all pages in this teamspace.",description:"Disable the Share to web option in the Share menu for all pages in this teamspace."}),tooltip:w("disable_public_access")&&I}),n()(Lt,{on:h.disable_guests.teamIsDisabled,disabled:!C("disable_guests"),onChange:()=>k("disable_guests"),shouldTriggerUpsell:T("disable_guests"),secondCaption:Z("disable_guests"),title:l().createElement(l().Fragment,null,n()(g.FormattedMessage,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests",description:"Disable guests for this teamspace"}),w("disable_guests")&&A),caption:n()(g.FormattedMessage,{id:"teamSettingsSecurity.setting.guestCaption",defaultMessage:"Prevent anyone from inviting people outside of the workspace to pages.",description:"Prevent anyone from inviting people outside of the workspace to pages for this teamspace."}),tooltip:w("disable_guests")&&I}),n()(Lt,{on:h.disable_export.teamIsDisabled,disabled:!C("disable_export"),onChange:()=>k("disable_export"),shouldTriggerUpsell:T("disable_export"),secondCaption:Z("disable_export"),title:l().createElement(l().Fragment,null,n()(g.FormattedMessage,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export",description:"Disable export for this team"}),w("disable_export")&&A),caption:n()(g.FormattedMessage,{id:"teamSettingsSecurity.setting.exportCaption",defaultMessage:"Prevent anyone from exporting as Markdown, CSV, or PDF.",description:"Prevent anyone from exporting as Markdown, CSV, or PDF for this team."}),tooltip:w("disable_export")&&I}),r&&n()(j.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",message:n()(g.FormattedMessage,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security",description:"Link text that shows in the security tab of the teamspaces settings modal. When the user clicks the link, they are taken to a reference with more information about teamspaces security and permissions."})}))}function ee(e){const t=(0,d.O7)(),i=(0,u.y)((e=>({disabled:{background:e.whiteButtonBackground,color:e.mediumTextColor}})),[]);return l().createElement(H.Z,D()({style:e.disabled?i.disabled:void 0,isLarge:!0,isRed:!e.disabled,disabled:e.disabled,onClick:()=>e.disabled?void 0:async function(e){let{teamStore:t,environment:i}=e;await(0,L.aQ)({environment:i,teamStore:t,from:"sidebar_team_modal"})}({environment:t,teamStore:e.teamStoreInstance})},e.tooltipEvents),n()(g.FormattedMessage,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace",description:"Archive teamspace"}))}function te(e){return e?"disable":"allow"}function ie(e){var t;let{teamStore:i}=e;const a=(0,d.O7)(),[{currentSpaceStore:s}]=(0,c.oR)(b.default),o=(0,S.TE)(i),l=(0,y.HC)(),[m,p]=(0,r.useState)(void 0),[h,f]=(0,r.useState)(void 0),v=o?22:34,M=(0,u.y)((()=>({container:{maxWidth:400,marginLeft:4},settingsLabel:{marginTop:o?12:8},descriptionLabel:{marginTop:12},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:o?18:0},icon:{marginRight:8},name:{height:v},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:20}})),[o,v]),w=(0,c.VK)((()=>i.state),[i]);if(!w.value)return null;const C=w.value.name,T=null!==(t=w.value.description)&&void 0!==t?t:"",k=T.length>0,Z=null==m?void 0:m.trim(),A=null==h?void 0:h.trim(),I=""===Z||(void 0===h||A===T.trim())&&(void 0===m||Z===C.trim());return n()("div",{style:M.container},void 0,n()(Q,{title:n()(g.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.title",defaultMessage:"Teamspace details",description:"Basic details for teamspace."})}),n()(P.Z,{style:M.settingsLabel},void 0,n()(g.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name",description:"Icon and name for teamspace."})),n()("div",{style:M.nameAndIconWrap},void 0,n()(Y.p,{disabled:o,store:i,style:M.icon,size:v,onChange:e=>{(0,O.createAndCommit)({userAction:"TeamSettingsGeneral.updateIcon",environment:a,perform:t=>{(0,L.fs)({store:i,update:{icon:e},transaction:t})}})}}),o?n()(K.Z,{},void 0,C):n()(ae,{value:null!=m?m:C,style:M.name,onBlur:e=>{p(e)},onChange:e=>{p(e)},disabled:o,placeholder:"Acme Labs"})),n()(P.Z,{style:M.descriptionLabel},void 0,n()(g.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description",description:"Description for teamspace."})),o?n()(K.Z,{isMultiline:!0,isSecondaryColor:!k},void 0,k?T:n()(g.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description",description:"Shown in teamspace settings for teamspace members when there is no teamspace description."})):n()(ae,{value:void 0===h?T:h,onBlur:e=>{f(e)},onChange:e=>{f(e)},disabled:o,textarea:!0,placeholder:"Details about your teamspace"}),!o&&n()(W.Z,{style:M.updateButton,disabled:I,isLarge:!0,onClick:async()=>{if(!I){if(Z&&Z!==C.trim()){if(!(await(0,N.Xg)({environment:a,spaceStore:s,teamName:Z})))return}(0,O.createAndCommit)({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:a,perform:e=>{(0,L.fs)({store:i,update:{name:null!=Z?Z:C,description:null!=A?A:T},transaction:e})}}),R.oV({label:n()(g.FormattedMessage,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details",description:"Tells the user that the changes they made to the team settings were successfully made."})})}}},void 0,n()(g.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})),n()(ne,{teamStore:i}),l&&n()(j.Z,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:M.learnMoreLinkContainer}))}function ae(e){const{value:t,style:i,onBlur:a,onChange:s,placeholder:o,disabled:d}=e,[c,u]=(0,r.useState)(!1),m=(0,r.useRef)(null);return n()(z.Z,{capture:c,render:n=>l().createElement(G.Z,D()({textarea:e.textarea,autosize:e.autosize,ref:m,onFocus:e=>{u(!0)},onBlur:e=>{u(!1),a(e.target.value)},onChange:e=>{u(!1),s&&s(e.target.value)},onSubmit:e=>{e.target.blur()},placeholder:o,disabled:d,value:t,style:i},n))})}function ne(e){let{teamStore:t}=e;const i=(0,u.y)((()=>({divider:{marginTop:20,marginBottom:20},dangerZoneLabel:{marginBottom:8},archiveMessageLabel:{marginTop:8}})),[]),a=(0,d.O7)(),s=(0,c.VK)((()=>t.state),[t]).value,o=(0,S.ql)(t),r=(0,U.y)(t.id);if(!s)return null;if(!o)return null;const m=s.name,p=Boolean(s.archived_by);return l().createElement(l().Fragment,null,n()(V.Z,{size:1,style:i.divider}),n()(Q,{title:n()(g.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),style:i.dangerZoneLabel}),p?l().createElement(l().Fragment,null,n()(H.Z,{isLarge:!0,onClick:()=>(e=>{let{teamStore:t,teamName:i}=e;return(0,L.YH)({environment:a,teamStore:t,teamName:i,from:"sidebar_team_modal"})})({teamName:m,teamStore:t})},void 0,n()(g.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})),n()(K.Z,{isSmall:!0,isMultiline:!0,style:i.archiveMessageLabel},void 0,n()(g.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."}))):l().createElement(l().Fragment,null,n()(q.Z,{disableTooltip:!r,renderTooltip:()=>n()(g.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.cannotArchive",defaultMessage:"Cannot archive this teamspace because it is the only default teamspace in this workspace.",description:"Tells the user that they're unable to archive this teamspace due to stated reason."}),render:e=>n()(ee,{disabled:r,teamStoreInstance:t,tooltipEvents:e})}),n()(K.Z,{isSmall:!0,isMultiline:!0,style:i.archiveMessageLabel},void 0,n()(g.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamCaption",defaultMessage:"Archiving this teamspace will remove access and hide it in the sidebar for all teamspace members."}))))}var se=i(53397),oe=i(77907),re=i(33052);function le(e){let{teamStore:t}=e;const i=(0,u.y)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.modalBackground,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),a=(0,g.useIntl)(),[s,o]=(0,c.oR)(T.Z),[r,d,m]=(0,c.oR)(void 0,re.Z),p=(0,S.ef)(t),h=(0,S.vR)(t);return n()("div",{style:i.container},void 0,n()(oe.LazyTeamPermissionsInviteWithModal,{store:t,permissionsInviteStore:m,origin:n()(q.Z,{placement:q.Z.Placement.Left,alignment:q.Z.Alignment.Start,textWrap:!0,renderTooltip:()=>h?n()("div",{style:{width:270}},void 0,n()(g.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembersToDefaultTeam.tooltip",defaultMessage:"You can’t add members because this is a default teamspace and is synced with all workspace members",description:"Message that tells the user that they cannot add members to this team since it is a default team."})):p?n()("div",{style:{width:150}},void 0,n()(g.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups",description:"Message that tells the user that they can add members and groups via this button."})):n()("div",{style:{width:220}},void 0,n()(g.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace",description:"Message that tells the user that they cannot add members to this team since they do not have permissions."})),render:e=>l().createElement(W.Z,D()({disabled:h||!p,isLarge:!0,onClick:()=>{d({...r,modalOpen:!0})}},e),n()(g.FormattedMessage,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"}))})}),n()(G.Z,{placeholder:a.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…",description:"Search input text shown in team settings for filtering groups and members in a team."}),style:i.input,value:s.memberFilterQuery,onChange:e=>{o({...s,memberFilterQuery:e.target.value,limitMembers:!0})},left:se.Z.searchThick(i.searchIcon),showClearButton:!0,format:G.Z.Format.Small}))}i(85827);var de=i(31942),ce=i(59054),ue=i(27006),me=i(19889),pe=i(64684),ge=i(31299),he=i(38755),fe=i(33058),ve=i(75246),ye=i(67669),Se=i(86125),Me=i(77701),be=i(25735),we=i(23596),Ce=i(40039),Te=i(52738),ke=i(47307),Ze=i(61766),Ae=i(60709),Ie=i(48762),Pe=i(46167),_e=i(71202),xe=i(25584),Fe=i(42001),Be=i(83071),Ee=i(29369),De=i(7567);function Re(e){const{teamStore:t,memberInfo:i,permissionItem:a,memberName:s,style:o,onMenuItemClicked:m,isPermissionOverridden:p}=e,h=(0,d.O7)(),f=(0,g.useIntl)(),v=(0,u.F)(),y=(0,r.useMemo)((()=>new Ze.Z),[]),S=(0,u.y)((e=>({header:{display:"flex",flexDirection:"column",backgroundColor:e.sidebarSecondaryBackground,fontSize:12,color:e.mediumTextColor,alignItems:"flex-start",paddingTop:10,paddingLeft:12,paddingRight:12,paddingBottom:10},overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},overrideLabel:{paddingLeft:8,color:e.mediumTextColor}})),[]),M=(0,c.VK)((()=>t.getTeamPermission()),[t]),w=(0,c.VK)((()=>{const e=null==t?void 0:t.getValue(),i=f.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members‘ access to enable this option."}),a=n()(g.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});function s(t){return e&&(0,pe.bk)(e,t)?{isDisabled:!0,disabledMessage:i}:void 0}return["editor","read_and_write","comment_only","reader"].map((e=>({role:e,disabledInfo:s(e),tag:(null==M?void 0:M.role)===e?a:void 0})))}),[M,f,t]);const[{currentSpaceStore:C}]=(0,c.oR)(b.default),T=(0,c.VK)((()=>!("enterprise"===(null==C?void 0:C.getSubscriptionTier()))&&!p),[C,p]),k=n()("div",{style:S.overrideTitle},void 0,n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions",description:"A menu item for the user to click on and assign or see the custom role for a team member."}),T?n()(X.Z,{subscriptionTier:"enterprise",analyticsName:"team_member_permission_override",desktopStyle:{marginLeft:8,marginRight:12}}):n()(De.Z,{role:"owner"===i.type?"none":a.role,table:Ee.e0,type:"user"===i.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===i.entity_type?"user_permission_item":"group_permission_item",buttonStyle:{marginRight:0,fontSize:12,color:v.mediumTextColor,visibility:p?void 0:"hidden"},availableRoleItems:w,header:n()(K.Z,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginLeft:16,marginTop:8}},void 0,n()(g.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role",description:"Header text for the customize permission options popup."})),onChange:e=>{"none"!==e&&(!function(e){ke.showDialog({message:n()(g.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}'s role to {role}?",values:{name:s,role:(0,ye.r_)(e).toLowerCase()}}),description:n()(g.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:ke.dismissDialog,items:[{label:n()(g.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:a}=O.createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:h,perform:a=>{L.jg({memberInfo:i,teamStore:t,transaction:a,environment:h,permissionRole:e})}});await a}}]})}(e),m&&m())},buttonPopupStore:y,placementToOrigin:Ae.Iw.Right,alignmentToOrigin:Ae.lU.End}));return n()(q.Z,{placement:q.Z.Placement.Left,textWrap:!0,renderTooltip:()=>n()(g.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace",description:"Tooltip shown when hovering over the custom permissions button."}),render:e=>l().createElement(Ie.Z,D()({},e,{focused:!1,style:o,textWrapperStyle:{marginRight:0},disabled:T,onClick:()=>y.setState({open:!0}),title:k,icon:p?n()("div",{style:{marginTop:8}},void 0,se.Z.check({width:14})):void 0}))})}function Le(e){let{teamStore:t,memberInfo:i,permissionItem:a,memberName:s,isPermissionOverridden:o,disabled:r}=e;const l=(0,c.qz)(void 0,Ze.Z),[u,p]=(0,c.oR)(l),h=(0,d.O7)(),[{currentUserStore:f,currentSpaceStore:v}]=(0,c.oR)(b.default),y=(0,c.VK)((()=>{const e=null==f?void 0:f.userId;return"user"===i.entity_type&&i.user_id===e}),[null==f?void 0:f.userId,i]),S=()=>p({...u,open:!1}),M=async e=>{if(S(),"owner"===e){if("user"===i.entity_type){const{serverCommitResult:e}=O.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:h,perform:e=>{L.W8({environment:h,userId:i.user_id,teamStore:t,transaction:e})}});await e}}else y?ke.showDialog({message:n()(g.FormattedMessage,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You'll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:ke.dismissDialog,items:[{label:n()(g.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:w}]}):await w()},w=async()=>{if("owner"===i.type&&"user"===i.entity_type){const{serverCommitResult:e}=O.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:h,perform:e=>{L.mX({userId:i.user_id,teamStore:t,transaction:e,environment:h})}});await e}else if("member"===i.type){const{serverCommitResult:e}=O.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:h,perform:e=>{L.X0({memberInfo:i,teamStore:t,transaction:e})}});await e}},C=async()=>{const{entity_type:e}=i;switch(S(),e){case"group":const a=(0,he.getSpacePermissionGroup)({spaceStore:v,groupId:i.group_id});if(!a)throw new Error("Permission group not found in space.");L.mN({environment:h,teamStore:t,group:a});break;case"user":await L.WO({environment:h,teamStore:t,currentSpaceStore:v,userId:i.user_id,from:"team_settings_member_table"});break;default:(0,m.t1)(e)}};return n()(Pe.Z,{buttonPopupStore:l,placementToOrigin:Ae.Iw.Bottom,renderOrigin:e=>n()(Ne,{buttonPopupEvents:e,isPermissionOverridden:o,permissionItem:a,memberInfo:i,disabled:r}),render:()=>n()(Oe,{teamStore:t,isPermissionOverridden:o,memberInfo:i,permissionItem:a,memberName:s,onMenuItemClicked:M,onRemoveClicked:C,onSubMenuItemClicked:S}),popupType:Pe.Z.PopupType.Popup})}function Oe(e){let{teamStore:t,isPermissionOverridden:i,memberInfo:a,permissionItem:s,memberName:r,onRemoveClicked:d,onMenuItemClicked:m,onSubMenuItemClicked:h}=e;const f=(0,c.VK)((()=>t.isDefault()),[t]),S=(0,c.VK)((()=>(0,y.Hu)({membership:t.getKeyStore("membership").getValue()})),[t]),M=(0,c.VK)((()=>1===t.getMembers().filter((e=>"owner"===e.type)).length),[t]),b=(0,u.y)((e=>{const t={paddingTop:5,paddingBottom:5},i={...t,width:280,alignItems:"flex-start"};return{actionMenu:{marginTop:-4},removeButton:{...t,color:e.errorText},menuItem:i,indentedMenuItem:{...i,paddingLeft:20},overrideLabel:{paddingLeft:10,color:e.mediumTextColor,fontSize:12,fontWeight:p.Z.fontWeight.regular}}}),[]),w=(e,t)=>{const a="member"===e&&"owner"===t.type&&M||"owner"===e&&"group"===t.entity_type,o="owner"===e&&"group"===t.entity_type||a;return{key:e,action:()=>m(e),render:r=>{const d=!i&&t.type===e;return n()(q.Z,{disableTooltip:!a,placement:q.Z.Placement.Right,textWrap:!0,renderTooltip:()=>"group"===t.entity_type?n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableOwnerForGroupsTooltip",defaultMessage:"Groups can't be teamspace owners",description:"Tooltip shown when the option for upgrading someone to an owner is disabled because it is a group."}):n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableWithOnlyOneOwnerTooltip",defaultMessage:"Add another teamspace owner to downgrade yourself to member",description:"Tooltip shown when the option for downgrading someone to a member is disabled because there is only one owner."}),render:t=>l().createElement("span",t,l().createElement(Ie.Z,D()({},r,{style:d?b.menuItem:b.indentedMenuItem,disabled:o,disabledFeedback:o,title:n()(Ue,{isPermissionOverridden:i,type:e,permissionItem:s}),caption:Ve(e),shouldWrapCaption:!0,icon:d?se.Z.check({width:14}):void 0})))})}}},C=f&&"user"===a.entity_type,T=[{key:"teamRoles",items:o().compact([w("owner",a),w("member",a),ze({onRemoveClicked:d,styles:b,isMemberInDefaultTeam:C}),..."owner"===a.type||S?[]:[{key:"divider",action:()=>{},render:()=>n()(V.Z,{size:10})},{key:"permissions_override",action:()=>{},render:e=>l().createElement("span",e,n()(Re,{teamStore:t,memberInfo:a,permissionItem:s,memberName:r,onMenuItemClicked:h,isPermissionOverridden:i,style:i?b.menuItem:b.indentedMenuItem}))}]]),render:e=>l().createElement(Be.Z,D()({},e,{topBorder:0!==e.index}))}];return n()(_e.Z,{className:v.a6,menuType:_e.Z.MenuType.Popup},void 0,n()(xe.Z,{type:xe.Z.Type.Vertical,initialFocus:void 0,sections:T}))}function Ne(e){let{buttonPopupEvents:t,disabled:i,isPermissionOverridden:a,permissionItem:s,memberInfo:o}=e;const r=(0,u.y)((e=>({label:{color:e.regularTextColor,fontSize:12.5,fontWeight:p.Z.fontWeight.regular},overrideLabel:{color:e.mediumTextColor,fontSize:12,fontWeight:p.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),d=function(e,t,i){if(t&&i)return function(e){switch(e){case"none":return n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,m.t1)(e)}}(i);return We(e)}(o.type,a,s.role);return l().createElement(Fe.Z,D()({disabled:i},t),a&&n()("span",{style:r.overrideLabel},void 0,n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom",description:"Tells the user that this is a custom permission override."}),n()("span",{style:{marginLeft:5,marginRight:5}},void 0,"•")),n()("span",{style:r.label},void 0,d),!i&&se.Z.chevronDown(r.chevron))}function Ue(e){let{isPermissionOverridden:t,permissionItem:i,type:a}=e;const s=We(a);return n()("div",{},void 0,n()("span",{},void 0,s))}function We(e){switch(e){case"owner":return n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.ownerLabel",defaultMessage:"Teamspace owner"});case"member":return n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.memberLabel",defaultMessage:"Member"});case"team_level_guest":return n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.guestLabel",defaultMessage:"Guest"});default:(0,m.t1)(e)}}function Ve(e){switch(e){case"owner":return n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.ownerCaption",defaultMessage:"Full access to teamspace pages and can edit teamspace settings"});case"member":return n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.memberCaption",defaultMessage:"Access to teamspace pages but cannot edit teamspace settings"});case"team_level_guest":return;default:(0,m.t1)(e)}}function ze(e){let{styles:t,onRemoveClicked:i,isMemberInDefaultTeam:a}=e;const s=a?n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.remove.disabledTooltip.cannotRemoveFromDefault",defaultMessage:"Members cannot be removed from a default teamspace.",description:'Tooltip shown when hovering over the disabled "Remove" button, shown to indicate that members cannot be removed since the group is default .'}):void 0;return{key:"remove",action:i,render:e=>n()(q.Z,{disableTooltip:!s,placement:q.Z.Placement.Right,textWrap:!1,renderTooltip:()=>s,render:i=>l().createElement("span",i,l().createElement(Ie.Z,D()({},e,{style:{...t.removeButton,...t.indentedMenuItem},disabled:Boolean(s),disabledFeedback:!0,title:n()(g.FormattedMessage,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})))})}}var Ge=i(13380);function He(e){const{icon:t,label:i,name:a,tag:s,style:o}=e,r=(0,u.y)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...o},labelContainer:{display:"flex",flexDirection:"column",...p.Z.textOverflowStyle},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[o]);return n()("div",{style:r.container},void 0,t,n()("div",{style:r.labelContainer},void 0,n()("div",{style:r.nameContainer},void 0,n()(Ge.s,{style:r.name},void 0,a),s),n()(K.Z,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0},void 0,n()(Ge.s,{},void 0,i))))}function qe(e){const{iconComponent:t,label:i,name:a,permissionRoleSelectComponent:s,tag:o,tooltip:r,style:d}=e,c=(0,u.y)((e=>({permissionRow:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center",...d}})),[d]);return n()("div",{style:c.permissionRow},void 0,n()(He,{icon:t,name:a,tag:o,label:i,style:{minWidth:200,marginRight:6}}),n()(q.Z,{textWrap:!0,style:{width:210},disableTooltip:!r,placement:q.Z.Placement.Left,renderTooltip:()=>r,render:e=>l().createElement("span",e,s)}))}function Ke(e){const{type:t,store:i,permissionItem:a,memberInfo:s}=e,[{currentSpaceStore:o}]=(0,c.oR)(b.default),r=(0,g.useIntl)(),p=(0,c.VK)((()=>{switch(t){case"group":return"none";case"user":const i=null==o?void 0:o.getValue();return i?(0,ye.su)(i,e.memberInfo.user_id):"none";default:(0,m.t1)(t)}}),[o,t,e]),h=(0,S.ql)(i),f=(0,d.O7)(),v=(0,c.VK)((()=>{const e=f.currentUser.id,t=null==o?void 0:o.getValue(),a=i.getValue();return!!(t&&a&&e)&&(0,pe.W9)(a,e,t)}),[f.currentUser.id,o,i]),y=(0,c.VK)((()=>{var e;return"owner"!==s.type&&a.role!==(null===(e=i.getTeamPermission())||void 0===e?void 0:e.role)}),[s.type,a.role,i]),{name:M,label:w,icon:C}=(0,c.VK)((()=>{switch(t){case"group":return function(e){var t;let{spaceId:i,permissionGroup:a}=e;const{name:s,user_ids:o,icon:r}=a,d=null!==(t=null==o?void 0:o.length)&&void 0!==t?t:0;return{name:null!=s?s:n()(g.FormattedMessage,{id:"teamPermissionSettings.unknownGroup",defaultMessage:"Unknown Group",description:"Shown in team members list in team settings when group name is not available."}),label:n()(q.Z,{placement:q.Z.Placement.Bottom,alignment:q.Z.Alignment.Start,disableTooltip:0===d,renderTooltip:()=>n()(be.Y,{group:a,limit:10,noMembersMessage:void 0}),render:e=>l().createElement("div",e,n()(g.FormattedMessage,{id:"teamPermissionSettings.group",defaultMessage:"Group",description:"Indicates a group of members"})," • ",n()(g.FormattedMessage,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",description:"Shown in team members list in team settings underneath group name.",values:{groupSize:d}}))}),icon:r&&n()(Ce.Z,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:s,size:18,icon:r&&i?{icon:r,pointer:{table:ve.bx,id:i}}:void 0})}}({permissionGroup:e.permissionGroup,spaceId:null==o?void 0:o.id});case"user":return function(e){let{intl:t,userValue:i}=e;return{name:(0,me.Nz)(t,i),label:null==i?void 0:i.email,icon:n()(Te.Z,{avatarShouldShowShadow:!0,userValue:i,size:we.Z.iconSize})}}({intl:r,userValue:e.userStore.getValue()});default:(0,m.t1)(t)}}),[t,e,r,null==o?void 0:o.id]),T=n()("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},void 0,n()(Le,{teamStore:i,memberInfo:s,memberName:M,permissionItem:a,isPermissionOverridden:y,disabled:!h&&!v})),k=(0,u.y)((e=>({row:{minHeight:52},pill:{marginLeft:6,height:17}})),[]);return n()(qe,{style:k.row,tag:(0,ue.Bc)(p)?n()(Se.Z,{desktopStyle:k.pill,mobileStyle:k.pill,role:je(p)}):"group"===t?n()("div",{style:k.pill},void 0,C):void 0,permissionRoleSelectComponent:T,iconComponent:"group"===t?n()(Me.Z,{size:32}):C,name:M,label:w})}function je(e){switch(e){case"editor":return"admin";case"membership_admin":return"membership_admin";default:(0,m.t1)(e)}}function Ye(e){let{teamStore:t,memberToAdd:i}=e;const a=(0,d.O7)(),s=(0,g.useIntl)(),o=(0,u.y)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"}})),[]),l=(0,r.useCallback)((e=>{R.oV({label:n()(g.FormattedMessage,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {user}",description:"Client side message shown when the team invite fails on the server side.",values:{user:e.name||e.email}})})}),[]),c=(0,r.useCallback)((async e=>{await(0,L.Uj)({environment:a,teamMemberInfos:[{type:"member",entity_type:"user",user_id:e.id}],teamStore:t,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})||l(e)}),[a,t,l]);return n()("div",{style:o.container},void 0,n()(He,{icon:n()(Te.Z,{userValue:i,size:32}),name:(0,me.Nz)(s,i),label:i.email}),n()(Fe.Z,{isBlue:!0,onClick:async()=>{await c(i)},icon:se.Z.plus},void 0,n()(g.FormattedMessage,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",description:"Button for add a member to the team.",defaultMessage:"Add"})))}function Qe(e){let{sortType:t,onChangeSortType:i}=e;const a=(0,u.y)((e=>({container:{width:"100%",display:"flex",justifyContent:"space-between",borderBottom:"1px solid ".concat(e.regularDividerColor)}})),[]),s=e=>e===t.column?t.sortedAscending?"ascending":"descending":"none",o=e=>{const a=e===t.column&&!t.sortedAscending;i({column:e,sortedAscending:a})};return l().createElement(l().Fragment,null,n()("div",{style:a.container},void 0,n()(Je,{title:n()(g.FormattedMessage,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:s("name"),onClick:()=>o("name")}),n()(Je,{title:n()(g.FormattedMessage,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:s("role"),onClick:()=>o("role")})))}function Je(e){let{sortedType:t,title:i,onClick:a}=e;const s=(0,u.y)((e=>({button:{color:e.mediumTextColor,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor}})),[]);return n()(Fe.Z,{style:s.button,hoveredStyle:s.buttonHover,onClick:a},void 0,"ascending"===t&&se.Z.arrowUp(s.sortIcon),"descending"===t&&se.Z.arrowDown(s.sortIcon),i)}function Xe(e){var t,i;let{store:a}=e;const s=(0,d.O7)(),h=(0,u.y)((e=>({container:{display:"block",overflow:"hidden"},membersHeader:{marginBottom:8},noResult:{fontSize:p.Z.fontSize.UIRegular.desktop,color:e.mediumTextColor,marginTop:8},showMore:{marginBottom:24,width:"max-content"}})),[]),[f,v]=(0,r.useState)({column:"role",sortedAscending:!1}),[y]=(0,c.oR)(T.Z),M=(0,S.ef)(a),w=(0,c.VK)((()=>{const e=null==a?void 0:a.getValue();if(!e)return[];return(0,pe.hY)(e)}),[a]),[{currentUserStore:k,currentSpaceStore:Z}]=(0,c.oR)(b.default),{permissionRowInfos:A,numNotShown:I}=(0,c.VK)((()=>{const e=function(e){let{permissionRowInfos:t,memberFilterQuery:i}=e;if(""===i)return t;return(0,de.ZP)(i,t,(e=>{var t;const{type:i}=e;switch(i){case"group":return null!==(t=e.permissionGroup.name)&&void 0!==t?t:"";case"user":const a=e.userStore.getValue();return a?(0,me.of)(a):"";default:(0,m.t1)(i)}}))}({permissionRowInfos:function(e){let{currentUserStore:t,currentSpaceStore:i,teamStore:a,members:n}=e;return o().compact(n.map((e=>{const{entity_type:n}=e;return"user"===n?function(e){let{currentUserStore:t,teamStore:i,member:a}=e;if(!t)return;const n=$e({teamStore:i,member:a}),s=C.Z.createChildStore(t,{table:me.KJ,id:a.user_id});return{type:"user",memberInfo:a,permissionItem:{type:"user_permission",user_id:a.user_id,role:n},userStore:s}}({currentUserStore:t,teamStore:a,member:e}):"group"===n?function(e){let{currentSpaceStore:t,teamStore:i,member:a}=e;const n=(0,he.getSpacePermissionGroup)({spaceStore:t,groupId:a.group_id});if(!n)return;const s=$e({teamStore:i,member:a});return{type:"group",memberInfo:a,permissionItem:{type:"group_permission",group_id:n.id,role:s},permissionGroup:n}}({currentSpaceStore:i,teamStore:a,member:e}):void(0,m.t1)(n)})))}({currentUserStore:k,currentSpaceStore:Z,teamStore:a,members:w}),memberFilterQuery:y.memberFilterQuery}),t=function(e){let{permissionRowInfos:t,sortType:i}=e;const{column:a,sortedAscending:n}=i,s={permissionRowInfos:t,sortedAscending:n};if("role"===a)return function(e){let{permissionRowInfos:t,sortedAscending:i}=e;const a=["owner","member","team_level_guest"],n=["group","user"];return[...t].sort(((e,t)=>{const i=e.memberInfo.entity_type,a=t.memberInfo.entity_type;return n.indexOf(i)-n.indexOf(a)})).sort(((e,t)=>{const n=e.memberInfo.type,s=t.memberInfo.type,o=a.indexOf(n)-a.indexOf(s);return i?-o:o}))}(s);if("name"===a)return function(e){let{permissionRowInfos:t,sortedAscending:i}=e;return[...t].sort(((e,t)=>{var a,n;const s=null!==(a=et(e))&&void 0!==a?a:"",o=null!==(n=et(t))&&void 0!==n?n:"";if(s===o)return 0;const r=s<o?-1:1;return i?-r:r}))}(s);(0,m.t1)(a)}({permissionRowInfos:e,sortType:f}),i=y.limitMembers?t.slice(0,50):t;return{permissionRowInfos:i,numNotShown:e.length-i.length}}),[Z,k,w,a,f,y.memberFilterQuery,y.limitMembers]),[P]=(0,ce.r5)((async()=>{var e;if(!M||null===(e=y.memberFilterQuery)||void 0===e||!e.trim().length)return[];const t=await ge.O$({environment:s,query:y.memberFilterQuery,membersOnly:!0}),i=A.reduce(((e,t)=>{var i;return"user"===t.type&&null!==(i=t.memberInfo)&&void 0!==i&&i.user_id&&e.add(t.memberInfo.user_id),e}),new Set);return t.filter((e=>!Boolean(i.has(e.id)))).slice(0,5)}),[s,y.memberFilterQuery,A,M]),_=Boolean(null===(t=y.memberFilterQuery)||void 0===t?void 0:t.trim().length),x=A.length>0,F="resolved"===P.status&&(null===(i=P.value)||void 0===i?void 0:i.length)>0;return n()("div",{style:h.container},void 0,n()(tt,{title:_?n()(g.FormattedMessage,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this team",description:"Label for a list of users who are currently in the team"}):n()(Qe,{sortType:f,onChangeSortType:v}),rows:A,renderRow:e=>l().createElement(Ke,D()({store:a},e))}),I>0&&n()(fe.Z,{style:h.showMore,onClick:()=>{T.Z.setState({...y,limitMembers:!1})}},void 0,n()(g.FormattedMessage,{defaultMessage:"Show {numNotShown} more",id:"teamPermissionSettings.member.showMore",description:"Show more button when not all members can be shown at once. Clicking on it will show remaining members in the team.",values:{numNotShown:I}})),F&&n()(tt,{title:n()(g.FormattedMessage,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in team",description:"Label for a list of users who are currently not in the team"}),rows:P.value||[],renderRow:e=>n()(Ye,{teamStore:a,memberToAdd:e})}),!x&&!F&&n()("div",{style:h.noResult},void 0,n()(g.FormattedMessage,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members found",description:"Label when no members are found matching the search query"})))}function $e(e){let{teamStore:t,member:i}=e;const a=t.getValue();if(!a)return"none";const n=function(e){var t;let{teamValue:i,member:a}=e;const n=null===(t=i.permissions)||void 0===t?void 0:t.find((e=>(0,ue.hV)(e)&&"group"===a.entity_type&&e.group_id===a.group_id||(0,ue.jg)(e)&&"user"===a.entity_type&&a.user_id===e.user_id));return null==n?void 0:n.role}({teamValue:a,member:i});return n||(0,pe.xC)(a)}function et(e){const{type:t}=e;if("user"===t){var i,a;const{userStore:t}=e;return null!==(i=null===(a=t.getName())||void 0===a?void 0:a.name)&&void 0!==i?i:t.getEmail()}if("group"===t){const{permissionGroup:t}=e;return t.name}(0,m.t1)(t)}function tt(e){let{rows:t,renderRow:i,title:a}=e;const s=(0,u.y)((e=>({membersList:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",width:"100%",marginBottom:12},memberDivider:{borderBottom:"1px solid ".concat(e.regularDividerColor)}})),[]);return t.length?l().createElement(l().Fragment,null,a&&n()(K.Z,{isSmall:!0},void 0,a),n()("div",{style:s.membersList},void 0,t.map(((e,t)=>l().createElement(l().Fragment,null,t>0&&n()("div",{style:s.memberDivider}),i(e)))))):null}function it(e){let{teamStore:t}=e;const i=(0,u.y)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:14}})),[]);return n()("div",{style:i.content},void 0,n()(le,{teamStore:t}),n()(Xe,{store:t}))}function at(e){let{teamStore:t}=e;return l().createElement(l().Fragment,null,n()(nt,{teamStore:t}),n()(it,{teamStore:t}))}function nt(e){let{teamStore:t}=e;const i=(0,d.O7)(),a=(0,u.y)((e=>({content:{width:"100%",display:"grid",gridAutoFlow:"row",rowGap:26},divider:{marginBottom:20},defaultTeamToggle:{marginTop:0,border:"1px solid ".concat(e.regularDividerColor),borderRadius:4,padding:"12px 0px 12px 16px",marginBottom:32},header:{marginBottom:12}})),[]),[{currentSpaceStore:s}]=(0,c.oR)(b.default),o=(0,S.ql)(t),{displayed:r,isTeamInviteOnly:m}=(0,c.VK)((()=>{var e;const i=t.getSettingsStore().getKeyStore("space_member_join_access").getValue(),a=null!==(e=null==s?void 0:s.canAdmin())&&void 0!==e&&e;return{displayed:o&&a,isTeamInviteOnly:"invite_only"===i}}),[t,s,o]),p=(0,c.VK)((()=>{var e;return null!==(e=t.isDefault())&&void 0!==e&&e}),[t]);return r?l().createElement(l().Fragment,null,n()(Lt,{on:p,disabled:m,onChange:async()=>{s&&await async function(e,t,i){const a=!t.isDefault();if(!(await(0,N.HV)(a)))return;await(0,L.MH)({teamStore:t,spaceStore:i,environment:e,isDefault:a,createNewTeamFlowId:void 0,from:"sidebar_team_modal"})}(i,t,s)},title:n()(g.FormattedMessage,{id:"teamSettings.defaultTeam.title",defaultMessage:"Make default teamspace",description:"Shown as a title for a toggle in teamspace settings that indicates whether the teamspace should be synced with the entire workspace."}),caption:n()(g.FormattedMessage,{id:"teamSettings.defaultTeam.subtitle",defaultMessage:"Automatically add all workspace members to this teamspace",description:"Shown as a sub-title for a toggle in teamspace settings that indicates whether the teamspace should be synced with the entire workspace."}),tooltip:m&&n()(g.FormattedMessage,{id:"teamSettingsGeneral.setting.isDefaultTeam.tooltipInviteOnlyTeam",defaultMessage:"Make this an open teamspace to allow this setting",description:"Tooltip text shown when hovering over default teamspace toggle for a teamspace that is closed or private."}),style:a.defaultTeamToggle,shouldTriggerUpsell:!1})):null}i(7406);var st=i(26825);const ot=["none","reader","comment_only","read_and_write","editor"],rt=["reader","comment_only","read_and_write","editor"],lt=["editor"];function dt(e){let{teamValue:t}=e;const i=function(e){var t,i,a,n;let{teamValue:s}=e;const{permissions:o=[],id:r}=s,l=null!==(t=null===(i=o.find((e=>(0,ue.ix)(e))))||void 0===i?void 0:i.role)&&void 0!==t?t:"none",d=null!==(a=null===(n=o.find((e=>(0,ue.zU)(e)&&e.team_id===r)))||void 0===n?void 0:n.role)&&void 0!==a?a:l;return{spacePermission:{type:"space_permission",role:l},teamMemberPermission:{type:"explicit_team_permission",team_id:r,role:d},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:r,role:"editor"}}}({teamValue:t}),{spacePermission:a,teamMemberPermission:n}=i,s={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},o={spacePermission:ut({roles:ot,currentRole:n.role}),teamMemberPermission:ct({roles:rt,currentRole:a.role}),teamOwnerPermission:lt},{visibility:r,space_member_join_access:l}=t.settings;return"team_members"===r&&(s.space_member_join_access=["invite_only"],o.spacePermission=["none"]),"self_join"===l&&(s.visibility=["space_members"],s.invite_access=["team_members"],o.spacePermission=o.spacePermission.filter((e=>"none"!==e))),t.is_default&&(o.teamMemberPermission=[n.role],o.spacePermission=[n.role]),{settingsOptions:s,permissionItemRoleOptions:o,currentTeamPermissionItems:i}}function ct(e){let{roles:t,currentRole:i}=e;return t.filter((e=>(0,st.IF)(e,i)))}function ut(e){let{roles:t,currentRole:i}=e;return t.filter((e=>(0,st.SL)(e,i)))}var mt=i(98742),pt=i(19757),gt=i(86275),ht=i(14947);function ft(e){let{teamStore:t,accessLevel:i,disabled:a,onChange:s}=e;const o=(0,S.vR)(t),r=(0,gt.U)({isCreateTeam:!1,teamStore:t,isDefault:o,onChange:s});return n()(vt,{allOptionsDisabled:a,currentOption:i,options:r})}function vt(e){let{currentOption:t,options:i,allOptionsDisabled:a}=e;const s=(0,u.y)((e=>({root:{display:"flex",flexDirection:"row",alignItems:"center",width:"100%",background:e.buttonHoveredBackground,borderRadius:6,padding:3},buttonContainer:{display:"flex",flexGrow:1},option:{flexGrow:1,display:"flex",flexDirection:"column",textAlign:"center",borderRadius:5,padding:"6px 14px 8px"},currentOption:{boxShadow:"0px 2px 3px rgba(0, 0, 0, 0.1)",background:e.modalBackground},optionTitleAndIconContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionIconContainer:{flexShrink:0,marginRight:4},optionIcon:{fill:e.mediumIconColor},optionTitle:{fontSize:13,color:e.mediumTextColor,fontWeight:400},currentOptionTitle:{color:e.regularTextColor,fontWeight:500},optionCaption:{fontSize:12,color:e.mediumTextColor,lineHeight:1.2,textAlign:"left"},checkIcon:{width:9,margin:"0 auto"},divider:{height:30,alignSelf:"center"}})),[]);return n()("div",{style:s.root},void 0,i.map(((e,o)=>{var r;const d=e.key===t,c=o===i.length-1,u=(null===(r=i[o+1])||void 0===r?void 0:r.key)===t,m=!d&&!c&&!u;return n()("div",{style:s.buttonContainer},void 0,n()(q.Z,{textWrap:!0,disableTooltip:!e.tooltip,placement:q.Z.Placement.Bottom,renderTooltip:()=>e.tooltip,render:t=>l().createElement(ht.Z,D()({style:{...s.option,...d&&s.currentOption},onClick:d?void 0:e.onSelect,disabled:a||e.disabled,ignoreLocalHoverState:d},t),n()("div",{style:s.optionTitleAndIconContainer},void 0,n()("div",{style:s.optionIconContainer},void 0,e.icon({...s.optionIcon,...d&&{fill:e.iconColor}})),n()("div",{style:{...s.optionTitle,...d&&s.currentOptionTitle}},void 0,e.title)),n()("div",{style:s.optionCaption},void 0,e.caption))}),m&&n()(V.Z,{vertical:!0,size:1,style:s.divider}))})))}function yt(e){const{teamStore:t,numTeamMembers:i}=e,a=(0,d.O7)(),s=(0,u.F)(),o=(0,g.useIntl)(),r=(0,c.VK)((()=>t.getTeamPermission()),[t]),l=(0,S.TE)(t),m=(0,c.VK)((()=>{var e;const i=null===(e=t.getPermissions())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),a=o.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members",description:"Tooltip explaining why you can't set a teamspace permission to something lower."});function n(e){return i&&e!==i.role&&(0,st.nl)(e,i.role)===i.role&&!t.isDefault()?{isDisabled:!0,disabledMessage:a}:void 0}return[{role:"editor",disabledInfo:n("editor")},{role:"read_and_write",disabledInfo:n("read_and_write")},{role:"comment_only",disabledInfo:n("comment_only")},{role:"reader",disabledInfo:n("reader")}]}),[o,t]),p=r&&n()(De.Z,{role:r.role,table:Ee.e0,type:(0,ue.zU)(r)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:l,buttonStyle:{fontSize:12.5,marginRight:0,color:s.mediumTextColor},availableRoleItems:m,onChange:e=>{O.createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:a,perform:i=>{(0,L.xI)({environment:a,teamStore:t,newRole:e,transaction:i})}})}}),{teamName:h}=(0,c.VK)((()=>({teamName:t.getName()})),[t]),f=n()(Y.p,{disabled:!0,store:t,size:we.Z.iconSize});return n()(qe,{permissionRoleSelectComponent:p,iconComponent:f,name:St(h),label:n()(g.FormattedMessage,{id:"TeamMembersPermissionRow.teamspacePermissionItem.description",defaultMessage:"{num, plural, one {{num} person} other {{num} people}}",description:"Caption showing how many members are in this teamspace.",values:{num:i}})})}function St(e){return n()(g.FormattedMessage,e?{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",description:"Title for teamspace member permission",values:{teamName:e}}:{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName",description:"Title for teamspace member permission when teamspace name is not available."})}var Mt=i(62512);function bt(e){const{teamStore:t,teamOwnerIds:i}=e,a=(0,u.F)(),s=(0,c.VK)((()=>t.getName()),[t]),o=(0,c.VK)((()=>t.getTeamOwnerPermission()),[t]),[{currentUserStore:r}]=(0,c.oR)(b.default),l=(0,c.VK)((()=>r?i.map((e=>C.Z.createChildStore(r,{table:me.KJ,id:e}))):[]),[r,i]);return n()(qe,{tooltip:n()(g.FormattedMessage,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default",description:"Tooltip explaining why you can't modify teamspace owners' team role."}),permissionRoleSelectComponent:n()(De.Z,{role:"editor",table:Ee.e0,type:o&&(0,ue.LW)(o)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:a.mediumTextColor,marginRight:0},availableRoleItems:[]}),iconComponent:n()(Mt.n,{teamStore:t,ownerStores:l}),name:wt(s),label:n()(g.FormattedMessage,{id:"TeamOwnersPermissionRow.teamspacePermissionItem.description",defaultMessage:"{num, plural, one {{num} person} other {{num} people}}",description:"Caption showing how many owners are in this teamspace.",values:{num:i.length}})})}function wt(e){return n()(g.FormattedMessage,e?{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",description:"Title for teamspace owner permission",values:{teamName:e}}:{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName",description:"Title for teamspace owner permission when teamspace name is not available."})}var Ct=i(76464);function Tt(e){const{teamStore:t}=e,i=(0,d.O7)(),[{currentSpaceStore:a}]=(0,c.oR)(b.default),{iconComponent:s,spaceName:o}=(0,c.VK)((()=>{if(!a)return{iconComponent:void 0,spaceName:void 0};const e=(0,he.getSpaceName)(i,a);return{iconComponent:n()(Y.p,{disabled:!0,store:a,size:we.Z.iconSize}),spaceName:e}}),[a,i]),r=(0,c.VK)((()=>{const e=null==t?void 0:t.getValue(),i=null==a?void 0:a.getValue();if(!e||!i||!a)return;return(0,he.getSpacePermissionItems)(a).filter((e=>(0,ue.J5)((0,ue.cY)(e)))).length}),[a,t]);return n()(qe,{permissionRoleSelectComponent:n()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},void 0,n()(Zt,{teamStore:t})),iconComponent:s,name:kt(o),label:n()(g.FormattedMessage,{id:"teamPermissionSettings.openSpacePermissionItem.description",defaultMessage:"{num, plural, one {{num} person} other {{num} people}}",values:{num:r}})})}function kt(e){return n()(g.FormattedMessage,e?{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}:{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function Zt(e){const{teamStore:t}=e,i=(0,d.O7)(),a=(0,u.F)(),s=(0,c.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),r=(0,S.TE)(t),m=(0,c.VK)((()=>{const e=t.getValue();if(e)return dt({teamValue:e})}),[t],{useDeepEqual:!0});if(!m)return null;const p=m.permissionItemRoleOptions.spacePermission;if(1===p.length&&"none"===p[0])return n()(q.Z,{renderTooltip:()=>n()(g.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",description:"Permission tooltip showing that when a team is private, pages cannot be shared with the workspace.",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>l().createElement("div",D()({style:{display:"flex",alignItems:"center",maxWidth:170}},e),se.Z.lockedFilled({width:14,height:14,fill:a.timelineRed,marginRight:4}),n()("div",{style:{fontSize:12.5,color:a.timelineRed,marginRight:8}},void 0,n()(g.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",description:"Permission label showing that for private teams, non-team members will have no access to the team.",defaultMessage:"No access • Invite only"})))});{const e=o().sortBy(p,(e=>-ue.xm[e])).map((e=>({role:e})));return n()(De.Z,{role:s.role,table:Ee.e0,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:r||1===p.length,buttonStyle:{fontSize:12.5,marginRight:0,color:a.mediumTextColor},availableRoleItems:e,onChange:e=>{const a={...s,role:e};O.createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:i,perform:e=>{Ct.ep({environment:i,store:t,permissionItems:[a],transaction:e})}})}})}}function At(e){let{teamStore:t}=e;const i=(0,c.VK)((()=>t.getTeamAccessLevel()),[t]),a=(0,d.O7)(),s=(0,c.VK)((()=>{const e=t.getValue();return e&&(0,pe.XO)(e)||[]}),[t]),o=(0,c.VK)((()=>{var e,i;return null!==(e=null===(i=t.getTeamPermission())||void 0===i?void 0:i.role)&&void 0!==e?e:"none"}),[t]),m=(0,S.KR)(t),h=(0,c.VK)((()=>t.state),[t]).value,f=(0,r.useCallback)((e=>{L.Ju({environment:a,accessLevel:e,store:t,teamName:null==h?void 0:h.name,from:"sidebar_team_modal"})}),[a,t,h]),v=(0,r.useCallback)((e=>{(0,O.createAndCommit)({userAction:"team.setInviteAccess",environment:a,perform:i=>{L.$x({environment:a,store:t,update:{invite_access:e},transaction:i})}})}),[a,t]),M=(0,r.useCallback)((e=>{(0,O.createAndCommit)({userAction:"teamsHelpers.changeTeamSetting",environment:a,perform:i=>{L.$x({environment:a,store:t,update:{disable_team_page_edits:e},transaction:i})}})}),[a,t]),b=(0,S.ql)(t),w=(0,S.TE)(t),C=(0,y.HC)(),T=(0,u.y)((e=>({header:{marginBottom:12},permissionsWrap:{paddingBottom:12,borderBottom:"1px solid ".concat(e.regularDividerColor),marginBottom:22},switcherWrap:{marginTop:14,marginBottom:12},teamPageAccessHeader:{fontSize:12,fontWeight:p.Z.fontWeight.medium}})),[]),k=(0,c.VK)((()=>{const e=t.getValue();if(e)return dt({teamValue:e})}),[t],{useDeepEqual:!0}),Z=(0,c.VK)((()=>t.isDefault()),[t]);if(!h||!k)return null;const A=!b||1===k.settingsOptions.invite_access.length;return l().createElement(l().Fragment,null,n()(Q,{style:T.header,title:n()(g.FormattedMessage,{id:"TeamSettingsPermissions.pagePermissions.title",defaultMessage:"Permissions",description:"Team permissions menu."})}),n()("div",{style:T.permissionsWrap},void 0,n()("div",{style:T.switcherWrap},void 0,n()(ft,{teamStore:t,accessLevel:i,onChange:f,disabled:w})),function(e){let{teamStore:t,teamOwnerIds:i,numTeamMembers:a,isDefault:s}=e;return[n()(bt,{teamStore:t,teamOwnerIds:i}),n()(yt,{teamStore:t,numTeamMembers:a}),!s&&n()(Tt,{teamStore:t})]}({teamStore:t,teamOwnerIds:s,numTeamMembers:m,isDefault:Z})),n()(It,{title:n()(g.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite teamspace members",description:"Decide who in the teamspace can invite other members"}),caption:n()(g.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.caption",defaultMessage:"Who can add people to the teamspace",description:"Rephrasing the setting to show that people can add teamspace members"}),disabled:A,optionTooltip:A&&b&&n()(g.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members",description:"Tells the user that they need to change teamspace permissions to Closed or Private to change this setting of who can invite teamspace members."}),currentOption:h.settings.invite_access,allOptions:[{option:"team_members",label:n()(g.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member",description:"Any teamspace member can invite others."}),action:()=>v("team_members")},{option:"team_owners",label:n()(g.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners",description:"Only teamspace owners can invite others."}),action:()=>v("team_owners")}]}),(0,ue.J5)(o)?n()(It,{title:l().createElement(l().Fragment,null,n()(g.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar",description:"Decide who in the team can edit the teamspace sidebar section"})),caption:n()(g.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages",description:"Actions possible when the teamspace edit pages setting is enabled"}),disabled:w,currentOption:Boolean(h.settings.disable_team_page_edits),allOptions:[{option:!1,label:n()(g.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member",description:"Any teamspace member can edit teamspace sidebar pages."}),action:()=>M(!1)},{option:!0,label:n()(g.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners",description:"Only team owners can edit teamspace sidebar pages."}),action:()=>M(!0)}]}):n()(It,{title:n()(g.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar",description:"Decide who in the team can edit the teamspace sidebar section"}),caption:n()(g.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages",description:"Actions possible when the teamspace edit pages setting is enabled"}),disabled:!0,currentOption:!0,allOptions:[{option:!0,label:n()(g.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners",description:"Only team owners can edit teamspace sidebar pages."}),action:()=>{}}],optionTooltip:n()(g.FormattedMessage,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar",description:"Tooltip telling user why they can't change this option."})}),C&&n()(j.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:n()(g.FormattedMessage,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions",description:"Link text that shows in the permissions tab of the teamspaces settings modal. When the user clicks the link, they are taken to a reference with more information about teamspaces security and permissions."})}))}function It(e){const{title:t,caption:i,currentOption:a,allOptions:s,disabled:o,optionTooltip:r}=e,c=(0,d.Fy)(),m=(0,u.y)((e=>({root:{display:"flex",alignItems:"center",width:"100%",marginBottom:20},title:{fontSize:14,marginRight:8,flexGrow:1},divider:{marginTop:14,marginBottom:14},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},buttonStyle:{fontSize:12.5,color:e.mediumTextColor},tooltipWidth:{width:300}})),[]),p=s.find((e=>e.option===a));return p?l().createElement(l().Fragment,null,n()("div",{style:m.root},void 0,n()("div",{style:m.title},void 0,t,i&&n()(K.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%"}},void 0,i)),n()(q.Z,{style:m.tooltipWidth,placement:pt.ug.Top,alignment:q.Z.Alignment.Start,textWrap:!0,disableTooltip:!r,renderTooltip:()=>r,render:e=>l().createElement(Pe.Z,D()({},e,{disablePopup:o,popupType:c.isMobile?Pe.Z.PopupType.SlideUp:Pe.Z.PopupType.Popup,alignmentToOrigin:Pe.Z.Alignment.End,renderOrigin:t=>l().createElement(Fe.Z,D()({style:m.buttonStyle,disabled:o},(0,mt.Z)(e,t)),p.label,!o&&se.Z.chevronDown(m.chevron)),render:e=>{let t;t=c.isMobile?{menuType:_e.Z.MenuType.ActionSheet}:{menuType:_e.Z.MenuType.Popup,minWidth:150};const i=[{key:"options",render:e=>l().createElement(Be.Z,e),items:s.map((t=>({key:t.option.toString(),render:e=>l().createElement(Ie.Z,D()({},e,{title:t.label,caption:t.caption,checkState:a===t.option})),action:()=>{t.action(),e.close()}})))}];return l().createElement(_e.Z,t,n()(xe.Z,{type:xe.Z.Type.Vertical,initialFocus:void 0,sections:i}))}}))}))):null}var Pt=i(41493),_t=i(26524);function xt(e){return r.createElement(_t.Z,e,n()(g.FormattedMessage,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned",description:"Unowned badge to indicate that this team is an unowned team, i.e. a team with no owners."}))}function Ft(e){const[t]=(0,c.oR)(T.Z),{teamStore:i}=e;if(!t.open)return null;switch(t.tab){case T.a.General:return n()(ie,{teamStore:i});case T.a.Members:return n()(at,{teamStore:i});case T.a.Permissions:return n()(At,{teamStore:i});case T.a.Security:return n()($,{teamStore:i});default:(0,m.t1)(t.tab)}}function Bt(e){const{userId:t,currentSpaceStore:i}=e,a=(0,c.VK)((()=>C.Z.createChildStore(i,{table:"notion_user",id:t,spaceId:i.id}).state),[i,t]),s=a.value;return a.ready||s?n()(Pt.Z,{avatarShouldShowShadow:!0,userValue:s,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function Et(e){const{userIds:t,label:i,hasMarginTop:a}=e,[{currentSpaceStore:s}]=(0,c.oR)(b.default);return s?l().createElement(l().Fragment,null,n()(P.Z,{hasMarginTop:a},void 0,i),t.map((e=>n()(Bt,{userId:e,currentSpaceStore:s})))):null}function Dt(){const e=(0,d.O7)(),[t,i]=(0,c.oR)(T.Z),[{currentSpaceStore:a,currentSpaceViewStore:s}]=(0,c.oR)(b.default),r=(0,d.Fy)(),l=(0,u.y)((e=>({modal:{width:r.isMobile?"auto":630,height:r.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},icon:{marginRight:8,fontWeight:p.Z.fontWeight.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.regularTextColor,fontWeight:p.Z.fontWeight.regular,textTransform:"unset",fontSize:11}})),[r.isMobile]),f=(0,c.VK)((()=>{const e=t.selectedTeamId;if(!a||!e)return;return w.Z.createChildStore(a,{table:"team",id:e,spaceId:null==a?void 0:a.id})}),[a,t]),M=(0,c.VK)((()=>null==f?void 0:f.getSettingsStore().getValue()),[f]),C=(0,S.ql)(f);if(!a||!s||!f)return null;const{open:P}=t,_=[T.a.General,T.a.Members,T.a.Permissions,T.a.Security];return n()(Z.Z,{open:P,innerStyle:l.modal,onDismiss:()=>{T.Z.reset(),T.Z.reset()},render:()=>t.open?n()("div",{className:v.Nf,style:{height:"100%"}},void 0,n()("div",{style:l.modalWrap},void 0,n()(k.Z,{capture:!0,onBackspace:o().identity,onLeft:o().identity,onRight:o().identity,onSelectAll:o().identity,onRedo:o().identity,onUndo:o().identity,onCut:o().identity,onCopy:o().identity,onPaste:o().identity,onKeypress:o().identity,onDelete:o().identity,onTab:o().identity},void 0,n()("div",{style:l.innerWrap},void 0,n()("div",{style:l.header},void 0,n()(Y.p,{disabled:!0,store:f,size:24,style:l.icon}),n()(A.Z,{store:f,style:{fontSize:16,fontWeight:p.Z.fontWeight.semibold}}),(0,y.C2)(M)&&n()(B.Z,{iconStyle:l.lockIcon}),(0,y.Hu)({membership:f.getKeyStore("membership").getValue()})&&n()("div",{style:{gap:5,display:"flex"}},void 0,n()(xt,{desktopStyle:l.unownedPill,mobileStyle:l.unownedPill,innerStyle:l.unownedPillInner})),n()("div",{style:{flexGrow:1}}),n()(F.M,{teamStore:f,onLeavingTeam:()=>T.Z.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})),n()(x.Z,{tabs:_.map((e=>function(e,t){switch(e){case T.a.General:return n()(g.FormattedMessage,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General",description:"General settings for a team"});case T.a.Members:return n()(Rt,{teamStore:t});case T.a.Permissions:return n()(g.FormattedMessage,{id:"sidebarTeamModalTab.option.permissions",defaultMessage:"Permissions",description:"Permissions-related settings for a team"});case T.a.Security:return n()(g.FormattedMessage,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security",description:"Security settings for a team"});default:(0,m.t1)(e)}}(e,f))),selectedIndex:t.open?_.indexOf(t.tab):1,onChange:a=>{t.open&&(h.trackTeamSettingsTabClick(e,{store:f,tab_old_value:t.tab,tab_new_value:_[a]}),i({...t,tab:_[a]}))},tabStyle:{marginLeft:-8},style:l.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),n()(I.Z,{type:I.Z.OverflowType.Y,style:l.scroller},void 0,n()("div",{style:l.contentWrap},void 0,n()(Ft,{currentSpaceStore:a,teamStore:f,userIsTeamOwner:C}))))))):null})}function Rt(e){let{teamStore:t}=e;const i=(0,c.VK)((()=>{var e,i;return null!==(e=null==t||null===(i=t.getMembers())||void 0===i?void 0:i.length)&&void 0!==e?e:0}),[t]),a=(0,u.F)();return l().createElement(l().Fragment,null,n()(g.FormattedMessage,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members",description:"Members list for a team with a member count next to it."}),n()("span",{},void 0," "),n()("div",{style:{color:a.lightTextColor}},void 0,i))}function Lt(e){let{title:t,caption:i,secondCaption:a,on:s,disabled:o,tooltip:r,style:c,onChange:m,shouldTriggerUpsell:p}=e;const g=(0,d.O7)(),h=(0,M.Z)(),v=(0,u.y)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:16,marginBottom:16,cursor:p?"pointer":void 0,...c},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18}})),[c,p]);return l().createElement(l().Fragment,null,n()("div",{style:v.root,onClick:()=>{if(p)return(0,f.y)(g,{from:"team_security_settings",for:h,dontOpenPlansOnCancel:!0})}},void 0,n()("div",{style:v.title},void 0,t,n()(K.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"}},void 0,i),a&&n()(K.Z,{isSmall:!0},void 0,a)),n()("div",{style:v.switcherWrap},void 0,n()(q.Z,{disableTooltip:!r,renderTooltip:()=>r,render:e=>l().createElement("div",e,n()(_.Z,{on:s,disabled:o,onClick:m}))}))))}},41205:(e,t,i)=>{i.r(t),i.d(t,{default:()=>x});var a=i(77094),n=i.n(a),s=i(77422),o=i.n(s),r=(i(33948),i(67294)),l=i.n(r),d=i(83355),c=i(5366),u=i(21325),m=i(27832),p=i(35875),g=i(72693),h=i(15102),f=i(47966),v=i(97464),y=i.n(v),S=i(8848),M=i(53397),b=i(24684),w=i(82990),C=i(95477),T=i(21115),k=i(92083),Z=i(27242),A=i(37235);class I extends d.Z{renderComponent(){return l().createElement(l().Fragment,null,M.Z.notionLogoStroked({width:34,height:34,marginBottom:18}),n()("div",{style:{...this.getPrimaryTextStyle(),marginBottom:6}},void 0,this.getPlanTitle()),n()("div",{style:this.getSecondaryTextStyle()},void 0,this.getOneLiner()),this.renderPriceAndTerms(),this.renderBlockLimit(),this.renderPlanFeatures(),this.renderLearnMore())}renderBlockLimit(){const{planInfo:e}=this.props;if("team_free"===e.subscriptionTier)return l().createElement(l().Fragment,null,n()("div",{style:{fontWeight:w.Z.fontWeight.semibold,fontSize:24}},void 0,n()(c.FormattedMessage,{id:"spaceSubscriptionUpgradePlanFeatures.blockLimit.title",defaultMessage:"Free"})),n()("div",{style:this.getSecondaryTextStyle()},void 0,n()(c.FormattedMessage,{id:"spaceSubscriptionUpgradePlanFeatures.blockLimit.description",defaultMessage:"For the first 1,000 blocks"}),n()(A.Z,{renderTooltip:()=>n()(c.FormattedMessage,{id:"spaceSubscriptionUpgradePlanFeatures.blockLimit.tooltip",defaultMessage:"Blocks are pieces of content you add to a page, like a paragraph or to-do item.{br}Some features on the Team Plan are not available on the Team Trial.",values:{br:n()("br",{})}}),placement:A.Z.Placement.Top,render:e=>l().createElement("span",e,M.Z.help({marginLeft:6,width:14,fill:S.ZP.mediumIconColor,verticalAlign:"middle",display:"inline-block"}))})))}renderPriceAndTerms(){const{planInfo:e,intl:t}=this.props;if("team_free"!==e.subscriptionTier)return l().createElement(l().Fragment,null,n()("div",{style:this.getPrimaryTextStyle()},void 0,n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.price",defaultMessage:"{price}",description:"Price is already formatted, e.g. $10",values:{price:(0,T._B)({subscriptionTier:e.subscriptionTier,billingInterval:e.billingInterval,intl:t})}})),n()("div",{style:this.getSecondaryTextStyle()},void 0,this.getFormattedTerm()))}getFormattedTerm(){const{planInfo:e,intl:t}=this.props,i=(0,b.MZ)(C.Z,t),a={personal:i.terms.pro,team:i.terms.team,enterprise:i.terms.enterprise}[e.subscriptionTier];return{per_month:n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.perMonthPricing.label",defaultMessage:"per month",description:"Appears after the price per month for a given plan, e.g. $10 per month"}),per_member_per_month:n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.perUserPerMonthPricing.label",defaultMessage:"per member, per month",description:"Appears after the price per member, per month for a given plan, e.g. $10 per member, per month"})}[a]}renderPlanFeatures(){var e=this;const{planInfo:t}=this.props;return l().createElement(l().Fragment,null,n()(A.Z,{delayThreshold:0,placement:A.Z.Placement.Left,renderTooltip:()=>this.renderPreviousPlanTierFeatures(),render:t=>l().createElement("span",y()({},t,{style:{cursor:"help",fontSize:14}}),n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.features",defaultMessage:"<span>Everything in {planName},</span> plus:",description:"Shown when comparing plan tier features in upgrade modal; 'planName' will be Personal, Team Trial, or Team",values:{span:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n()("span",{style:{paddingBottom:1,borderBottom:"1px dotted ".concat(e.theme.lightTextColor)}},void 0,i)},planName:this.getPreviousPlanName()}}))}),this.getFeaturesByPlanKey(t.subscriptionTier).map(((e,i)=>n()("div",{style:{display:"flex",alignItems:"center",padding:"4px 0px",fontSize:14}},"".concat(t.subscriptionTier,"-feature-").concat(i),M.Z.thinCheck({width:14,height:14,marginRight:5,color:this.theme.lightTextColor}),e.label,e.isComingSoon&&n()("div",{style:{background:this.theme.buttonHoveredBackground,fontSize:10,fontWeight:500,letterSpacing:"0.015em",color:this.theme.mediumTextColor,display:"inline",textTransform:"uppercase",padding:"2px 4px",marginLeft:6,borderRadius:3,whiteSpace:"nowrap"}},void 0,b.Mn)))))}renderPreviousPlanTierFeatures(){const e=this.getTierBelowKey();return this.getFeaturesByPlanKey(e).map(((t,i)=>n()("div",{style:{display:"flex",alignItems:"center",padding:"4px 0px",fontSize:14}},"".concat(e,"-feature-").concat(i),M.Z.thinCheck({width:14,height:14,marginRight:5,color:this.theme.regularInvertedTextColor}),t.label)))}renderLearnMore(){return n()("div",{style:{fontWeight:w.Z.fontWeight.regular,fontSize:14,marginBottom:16,color:this.theme.mediumTextColor,textDecoration:"underline",marginTop:8,cursor:"pointer"},onClick:()=>{Z.Z.reset(),p.Z.reset(),k.ZP.setState({open:!0,currentTab:"plans",defaultSubtab:void 0})}},void 0,n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.learnMore",defaultMessage:"Learn more"}))}getPlanTitle(){const{planInfo:e}=this.props;return{personal:n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.title.personal",defaultMessage:"Upgrade to Personal Pro"}),team:n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.title.team",defaultMessage:"Upgrade to Team"}),enterprise:n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.title.enterprise",defaultMessage:"Upgrade to Enterprise"}),team_free:n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.title.teamFree",defaultMessage:"Upgrade to Team Trial"})}[e.subscriptionTier]}getOneLiner(){const{planInfo:e}=this.props;switch(e.subscriptionTier){case"personal":return n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.oneLiner.personal",defaultMessage:"For power users who want to do even more."});case"team":case"team_free":return n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.oneLiner.team",defaultMessage:"For teams to write, plan, and work together in one spot."});case"enterprise":return n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.oneLiner.enterprise",defaultMessage:"Controls and support to run your company."})}}getPreviousPlanName(){return{personal:n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.personal",defaultMessage:"Pro"}),personal_free:n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.free",defaultMessage:"Personal"}),team_free:n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.teamTrial",defaultMessage:"Team Trial"}),team:n()(c.FormattedMessage,{id:"subscriptionUpgradeDetails.planName.team",defaultMessage:"Team"})}[this.getTierBelowKey()]}getTierBelowKey(){const{planInfo:e}=this.props;return{personal:"personal_free",team:"team_free",team_free:"personal",enterprise:"team"}[e.subscriptionTier]}getFeaturesByPlanKey(e){const t=(0,b.Cq)();return{personal_free:[t.unlimitedBlocks,t.shareWithLimitedGuests,t.syncAcrossDevices],personal:[t.unlimitedFileUploads,t.unlimitedGuests,t.versionHistory,t.contentApi],team_free:[t.unlimitedTeamMembers,t.collaborativeWorkspace,t.adminTools],team:[t.unlimitedBlocks,t.unlimitedFileUploads,t.versionHistory,t.advancedPermissions],enterprise:[t.sso,t.scimApi,t.advancedSecurity,t.dedicatedManager,t.customContract]}[e]}getPrimaryTextStyle(){return{fontWeight:w.Z.fontWeight.bold,fontSize:22,lineHeight:1.1,marginBottom:2}}getSecondaryTextStyle(){return{fontWeight:w.Z.fontWeight.regular,fontSize:14,lineHeight:1.4,marginBottom:22,color:this.theme.mediumTextColor}}}const P=(0,c.injectIntl)(I);class _ extends d.Z{constructor(){super(...arguments),o()(this,"storeTypes",{}),o()(this,"renderModal",(()=>n()("div",{style:this.getModalStyle()},void 0,n()(P,{planInfo:{subscriptionTier:"team_free"}}),n()("div",{style:this.getButtonContainerStyle()},void 0,n()(f.Z,{isLarge:!0,style:{marginLeft:"auto",marginRight:12},onClick:this.handleModalClose},void 0,n()(c.FormattedMessage,{id:"spacePermissionSettingsTrialModal.cancel.label",defaultMessage:"Cancel"})),n()(g.Z,{onClick:this.handleTrialAccept,isLarge:!0},void 0,n()(c.FormattedMessage,{id:"spacePermissionSettingsTrialModal.tryItFree.label",defaultMessage:"Try it free"})))))),o()(this,"handleTrialAccept",(async()=>{const{currentSpaceStore:e}=m.default.state;e&&(await u.EO({environment:this.environment,spaceStore:e,planType:"team",from:"space_permission_settings_trial_modal"}),this.handleModalClose())})),o()(this,"handleModalClose",(()=>{p.Z.setState({...p.Z.state,open:!1})}))}renderComponent(){return n()(h.Z,{open:p.Z.state.open,render:this.renderModal,onDismiss:this.handleModalClose})}getButtonContainerStyle(){return{display:"flex",marginTop:40}}getModalStyle(){return{background:this.theme.popoverBackground,borderRadius:3,width:349,padding:24}}}const x=_},33396:(e,t,i)=>{i.r(t),i.d(t,{default:()=>dm});var a=i(77094),n=i.n(a),s=i(97464),o=i.n(s),r=i(77422),l=i.n(r),d=(i(33948),i(96486)),c=i.n(d),u=i(67294),m=i.n(u),p=i(83355),g=i(8848),h=i(53397),f=i(90965),v=i(82990),y=i(5366),S=i(48298),M=i(7512),b=i(50906),w=i(54642),C=i(47307),T=i(26111),k=i(29974),Z=i(27832),A=i(93561);function I(e,t,i){A.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),...i}},transaction:t})}function P(e){var t;const{currentSpaceViewStore:i}=Z.default.state;if(!i)return;const a=null===(t=i.getSettings())||void 0===t?void 0:t.enterprise_settings_prompt;a&&"dismissed"!==a.status&&A.createAndCommit({userAction:"spaceViewActions.incrementMembersPromptSettings",environment:e,perform:e=>{I(i,e,{enterprise_settings_prompt:{status:"dismissed"}})}})}var _=i(21325),x=i(37181),F=i(28020),B=i(43250),E=i(4708),D=i(67669),R=i(33665),L=i(21115),O=i(23537),N=(i(60285),i(49085)),U=i(32918),W=i(97880);function V(e){switch(e.actionName){case"page_viewed":case"page_created":case"page_deleted":case"page_restored":case"page_exported":case"page_moved":case"page_permission_updated":case"page_shared_to_web":case"file_uploaded":case"file_downloaded":case"private_content_transferred":return e.target.page;case"member_invited":case"member_joined":case"member_role_updated":case"member_removed":case"guest_removed":case"workspace_name_changed":case"workspace_icon_changed":case"workspace_domain_changed":case"allowed_email_domain_added":case"allowed_email_domain_removed":case"workspace_exported":case"workspace_integration_restriction_changed":case"public_page_cleared":case"public_page_set":case"scim_token_generated":case"scim_token_revoked":case"saml_toggled":case"saml_enforce_toggled":case"automatic_account_creation_toggled":case"workspace_creation_set_for_email_domain":case"login":case"logout":case"password_set":case"password_cleared":case"password_changed":case"email_changed":case"preferred_name_changed":case"picture_changed":case"user_deleted":case"allowed_support_access":case"revoked_support_access":case"invite_link_toggled":case"invite_link_reset":case"page_access_requests_toggled":case"public_page_sharing_toggled":case"workspace_sidebar_editing_toggled":case"disable_guests_toggled":case"pages_to_other_workspaces_toggled":case"export_toggled":case"idp_metadata_url_updated":case"idp_metadata_xml_updated":case"idp_metadata_xml_removed":case"member_added_to_group":case"member_removed_from_group":case"team_created":case"team_archived":case"team_restored":case"team_default_toggled":case"team_public_page_sharing_toggled":case"team_export_toggled":case"team_sidebar_editing_toggled":case"team_name_changed":case"team_description_changed":case"team_icon_changed":case"team_creation_admins_setting_toggled":case"team_guests_toggled":case"member_added_to_team":case"group_added_to_team":case"member_removed_from_team":case"group_removed_from_team":case"member_joined_team":case"member_left_team":case"member_team_role_updated":case"team_member_default_permission_updated":case"team_workspace_default_permission_updated":case"team_privacy_type_changed":case"team_invite_access_changed":return;default:(0,W.t1)(e)}}let z;function G(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U.sF;const a={type:"date",start_date:e.start_date};return U.OQ.toMomentRange(a).start.locale(t.locale).format(i)}function H(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U.c_;return U.OQ.dateTimeToMoment(e).locale(t.locale).format(i)}function q(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U.YF;return U.OQ.dateTimeToMoment(e).locale(t.locale).format(i)}function K(e){return e.starting&&e.ending?{starting:{type:"date",start_date:e.starting.start_date},ending:{type:"date",start_date:e.ending.start_date}}:e.starting?{starting:{type:"date",start_date:e.starting.start_date}}:e.ending?{ending:{type:"date",start_date:e.ending.start_date}}:{}}function j(e){if(e)return{type:"date",start_date:e.start_date}}function Y(e){return"".concat(e.actorType,":").concat(e.actorId)}function Q(e){const t=e.split(":");if(2===t.length)return"bot"===t[0]?{actorId:t[1],actorType:"bot"}:"notion_user"===t[0]?{actorId:t[1],actorType:"notion_user"}:void 0}!function(e){e.CreatedNewest="CreatedNewest",e.CreatedOldest="CreatedOldest"}(z||(z={}));class J extends N.Z{getInitialState(){return{pageNum:1,pageSize:10,timeRange:{},actors:[],actions:[],sortOrder:z.CreatedNewest}}}const X=new J,$=e=>{const{timeRange:t,actors:i,actions:a,sortOrder:n}=e,s=new URLSearchParams;return t.starting&&s.append("starting","".concat(U.OQ.toUnixMs(t.starting))),t.ending&&s.append("ending","".concat(U.OQ.toUnixMs(t.ending))),(null==i?void 0:i.length)>0&&s.append("actors",i.map(Y).join(",")),(null==a?void 0:a.length)>0&&s.append("actions",a.join(",")),s.append("sort","".concat(n||z.CreatedNewest)),s.toString()};class ee extends N.Z{getInitialState(){return{cachedResponses:{}}}getCursor(e,t,i){if(i<=1||this.state.spaceId!==e)return;const a=$(t);if(this.state.filterStr!==a)return;const n=this.state.cachedResponses[i-1];return"success"===n.status?null==n?void 0:n.nextCursor:void 0}startLoading(e,t){this.updateResultHelper(e,t,{status:"loading"})}updateLoadedResult(e,t,i){this.updateResultHelper(e,t,{...i,status:"success",loadedAt:Date.now()})}updateError(e,t){this.updateResultHelper(e,t,{status:"error"})}updateResultHelper(e,t,i){const a=$(t);1!==t.pageNum&&this.state.spaceId===e&&this.state.filterStr===a?this.setState({spaceId:e,filterStr:a,cachedResponses:{...this.state.cachedResponses,[t.pageNum]:{...i}}}):this.setState({spaceId:e,filterStr:a,cachedResponses:{[t.pageNum||1]:{...i}}})}}const te=new ee;var ie=i(95155),ae=i(53680);class ne extends N.Z{getInitialState(){return{displaySummary:!0,openDropdown:!1,query:""}}}const se=new ne;class oe extends N.Z{getInitialState(){return{name:"",domain:"",domainState:"current-space",emailDomains:[],publicHomePage:void 0}}getValueForSpace(e){const t=e.getValue(),i=e.getPublicContentDomain(),a=e.getPublicHomePage();if(t){const{name:e,email_domains:n}=t;return{name:e||"",domain:i||"",emailDomains:n||[],domainState:"current-space",publicHomePage:a}}}}const re=oe;class le extends N.Z{getInitialState(){return{emailDomains:[],spaceCreation:"admins_only"}}async updateValueForSpace(e){const{environment:t,spaceId:i,store:a}=e;if(!("on"===ie.default.getEligibleGroup({experimentId:"domain_claim",defaultGroup:"unassigned"})))return;const n=await(0,w.getEmailDomainsForSpace)(t,{spaceId:i});if("failed"===n.type)return void(0,C.showError)(n);const{data:s}=n,o=Object.keys(s);return 0!==o.length?a.setState({emailDomains:o,spaceCreation:s[o[0]].spaceCreationEnum}):a.setState(this.getInitialState()),a.state}}const de=le;class ce extends N.Z{getInitialState(){return{uploadingProfilePhoto:!1,givenName:"",familyName:"",name:"",startDayOfWeek:(0,U.aN)()}}getValueForUser(e,t){const i=e.getValue();if(i){const{profile_photo:e,name:a}=i,n=t.getSettings();return{uploadingProfilePhoto:!1,profilePhoto:e,name:a||"",startDayOfWeek:void 0===(null==n?void 0:n.start_day_of_week)?(0,U.aN)():null==n?void 0:n.start_day_of_week}}}}const ue=ce;async function me(e){const{environment:t,spaceId:i,store:a}=e,n=L.CM(t);if(n&&"enterprise"!==n)return a.reset(),{};const s=await w.getSamlConfigForSpace(t,{spaceId:i});if("failed"===s.type)C.showError(s);else if(s.data&&s.data.samlConfig){const e={...s.data.samlConfig,useMetadataUrl:Boolean(s.data.samlConfig.idpMetadataUrl)};return a.setState(e),s.data}return a.reset(),{}}class pe extends N.Z{getInitialState(){return{status:"unconfigured",emailDomains:[],domainVerifications:[],spaceIds:[],createAccount:!1,useMetadataUrl:!1}}async getValueForSpace(e,t){const i=new pe;return await me({environment:e,spaceId:t.id,store:i}),Promise.resolve(i.state)}}const ge=pe;var he=i(92083),fe=i(78291),ve=i(98905),ye=i(480),Se=i(28350),Me=i(77420),be=i(19889),we=i(31299),Ce=i(33929);class Te extends N.Z{getInitialState(){return{spaceId:void 0,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set}}isUserOrBotRemoved(e){return Boolean(e&&(this.state.removedUserIds.has(e)||this.state.removedBotIds.has(e)))}}const ke=new Te,Ze=(0,y.defineMessages)({loadCurrentAuditLogError:{id:"auditlog.error.loadCurrentAuditLogError",defaultMessage:"Failed to load audit logs",description:"The error message when audit log cannot be loaded from the server"}}),Ae=async e=>{const{environment:t,spaceId:i}=e,a=await w.getHistoricalAuditLogUsers(t,{spaceId:i});return"success"!==a.type?[]:a.data.results};var Ie=i(70630);class Pe extends N.Z{getInitialState(){return{open:!1}}}const _e=new Pe;var xe=i(72693),Fe=i(48762),Be=i(71202),Ee=i(25584),De=i(66722),Re=i(83071),Le=i(37235);const Oe=(0,y.defineMessages)({30:{id:"auditLogCSV.menu.30days",defaultMessage:"Last 30 days",description:"An audit log menu item giving the user an option to download the last 30 days worth of audit logs in CSV format"},60:{id:"auditLogCSV.menu.60days",defaultMessage:"Last 60 days",description:"An audit log menu item giving the user an option to download the last 60 days worth of audit logs in CSV format"},90:{id:"auditLogCSV.menu.90days",defaultMessage:"Last 90 days",description:"An audit log menu item giving the user an option to download the last 90 days worth of audit logs in CSV format"},365:{id:"auditLogCSV.menu.365days",defaultMessage:"Last 1 year",description:"An audit log menu item giving the user an option to download the last 1 year worth of audit logs in CSV format"},Export:{id:"auditLogCSV.menu.export",defaultMessage:"Export",description:"An audit log button giving the user an option to export and download audit logs in CSV format"}});class Ne extends p.Z{constructor(){super(...arguments),l()(this,"renderCSVMenu",(()=>{const e=[this.getCSVMenuItem(30),this.getCSVMenuItem(60),this.getCSVMenuItem(90),this.getCSVMenuItemWithConfirmation(365)];return n()(Be.Z,{menuType:Be.Z.MenuType.Popup},void 0,n()(Ee.Z,{type:Ee.Z.Type.Vertical,sections:[{key:"results",render:e=>m().createElement(Re.Z,e),items:e}],initialFocus:0}))})),l()(this,"getCSVMenuItem",(e=>({key:e,render:()=>n()(Fe.Z,{focused:!1,title:Ce.default.formatMessage(Oe[e]),onClick:()=>{this.handleDismiss(),Ue(this.environment,e)}}),action:()=>{}}))),l()(this,"getCSVMenuItemWithConfirmation",(e=>({key:e,render:()=>n()(Fe.Z,{focused:!1,title:Ce.default.formatMessage(Oe[e]),onClick:()=>{C.showDialog({message:n()(y.FormattedMessage,{id:"auditLogCSV.menu.365days.prompt",defaultMessage:"Are you sure you want to export a one year CSV? You can't repeat this action while this is processing in the background.",description:"An audit log menu confirmation dialog that confirms if the user wants to download the last 1 years worth of audit logs in CSV format and that they cannot repeat the action while processing is happening in the background."}),showCancel:!0,keepFocus:!0,items:[{label:n()(y.FormattedMessage,{id:"AuditLogCSV.exportConfirmationDialog.label",defaultMessage:"Export",description:"Label for button that when clicked will export a CSV for the current workspace."}),color:"blue",onAccept:()=>{this.handleDismiss(),Ue(this.environment,e)}}]})}}),action:()=>{}}))),l()(this,"handleDismiss",(()=>{_e.setState({open:!1})})),l()(this,"popOpenOptions",(e=>{_e.setState({open:e})}))}renderComponent(){const e=_e.state;return n()(De.ZP,{popupType:De.ZP.PopupType.Popup,open:e.open,placementToOrigin:De.ZP.Placement.Bottom,alignmentToOrigin:De.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,keepFocus:!1,render:this.renderCSVMenu,onDismiss:this.handleDismiss,enableOutsideClickDismiss:!0,origin:n()(Le.Z,{renderTooltip:()=>n()(y.FormattedMessage,{id:"auditLogCSV.popup.tooltip",defaultMessage:"Click for options to export the Audit Log in CSV form",description:"Message that shows options for the user to export audit log to CSV."}),render:t=>m().createElement(xe.Z,o()({isLarge:!0,onClick:()=>this.popOpenOptions(!e.open)},t),Ce.default.formatMessage(Oe.Export))})})}}const Ue=(e,t)=>{const{currentSpaceStore:i}=Z.default.state;i&&Ie.PN(e,{spaceId:i.id,exportOptions:{duration:t}})},We=(0,y.injectIntl)(Ne);var Ve=i(80084),ze=i(76150),Ge=i(13854),He=i(41558),qe=i(46167),Ke=i(55811),je=i(67950),Ye=i(46945),Qe=i(85114);const Je="Invalid date",Xe="Invalid range";class $e extends N.Z{getInitialState(){return{dateEdited:!1,timeEdited:!1,temporaryValue:{date:void 0,time:void 0},error:void 0}}}const et=$e;var tt=i(62727);class it extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{store:et}),l()(this,"renderInput",(()=>{const{device:e}=this.environment,{store:t,hideClearButton:i,focus:a,showTime:s,placeholder:r,...l}=this.props,d=e.isMobile?"date":"text",c=e.isMobile?"time":"text",u=tt.Z.Format.Transparent,p=e.isMobile?void 0:a;return n()("div",{style:{display:"flex",alignItems:"center",borderRadius:3,lineHeight:2,background:this.theme.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%",...this.getInputStyles().inputOuterStyle}},void 0,m().createElement(tt.Z,o()({},l,{type:d,format:u,placeholder:r,focus:"date"===p,onFocus:this.handleDateFocus,onChange:this.handleDateChange,onSubmit:e=>this.handleSubmit(e,"date"),onBlur:this.handleBlur,value:this.getDateInputValue(),size:1,style:{fontSize:e.isMobile?16:14},showClearButton:!s&&this.showClearButton(),onClearButtonClick:this.handleClear})),s&&m().createElement(m().Fragment,null,n()("div",{style:{height:14,width:1,background:this.theme.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}}),m().createElement(tt.Z,o()({},l,{placeholder:Ce.default.formatMessage(ot.timePlaceholder),type:c,format:u,focus:"time"===p,onFocus:this.handleTimeFocus,onChange:this.handleTimeChange,onSubmit:e=>this.handleSubmit(e,"time"),onBlur:this.handleBlur,value:this.getTimeInputValue(),size:1,style:{fontSize:e.isMobile?16:14},showClearButton:this.showClearButton(),onClearButtonClick:this.handleClear}))))})),l()(this,"handleDateFocus",(e=>{const{onDateFocus:t}=this.props,{store:i}=this.stores;i.setState({...i.state,dateEdited:!1}),t&&t(e)})),l()(this,"handleTimeFocus",(e=>{const{onTimeFocus:t}=this.props,{store:i}=this.stores;i.setState({...i.state,timeEdited:!1}),t&&t(e)})),l()(this,"handleClear",(()=>{const{onClear:e,onUpdate:t}=this.props,{store:i}=this.stores;i.setState({...i.state,dateEdited:!0,timeEdited:!0,temporaryValue:{date:void 0,time:void 0},error:void 0});const a=this.validateCurrent();a&&t(a),i.setState({...i.state,dateEdited:!1,timeEdited:!1}),e&&e()})),l()(this,"handleDateChange",(e=>{const{device:t}=this.environment,{store:i}=this.stores;i.setState({...i.state,dateEdited:!0,temporaryValue:{...i.state.temporaryValue,date:e.target.value||""}}),t.isAndroid&&this.handleBlur()})),l()(this,"handleTimeChange",(e=>{const{device:t}=this.environment,{store:i}=this.stores;i.setState({...i.state,timeEdited:!0,temporaryValue:{...i.state.temporaryValue,time:e.target.value||""}}),t.isAndroid&&this.handleBlur()})),l()(this,"handleSubmit",((e,t)=>{var i,a;const{onUpdate:n,onSubmit:s,showTime:o}=this.props,{store:r}=this.stores;let l;(!o||"date"===t&&null!==(i=this.props.value)&&void 0!==i&&i.start_time||"time"===t&&null!==(a=this.props.value)&&void 0!==a&&a.start_date)&&(l=this.validateCurrent(),l&&(n(l),l.error?r.setState({...r.state,dateEdited:!1,error:l.error}):r.reset())),s&&s(e,l)})),l()(this,"handleBlur",(e=>{const{onUpdate:t,onBlur:i}=this.props,{store:a}=this.stores,n=this.validateCurrent();n?(t(n),n.error?a.setState({...a.state,dateEdited:!1,timeEdited:!1,error:n.error}):a.reset()):a.setState({...a.state,dateEdited:!1,timeEdited:!1}),e&&i&&i(e)})),l()(this,"styles",{menuItem:{marginBottom:this.environment.device.isMobile?1:12},inputWrapper:{borderRadius:3,height:28,paddingRight:this.showClearButton()?6:0,position:"relative"},inputEditRegion:{width:this.showClearButton()?"calc(100% - 14px)":"100%"},inputEditRegionMobile:{padding:"2px 6px",position:"relative"},tooltipOriginGap:-8})}didUpdate(e){const{store:t}=this.stores;c().isEqual(e.value,this.props.value)||t.reset()}renderComponent(){const e=this.styles,t=this.getError();return t?n()(Le.Z,{renderTooltip:()=>t,forceVisibleState:!0,placement:Le.Z.Placement.Left,render:this.renderInput,originGap:e.tooltipOriginGap}):this.renderInput()}getDateInputValue(){const{device:e}=this.environment,{value:t,dateFormat:i,intl:a}=this.props,{store:n}=this.stores;return e.isMobile?t?G(t,a):"":n.state.temporaryValue.date?n.state.temporaryValue.date:n.state.dateEdited?n.state.temporaryValue.date||"":t?G(t,a,i):""}getTimeInputValue(){const{device:e}=this.environment,{value:t,timeFormat:i,intl:a}=this.props,{store:n}=this.stores;return e.isMobile?t?H(t,a):"":n.state.temporaryValue.time?n.state.temporaryValue.time:n.state.timeEdited?n.state.temporaryValue.time||"":t?H(t,a,i):""}getError(){const{store:e}=this.stores,{intl:t}=this.props;if(e.state.error)switch(e.state.error){case Je:return t.formatMessage({id:"dateInputError.invalidDateError.tooltip",defaultMessage:"Invalid date"});case Xe:return t.formatMessage({id:"dateInputError.invalidDateRangeError.tooltip",defaultMessage:"Invalid range"});default:(0,W.t1)(e.state.error)}}validateCurrent(){const{validate:e}=this.props,t=this.parseCurrentDateTimeValue();if(t)return e?e(t):t}parseCurrentDateTimeValue(){const{store:e}=this.stores,{value:t,showTime:i,isEndingDate:a}=this.props;if(!e.state.dateEdited&&!e.state.timeEdited)return;if(!e.state.temporaryValue.date&&!e.state.temporaryValue.time)return{value:void 0};const n=(0,Qe.uy)(e.state.temporaryValue.date||"",this.props.intl);if(n){let e="";return e=i?(null==t?void 0:t.start_time)||"00:00":a?"23:59":"00:00",{value:{type:"datetime",start_date:n,time_zone:(null==t?void 0:t.time_zone)||U.x7,start_time:e}}}const s=(0,Qe.wk)(e.state.temporaryValue.time||"",this.props.intl);return(null!=t&&t.start_date||n)&&s?{value:{type:"datetime",start_date:(null==t?void 0:t.start_date)||n,start_time:s,time_zone:(null==t?void 0:t.time_zone)||U.x7}}:{error:Je}}showClearButton(){const{device:e}=this.environment,{hideClearButton:t}=this.props;return!!e.isMobile||!t}getInputStyles(){const{device:e}=this.environment,{inputStyle:t,inputOuterStyle:i,style:a}=this.props,n=this.styles;return{style:{...n.menuItem,...a},inputOuterStyle:{...n.inputWrapper,...i,...this.getInputBorders()},inputStyle:{...n.inputEditRegion,...e.isMobile&&n.inputEditRegionMobile,...t}}}getInputBorders(){const{disabled:e,focus:t}=this.props,i=this.getThemeColors(),a=this.getError();if(!e)return a?i.inputError:t?i.inputFocused:i.inputDefault}getThemeColors(){return{inputDefault:{background:this.theme.inputBackground,boxShadow:this.theme.inputBoxShadow},inputFocused:{boxShadow:this.theme.outlineBlueInputBoxShadow},inputError:{boxShadow:this.theme.outlineRedInputBoxShadow},placeholder:{color:this.theme.lightTextColor}}}}const at=(0,y.injectIntl)(it);var nt=i(15282),st=i(60843);const ot=(0,y.defineMessages)({startingDateMessage:{defaultMessage:"Starting",id:"auditLog.dateTimeRangeMenu.startingDatePlaceholder",description:"Placeholder for the starting date in audit log date filter."},endingDateMessage:{defaultMessage:"Ending",id:"auditLog.dateTimeRangeMenu.endingDatePlaceholder",description:"Placeholder for the ending date in audit log date filter."},timePlaceholder:{defaultMessage:"12:00 AM",id:"auditLog.dateTimeRangeMenu.timePlaceholderInNumber",description:"Placeholder for the time input in audit log. 12 is the hour, 00 is the minutes, and AM/PM is morning vs afternoon."}});class rt extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{store:Ge.ZP,dayRangeStore:He.Z}),l()(this,"renderInputs",(()=>{const{device:e,WindowSizeStore:t}=this.environment,{value:i,disabled:a}=this.props,{store:s}=this.stores,o=s.getFocus();let r="date";o!==ze.Hv.StartTime&&o!==ze.Hv.EndTime||(r="time");const l=this.getRangeBounds();return n()("div",{style:{paddingTop:e.isMobile?16:12,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:s.state.showTime?"block":"flex",...e.isMobile&&{boxShadow:"\n\t\t\t\t\t\t\t0 1px 0 ".concat(this.theme.regularDividerColor,"\n\t\t\t\t\t\t"),position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0}},void 0,n()(at,{disabled:a,placeholder:Ce.default.formatMessage(ot.startingDateMessage),focus:o===ze.Hv.StartDate||o===ze.Hv.StartTime?r:void 0,value:i.starting,validate:this.validateStart,onUpdate:this.handleUpdateStart,onDateFocus:()=>this.handleDateFocus(ze.Hv.StartDate),onTimeFocus:()=>this.handleTimeFocus(ze.Hv.StartTime),onSubmit:(e,t)=>this.handleStartSubmit(e,t,o),inputElementAttributes:{max:l.latestValidStarting},showTime:s.state.showTime}),n()("div",{style:{width:12,height:8}}),n()(at,{disabled:a,placeholder:Ce.default.formatMessage(ot.endingDateMessage),focus:o===ze.Hv.EndDate||o===ze.Hv.EndTime?r:void 0,value:i.ending,validate:this.validateEnd,onUpdate:this.handleUpdateEnd,onDateFocus:()=>this.handleDateFocus(ze.Hv.EndDate),onTimeFocus:()=>this.handleTimeFocus(ze.Hv.EndTime),onSubmit:(e,t)=>this.handleEndSubmit(e,t,o),inputElementAttributes:{min:l.earliestValidEnding},showTime:s.state.showTime}))})),l()(this,"renderCalendar",(()=>{const{device:e}=this.environment,{value:t,onUpdate:i}=this.props,{store:a,dayRangeStore:s}=this.stores,o=this.styles,r=this.getThemeColors(),l={...o.pickerSection,...e.isMobile&&o.pickerSectionMobile,...e.isMobile&&r.pickerSectionMobile};return n()(Re.Z,{},void 0,n()("div",{style:l},void 0,n()(Ye.Z,{value:K(t),dateTimeStore:a,store:s,onUpdate:e=>{if(e.error)return;const a=function(e,t){let i={starting:void 0,ending:void 0};var a,n,s,o;if(t.starting&&t.ending)i={starting:{type:"datetime",start_time:"",start_date:t.starting.start_date,time_zone:""},ending:{type:"datetime",start_time:"",start_date:t.ending.start_date,time_zone:""}},null!==(a=e.starting)&&void 0!==a&&a.start_time&&null!==(n=e.starting)&&void 0!==n&&n.time_zone&&(i.starting={...i.starting,start_time:e.starting.start_time,time_zone:e.starting.time_zone}),null!==(s=e.ending)&&void 0!==s&&s.start_time&&null!==(o=e.ending)&&void 0!==o&&o.time_zone?i.ending={...i.ending,start_time:e.ending.start_time,time_zone:e.ending.time_zone}:i={starting:{...i.starting,start_time:"00:00",time_zone:U.x7},ending:{...i.ending,start_time:"23:59",time_zone:U.x7}};else if(t.starting){var r,l;i=null!==(r=e.starting)&&void 0!==r&&r.start_time&&null!==(l=e.starting)&&void 0!==l&&l.time_zone?{starting:{type:"datetime",start_date:t.starting.start_date,start_time:e.starting.start_time,time_zone:e.starting.time_zone},ending:e.ending}:{starting:{type:"datetime",start_date:t.starting.start_date,start_time:"00:00",time_zone:U.x7},ending:e.ending}}else if(t.ending){var d,c;i=null!==(d=e.ending)&&void 0!==d&&d.start_time&&null!==(c=e.ending)&&void 0!==c&&c.time_zone?{ending:{type:"datetime",start_date:t.ending.start_date,start_time:e.ending.start_time,time_zone:e.ending.time_zone},starting:e.starting}:{ending:{type:"datetime",start_date:t.ending.start_date,start_time:"23:59",time_zone:U.x7},starting:e.starting}}else i={starting:e.starting,ending:e.ending};return i}(t,e.value);return i({error:e.error,value:a})},validate:this.validateDateRangeField})))})),l()(this,"handleDateFocus",(e=>{const{store:t,dayRangeStore:i}=this.stores;t.setState({...t.state,focus:e});const a=Ge.QJ[e];i.setState({...i.state,focus:a})})),l()(this,"handleTimeFocus",(e=>{const{store:t}=this.stores;t.setState({...t.state,focus:e})})),l()(this,"handleUpdateStart",(e=>{const{onUpdate:t}=this.props;e.error||t({value:{...this.props.value,starting:e.value}})})),l()(this,"handleUpdateEnd",(e=>{const{onUpdate:t}=this.props;e.error||t({value:{...this.props.value,ending:e.value}})})),l()(this,"handleStartSubmit",((e,t,i)=>{const{store:a,dayRangeStore:n}=this.stores;t&&t.error||(i===ze.Hv.StartDate&&a.state.showTime?a.setState({...a.state,focus:ze.Hv.StartTime}):(a.setState({...a.state,focus:ze.Hv.EndDate}),n.setState({...n.state,focus:"ending"})))})),l()(this,"handleEndSubmit",((e,t,i)=>{const{store:a}=this.stores;t&&t.error||i===ze.Hv.EndDate&&a.state.showTime&&a.setState({...a.state,focus:ze.Hv.EndTime})})),l()(this,"validateStart",(e=>{const t=this.validateField("starting",e);return t.error?t:{value:t.value.starting}})),l()(this,"validateEnd",(e=>{const t=this.validateField("ending",e);return t.error?t:{value:t.value.ending}})),l()(this,"validateField",((e,t)=>{const{value:i}=this.props;return t.error?t:this.validateRange({...i,[e]:t.value})})),l()(this,"validateRange",(e=>{if(e.starting&&e.ending){const t=U.OQ.dateTimeToMoment(e.starting);return U.OQ.dateTimeToMoment(e.ending).isSameOrAfter(t)?{value:e}:{error:je.B.INVALID_RANGE}}return{value:e}})),l()(this,"getMenuProps",(()=>{const{device:e}=this.environment,{onDismiss:t,title:i}=this.props;if(e.isMobile){return{menuType:Be.Z.MenuType.Modal,title:i,right:n()(nt.DoneMenuText,{}),onClickRight:t,header:this.renderInputs()}}return{menuType:Be.Z.MenuType.Popup,onClickOutside:t,footer:this.props.footer}})),l()(this,"validateDateRangeField",((e,t)=>{const{value:i}=this.props;if(t.error)return t;const a=K(i);return this.validateDateRange({...a,[e]:t.value})})),l()(this,"validateDateRange",(e=>{if(e.starting&&e.ending){const t=U.OQ.toMoment(e.starting);return U.OQ.toMoment(e.ending).isSameOrAfter(t)?{value:e}:{error:je.B.INVALID_RANGE}}return{value:e}})),l()(this,"styles",{pickerSection:{paddingLeft:16,paddingRight:16},pickerSectionMobile:{paddingTop:16,paddingBottom:8},sidebar:{paddingTop:12,paddingBottom:24,overflowY:"auto",overflowX:"hidden",flex:"0 0 220px",backgroundColor:this.theme.sidebarSecondaryBackground,borderLeft:"1px solid ".concat(this.theme.regularDividerColor),maxWidth:"fit-content"},menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4,color:this.theme.mediumTextColor}})}didMount(){const{store:e}=this.stores;void 0!==this.props.showTime&&e.setState({...e.state,showTime:this.props.showTime})}renderComponent(){const{device:e}=this.environment;return m().createElement(Be.Z,this.getMenuProps(),n()("div",{style:{display:"flex",flexDirection:"row"}},void 0,n()("div",{},void 0,!e.isMobile&&this.renderInputs(),this.renderCalendar()),this.renderSidebar()))}renderSidebar(){const{store:e}=this.stores,{onUpdate:t,value:i}=this.props;return n()("aside",{style:this.styles.sidebar},void 0,n()(st.Z,{title:n()(y.FormattedMessage,{id:"auditlogDateFilter.timeToggle",defaultMessage:"Use time",description:"Toggle to show or not show time in audit log date filter."}),on:e.state.showTime,onClick:()=>{if(e.toggleShowTime(),e.state.showTime){const e=i;e.starting&&(e.starting.start_time="00:00"),e.ending&&(e.ending.start_time="23:59"),t({value:e})}},focused:!1}),n()(Fe.Z,{focused:!1,title:n()(y.FormattedMessage,{id:"auditlogDateFilter.quickFilters.today",defaultMessage:"Today"}),onClick:()=>{const e=Date.now(),t=U.CQ(e);this.setStoresTemporaryValue({starting:{...t,start_time:"00:00"},ending:t})},style:this.styles.menuItem}),n()(Fe.Z,{focused:!1,title:n()(y.FormattedMessage,{id:"auditlogDateFilter.quickFilters.yesterday",defaultMessage:"Yesterday"}),onClick:()=>{const e=U.Cv();this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:U.x7},ending:{type:"datetime",start_date:e.start_date,start_time:"23:59",time_zone:U.x7}})},style:this.styles.menuItem}),n()(Fe.Z,{focused:!1,title:n()(y.FormattedMessage,{id:"auditlogDateFilter.quickFilters.lastWeek",defaultMessage:"Last 7 days"}),onClick:()=>{const e=U.Oo(),t=U.CQ(Date.now());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:U.x7},ending:t})},style:this.styles.menuItem}),n()(Fe.Z,{focused:!1,title:n()(y.FormattedMessage,{id:"auditlogDateFilter.quickFilters.lastMonth",defaultMessage:"Last 30 days"}),onClick:()=>{const e=U.dj(),t=U.CQ(Date.now());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:U.x7},ending:t})},style:this.styles.menuItem}))}setStoresTemporaryValue(e){const{store:t,dayRangeStore:i}=this.stores;t.setState({...t.state,temporaryDateRange:e}),i.setState({...i.state,displayMonth:e.starting||e.ending?U.OQ.dateTimeToMoment(e.starting||e.ending):void 0,temporaryDateRange:{starting:j(e.starting),ending:j(e.ending)}})}getRangeBounds(){const{value:e,intl:t}=this.props;return{earliestValidEnding:e.starting&&q(e.starting,t,U.M8),latestValidStarting:e.ending&&q(e.ending,t,U.M8)}}getThemeColors(){return{pickerSectionMobile:{background:this.theme.popoverBackground,boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor),marginBottom:1}}}}const lt=(0,y.injectIntl)(rt);var dt=i(89206),ct=i(255),ut=i(42001),mt=i(98707),pt=i(75689),gt=i(91642);class ht extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{store:Ge.ZP,dayRangeStore:He.Z}),l()(this,"renderActiveButtonOrigin",(()=>{const{value:e,dateFormat:t,disabled:i,focused:a,intl:s}=this.props,o=this.styles,r=this.getThemeColors(),l={...o.menuItem,...r.activeMenuItem},d=Ve._Q(e,s,t),c=n()(ct.Z,{onClick:this.handleClear,disabled:i});return n()(Fe.Z,{focused:a,disabled:i,icon:h.Z.calendar(o.iconActiveDesktop),title:d,right:c,isTokenTitle:!0,alignIconTop:!0,onClick:this.handleOriginActivate,desktopTitleStyle:o.menuItemTitleDesktop,desktopIconStyle:o.iconActiveDesktopWrapper,style:l})})),l()(this,"renderInactiveButtonOrigin",(()=>{const{title:e,icon:t,disabled:i,focused:a,mode:s}=this.props,o=this.styles,r=this.getThemeColors(),l={...o.menuItem,...r.buttonMenuItem,...s===mt.Z.Mode.Pill?{width:"fit-content",border:"solid 1px",paddingLeft:0,paddingRight:0,borderRadius:20,fontSize:12}:{}};return n()(Fe.Z,{focused:a,disabled:i,icon:t(o.icon),title:e,onClick:this.handleOriginActivate,style:l})})),l()(this,"renderPillButtonOrigin",(()=>{const{value:e}=this.props,t=n()(y.FormattedMessage,{id:"searchDateFilter.shortTitle",defaultMessage:"Date"});return n()(Ke.u,{on:Boolean(e.starting||e.ending),icon:h.Z.calendar({width:16,marginRight:6,fill:"currentColor"}),title:n()("span",{},void 0,t),onClick:this.handleOriginActivate})})),l()(this,"renderPopupContents",(()=>{const{title:e,showButtons:t,sidebar:i}=this.props,{store:a,dayRangeStore:s}=this.stores;return m().createElement(m().Fragment,null,n()(lt,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:a,dayRangeStore:s,onDismiss:this.handleMenuClose,footer:"footer"===t&&this.renderFooter(),sidebar:i}),"side"===t&&n()("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",padding:"0px 10px"}},void 0,n()(ut.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleMenuClose},void 0,n()(y.FormattedMessage,{defaultMessage:"Cancel",id:"searchDateFilter.cancelButton.label"})),n()(xe.Z,{onClick:()=>this.props.onChange(this.stores.store.state.temporaryDateRange)},void 0,n()(y.FormattedMessage,{defaultMessage:"Accept",id:"searchDateFilter.acceptButton.label"}))))})),l()(this,"renderFooter",(()=>{const{store:e,dayRangeStore:t}=this.stores;return n()(Re.Z,{topBorder:!0,style:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"}},void 0,n()(ut.Z,{onClick:()=>{e.clearTemporaryDateRange(),t.clearTemporaryDateRange(),this.props.onChange({starting:void 0,ending:void 0})}},void 0,n()(y.FormattedMessage,{id:"searchDateFilter.clearButton",defaultMessage:"Clear"})),n()(xe.Z,{onClick:e=>{this.props.onChange(this.stores.store.state.temporaryDateRange),this.handleMenuClose(e)}},void 0,n()(y.FormattedMessage,{id:"searchDateFilter.applyButton",defaultMessage:"Apply"})))})),l()(this,"handleOriginActivate",(()=>{const{disabled:e}=this.props,{store:t,dayRangeStore:i}=this.stores;e||(t.setState({...t.state,isOpen:!0,focus:ze.Hv.StartDate}),i.setState({...i.state,isOpen:!0,focus:"starting"}))})),l()(this,"handleMenuClose",(e=>{const{onChange:t,onMenuDismiss:i,showButtons:a}=this.props,{store:n,dayRangeStore:s}=this.stores,{temporaryDateRange:o}=n.state;Ve.zD(e)||(a||t(o),n.setState({...n.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),s.setState({...s.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),i&&i())})),l()(this,"handleClear",(()=>{const{onChange:e}=this.props;e({starting:void 0,ending:void 0})})),l()(this,"handleMenuListKey",(e=>{e.preventDefault&&e.preventDefault()})),l()(this,"updateTemporary",(e=>{const{store:t,dayRangeStore:i}=this.stores;if(e.error)return;const a={starting:j(e.value.starting),ending:j(e.value.ending)};return i.setState({...i.state,temporaryDateRange:{...i.state.temporaryDateRange,...a}}),t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}})})),l()(this,"styles",{menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:16,width:16,marginRight:6},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:0,paddingBottom:8},popupWithSidebar:{display:"flex"},menuItemTitleDesktop:{width:"100%"},summary:{display:"inline-flex"}})}didMount(){this.updateTemporary({value:this.props.value})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{title:t,sidebar:i}=this.props,{store:a}=this.stores,s=this.styles,o=e===mt.z.Section,r=o?t:void 0,l=(()=>e===mt.Z.Mode.Section?this.renderActiveButtonOrigin():e===mt.Z.Mode.Button?this.renderInactiveButtonOrigin():e===mt.Z.Mode.Pill?this.renderPillButtonOrigin():void(0,W.t1)(e))();return n()(gt.Z,{title:r,marginAfter:o},void 0,n()(dt.Z,{capture:a.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey},void 0,n()(De.ZP,{popupType:this.getPopupType(),open:a.state.isOpen,origin:l,render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:De.ZP.Placement.Bottom,alignmentToOrigin:De.ZP.Alignment.Start,style:i?s.popupWithSidebar:s.popup})))}renderMobile(e){const{store:t}=this.stores,i=e===mt.z.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return n()(De.ZP,{popupType:De.ZP.PopupType.SlideUp,open:t.state.isOpen,origin:i,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:i}=this.props,a=this.styles;return n()(Fe.Z,{disabled:i,focused:!1,icon:e(a.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,dateFormat:i,disabled:a,intl:s}=this.props,o=this.styles,r=n()("div",{style:o.summary},void 0,h.Z.calendar(o.iconActiveMobile),Ve._Q(t,s,i));return n()(pt.Z,{disabled:a,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:r})}getCurrentValue(){const{value:e}=this.props,{store:t}=this.stores,{temporaryDateRange:i}=t.state;return{...e,...i}}getPopupType(){const{device:e}=this.environment;return e.isMobile?qe.Z.PopupType.SlideUp:qe.Z.PopupType.Popup}getThemeColors(){return{buttonMenuItem:{color:this.theme.mediumTextColor},activeMenuItem:{color:this.theme.regularTextColor}}}}const ft=(0,y.injectIntl)(ht);var vt=i(41952),yt=i(20454),St=i(26524),Mt=i(97680);class bt extends N.Z{getInitialState(){return{tempSelections:new Set([])}}setTempSelections(e){this.setState({tempSelections:new Set(e)})}}class wt extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{localStore:bt}),l()(this,"renderResultMenuItem",((e,t)=>{const{intl:i,auditLogHistoricalUserStore:a}=this.props,{localStore:s}=this.stores,r=this.getActorValue(e);return m().createElement(Mt.Z,o()({},t,{key:e,user:r,useEmailAsTooltip:!0,checkState:s.state.tempSelections.has(e),userTitle:n()("div",{style:{display:"flex",gap:4}},void 0,(0,be.Nz)(i,r),a.isUserOrBotRemoved(null==r?void 0:r.id)&&n()(St.Z,{},void 0,n()(y.FormattedMessage,{id:"auditlogActorFilter.removed_user",defaultMessage:"Removed",description:"Describes a user who had access to the workspace, but no longer has it now"})))}))})),l()(this,"performRequest",(async e=>{let{query:t,current:i}=e;const{allUserIds:a,allBotIds:n}=this.props.auditLogHistoricalUserStore.getState(),s=await we.ri({environment:this.environment,query:t,userIds:[...a],botIds:[...n]}),o=[...s.users.map((e=>"notion_user:".concat(e.id))),...s.bots.map((e=>"bot:".concat(e.id)))];if(t.length>0)return o.slice(0,100);const r=this.props.selectedActors.map(Y),l=new Set(r),d=o.filter((e=>!l.has(e)));return[...r,...d].slice(0,Math.max(r.length,100))})),l()(this,"getActorValue",(e=>{const t=Q(e);if(t)return"notion_user"===t.actorType?this.createUserValue(t.actorId):this.createBotValue(t.actorId)})),l()(this,"createUserValue",(e=>yt.Z.createChildStore(this.props.parentStore,{table:be.KJ,id:e}).getValue())),l()(this,"createBotValue",(e=>(0,vt.Kv)(this.props.parentStore,{table:Me.cZ,id:e}).getValue()))}didMount(){this.updateTempSelectionFromProps()}renderComponent(){const{selectedActors:e,intl:t}=this.props,{localStore:i}=this.stores,a=n()(y.FormattedMessage,{id:"auditlogActorFilter.title",defaultMessage:"User",description:"The title of the actor filter in the pill mode"});return n()(mt.Z,{mode:mt.z.Pill,title:a,icon:h.Z.person,iconStyles:{marginRight:2},items:Array.from(i.state.tempSelections),hasItemsSelected:(null==e?void 0:e.length)>0,onChange:e=>{i.setTempSelections(e)},renderFooter:!0,allowApplyBatchSelection:!0,keepInputOnItemConfirm:!0,onMenuDismiss:e=>{"applyButton"!==e?this.updateTempSelectionFromProps():this.updateOnChangeToParent()},labelText:{title:a,tokenInputPlaceholder:t.formatMessage({defaultMessage:"Search user...",id:"auditlogActorFilter.searchActor.placeholder",description:"The placeholder in the input for search an actor in audit log filter"}),resultSectionTitle:t.formatMessage({defaultMessage:"Select users",id:"auditlogActorFilter.searchActor.resultsTitle",description:"The text shown above the list of all selectable actors in audit log filter"}),componentDebugName:"SearchActorFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}updateOnChangeToParent(){const{onChange:e}=this.props,{localStore:t}=this.stores;e(Array.from(t.state.tempSelections).map(Q).filter((e=>Boolean(e))))}updateTempSelectionFromProps(){const{selectedActors:e}=this.props,{localStore:t}=this.stores,i=e.map(Y);t.setTempSelections(i)}}const Ct=(0,y.injectIntl)(wt);var Tt=i(39336);const kt="YYYY/MM/DD hh:mm A",Zt=(0,y.defineMessages)({page_viewed:{id:"auditlogEventFilter.actionName.page_viewed",defaultMessage:"Page viewed",description:"An audit log that describe a user viewed a page"},page_created:{id:"auditlogEventFilter.actionName.page_created",defaultMessage:"Page created",description:"An audit log that describe a user created a page"},page_deleted:{id:"auditlogEventFilter.actionName.page_deleted",defaultMessage:"Page deleted",description:"An audit log that describe a user deleted a page"},page_restored:{id:"auditlogEventFilter.actionName.page_restored",defaultMessage:"Page restored",description:"An audit log that describe a user restored a deleted page"},page_exported:{id:"auditlogEventFilter.actionName.page_exported",defaultMessage:"Page exported",description:"An audit log that describe a user exported a page"},page_moved:{id:"auditlogEventFilter.actionName.page_moved",defaultMessage:"Page moved",description:"An audit log that describe a user moved a page"},page_permission_updated:{id:"auditlogEventFilter.actionName.page_permission_updated",defaultMessage:"Page permission updated",description:"An audit log that describe a page's permission has been changed. It means members, guests, bots, teams can be added, removed, or changed role for this page"},page_shared_to_web:{id:"auditlogEventFilter.actionName.page_shared_to_web",defaultMessage:"Page shared to web",description:"An audit log that describe a page is now shared with public. It means everyone on the internet have access this page."},password_set:{id:"auditlogEventFilter.actionName.password_set",defaultMessage:"Password set",description:"An audit log that describe a user set their password"},password_cleared:{id:"auditlogEventFilter.actionName.password_cleared",defaultMessage:"Password cleared",description:"An audit log that describe a user cleared their password"},password_changed:{id:"auditlogEventFilter.actionName.password_changed",defaultMessage:"Password changed",description:"An audit log that describe a user changed their password"},login:{id:"auditlogEventFilter.actionName.login",defaultMessage:"Login",description:"An audit log that describe a user logs in"},logout:{id:"auditlogEventFilter.actionName.logout",defaultMessage:"Logout",description:"An audit log that describe a user logs out"},member_invited:{id:"auditlogEventFilter.actionName.member_invited",defaultMessage:"Member invited",description:"An audit log that describe a user is invited to the workspace"},member_joined:{id:"auditlogEventFilter.actionName.member_joined",defaultMessage:"Member joined",description:"An audit log that describe a member has joined the workspace"},member_role_updated:{id:"auditlogEventFilter.actionName.member_role_updated",defaultMessage:"Member role updated",description:"An audit log that describe a member is updated with a role"},member_removed:{id:"auditlogEventFilter.actionName.member_removed",defaultMessage:"Member removed",description:"An audit log that describe a member is removed access from the space"},guest_removed:{id:"auditlogEventFilter.actionName.guest_removed",defaultMessage:"Guest removed",description:"An audit log that describe a guest is removed access from the space"},user_deleted:{id:"auditlogEventFilter.actionName.user_deleted",defaultMessage:"User deleted",description:"An audit log that describe a user is deleted"},email_changed:{id:"auditlogEventFilter.actionName.email_changed",defaultMessage:"Email changed",description:"An audit log that describe a user changed their email"},preferred_name_changed:{id:"auditlogEventFilter.actionName.preferred_name_changed",defaultMessage:"Name changed",description:"An audit log that describe a user changed their preferred name"},picture_changed:{id:"auditlogEventFilter.actionName.picture_changed",defaultMessage:"Picture changed",description:"An audit log that describe a user changed their picture"},file_uploaded:{id:"auditlogEventFilter.actionName.file_uploaded",defaultMessage:"File uploaded",description:"An audit log that describe a file is uploaded by a user"},file_downloaded:{id:"auditlogEventFilter.actionName.file_downloaded",defaultMessage:"File downloaded",description:"An audit log that describe a file is downloaded by a user"},invite_link_toggled:{id:"auditlogEventFilter.actionName.invite_link_toggled",defaultMessage:"Invite link toggled",description:"An audit log that shows that the workspace's invite link feature was enabled"},workspace_name_changed:{id:"auditlogEventFilter.actionNames.workspace_name_changed",defaultMessage:"Name changed",description:"An audit log that describes a change of the workspace name"},workspace_integration_restriction_changed:{id:"auditlogEventFilter.actionNames.workspace_integration_restriction_changed",defaultMessage:"Integration installation toggled",description:"An audit log that describes a change of the workspace integration restriction"},invite_link_reset:{id:"auditlogEventFilter.actionNames.invite_link_reset",defaultMessage:"Invite link reset",description:"An audit log filter that describes the invite link getting reset"},public_page_sharing_toggled:{id:"auditlogEventFilter.actionNames.public_page_sharing_toggled",defaultMessage:"Public page sharing toggled",description:"An audit log filter describing public page sharing toggled"},workspace_sidebar_editing_toggled:{id:"auditlogEventFilter.actionNames.workspace_sidebar_editing_toggled",defaultMessage:"Workspace sidebar editing toggled",description:"An audit log filter describing workspace sidebar editing toggled"},disable_guests_toggled:{id:"auditlogEventFilter.actionNames.disable_guests_toggled",defaultMessage:"Disable guests toggled",description:"An audit log filter describing disable guests toggled"},pages_to_other_workspaces_toggled:{id:"auditlogEventFilter.actionNames.pages_to_other_workspaces_toggled",defaultMessage:"Pages to other workspaces toggled",description:"An audit log filter describing pages to other workspaces toggled"},export_toggled:{id:"auditlogEventFilter.actionNames.export_toggled",defaultMessage:"Export toggled",description:"An audit log filter describing workspace export toggled"},page_access_requests_toggled:{id:"auditlogEventFilter.actionNames.page_access_requests_toggled",defaultMessage:"Page access requests toggled",description:"An audit log filter describing page access requests in workspace toggled"},workspace_exported:{id:"auditlogEventFilter.actionNames.workspace_exported",defaultMessage:"Content exported",description:"An audit log that describes an export of all the workspace contents, e.g. in PDF form"},workspace_icon_changed:{id:"auditlogEventFilter.actionNames.workspace_icon_changed",defaultMessage:"Icon changed",description:"An audit log that describes a change of the workspace icon"},allowed_email_domain_added:{id:"auditlogEventFilter.actionNames.allowed_email_domain_added",defaultMessage:"Added allowed email domain",description:"An audit log that describes the adding of an allowed_email_domain to a workspace"},allowed_email_domain_removed:{id:"auditlogEventFilter.actionNames.allowed_email_domain_removed",defaultMessage:"Removed allowed email domain",description:"An audit log that describes the removing of an allowed_email_domain to a workspace"},workspace_domain_changed:{id:"auditlogEventFilter.actionNames.workspace_domain_changed",defaultMessage:"Domain changed",description:"An audit log that describes a change of the workspace domain"},public_page_cleared:{id:"auditlogEventFilter.actionNames.public_page_cleared",defaultMessage:"Public home page link cleared",description:"An audit log that describes the clearing of a public home page for a workspace"},public_page_set:{id:"auditlogEventFilter.actionNames.public_page_set",defaultMessage:"Public home page set",description:"An audit log that describes the setting of a public home page for a workspace"},scim_token_generated:{id:"auditlogEventFilter.actionNames.scim_token_generated",defaultMessage:"SCIM token generated",description:"An audit log that describes the generating of a SCIM token for a workspace"},scim_token_revoked:{id:"auditlogEventFilter.actionNames.scim_token_revoked",defaultMessage:"SCIM token revoked",description:"An audit log that describes the revoking of the SCIM token for a workspace"},idp_metadata_url_updated:{id:"auditlogEventFilter.actionNames.idp_metadata_url_updated",defaultMessage:"IDP metadata URL updated",description:"An audit log filter that describes IDP metadata URL update"},idp_metadata_xml_updated:{id:"auditlogEventFilter.actionNames.idp_metadata_xml_updated",defaultMessage:"IDP metadata XML updated",description:"An audit log filter that describes IDP metadata XML update"},idp_metadata_xml_removed:{id:"auditlogEventFilter.actionNames.idp_metadata_xml_removed",defaultMessage:"IDP metadata XML removed",description:"An audit log filter that describes IDP metadata XML removed"},saml_toggled:{id:"auditlogEventFilter.actionNames.saml_toggled",defaultMessage:"SAML enabling toggled",description:"An audit log filter that describes the toggling of SAML enabling for a workspace"},saml_enforce_toggled:{id:"auditlogEventFilter.actionNames.saml_enforce_toggled",defaultMessage:"SAML enforcing toggled",description:"An audit log that describes the toggling of enforcing of SAML for a workspace"},automatic_account_creation_toggled:{id:"auditlogEventFilter.actionNames.automatic_account_creation_toggled",defaultMessage:"Auto-create accounts on sign-in toggled",description:"An audit log that describes the toggling of enabling of automatic creation of accounts on sign-in"},workspace_creation_set_for_email_domain:{id:"auditlogEventFilter.actionNames.workspace_creation_set_for_email_domain",defaultMessage:"Workspace creation setting updated",description:"An audit log that describes the setting of whether users under the domain can create a workspace."},member_added_to_group:{id:"auditlogEventFilter.actionNames.member_added_to_group",defaultMessage:"Member added to group",description:"An audit log that describes when a member is added to a group"},member_removed_from_group:{id:"auditlogEventFilter.actionNames.member_removed_from_group",defaultMessage:"Member removed from group",description:"An audit log that describes when a member is removed from a group"},allowed_support_access:{id:"auditlogEventFilter.actionNames.allowed_support_access",defaultMessage:"Granted support access",description:"An audit log that describes the enabling of support access"},revoked_support_access:{id:"auditlogEventFilter.actionNames.revoked_support_access",defaultMessage:"Revoked support access",description:"An audit log that describes the disabling of support access"},team_created:{id:"auditlogEventFilter.actionNames.team_created",defaultMessage:"Teamspace created",description:"An audit log that describes that a teamspace was created."},team_archived:{id:"auditlogEventFilter.actionNames.team_archived",defaultMessage:"Teamspace archived",description:"An audit log that describes that a teamspace was archived."},team_restored:{id:"auditlogEventFilter.actionNames.team_restored",defaultMessage:"Teamspace restored",description:"An audit log that describes that a teamspace was restored."},team_default_toggled:{id:"auditlogEventFilter.actionNames.team_default_toggled",defaultMessage:"Teamspace default toggled",description:"An audit log that describes that a teamspace's default status was toggled."},team_privacy_type_changed:{id:"auditlogEventFilter.actionNames.team_privacy_type_changed",defaultMessage:"Teamspace privacy type changed",description:"An audit log event that describes that the privacy type for a teamspace was updated."},team_invite_access_changed:{id:"auditlogEventFilter.actionNames.team_invite_access_changed",defaultMessage:"Teamspace invite access changed",description:"An audit log event that describes that who can invite teamspace members for a teamspace was updated."},team_public_page_sharing_toggled:{id:"auditlogEventFilter.actionNames.team_public_page_sharing_toggled",defaultMessage:"Teamspace public page sharing toggled",description:"An audit log that describes that public page sharing was toggled for a teamspace."},team_export_toggled:{id:"auditlogEventFilter.actionNames.team_export_toggled",defaultMessage:"Teamspace export toggled",description:"An audit log that describes that the ability to export a teamspace was toggled."},team_sidebar_editing_toggled:{id:"auditlogEventFilter.actionNames.team_sidebar_editing_toggled",defaultMessage:"Teamspace sidebar editing toggled",description:"An audit log that describes that the ability to edit a teamspace's sidebar was toggled."},team_guests_toggled:{id:"auditlogEventFilter.actionNames.team_guests_toggled",defaultMessage:"Teamspace disable guests toggled",description:"An audit log that describes that the ability to edit a teamspace's sidebar was toggled."},team_name_changed:{id:"auditlogEventFilter.actionNames.team_name_changed",defaultMessage:"Teamspace name changed",description:"An audit log that describes that a teamspace's name was changed."},team_description_changed:{id:"auditlogEventFilter.actionNames.team_description_changed",defaultMessage:"Teamspace description changed",description:"An audit log that describes that a teamspace's description was changed."},team_icon_changed:{id:"auditlogEventFilter.actionNames.team_icon_changed",defaultMessage:"Teamspace icon changed",description:"An audit log that describes that a teamspace's icon was changed."},team_creation_admins_setting_toggled:{id:"auditlogEventFilter.actionNames.team_creation_admins_setting_toggled",defaultMessage:"Teamspace creation limiting to admins changed",description:"An audit log that describes that the setting to limit teamspace creation to admins was changed."},member_added_to_team:{id:"auditlogEventFilter.actionNames.member_added_to_team",defaultMessage:"Member added to teamspace",description:"An audit log that describes that a user was added to a teamspace."},member_removed_from_team:{id:"auditlogEventFilter.actionNames.member_removed_from_team",defaultMessage:"Member removed from teamspace",description:"An audit log that describes that a user was removed from the teamspace."},group_added_to_team:{id:"auditlogEventFilter.actionNames.group_added_to_team",defaultMessage:"Group added to teamspace",description:"An audit log that describes that a group was added to a teamspace."},group_removed_from_team:{id:"auditlogEventFilter.actionNames.group_removed_from_team",defaultMessage:"Group removed from teamspace",description:"An audit log that describes that a group was removed from the teamspace."},member_left_team:{id:"auditlogEventFilter.actionNames.member_left_team",defaultMessage:"Member left teamspace",description:"An audit log that describes that a user left a teamspace."},member_joined_team:{id:"auditlogEventFilter.actionNames.member_joined_team",defaultMessage:"Member joined teamspace",description:"An audit log that describes that a user joined a teamspace."},member_team_role_updated:{id:"auditlogEventFilter.actionNames.member_team_role_updated",defaultMessage:"Member role updated for teamspace",description:"An audit log that describe a user's role in a teamspace was updated."},team_member_default_permission_updated:{id:"auditlogEventFilter.actionNames.team_member_default_permission_updated",defaultMessage:"Teamspace Members default permission updated",description:"An audit log that describes that the default permissions of members of a teamspace were updated."},team_workspace_default_permission_updated:{id:"auditlogEventFilter.actionNames.team_workspace_default_permission_updated",defaultMessage:"Workspace default permission updated for teamspace",description:"An audit log that describes that the default permissions for everyone else in the workspace for a teamspace were updated."},private_content_transferred:{id:"auditLogEventFilter.actionNames.private_content_transferred",defaultMessage:"Private content transferred",description:"Event name for private content transferred audit log event"}}),At=(0,y.defineMessages)({adminLabel:{id:"auditLogSpaceRoleMessages.admin",defaultMessage:"admin",description:"A user in an audit log entry who has admin access"},workspaceOwnerLabel:{id:"auditLogSpaceRoleMessages.workspaceOwner",defaultMessage:"workspace owner",description:"A user in an audit log entry who has workspace owner access"},membershipAdminLabel:{id:"auditLogSpaceRoleMessages.membershipAdmin",defaultMessage:"membership admin",description:"A user in an audit log entry who is a membership admin (controls membership for space & groups)."},memberLabel:{id:"auditLogSpaceRoleMessages.member",defaultMessage:"member",description:"A user in an audit log entry who has member access"},guestLabel:{id:"auditLogSpaceRoleMessages.guest",defaultMessage:"guest",description:"A user in an audit log entry who has guest access"},noAccessLabel:{id:"auditLogSpaceRoleMessages.noAccess",defaultMessage:"no access",description:"A user in an audit log entry who has no access"}}),It=(0,y.defineMessages)({private:{id:"auditLogColumnEvent.tooltip.pageAudience.private",defaultMessage:"private",description:"Audience descriptor for private pages"},shared_internally:{id:"auditLogColumnEvent.tooltip.pageAudience.sharedInternally",defaultMessage:"shared internally",description:"Audience descriptor for pages that are shared within a workspace"},shared_externally:{id:"auditLogColumnEvent.tooltip.pageAudience.sharedExternally",defaultMessage:"shared externally",description:"Audience descriptor for pages that are shared outside a workspace"},shared_to_web:{id:"auditLogColumnEvent.tooltip.pageAudience.sharedToWeb",defaultMessage:"shared to web",description:"Audience descriptor for pages that are shared to web"}}),Pt=(0,y.defineMessages)({missing:{defaultMessage:"MISSING",id:"auditLogSettings.copiedText.missingField",description:"Shown in the copied text/CSV for audit log in the case of a missing/unavailable field"},notApplicable:{defaultMessage:"N/A",id:"auditLogSettings.copiedText.notApplicable",description:"Means 'not applicable', shown in audit log CSV for values that shouldn't be populated for an audit log."}}),_t=["name","email","status","activityType","activity","audience","dateAndTime","platform","ipAddress","city","state","country","pageId"];(0,y.defineMessages)({name:{id:"exportAuditLog.header.name",defaultMessage:"Name",description:"The column header denoting that this column's contents show the name of an audit log event."},email:{id:"exportAuditLog.header.email",defaultMessage:"Email",description:"The column header denoting that this column's contents show the email of an audit log event's actor."},status:{id:"exportAuditLog.header.status",defaultMessage:"Status",description:"The column header denoting that this column's contents show the guest/member/admin status of an audit log event's actor"},activityType:{id:"exportAuditLog.header.activityType",defaultMessage:"Activity Type",description:"The column header denoting that this column's contents show the type of activity of an audit log event"},activity:{id:"exportAuditLog.header.activity",defaultMessage:"Activity",description:"The column header denoting that this column's contents show the activity contents of an audit log event"},dateAndTime:{id:"exportAuditLog.header.dateAndTime",defaultMessage:"Date and Time (UTC)",description:"The column header denoting that this column's contents show the date and time in UTC time for an audit log event"},platform:{id:"exportAuditLog.header.platform",defaultMessage:"Platform",description:"The column header denoting that this column's contents show the date and time of an audit log event"},ipAddress:{id:"exportAuditLog.header.ipAddress",defaultMessage:"IP Address",description:"The column header denoting that this column's contents show the IP address an audit log event took place in"},city:{id:"exportAuditLog.header.city",defaultMessage:"City",description:"The column header denoting that this column's contents show the city an audit log event took place in"},state:{id:"exportAuditLog.header.state",defaultMessage:"State",description:"The column header denoting that this column's contents show the state an audit log event took place in"},country:{id:"exportAuditLog.header.country",defaultMessage:"Country",description:"The column header denoting that this column's contents show the country an audit log event took place in"},audience:{id:"exportAuditLog.header.audience",defaultMessage:"Audience",description:"Column header for audit log CSV labelling the audience of the event"},pageId:{id:"exportAuditLog.header.pageId",defaultMessage:"Page Id",description:"Column header for audit log CSV labelling the page ID."}});function xt(e,t,i){var a;return e.actor.actorId===be.s$.id||e.actor.actorId===be.el.id?t.formatMessage({defaultMessage:"notion_admin",id:"auditLogPaginatedTable.copiedText.notionAdmin",description:"Shown in the copied text for a Notion Admin user"}):"notion_user"===e.actor.actorType?t.formatMessage(function(e,t){if(!e)return At.noAccessLabel;switch(e){case"admin":return t?At.workspaceOwnerLabel:At.adminLabel;case"membership_admin":return At.membershipAdminLabel;case"member":return At.memberLabel;case"guest":return At.guestLabel;case"no_access":return At.noAccessLabel;default:(0,W.t1)(e)}}(null===(a=e.actor.meta)||void 0===a?void 0:a.spaceRole,i)):t.formatMessage({defaultMessage:"N/A",id:"auditLogPaginatedTable.copiedText.noRole",description:"Shown in the copied text for a bot, who has no role. Means not applicable"})}function Ft(e,t){var i,a,n,s,o,r,l,d,c,u,m,p,g,h,f,v,y,S;return null!==(i=e.actor.meta)&&void 0!==i&&i.countryCode?null!==(a=e.actor)&&void 0!==a&&null!==(n=a.meta)&&void 0!==n&&n.city?"US"===(null===(s=e.actor.meta)||void 0===s?void 0:s.countryCode)&&null!==(o=e.actor)&&void 0!==o&&null!==(r=o.meta)&&void 0!==r&&r.state?t.formatMessage({description:"city, state and country metadata for audit log",defaultMessage:"{city}, {state}, {countryCode}",id:"auditLogSettings.metadata.cityStateAndCountry"},{city:null===(g=e.actor)||void 0===g||null===(h=g.meta)||void 0===h?void 0:h.city,state:null===(f=e.actor)||void 0===f||null===(v=f.meta)||void 0===v?void 0:v.state,countryCode:null===(y=e.actor)||void 0===y||null===(S=y.meta)||void 0===S?void 0:S.countryCode}):t.formatMessage({description:"city and country metadata for audit log",defaultMessage:"{city}, {countryCode}",id:"auditLogSettings.metadata.cityAndCountry"},{city:null===(l=e.actor)||void 0===l||null===(d=l.meta)||void 0===d?void 0:d.city,countryCode:null===(c=e.actor)||void 0===c||null===(u=c.meta)||void 0===u?void 0:u.countryCode}):null===(m=e.actor)||void 0===m||null===(p=m.meta)||void 0===p?void 0:p.countryCode:""}function Bt(e){const{auditLogEntry:t,intl:i,dateTimezone:a,getAuditLogEventText:n,shouldShowWorkspaceOwner:s,shouldShowPrivateNames:o}=e,r=[],l=i.formatMessage(Pt.missing);return _t.forEach((e=>{var d,c,u,m,p;switch(e){case"name":r.push(t.actor.name||l);break;case"email":r.push(function(e,t){return"notion_user"===e.actor.actorType?e.actor.email:t.formatMessage({defaultMessage:"N/A",id:"auditLogPaginatedTable.copiedText.noEmail",description:"Shown in the copied text for a bot, who has no email address. Means not applicable"})}(t,i)||l);break;case"status":r.push(xt(t,i,s)||l);break;case"activityType":r.push(Zt[t.actionName]?i.formatMessage(Zt[t.actionName]):l);break;case"activity":r.push(n(t)||l);break;case"dateAndTime":r.push((0,Tt.default)(t.serverTimestamp).tz(a).format(kt)||l);break;case"platform":r.push((null===(d=t.actor.meta)||void 0===d?void 0:d.platform)||l);break;case"ipAddress":r.push((null===(c=t.actor.meta)||void 0===c?void 0:c.ipAddress)||l);break;case"city":r.push((null===(u=t.actor.meta)||void 0===u?void 0:u.city)||l);break;case"state":r.push((null===(m=t.actor.meta)||void 0===m?void 0:m.state)||l);break;case"country":r.push((null===(p=t.actor.meta)||void 0===p?void 0:p.countryCode)||l);break;case"audience":if(!o)break;const g=function(e){var t;return null!==(t=Et(e))&&void 0!==t?t:e.intl.formatMessage(Pt.notApplicable)}({auditLogEntry:t,intl:i});o&&r.push(g||l);break;case"pageId":if(!o)break;const h=V(t);h?r.push(h.id):r.push(i.formatMessage(Pt.notApplicable));break;default:(0,W.t1)(e)}})),r.join(",")}function Et(e){var t;const{auditLogEntry:i,intl:a}=e,n=V(i);return null!=n&&null!==(t=n.meta)&&void 0!==t&&t.pageAudience?a.formatMessage(It[n.meta.pageAudience]):null}let Dt,Rt;!function(e){e.Page="Page",e.Workspace="Workspace",e.Team="Team",e.Account="Account"}(Dt||(Dt={})),function(e){e.All="All",e.Partial="Partial",e.None="None"}(Rt||(Rt={}));class Lt extends N.Z{getInitialState(){return{categorySelections:{[Dt.Page]:Rt.All,[Dt.Workspace]:Rt.All,[Dt.Team]:Rt.All,[Dt.Account]:Rt.All},actionSelections:{page_viewed:!0,page_created:!0,page_deleted:!0,page_restored:!0,page_exported:!0,page_moved:!0,page_permission_updated:!0,page_shared_to_web:!0,private_content_transferred:!0,password_set:!0,password_cleared:!0,password_changed:!0,login:!0,logout:!0,member_invited:!0,member_role_updated:!0,member_removed:!0,guest_removed:!0,email_changed:!0,user_deleted:!0,member_joined:!0,preferred_name_changed:!0,picture_changed:!0,workspace_name_changed:!0,workspace_icon_changed:!0,allowed_email_domain_added:!0,allowed_email_domain_removed:!0,workspace_domain_changed:!0,workspace_exported:!0,public_page_cleared:!0,public_page_set:!0,scim_token_generated:!0,scim_token_revoked:!0,saml_toggled:!0,saml_enforce_toggled:!0,automatic_account_creation_toggled:!0,workspace_creation_set_for_email_domain:!0,member_added_to_group:!0,member_removed_from_group:!0,file_uploaded:!0,file_downloaded:!0,invite_link_toggled:!0,invite_link_reset:!0,page_access_requests_toggled:!0,public_page_sharing_toggled:!0,workspace_sidebar_editing_toggled:!0,disable_guests_toggled:!0,pages_to_other_workspaces_toggled:!0,export_toggled:!0,workspace_integration_restriction_changed:!0,idp_metadata_url_updated:!0,idp_metadata_xml_updated:!0,idp_metadata_xml_removed:!0,allowed_support_access:!0,revoked_support_access:!0,team_created:!0,team_archived:!0,team_restored:!0,team_default_toggled:!0,team_public_page_sharing_toggled:!0,team_guests_toggled:!0,team_export_toggled:!0,team_sidebar_editing_toggled:!0,team_name_changed:!0,team_description_changed:!0,team_icon_changed:!0,team_creation_admins_setting_toggled:!0,member_added_to_team:!0,group_added_to_team:!0,member_removed_from_team:!0,group_removed_from_team:!0,member_left_team:!0,member_joined_team:!0,member_team_role_updated:!0,team_member_default_permission_updated:!0,team_workspace_default_permission_updated:!0,team_privacy_type_changed:!0,team_invite_access_changed:!0},isMenuOpen:!1,renderOrder:[{category:Dt.Page,orderedActions:["page_viewed","page_created","page_deleted","page_restored","page_exported","page_moved","page_permission_updated","page_shared_to_web","file_uploaded","file_downloaded"]},{category:Dt.Workspace,orderedActions:["member_invited","member_joined","member_role_updated","member_removed","guest_removed","invite_link_toggled","workspace_name_changed","invite_link_reset","page_access_requests_toggled","public_page_sharing_toggled","workspace_sidebar_editing_toggled","disable_guests_toggled","pages_to_other_workspaces_toggled","export_toggled","workspace_icon_changed","allowed_email_domain_added","allowed_email_domain_removed","workspace_domain_changed","workspace_exported","workspace_integration_restriction_changed","public_page_cleared","public_page_set","scim_token_generated","scim_token_revoked","idp_metadata_url_updated","idp_metadata_xml_updated","idp_metadata_xml_removed","saml_toggled","saml_enforce_toggled","automatic_account_creation_toggled","workspace_creation_set_for_email_domain","member_added_to_group","member_removed_from_group"]},{category:Dt.Account,orderedActions:["login","logout","password_set","password_cleared","password_changed","email_changed","preferred_name_changed","picture_changed","user_deleted","allowed_support_access","revoked_support_access"]},{category:Dt.Team,orderedActions:["team_created","team_archived","team_restored","team_privacy_type_changed","team_default_toggled","team_public_page_sharing_toggled","team_export_toggled","team_sidebar_editing_toggled","team_guests_toggled","team_invite_access_changed","team_name_changed","team_description_changed","team_icon_changed","team_creation_admins_setting_toggled","member_added_to_team","group_added_to_team","member_removed_from_team","group_removed_from_team","member_joined_team","member_left_team","member_team_role_updated","team_member_default_permission_updated","team_workspace_default_permission_updated"]}]}}getAllActionNames(){return(0,W.Yd)(this.state.actionSelections)}getSelectedActionNames(){return this.getAllActionNames().filter((e=>this.state.actionSelections[e]))}hasActionNameSelected(){const e=this.getAllActionNames(),t=this.getSelectedActionNames();return t.length>0&&t.length!==e.length}toggleCategorySelection(e){const t=e.category,i=this.state.categorySelections[t],a=i===Rt.None||i===Rt.Partial?Rt.All:Rt.None,n=a===Rt.All,s={...this.state.actionSelections},o=this.state.renderOrder.find((e=>e.category===t));o&&(o.orderedActions.forEach((e=>{s[e]=n})),this.setState({...this.state,actionSelections:s,categorySelections:{...this.state.categorySelections,[o.category]:a}}))}toggleActionNameSelection(e,t){const i=this.state.actionSelections[e],a={...this.state.actionSelections,[e]:!i},n=t.orderedActions.filter((e=>a[e])).length,s=0===n?Rt.None:n===t.orderedActions.length?Rt.All:Rt.Partial;this.setState({...this.state,actionSelections:a,categorySelections:{...this.state.categorySelections,[t.category]:s}})}clearAllSelections(){const e=this.getBulkUpdateNextActionSelectionState((0,W.Yd)(this.state.actionSelections),!1),t=this.getBulkUpdateNextCategorySelectionState((0,W.Yd)(this.state.categorySelections),Rt.None);this.setState({...this.state,actionSelections:e,categorySelections:t})}getBulkUpdateNextCategorySelectionState(e,t){const i={...this.state.categorySelections};return e.forEach((e=>{i[e]=t})),i}getBulkUpdateNextActionSelectionState(e,t){const i={...this.state.actionSelections};return e.forEach((e=>{i[e]=t})),i}}var Ot=i(29798),Nt=i(82970);class Ut extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{componentStore:Lt,lastSelectionStore:Lt,menuListStore:Ot.Z}),l()(this,"renderMenu",(()=>{const{componentStore:e,menuListStore:t}=this.stores,i=[];e.state.renderOrder.forEach((e=>{(e.category!==Dt.Team||(0,O.bq)())&&(i.push(this.renderCategoryMenu(e)),e.orderedActions.forEach((t=>{i.push(this.renderActionNameMenu(t,e))})))}));const a={key:"results",items:i,render:e=>m().createElement(Re.Z,o()({},e,{title:null,loading:!1}))};return m().createElement(m().Fragment,null,n()(Be.Z,{menuType:Be.Z.MenuType.Popup,header:null,maxHeight:356},void 0,n()(Ee.Z,{type:Ee.Z.Type.Vertical,store:t,initialFocus:0,sections:[a]})),n()(Re.Z,{topBorder:!0,style:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"}},void 0,n()(ut.Z,{onClick:()=>{this.handleClear()}},void 0,n()(y.FormattedMessage,{id:"auditlogEventFilter.clearButton",defaultMessage:"Clear"})),n()(xe.Z,{onClick:()=>{this.handleApply()}},void 0,n()(y.FormattedMessage,{id:"auditlogEventFilter.applyButton",defaultMessage:"Apply"}))))})),l()(this,"renderPillButtonOrigin",(e=>{const{componentStore:t}=this.stores,i=t.hasActionNameSelected();return n()(Ke.u,{on:i,icon:h.Z.bot({width:16,marginRight:6,fill:"currentColor"}),title:n()("span",{},void 0,e),onClick:()=>{this.setMenuOpen(!0)}})})),l()(this,"setMenuOpen",(e=>{const{componentStore:t}=this.stores;t.setState({...t.state,isMenuOpen:e})})),l()(this,"styles",{menu:{width:250,maxHeight:"40vh"},menuItem:{width:"fit-content",border:"solid 1px",borderColor:this.theme.outlineButtonBorder,paddingLeft:0,paddingRight:0,borderRadius:20,fontSize:12},icon:{height:14,width:14,fill:"currentColor"},popup:{paddingTop:8,paddingBottom:8}})}renderComponent(){const{componentStore:e}=this.stores,t=this.styles,i=n()(y.FormattedMessage,{id:"auditlogEventFilter.title",defaultMessage:"Event",description:"The title of the event filter in the pill mode"}),a=this.renderPillButtonOrigin(i);return n()(gt.Z,{marginAfter:!1},void 0,n()(De.ZP,{popupType:De.ZP.PopupType.Popup,placementToOrigin:De.ZP.Placement.Bottom,alignmentToOrigin:De.ZP.Alignment.Start,open:e.state.isMenuOpen,render:this.renderMenu,onDismiss:()=>{this.handleMenuCloseFromOutside()},keepFocus:!0,origin:a,preventScaleTransition:!0,style:t.popup}))}renderCategoryMenu(e){const{intl:t}=this.props,{componentStore:i}=this.stores,a=e.category,s=()=>{i.toggleCategorySelection(e)};return{key:a,action:s,render:e=>m().createElement(Fe.Z,o()({},e,{icon:n()(Nt.Z,{checked:i.state.categorySelections[a]===Rt.All,size:16,onClick:s}),focused:!1,title:t.formatMessage(Wt[a]),className:"notranslate"}))}}renderActionNameMenu(e,t){const{intl:i}=this.props,{componentStore:a}=this.stores,s=()=>{a.toggleActionNameSelection(e,t)};return{key:e,action:s,render:t=>m().createElement(Fe.Z,o()({},t,{icon:n()(Nt.Z,{checked:a.state.actionSelections[e],size:16,onClick:s}),focused:!1,title:i.formatMessage(Zt[e]),className:"notranslate",style:{paddingLeft:20}}))}}handleMenuCloseFromOutside(){const{componentStore:e,lastSelectionStore:t}=this.stores;e.setState({...e.state,actionSelections:{...t.state.actionSelections},categorySelections:{...t.state.categorySelections}}),this.setMenuOpen(!1)}handleClear(){const{componentStore:e}=this.stores;e.clearAllSelections()}handleApply(){const{onChange:e}=this.props,{componentStore:t,lastSelectionStore:i}=this.stores,a=t.getAllActionNames(),n=t.getSelectedActionNames();e(a.length===n.length?[]:n),0===n.length&&t.reset(),i.setState({...i.state,actionSelections:{...t.state.actionSelections},categorySelections:{...t.state.categorySelections}}),this.setMenuOpen(!1)}}const Wt=(0,y.defineMessages)({[Dt.Page]:{id:"auditlogEventFilter.categoryName.page",defaultMessage:"Page",description:"audit log action category - page"},[Dt.Workspace]:{id:"auditlogEventFilter.categoryName.workspace",defaultMessage:"Workspace",description:"audit log action category - workspace"},[Dt.Team]:{id:"auditlogEventFilter.categoryName.team",defaultMessage:"Teamspace",description:"audit log action category - Teamspace"},[Dt.Account]:{id:"auditlogEventFilter.categoryName.account",defaultMessage:"Account",description:"audit log action category - account"}}),Vt=(0,y.injectIntl)(Ut);const zt=(0,y.injectIntl)((function(e){const{spaceStore:t}=e,[i,a]=(0,Se.oR)(X),[s,o,r]=(0,Se.oR)(ke);return n()("div",{style:{display:"flex",flexDirection:"row",gap:4}},void 0,n()(ft,{mode:mt.z.Pill,focused:!1,title:n()(y.FormattedMessage,{id:"auditlogDateFilter.title",defaultMessage:"Date"}),icon:h.Z.calendar,value:i.timeRange,showButtons:"footer",onChange:e=>{a({...i,timeRange:e,pageNum:1})}}),n()(Ct,{parentStore:t,auditLogHistoricalUserStore:r,selectedActors:i.actors,onChange:e=>{a({...i,actors:e,pageNum:1})}}),n()(Vt,{parentStore:t,selectedEvents:i.actions,onChange:e=>{a({...i,actions:e,pageNum:1})}}))}));var Gt=i(95477),Ht=i(47966),qt=i(23189);function Kt(){return n()(qt.Z,{large:!0,style:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:v.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"}},void 0,n()("div",{style:{gap:8,display:"flex"}},void 0,n()(y.FormattedMessage,{id:"auditlog.title",defaultMessage:"Audit log"})),n()(jt,{}))}function jt(){const e=(0,ye.O7)();return Gt.Z.isLocalhost||"development"===Gt.Z.env?n()(Ht.Z,{style:{marginLeft:10},isSmall:!0,onClick:()=>{(0,T.navigateToExternalURL)({environment:e,url:"https://dev.notion.so/notion/Audit-Log-Dev-feedback-e9048c4e7d544369b0b8413ec20f02cf",targetSelf:!0})}},void 0,"🎁 Feedback is a gift!"):null}var Yt=i(24405);function Qt(e){const{paragraphs:t}=e,i=(0,Yt.y)((e=>({skeletonRect:{borderRadius:3,backgroundColor:e.lightDividerColor}})),[]),a=null==t?void 0:t.map((e=>{const t={height:e.lineHeight,marginTop:e.lineMargin,marginBottom:e.lineMargin},a={marginTop:e.sectionMargin,marginBottom:e.sectionMargin},s=[...Array(e.repeat||1)].map((s=>n()("div",{style:{...a}},void 0,e.sectionWidths.map((e=>n()("div",{className:B.MD,style:{...i.skeletonRect,...t,width:"".concat(e,"%")}}))))));return m().createElement(m().Fragment,null," ",s," ")}));return m().createElement(m().Fragment,null," ",a," ")}const Jt=function(){return n()("div",{style:{}},void 0,n()(Qt,{paragraphs:[{lineHeight:45,lineMargin:20,sectionWidths:[100],repeat:1,sectionMargin:15},{lineHeight:40,lineMargin:5,sectionWidths:[100],repeat:8,sectionMargin:10}]}))};var Xt=i(25186),$t=i(31689),ei=i(14947),ti=i(40235),ii=i(46951),ai=i(21752);function ni(e){const{auditLogEntry:t,actorStore:i,id:a}=e,s=(0,Se.VK)((()=>i.state),[i]),o=(0,u.createRef)();if(s.ready&&s.value){const e=i.pointer.table;if(e===be.KJ){var r;const e=s.value,i=t.actor,l=i.name||(null==e?void 0:e.name),d=i.email||(null==e?void 0:e.email),c=null===(r=i.meta)||void 0===r?void 0:r.spaceRole,u="member"===c||"no_access"===c?void 0:c;return n()(Le.Z,{disableTooltip:si(o.current),renderTooltip:()=>m().createElement(m().Fragment,null,n()("div",{},void 0,l),n()("div",{},void 0,d)),placement:Le.Z.Placement.Bottom,render:t=>m().createElement("div",t,n()(ai.Z,{id:a,userValue:{...e,name:l,email:d},spaceRole:u}))})}if(e===Me.cZ){const e=s.value,i=t.actor.name||e.name,r=t.actor.actorId;return n()(Le.Z,{disableTooltip:si(o.current),renderTooltip:()=>m().createElement(m().Fragment,null,n()("div",{},void 0,i),n()("div",{},void 0,r)),placement:Le.Z.Placement.Bottom,render:e=>m().createElement("div",e,n()(ai.Z,{id:a,userValue:{id:t.actor.actorId,version:1,email:r,name:i}}))})}}return n()(ai.Z,{id:a,userValue:{id:t.actor.actorId,name:t.actor.name,version:1,email:""}})}function si(e){return!!e&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}var oi=i(19757);function ri(e){const{auditLogEntry:t,id:i}=e;return n()(Le.Z,{renderTooltip:()=>n()("div",{style:{display:"flex",flexDirection:"column",fontVariantNumeric:"tabular-nums"}},void 0,n()("div",{},void 0,(0,Tt.default)(t.serverTimestamp).tz(U.x7).format("z: ".concat(kt))),n()("div",{},void 0,n()(y.FormattedMessage,{id:"auditLogSettings.timeTooltip.utcTime",defaultMessage:"UTC: {time}",description:"Tooltip for UTC time on hover in the audit log.",values:{time:(0,Tt.default)(t.serverTimestamp).tz("UTC").format(kt)}}))),render:e=>n()("div",{id:i},void 0,m().createElement(ii.Z,o()({isSecondaryColor:!0},e),(0,Tt.default)(t.serverTimestamp).format(kt))),placement:oi.ug.Bottom})}var li=i(65917),di=i(26825),ci=i(21202),ui=i(19639),mi=i(75246),pi=i(29369);function gi(e){var t;return fi(null===(t=e.meta)||void 0===t?void 0:t.permissionLevel)}function hi(e){var t;return"space_members"!==(null===(t=e.meta)||void 0===t?void 0:t.permissionLevel)}function fi(e){return"workspace"!==e}const vi=(0,y.defineMessages)({picture_changed:{id:"auditlog.actionNames.eventColumn.picture_changed",defaultMessage:"Changed profile picture",description:"Changed picture event for audit log"},password_cleared:{id:"auditlog.actionNames.eventColumn.password_cleared",defaultMessage:"Cleared login password",description:"Password cleared event for audit log"},password_set:{id:"auditlog.actionNames.eventColumn.password_set",defaultMessage:"Created a login password",description:"Password set event for audit log"},password_changed:{id:"auditlog.actionNames.eventColumn.password_changed",defaultMessage:"Changed login password",description:"Password change event for audit log"},logout:{id:"auditlog.actionNames.eventColumn.logout",defaultMessage:"Logged out",description:"Logout picture event for audit log"},user_deleted:{id:"auditlog.actionNames.eventColumn.user_deleted",defaultMessage:"User was deleted",description:"User deleted event for audit log"},member_joined:{id:"auditlog.actionNames.eventColumn.member_joined",defaultMessage:"Joined the workspace",description:"Member joined event for audit log"},file_uploaded:{id:"auditlog.actionNames.eventColumn.file_uploaded",defaultMessage:"Uploaded a file",description:"File uploaded event for audit log"},invite_link_reset:{id:"auditlog.actionNames.eventColumn.invite_link_reset",defaultMessage:"Reset invite link",description:"Reset invite link for workspace"},workspace_exported:{id:"auditlog.actionNames.eventColumn.workspace_exported",defaultMessage:"Exported all workspace content",description:"An audit log that describes an export of all the workspace contents, e.g. in PDF form"},workspace_icon_changed:{id:"auditlog.actionNames.eventColumn.workspace_icon_changed",defaultMessage:"Changed workspace icon",description:"An audit log that describes a change of the workspace icon"},public_page_cleared:{id:"auditlogEventFilter.actionNames.public_page_cleared",defaultMessage:"Public home page link cleared",description:"An audit log that describes the clearing of a public home page for a workspace"},scim_token_generated:{id:"auditlog.actionNames.scim_token_generated",defaultMessage:"Generated API SCIM token",description:"An audit log that describes the generating of a SCIM token for a workspace"},scim_token_revoked:{id:"auditlog.actionNames.scim_token_revoked",defaultMessage:"Revoked API SCIM token",description:"An audit log that describes the revoking of the SCIM token for a workspace"},page_access_requests_toggled:{id:"auditlog.actionNames.eventColumn.page_access_requests_toggled",defaultMessage:"page access requests from non-members",description:"Used to track page access requests toggle from settings in audit log, will either have the word 'Enabled' or 'Disabled' in front"},public_page_sharing_toggled:{id:"auditlog.actionNames.eventColumn.public_page_sharing_toggled",defaultMessage:"members sharing pages publicly",description:"Used to track page sharing toggle from settings in audit log, will either have the word 'Enabled' or 'Disabled' in front"},workspace_sidebar_editing_toggled:{id:"auditlog.actionNames.eventColumn.workspace_sidebar_editing_toggled",defaultMessage:"members changing the Workspace section",description:"Used to track members changing Workspace settings toggle in audit log, will either have the word 'Enabled' or 'Disabled' in front"},disable_guests_toggled:{id:"auditlog.actionNames.eventColumn.disable_guests_toggled",defaultMessage:"guests",description:"Used to track toggling guests in a workspace in audit log, will either have the word 'Enabled' or 'Disabled' in front"},pages_to_other_workspaces_toggled:{id:"auditlog.actionNames.eventColumn.pages_to_other_workspaces_toggled",defaultMessage:"moving or duplicating pages to other workspaces",description:"Used to track toggling moving pages to other workspaces in audit log, will either have the word 'Enabled' or 'Disabled' in front"},export_toggled:{id:"auditlog.actionNames.eventColumn.export_toggled",defaultMessage:"export",description:"Used to track toggling export for a workspace in audit log, will either have the word 'Enabled' or 'Disabled' in front"},idp_metadata_xml_updated:{id:"auditlog.actionNames.eventColumn.idp_metadata_xml_updated",defaultMessage:"Updated IDP metadata XML",description:"An audit log that describes IDP metadata XML getting updated"},idp_metadata_xml_removed:{id:"auditlog.actionNames.eventColumn.idp_metadata_xml_removed",defaultMessage:"Removed IDP metadata XML",description:"An audit log that describes IDP metadata XML getting removed"},saml_enabled:{id:"auditlog.actionNames.saml_enabled",defaultMessage:"Enabled SAML",description:"An audit log that describes the enabling of SAML for a workspace"},saml_disabled:{id:"auditlog.actionNames.saml_disabled",defaultMessage:"Disabled SAML",description:"An audit log that describes the disabling of SAML for a workspace"},saml_enforced:{id:"auditlog.actionNames.saml_enforced",defaultMessage:"Enabled enforcing SAML",description:"An audit log that describes the enforcing of SAML for a workspace"},saml_unenforced:{id:"auditlog.actionNames.saml_unenforced",defaultMessage:"Disabled enforcing SAML",description:"An audit log that describes the disabling of SAML enforcing for a workspace"},automatic_account_creation_enabled:{id:"auditlog.actionNames.automatic_account_creation_enabled",defaultMessage:"Enabled automatically creating accounts on sign-in",description:"An audit log that describes the enabling of automatically creating accounts on sign-in"},automatic_account_creation_disabled:{id:"auditlog.actionNames.automatic_account_creation_disabled",defaultMessage:"Disabled automatically creating accounts on sign-in",description:"An audit log that describes the disabling of automatically creating accounts on sign-in"},a_private_page:{defaultMessage:"a private page",id:"auditlog.actionNames.eventColumn.private_page",description:"An audit log that describes a page action performed on a page that is private"},an_untitled_page:{defaultMessage:"an untitled page",id:"auditlog.actionNames.eventColumn.untitled_page",description:"An audit log that describes a page action performed on a page that is untitled"},thisWorkspace:{defaultMessage:"this workspace",id:"auditlog.actionNames.eventColumn.thisWorkspace",description:"The word is used in an audit log that describes a page action performed to the current workspace"},otherWorkspace:{defaultMessage:"another workspace",id:"auditlog.actionNames.eventColumn.otherWorkspace",description:"The word is used in an audit log that describes a page action performed to another workspace"},workspaceLevel:{defaultMessage:"the workspace level",id:"auditlog.actionNames.eventColumn.workspaceLevel",description:"The word is used in an audit log that describes a page action performed to a page at the workspace level"},private:{defaultMessage:"private",id:"auditlog.actionNames.eventColumn.private",description:"The word is used in an audit log that describes a page action performed to a private page"},a_file:{defaultMessage:"a file",id:"auditlog.actionNames.eventColumn.a_file",description:"The word is used in an audit log that describes a file users uploaded or downloaded"},a_file_with_extension:{defaultMessage:"a {extension} file",id:"auditlog.actionNames.eventColumn.a_file_with_extension",description:"The word is used in an audit log that describes a file with a particular extension users uploaded or downloaded"},team:{defaultMessage:"teamspace",id:"auditlog.actionNames.eventColumn.team",description:"The word to denote a teamspace in audit log."},for_a_private_team:{defaultMessage:"for a private teamspace",id:"auditlog.actionNames.eventColumn.for_private_team",description:"An audit log that describes a action performed for a teamspace that is private"},a_private_team:{defaultMessage:"a private teamspace",id:"auditlog.actionNames.eventColumn.private_team",description:"An audit log that describes a action performed on a teamspace that is private"},a_team_and_page:{defaultMessage:"a teamspace and page",id:"auditlog.actionNames.eventColumn.team_and_page",description:"A phrase to denote a teamspace and page in audit log (e.g. under which a child page resides)."},team_member:{defaultMessage:"teamspace member",id:"auditlog.actionNames.eventColumn.team_member",description:"A phrase to denote a teamspace member."},team_owner:{defaultMessage:"teamspace owner",id:"auditlog.actionNames.eventColumn.team_owner",description:"A phrase to denote a teamspace owner."},team_level_guest:{defaultMessage:"teamspace guest",id:"auditlog.actionNames.eventColumn.team_level_guest",description:"A phrase to denote a teamspace guest."},group:{defaultMessage:"group",id:"auditlog.actionNames.eventColumn.group",description:"The word to denote a group in audit log."},user:{defaultMessage:"user",id:"auditLogEntry.user.noName",description:"Placeholder used in audit log entry when a user neither has a name nor an email address."}});function yi(e,t){return"user"in t.target&&t.target.user?Si(e,t.target.user):"bot"in t.target&&t.target.bot?t.target.bot.name?"“".concat(t.target.bot.name,"“"):"bot":"group"in t.target&&t.target.group?t.target.group.name?"“".concat(t.target.group.name,"“"):"group":void 0}function Si(e,t){return t?t.name&&t.email?"“".concat(t.name,"“ (").concat(t.email,")"):t.name?"“".concat(t.name,"“"):t.email?"“".concat(t.email,"“"):e.formatMessage(vi.user):e.formatMessage(vi.user)}const Mi=(0,y.defineMessages)({equallyRestrictive:{defaultMessage:". This is the same as the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_equal",description:"An audit log suffix that describes that a team's guest settings were the same as the workspace's"},moreRestrictive:{defaultMessage:". This is more restrictive than the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_more_restrictive",description:"An audit log suffix that describes that a team's guest settings were more restrictive than the workspace's"},lessRestrictive:{defaultMessage:". This is less restrictive than the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_less_restrictive",description:"An audit log suffix that describes that a team's guest settings were less restrictive than the workspace's"}});function bi(e,t){if(void 0!==e&&void 0!==t)return e===t?m().createElement(y.FormattedMessage,Mi.equallyRestrictive):!e&&t?m().createElement(y.FormattedMessage,Mi.moreRestrictive):e&&!t?m().createElement(y.FormattedMessage,Mi.lessRestrictive):void 0}function wi(e){return e.name?"“".concat(e.name,"“ group"):m().createElement(y.FormattedMessage,vi.group)}function Ci(e,t){return!t&&hi(e.target.team)?m().createElement(y.FormattedMessage,vi.for_a_private_team):e.changes.name.oldValue&&e.changes.name.newValue?n()(y.FormattedMessage,{defaultMessage:"from “{oldTeamName}“ to “{newTeamName}“",id:"auditlog.actionNames.eventColumn.from_old_team_name_to_new_team_name",description:"An audit log that describes that a team's name change.",values:{oldTeamName:e.changes.name.oldValue,newTeamName:e.changes.name.newValue}}):!e.changes.name.oldValue&&e.changes.name.newValue?n()(y.FormattedMessage,{defaultMessage:"from some teamspace name to “{newTeamName}“",id:"auditlog.actionNames.eventColumn.from_unknown_team_name_to_new_team_name",description:"An audit log that describes that a teamspace's name change from an unknown old name.",values:{newTeamName:e.changes.name.newValue}}):n()(y.FormattedMessage,{defaultMessage:"for {teamName}",id:"auditlog.actionNames.eventColumn.for_team_name",description:"An audit log that describes that a team's name.",values:{teamName:Ti(e,t)}})}function Ti(e,t){return"team"in e.target?ki(e.target.team,t):m().createElement(y.FormattedMessage,vi.team)}function ki(e,t){return!t&&hi(e)?m().createElement(y.FormattedMessage,vi.a_private_team):e.name?"“".concat(e.name,"“ teamspace"):m().createElement(y.FormattedMessage,vi.team)}function Zi(e){if(e)switch(e){case"owner":return m().createElement(y.FormattedMessage,vi.team_owner);case"member":return m().createElement(y.FormattedMessage,vi.team_member);case"team_level_guest":return m().createElement(y.FormattedMessage,vi.team_level_guest)}return m().createElement(y.FormattedMessage,vi.team_member)}function Ai(e){return m().createElement(y.FormattedMessage,function(e){if(!e)return di.mq.noAccessLabel;switch(e){case"editor":return di.mq.fullAccessLabel;case"membership_admin":case"read_and_write":return di.mq.canEditLabel;case"content_only_editor":return di.mq.canEditContentLabel;case"reader":return di.mq.canReadLabel;case"comment_only":return di.mq.canCommentLabel;case"none":return di.mq.noAccessLabel;default:(0,W.t1)(e)}}(e))}function Ii(e){var t,i,a,n;return{oldRole:m().createElement(y.FormattedMessage,Pi(null===(t=e.changes)||void 0===t||null===(i=t.permission)||void 0===i?void 0:i.oldValue)),newRole:m().createElement(y.FormattedMessage,Pi(null===(a=e.changes)||void 0===a||null===(n=a.permission)||void 0===n?void 0:n.newValue))}}const Pi=e=>{if(!e)return di.mq.noAccessLabel;switch(e){case"editor":return di.mq.adminLabel;case"membership_admin":return di.mq.membershipAdminLabel;case"read_and_write":return di.mq.memberLabel;default:return di.mq.noAccessLabel}};function _i(e,t){return!t&&gi(e.target.page)?m().createElement(y.FormattedMessage,vi.a_private_page):e.target.page.title?"“".concat(e.target.page.title,"“"):m().createElement(y.FormattedMessage,vi.an_untitled_page)}function xi(e){var t,i,a,n,s,o;return null!==(t=e.target)&&void 0!==t&&null!==(i=t.page)&&void 0!==i&&null!==(a=i.meta)&&void 0!==a&&a.parent&&"title"in(null===(n=e.target)||void 0===n||null===(s=n.page)||void 0===s||null===(o=s.meta)||void 0===o?void 0:o.parent)?"“".concat(e.target.page.meta.parent.title,"“"):m().createElement(y.FormattedMessage,vi.an_untitled_page)}function Fi(e){var t;return null!==(t=e.actor.meta)&&void 0!==t&&t.platform?n()(y.FormattedMessage,{defaultMessage:"on {platform}",id:"auditlog.actionNames.eventColumn.logged_in_platform",description:"An audit log phrase that describes what platform a user logged in on (e.g. desktop)",values:{platform:e.actor.meta.platform}}):""}function Bi(e){return e.changes.name.oldValue?n()(y.FormattedMessage,{defaultMessage:"from “{oldDomain}“",id:"auditlog.actionNames.eventColumn.old_domain",description:"An audit log phrase that describes what the old domain for a workspace was before it changed.",values:{oldDomain:e.changes.name.oldValue}}):""}function Ei(e,t,i){var a,s;return"block"===e.table?!i&&hi(t)&&fi(null===(a=e.meta)||void 0===a?void 0:a.permissionLevel)?n()(y.FormattedMessage,{defaultMessage:"a private teamspace page",id:"auditlog.actionNames.eventColumn.under_private_team_and_private_parent_page",description:"An audit log phrase that describes a page being under a private page in a private team.",values:{teamName:ki(t,i),parentPage:Di(e)}}):!i&&fi(null===(s=e.meta)||void 0===s?void 0:s.permissionLevel)?n()(y.FormattedMessage,{defaultMessage:"a private page in {teamName}",id:"auditlog.actionNames.eventColumn.under_private_page_in_team",description:"An audit log phrase that describes a page being under a private page in a team.",values:{teamName:ki(t,i)}}):n()(y.FormattedMessage,{defaultMessage:"{teamName} page {parentPage}",id:"auditlog.actionNames.eventColumn.team_parent_page",description:"An audit log phrase that describes what parent page and teamspace a page is under.",values:{teamName:ki(t,i),parentPage:Di(e)}}):"team"===e.table?ki(t,i):void 0}function Di(e){return"title"in e?"“".concat(e.title,"“"):m().createElement(y.FormattedMessage,vi.an_untitled_page)}function Ri(e,t,i){var a;return i?"space"===i.table?i.id!==e?m().createElement(y.FormattedMessage,vi.otherWorkspace):fi(i.permissionLevel)?t?m().createElement(y.FormattedMessage,vi.private):m().createElement(y.FormattedMessage,vi.a_private_page):m().createElement(y.FormattedMessage,vi.thisWorkspace):"team"===i.table?ki(i,t):!t&&fi(null===(a=i.meta)||void 0===a?void 0:a.permissionLevel)?m().createElement(y.FormattedMessage,vi.a_private_page):i.title?"“".concat(i.title,"“"):void 0:m().createElement(y.FormattedMessage,vi.an_untitled_page)}const Li=(0,y.defineMessages)({open:{defaultMessage:"Open",id:"auditlog.actionNames.eventColumn.team_privacy_types.open",description:"An audit log phrase that describes an open team"},closed:{defaultMessage:"Closed",id:"auditlog.actionNames.eventColumn.team_privacy_types.closed",description:"An audit log phrase that describes a closed team"},private:{defaultMessage:"Private",id:"auditlog.actionNames.eventColumn.team_privacy_types.private",description:"An audit log phrase that describes a private team"},unknown:{defaultMessage:"an unknown privacy state",id:"auditlog.actionNames.eventColumn.team_privacy_types.unknown",description:"An audit log phrase that describes a team with an unknown privacy state"}});function Oi(e){return e?m().createElement(y.FormattedMessage,Li[e]):m().createElement(y.FormattedMessage,Li.unknown)}const Ni=(0,y.defineMessages)({team_members:{defaultMessage:"any teamspace member",id:"auditlog.actionNames.eventColumn.team_access_level_types.team_members",description:"An audit log phrase that any teamspace members can invite teamspace members"},team_owners:{defaultMessage:"only teamspace owners",id:"auditlog.actionNames.eventColumn.team_access_level_types.team_owners",description:"An audit log phrase that only teamspace owners can invite teamspace members"},unknown:{defaultMessage:"unknown",id:"auditlog.actionNames.eventColumn.team_access_level_types.unknown",description:"An audit log phrase that describes a team state where who can invite team members is unknown"}});function Ui(e,t,i,a){var s,o,r,l,d,c,u,p,g,h,f,v,S,M,b,w,C,T,k,Z,A,I,P,_,x,F,B;switch(e.actionName){case"page_viewed":return n()(y.FormattedMessage,{defaultMessage:"Viewed {pageName}",id:"auditlog.actionNames.eventColumn.page_viewed_under",description:"An audit log that describes a viewed page",values:{pageName:_i(e,a)}});case"page_deleted":return e.target.page.meta.permanentDeletion?n()(y.FormattedMessage,{defaultMessage:"Permanently deleted {pageName}",id:"auditlog.actionNames.eventColumn.page_permanently_deleted",description:"Permanently deleted page event for audit log",values:{pageName:_i(e,a)}}):n()(y.FormattedMessage,{defaultMessage:"Deleted {pageName}",id:"auditlog.actionNames.eventColumn.page_deleted",description:"Deleted page event for audit log",values:{pageName:_i(e,a)}});case"page_restored":return n()(y.FormattedMessage,{defaultMessage:"Restored {pageName}",id:"auditlog.actionNames.eventColumn.page_restored",description:"Restored page event for audit log",values:{pageName:_i(e,a)}});case"page_exported":return n()(y.FormattedMessage,{defaultMessage:"Exported {pageName}",id:"auditlog.actionNames.eventColumn.page_exported",description:"Exported page event for audit log",values:{pageName:_i(e,a)}});case"page_moved":{var E,D,R;const t=null===(E=e.changes)||void 0===E?void 0:E.team,i=e.changes.parent.oldValue,s=e.changes.parent.newValue;if(null!=t&&t.oldValue&&null!=t&&t.newValue&&i&&s&&("block"===i.table||"block"===s.table))return n()(y.FormattedMessage,{defaultMessage:"Moved {pageName} from {oldTeamAndPage} to {newTeamAndPage}",id:"auditlog.actionNames.eventColumn.page_moved_team",description:"Moved page event for audit log in the context of a team",values:{pageName:_i(e,a),oldTeamAndPage:Ei(i,null==t?void 0:t.oldValue,a),newTeamAndPage:Ei(s,null==t?void 0:t.newValue,a)}});let o=Ri(e.spaceId,a,e.changes.parent.oldValue),r=Ri(e.spaceId,a,e.changes.parent.newValue);return"space"===(null===(D=e.changes.parent.oldValue)||void 0===D?void 0:D.table)&&"space"===(null===(R=e.changes.parent.newValue)||void 0===R?void 0:R.table)&&e.changes.parent.oldValue.id===e.changes.parent.newValue.id&&(fi(e.changes.parent.oldValue.permissionLevel)||fi(e.changes.parent.newValue.permissionLevel))&&(o=fi(e.changes.parent.oldValue.permissionLevel)?m().createElement(y.FormattedMessage,vi.private):m().createElement(y.FormattedMessage,vi.workspaceLevel),r=fi(e.changes.parent.newValue.permissionLevel)?m().createElement(y.FormattedMessage,vi.private):m().createElement(y.FormattedMessage,vi.workspaceLevel)),n()(y.FormattedMessage,{defaultMessage:"Moved {pageName} from {oldParentName} to {newParentName}",id:"auditlog.actionNames.eventColumn.page_moved",description:"Moved page event for audit log",values:{pageName:_i(e,a),oldParentName:o,newParentName:r}})}case"page_permission_updated":return function(e,t,i){var a,s,o,r,l;const d="bot"in t.target,c="space"in t.target,u="team"in t.target,m="group"in t.target,p="user"in t.target&&"guest"===(null===(a=t.target.user.meta)||void 0===a?void 0:a.spaceRole);var g,h,f,v;if(d)return n()(y.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for bot {botName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_bot",description:"An audit log that describe a page's permission has been changed for bots. It means bots can be added, removed, or changed role for this page",values:{botName:yi(e,t),oldRole:Ai(null===(g=t.changes)||void 0===g||null===(h=g.permission)||void 0===h?void 0:h.oldValue),newRole:Ai(null===(f=t.changes)||void 0===f||null===(v=f.permission)||void 0===v?void 0:v.newValue),pageName:_i(t,i)}});var S,M,b,w,C,T,k,Z,A,I,P,_;if(c)return n()(y.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for everyone in the workspace from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_space",description:"An audit log that describe a page's permission has been changed for everyone in the workspace. It means the permission can be added, removed, or changed role for this page",values:{oldRole:Ai(null===(S=t.changes)||void 0===S||null===(M=S.permission)||void 0===M?void 0:M.oldValue),newRole:Ai(null===(b=t.changes)||void 0===b||null===(w=b.permission)||void 0===w?void 0:w.newValue),pageName:_i(t,i)}});if(u)return n()(y.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_team",description:"An audit log that describe a page's permission has been changed for a team.",values:{oldRole:Ai(null===(C=t.changes)||void 0===C||null===(T=C.permission)||void 0===T?void 0:T.oldValue),newRole:Ai(null===(k=t.changes)||void 0===k||null===(Z=k.permission)||void 0===Z?void 0:Z.newValue),pageName:_i(t,i),teamName:Ti(t,i)}});if(p)return n()(y.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for guest {guestNameAndEmail} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_guest",description:"An audit log that describe a page's permission has been changed for guests. It means guests can be added, removed, or changed role for this page",values:{guestNameAndEmail:yi(e,t),oldRole:Ai(null===(A=t.changes)||void 0===A||null===(I=A.permission)||void 0===I?void 0:I.oldValue),newRole:Ai(null===(P=t.changes)||void 0===P||null===(_=P.permission)||void 0===_?void 0:_.newValue),pageName:_i(t,i)}});if(m){var x,F,B,E;return n()(y.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for group {groupName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_group",description:"An audit log that describe a page's permission has been changed for a group. It means a group has been added, removed, or changed permission roles for this page",values:{groupName:yi(e,t),oldRole:Ai(null===(x=t.changes)||void 0===x||null===(F=x.permission)||void 0===F?void 0:F.oldValue),newRole:Ai(null===(B=t.changes)||void 0===B||null===(E=B.permission)||void 0===E?void 0:E.newValue),pageName:_i(t,i)}})}return n()(y.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for {memberNameAndEmail} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_default",description:"An audit log that describe a page's permission has been changed for members. It means members can be added, removed, or changed role for this page",values:{memberNameAndEmail:yi(e,t),oldRole:Ai(null===(s=t.changes)||void 0===s||null===(o=s.permission)||void 0===o?void 0:o.oldValue),newRole:Ai(null===(r=t.changes)||void 0===r||null===(l=r.permission)||void 0===l?void 0:l.newValue),pageName:_i(t,i)}})}(i,e,a);case"page_created":const G=V(e);if(null!=G&&null!==(s=G.meta)&&void 0!==s&&s.parent){var L,O,N,U,z;if(G.meta.parent.table===mi.bx)return!a&&"private"===(null===(N=G.meta)||void 0===N?void 0:N.permissionLevel)||"private"===(null===(U=G.meta)||void 0===U?void 0:U.pageAudience)?n()(y.FormattedMessage,{defaultMessage:"Created a private page",description:"Created private page event for audit log",id:"auditlog.actionNames.eventColumn.page_created_private"}):n()(y.FormattedMessage,{defaultMessage:"Created a page in the workspace",description:"Created page event for audit log",id:"auditlog.actionNames.eventColumn.page_created_workspace"});if((null===(L=G.meta)||void 0===L?void 0:L.parent.table)===pi.e0)return n()(y.FormattedMessage,{defaultMessage:"Created a page under {teamName}",description:"Created page under a team event for audit log",id:"auditlog.actionNames.eventColumn.page_created_team",values:{teamName:ki(G.meta.parent,a)}});if((null===(O=G.meta)||void 0===O?void 0:O.parent.table)===ci.iU)return a||"private"!==(null===(z=G.meta)||void 0===z?void 0:z.permissionLevel)?n()(y.FormattedMessage,{defaultMessage:"Created a page under {parentPageName}",description:"Created page event for audit log",id:"auditlog.actionNames.eventColumn.page_created_under",values:{parentPageName:xi(e)}}):n()(y.FormattedMessage,{defaultMessage:"Created a private page",description:"Created private page event for audit log",id:"auditlog.actionNames.eventColumn.page_created_private"})}return n()(y.FormattedMessage,{defaultMessage:"Created a page",description:"Created page (audit log)",id:"auditlog.actionNames.eventColumn.page_created_general"});case"page_shared_to_web":return function(e,t){if(void 0===e.changes.permission.newValue||"none"===e.changes.permission.newValue)return n()(y.FormattedMessage,{defaultMessage:"Disabled sharing {pageName} to web",id:"auditlog.actionNames.eventColumn.page_shared_to_web.disabled",description:"An audit log that describe a page has been disabled for sharing to web. It means everyone on the Internet will not have access to the page.",values:{pageName:_i(e,t)}});return n()(y.FormattedMessage,{defaultMessage:"Enabled sharing {pageName} to web",id:"auditlog.actionNames.eventColumn.page_shared_to_web.enabled",description:"An audit log that describe a page has been enabled for sharing to web. It means everyone on the Internet will have access to the page.",values:{pageName:_i(e,t)}})}(e,a);case"login":return null!==(o=e.actor.meta)&&void 0!==o&&o.countryCode?n()(y.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithCityStateAndCountry",defaultMessage:"Logged in {platform} in {geolocation}",description:"Login event for audit log with additional metadata (platform is device i.e. web, mobile, city/country name)",values:{platform:Fi(e),geolocation:Ft(e,i)}}):n()(y.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithPlatform",defaultMessage:"Logged in {platform}",description:"Login event for audit log with additional metadata (platform is device i.e. web, mobile, city/country name)",values:{platform:Fi(e)}});case"allowed_support_access":return n()(y.FormattedMessage,{defaultMessage:"Granted support access for {name} until {date}",id:"auditlog.actionNames.allowed_support_access",description:"An audit log that describes the enabling of support access",values:{date:i.formatDate(e.changes.expiresAt),name:e.target.user.name}});case"revoked_support_access":return n()(y.FormattedMessage,{defaultMessage:"Revoked support access for {name}",id:"auditlog.actionNames.revoked_support_access",description:"An audit log that describes the disabling of support access",values:{name:e.target.user.name}});case"preferred_name_changed":return function(e){const t=e.changes.name.oldValue,i=e.changes.name.newValue;if(t&&i)return n()(y.FormattedMessage,{defaultMessage:'Changed name from "{oldValue}" to "{newValue}"',id:"auditlog.actionNames.eventColumn.preferred_name_changed",description:"An audit log that describes a change of a user's preferred name between two values",values:{oldValue:t,newValue:i}});if(!t&&i)return n()(y.FormattedMessage,{defaultMessage:'Set name to "{newValue}"',id:"auditlog.actionNames.eventColumn.preferred_name_changed_to_value",description:"An audit log that describes a change of a user's preferred name to a new value",values:{newValue:i}});if(t&&!i)return n()(y.FormattedMessage,{defaultMessage:'Removed name "{oldValue}"',id:"auditlog.actionNames.eventColumn.preferred_name_changed_from_value",description:"An audit log that describes a change of a user's preferred name from the old value",values:{oldValue:t}});return n()(y.FormattedMessage,{defaultMessage:"Name was changed",id:"auditlog.actionNames.eventColumn.preferred_name_changed_generic",description:"An audit log that describes a change of a user's preferred name"})}(e);case"email_changed":return n()(y.FormattedMessage,{defaultMessage:"Changed email from {oldEmail} to {newEmail}",id:"auditlog.actionNames.eventColumn.email_changed",description:"Email changed event for audit log",values:{oldEmail:e.changes.email.oldValue,newEmail:e.changes.email.newValue}});case"member_invited":{const t=Ii(e);return n()(y.FormattedMessage,{defaultMessage:"Invited {memberNameAndEmail} to the workspace as {newRole}",id:"auditlog.actionNames.eventColumn.member_invited",description:"An audit log that describe a user is invited to the workspace",values:{memberNameAndEmail:yi(i,e),newRole:t.newRole}})}case"member_role_updated":{const t=Ii(e);return n()(y.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.member_role_updated",description:"An audit log that describe a member is updated with a role",values:{memberNameAndEmail:yi(i,e),oldRole:t.oldRole,newRole:t.newRole}})}case"member_removed":return e.actor.actorId===e.target.user.id?n()(y.FormattedMessage,{defaultMessage:"Left the workspace",id:"auditlog.actionNames.eventColumn.member_left",description:"An audit log that describes when a member leaves the workspace"}):n()(y.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from the workspace",id:"auditlog.actionNames.eventColumn.member_removed",description:"An audit log that describe a member is removed access from the space",values:{memberNameAndEmail:yi(i,e)}});case"guest_removed":return n()(y.FormattedMessage,{defaultMessage:"Removed guest {guestNameAndEmail} from the workspace",id:"auditlog.actionNames.eventColumn.guest_removed",description:"An audit log that describe a guest is removed access from the space",values:{guestNameAndEmail:yi(i,e)}});case"file_uploaded":return n()(y.FormattedMessage,{defaultMessage:"Uploaded a file to {pageName}",id:"auditlog.actionNames.eventColumn.file_uploaded_public",description:"Uploaded a file to a non-private page event for audit log",values:{pageName:_i(e,a)}});case"file_downloaded":return function(e,t){return n()(y.FormattedMessage,{defaultMessage:"Downloaded {fileName} from {pageName}",id:"auditlog.actionNames.eventColumn.file_downloaded",description:"An audit log that describes a user has downloaded a file from a page",values:{fileName:Wi(e,t),pageName:_i(e,t)}})}(e,a);case"invite_link_toggled":return e.changes.enabled.newValue?n()(y.FormattedMessage,{id:"auditlog.actionNames.eventColumn.inviteLink.enabled",defaultMessage:"Enabled invite link",description:"Audit log for invite link enabled"}):n()(y.FormattedMessage,{id:"auditlog.actionNames.eventColumn.inviteLink.disabled",defaultMessage:"Disabled invite link",description:"Audit log for invite link disabled"});case"public_page_sharing_toggled":case"workspace_sidebar_editing_toggled":case"disable_guests_toggled":case"pages_to_other_workspaces_toggled":case"export_toggled":case"page_access_requests_toggled":return e.changes.enabled.newValue?n()(y.FormattedMessage,{id:"auditlog.actionNames.eventColumn.toggleEvent.disabled",defaultMessage:"Disabled {workspaceSetting}",description:"Audit log event for disabling a workspace setting",values:{workspaceSetting:i.formatMessage(vi[e.actionName])}}):n()(y.FormattedMessage,{id:"auditlog.actionNames.eventColumn.toggleEvent.enabled",defaultMessage:"Enabled {workspaceSetting}",description:"Audit log event for enabling a workspace setting",values:{workspaceSetting:i.formatMessage(vi[e.actionName])}});case"workspace_name_changed":return n()(y.FormattedMessage,{defaultMessage:"Changed workspace name from “{oldValue}“ to “{newValue}“",id:"auditlog.actionNames.eventColumn.workspace_name_changed",description:"An audit log that describes a change of the workspace name",values:{oldValue:e.changes.name.oldValue,newValue:e.changes.name.newValue}});case"workspace_domain_changed":return n()(y.FormattedMessage,{defaultMessage:"Changed workspace domain {oldValue} to “{newValue}“",id:"auditlog.actionNames.eventColumn.workspace_domain_changed",description:"An audit log that describes a change of the workspace domain",values:{oldValue:Bi(e),newValue:e.changes.name.newValue}});case"workspace_integration_restriction_changed":return function(e){const t=void 0,{oldValue:i,newValue:a}=e.changes.integration_restrictions;if(a===t)return n()(y.FormattedMessage,{defaultMessage:"Enabled members installing integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.no_restrictions",description:"An audit log that describes a user has removed the workspace integration restrictions, which means workspace members can install any integration."});if(i===t&&"approved_only"===a)return n()(y.FormattedMessage,{defaultMessage:"Disabled members installing integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.approved_only",description:"An audit log that describes a user has turned on the workspace integration restrictions, which means workspace members can only install integrations pre-approved by an admin."});if("approved_or_built_by_notion"===i&&"approved_only"===a)return n()(y.FormattedMessage,{defaultMessage:"Disabled auto approval for built-by-Notion integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.disabled_built_by_notion.from_approved_or_built_by_notion",description:"An audit log that describes a user has turned off auto approval for built-by-Notion integrations."});if("approved_only"===i&&"approved_or_built_by_notion"===a)return n()(y.FormattedMessage,{defaultMessage:"Enabled auto approval for built-by-Notion integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.enabled_built_by_notion",description:"An audit log that describes a user has turned on auto approval for built-by-Notion integrations."});return n()(y.FormattedMessage,{defaultMessage:"Changed workspace integration restriction",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.fallback_message",description:"An audit log that describes workspace integration restrictions is changed."})}(e);case"allowed_email_domain_added":return n()(y.FormattedMessage,{defaultMessage:"Added “{addedValue}“ into allowable email domains",id:"auditlog.actionNames.eventColumn.allowed_email_domain_added",description:"An audit log that describes the adding of an allowed email domain to a workspace",values:{addedValue:e.changes.domain}});case"allowed_email_domain_removed":return n()(y.FormattedMessage,{defaultMessage:"Removed “{removedValue}“ from allowable email domains",id:"auditlog.actionNames.eventColumn.allowed_email_domain_removed",description:"An audit log that describes the removing of an allowed email domain to a workspace",values:{removedValue:e.changes.domain}});case"public_page_set":return e.changes.name.oldValue?n()(y.FormattedMessage,{defaultMessage:"Changed public home page from “{oldPage}“ to “{newPage}“",id:"auditlog.actionNames.eventColumn.public_page_changed",description:"An audit log that describes the changing of a public home page for a workspace",values:{oldPage:e.changes.name.oldValue,newPage:e.changes.name.newValue}}):n()(y.FormattedMessage,{defaultMessage:"Set “{newPage}“ as public home page",id:"auditlog.actionNames.eventColumn.public_page_set",description:"An audit log that describes the setting of a public home page for a workspace",values:{newPage:e.changes.name.newValue}});case"idp_metadata_url_updated":return e.changes.url.oldValue?n()(y.FormattedMessage,{defaultMessage:'Changed IDP metadata URL from "{oldValue}" to "{newValue}"',id:"auditlog.actionNames.eventColumn.idp_metadata_url_updated",description:"An audit log that describes when an IDP metadata URL is updated",values:{oldValue:e.changes.url.oldValue,newValue:e.changes.url.newValue}}):n()(y.FormattedMessage,{defaultMessage:'Set IDP metadata URL to "{newValue}"',id:"auditlog.actionNames.eventColumn.idp_metadata_url_set",description:"An audit log that describes when an IDP metadata URL is first set",values:{newValue:e.changes.url.newValue}});case"saml_toggled":return e.changes.enabled.newValue?m().createElement(y.FormattedMessage,vi.saml_enabled):m().createElement(y.FormattedMessage,vi.saml_disabled);case"saml_enforce_toggled":return e.changes.enabled.newValue?m().createElement(y.FormattedMessage,vi.saml_enforced):m().createElement(y.FormattedMessage,vi.saml_unenforced);case"automatic_account_creation_toggled":return e.changes.enabled.newValue?m().createElement(y.FormattedMessage,vi.automatic_account_creation_enabled):m().createElement(y.FormattedMessage,vi.automatic_account_creation_disabled);case"workspace_creation_set_for_email_domain":return function(e,t){const{oldValue:i,newValue:a}=e.changes.workspace_creation;if(!i&&!a)return n()(y.FormattedMessage,{defaultMessage:"Changed workspace creation setting",id:"auditlog.actionNames.eventColumn.workspace_creation_set_for_email_domain.fallback_message",description:"An audit log that describes changes for the workspace creation prevention setting without indicating the old or new values."});const s=e.changes.workspace_creation.oldValue?t.formatMessage({id:"auditLogEntry.changes.workspaceCreation.beforeSetting",defaultMessage:" from {prevWorkspaceCreationSetting}",description:"Description of previous workspace creation setting"},{prevWorkspaceCreationSetting:(0,ui.nJ)(e.changes.workspace_creation.oldValue,t)}):"",o=e.changes.workspace_creation.newValue?t.formatMessage({id:"auditLogEntry.changes.workspaceCreation.afterSetting",defaultMessage:" to {afterWorkspaceCreationSetting}",description:"Description of current workspace creation setting"},{afterWorkspaceCreationSetting:(0,ui.nJ)(e.changes.workspace_creation.newValue,t)}):"";return n()(y.FormattedMessage,{defaultMessage:"Changed workspace creation setting{before}{after}.",id:"auditlog.actionNames.eventColumn.workspace_creation_set_for_email_domain",description:"An audit log that describes changes for the workspace creation prevention setting providing the old and new values.",values:{before:s,after:o}})}(e,i);case"member_added_to_group":return n()(y.FormattedMessage,{defaultMessage:"Added {memberNameAndEmail} to {groupName}",id:"auditlog.actionNames.eventColumn.member_added_to_group",description:"An audit log that describes that a user was added to a group.",values:{memberNameAndEmail:yi(i,e),groupName:wi(e.target.group)}});case"member_removed_from_group":return n()(y.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from {groupName}",id:"auditlog.actionNames.eventColumn.member_removed_from_group",description:"An audit log that describes that a user was removed from a group.",values:{memberNameAndEmail:yi(i,e),groupName:wi(e.target.group)}});case"team_created":return n()(y.FormattedMessage,{defaultMessage:"Created {teamName}",id:"auditlog.actionNames.eventColumn.team_created",description:"An audit log that describes that a team was created.",values:{teamName:Ti(e,a)}});case"team_archived":return n()(y.FormattedMessage,{defaultMessage:"Archived {teamName}",id:"auditlog.actionNames.eventColumn.team_archived",description:"An audit log that describes that a team was archived.",values:{teamName:Ti(e,a)}});case"team_restored":return n()(y.FormattedMessage,{defaultMessage:"Restored {teamName}",id:"auditlog.actionNames.eventColumn.team_restored",description:"An audit log that describes that a team was restored.",values:{teamName:Ti(e,a)}});case"team_default_toggled":return e.changes.enabled.newValue?n()(y.FormattedMessage,{defaultMessage:"Added {teamName} to the default teamspace list. Workspace members will automatically be added to the teamspace",id:"auditlog.actionNames.eventColumn.team_default_enabled",description:"An audit log that describes that a teamspace was set to be default which enabled all workspace members to be automatically added to this teamspace.",values:{teamName:Ti(e,a)}}):n()(y.FormattedMessage,{defaultMessage:"Removed {teamName} from the default teamspace list. Workspace members will no longer be automatically added to the teamspace",id:"auditlog.actionNames.eventColumn.team_default_disabled",description:"An audit log that describes that a teamspace was removed from being default which disables all workspace members from being automatically added to this teamspace.",values:{teamName:Ti(e,a)}});case"team_public_page_sharing_toggled":return e.changes.enabled.newValue?m().createElement(m().Fragment,null,n()(y.FormattedMessage,{defaultMessage:"Disabled members sharing pages under {teamName} publicly",id:"auditlog.actionNames.eventColumn.team_public_page_sharing_disabled",description:"An audit log that describes that public page sharing was switched off for a team",values:{teamName:Ti(e,a)}}),bi(null!==(r=null===(l=e.meta)||void 0===l?void 0:l.spacePublicPageSharingDisabled)&&void 0!==r?r:null==e?void 0:e.spacePublicPageSharingDisabled,e.changes.enabled.newValue)):m().createElement(m().Fragment,null,n()(y.FormattedMessage,{defaultMessage:"Enabled members sharing pages under {teamName} publicly",id:"auditlog.actionNames.eventColumn.team_public_page_sharing_enabled",description:"An audit log that describes that public page sharing was switched on for a team",values:{teamName:Ti(e,a)}}),bi(null!==(d=null===(c=e.meta)||void 0===c?void 0:c.spacePublicPageSharingDisabled)&&void 0!==d?d:null==e?void 0:e.spacePublicPageSharingDisabled,e.changes.enabled.newValue));case"team_export_toggled":return e.changes.enabled.newValue?m().createElement(m().Fragment,null,n()(y.FormattedMessage,{defaultMessage:"Disabled export for {teamName}",id:"auditlog.actionNames.eventColumn.team_export_disabled",description:"An audit log that describes that exports were disabled for a team",values:{teamName:Ti(e,a)}}),bi(null!==(u=null===(p=e.meta)||void 0===p?void 0:p.spaceExportDisabled)&&void 0!==u?u:null==e?void 0:e.spaceExportDisabled,e.changes.enabled.newValue)):m().createElement(m().Fragment,null,n()(y.FormattedMessage,{defaultMessage:"Enabled export for {teamName}",id:"auditlog.actionNames.eventColumn.team_export_enabled",description:"An audit log that describes that exports were enabled for a team",values:{teamName:Ti(e,a)}}),bi(null!==(g=null===(h=e.meta)||void 0===h?void 0:h.spaceExportDisabled)&&void 0!==g?g:null==e?void 0:e.spaceExportDisabled,e.changes.enabled.newValue));case"team_sidebar_editing_toggled":return e.changes.enabled.newValue?n()(y.FormattedMessage,{defaultMessage:"Disabled members changing the sidebar section for {teamName}",id:"auditlog.actionNames.eventColumn.team_sidebar_editing_disabled",description:"An audit log that describes that changing the sidebar section was disabled for a team",values:{teamName:Ti(e,a)}}):n()(y.FormattedMessage,{defaultMessage:"Enabled members changing the sidebar section for {teamName}",id:"auditlog.actionNames.eventColumn.team_sidebar_editing_enabled",description:"An audit log that describes that changing the sidebar section was enabled for a team",values:{teamName:Ti(e,a)}});case"team_creation_admins_setting_toggled":return e.changes.enabled.newValue?n()(y.FormattedMessage,{defaultMessage:"Disabled members creating teamspaces",id:"auditlog.actionNames.eventColumn.team_creation_admins_setting_disabled",description:"An audit log that describes that the ability for everyone in the workspace to create a team was disabled",values:{teamName:Ti(e,a)}}):n()(y.FormattedMessage,{defaultMessage:"Enabled members creating teamspaces",id:"auditlog.actionNames.eventColumn.team_creation_admins_setting_enabled",description:"An audit log that describes that the ability for everyone in the workspace to create a team was enabled",values:{teamName:Ti(e,a)}});case"team_guests_toggled":return e.changes.enabled.newValue?m().createElement(m().Fragment,null,n()(y.FormattedMessage,{defaultMessage:"Disabled guests for {teamName}",id:"auditlog.actionNames.eventColumn.team_guests_toggled_disabled",description:"An audit log that describes that the ability for everyone in the workspace to create a team was disabled",values:{teamName:Ti(e,a)}}),bi(null!==(f=null===(v=e.meta)||void 0===v?void 0:v.spaceDisableGuests)&&void 0!==f?f:e.spaceDisableGuests,e.changes.enabled.newValue)):m().createElement(m().Fragment,null,n()(y.FormattedMessage,{defaultMessage:"Enabled guests for {teamName}",id:"auditlog.actionNames.eventColumn.team_guests_toggled_enabled",description:"An audit log that describes that the ability for everyone in the workspace to create a team was enabled",values:{teamName:Ti(e,a)}}),bi(null!==(S=null===(M=e.meta)||void 0===M?void 0:M.spaceDisableGuests)&&void 0!==S?S:e.spaceDisableGuests,e.changes.enabled.newValue));case"team_name_changed":return n()(y.FormattedMessage,{defaultMessage:"Changed teamspace name {oldTeamNameToNewTeamName}",id:"auditlog.actionNames.eventColumn.team_name_changed",description:"An audit log that describes that a team name was changed.",values:{oldTeamNameToNewTeamName:Ci(e,a)}});case"team_description_changed":return n()(y.FormattedMessage,{defaultMessage:"Changed description of {teamName}",id:"auditlog.actionNames.eventColumn.team_description_changed",description:"An audit log that describes that a team description was changed.",values:{teamName:Ti(e,a)}});case"team_icon_changed":return n()(y.FormattedMessage,{defaultMessage:"Changed icon of {teamName}",id:"auditlog.actionNames.eventColumn.team_icon_changed",description:"An audit log that describes that a team icon was changed.",values:{teamName:Ti(e,a)}});case"member_added_to_team":return n()(y.FormattedMessage,{defaultMessage:"Invited {memberNameAndEmail} to {teamName} as {teamRole}",id:"auditlog.actionNames.eventColumn.member_added_to_team",description:"An audit log that describes that a user was added to a team.",values:{memberNameAndEmail:yi(i,e),teamName:Ti(e,a),teamRole:Zi(e.changes.teamRole.newValue)}});case"group_added_to_team":return n()(y.FormattedMessage,{defaultMessage:"Invited {groupName} to {teamName} as teamspace member",id:"auditlog.actionNames.eventColumn.group_added_to_team",description:"An audit log that describes that a group was added to a teamspace.",values:{groupName:wi(e.target.group),teamName:Ti(e,a)}});case"member_removed_from_team":return n()(y.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from {teamName}",id:"auditlog.actionNames.eventColumn.member_removed_from_team",description:"An audit log that describes that a user was removed from a team.",values:{memberNameAndEmail:yi(i,e),teamName:Ti(e,a)}});case"group_removed_from_team":return n()(y.FormattedMessage,{defaultMessage:"Removed {groupName} from {teamName}",id:"auditlog.actionNames.eventColumn.group_removed_from_team",description:"An audit log that describes that a group was removed from a team.",values:{groupName:wi(e.target.group),teamName:Ti(e,a)}});case"member_joined_team":return n()(y.FormattedMessage,{defaultMessage:"Joined {teamName} as {teamRole}",id:"auditlog.actionNames.eventColumn.member_joined_team",description:"An audit log that describes that a user joined a team.",values:{teamName:Ti(e,a),teamRole:Zi(e.changes.teamRole.newValue)}});case"member_left_team":return n()(y.FormattedMessage,{defaultMessage:"Left {teamName}",id:"auditlog.actionNames.eventColumn.member_left_team",description:"An audit log that describes that a user left a team.",values:{teamName:Ti(e,a)}});case"member_team_role_updated":return n()(y.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldTeamRole} to {newTeamRole} in {teamName}",id:"auditlog.actionNames.eventColumn.member_team_role_updated",description:"An audit log that describe a user's role in a team was updated.",values:{memberNameAndEmail:yi(i,e),oldTeamRole:Zi(e.changes.teamRole.oldValue),newTeamRole:Zi(e.changes.teamRole.newValue),teamName:Ti(e,a)}});case"team_member_default_permission_updated":return n()(y.FormattedMessage,{defaultMessage:"Updated default page permissions for teamspace members in {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_member_default_permission_updated",description:"An audit log event that describes default page permissions for teamspace members in a teamspace were updated.",values:{teamName:Ti(e,a),oldRole:Ai(null===(b=e.changes)||void 0===b||null===(w=b.permission)||void 0===w?void 0:w.oldValue),newRole:Ai(null===(C=e.changes)||void 0===C||null===(T=C.permission)||void 0===T?void 0:T.newValue)}});case"team_workspace_default_permission_updated":return n()(y.FormattedMessage,{defaultMessage:"Updated default page permissions for everyone else in the workspace for {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_workspace_default_permission_updated",description:"An audit log event that describes that page permissions for a team were updated for the workspace.",values:{teamName:Ti(e,a),oldRole:Ai(null===(k=e.changes)||void 0===k||null===(Z=k.permission)||void 0===Z?void 0:Z.oldValue),newRole:Ai(null===(A=e.changes)||void 0===A||null===(I=A.permission)||void 0===I?void 0:I.newValue)}});case"team_privacy_type_changed":return n()(y.FormattedMessage,{defaultMessage:"Changed the teamspace privacy type for {teamName} from {oldType} to {newType}",id:"auditlog.actionNames.eventColumn.team_privacy_type_changed",description:"An audit log event that describes that the privacy type for a teamspace was updated.",values:{teamName:Ti(e,a),oldType:Oi(null===(P=e.changes)||void 0===P?void 0:P.teamAccessLevel.oldValue),newType:Oi(null===(_=e.changes)||void 0===_?void 0:_.teamAccessLevel.newValue)}});case"team_invite_access_changed":return n()(y.FormattedMessage,{defaultMessage:"Changed who can invite teamspace members to {newType} for {teamName}",id:"auditlog.actionNames.eventColumn.team_invite_access_changed",description:"An audit log event that describes that the privacy type for a teamspace was updated.",values:{teamName:Ti(e,a),newType:(B=null===(x=e.changes)||void 0===x||null===(F=x.teamInviteAccess)||void 0===F?void 0:F.newValue,B?m().createElement(y.FormattedMessage,Ni[B]):m().createElement(y.FormattedMessage,Ni.unknown))}});case"private_content_transferred":return n()(y.FormattedMessage,{defaultMessage:"Transferred private content from {fromUserName} to {toUserName}",id:"auditLog.actionNames.eventColumn.private_content_transferred",description:"An audit log event describing when private page content is transferred from one user to another",values:{fromUserName:Si(i,e.changes.userPermission.oldValue),toUserName:Si(i,e.changes.userPermission.newValue)}});case"workspace_exported":case"workspace_icon_changed":case"public_page_cleared":case"logout":case"password_changed":case"password_cleared":case"password_set":case"picture_changed":case"revoked_support_access":case"user_deleted":case"member_joined":case"invite_link_toggled":case"scim_token_generated":case"scim_token_revoked":case"invite_link_reset":case"idp_metadata_xml_removed":case"idp_metadata_xml_updated":return m().createElement(y.FormattedMessage,vi[e.actionName]);default:if("local"!==t)return li.log({level:"error",from:"auditLogEvent",type:"AuditLogEvent",data:{miscDataToConvertToString:{data:e}}}),m().createElement(m().Fragment,null);(0,W.t1)(e)}}function Wi(e,t){const{name:i,extension:a}=e.target.file;return!(!t&&gi(e.target.page))&&i?"“".concat(i,"“"):a?m().createElement(y.FormattedMessage,o()({},vi.a_file_with_extension,{values:{extension:a}})):m().createElement(y.FormattedMessage,vi.a_file)}function Vi(e){const{auditLogEntry:t,id:i}=e,[a,s]=(0,u.useState)(""),r=(0,y.useIntl)();return(0,u.useEffect)((()=>{const e=document.getElementById(i);s((null==e?void 0:e.textContent)||"")}),[i]),n()(Le.Z,{style:{whiteSpace:"normal"},delayThreshold:80,renderTooltip:()=>n()(Gi,{text:a,auditLogEntry:t}),placement:Le.Z.Placement.Bottom,render:e=>m().createElement("div",o()({},e,{style:{fontSize:14,...v.Z.textOverflowStyle},id:i}),n()(zi,{auditLogEntry:t,env:Gt.Z.env,intl:r}))})}function zi(e){const{auditLogEntry:t,env:i,intl:a}=e;return Ui(t,i,a,(0,Se.VK)((()=>"on"===ie.default.getGroup("show_private_names_in_audit_log")),[]))}function Gi(e){var t,i;const{auditLogEntry:a,text:s}=e,o=(0,y.useIntl)(),r=(0,Se.VK)((()=>"on"===ie.default.getGroup("show_private_names_in_audit_log")),[]),l=Et({auditLogEntry:a,intl:o});return n()("div",{},void 0,s,(null===(t=a.actor.meta)||void 0===t?void 0:t.ipAddress)&&n()("div",{},void 0,n()(y.FormattedMessage,{description:"User's IP address in audit log",defaultMessage:"IP address: {ip}",values:{ip:null===(i=a.actor.meta)||void 0===i?void 0:i.ipAddress},id:"auditLogSettings.metadata.ipAddress"})),n()("div",{},void 0,Ft(a,o)),r&&l&&n()(y.FormattedMessage,{id:"auditLogColumnEvent.tooltip.audienceMessage",description:"Message in tooltip describing audience for permission change events",defaultMessage:"Page audience: {audience}",values:{audience:l}}))}function Hi(e){const{children:t,disabled:i,onClick:a}=e;return n()(ut.Z,{onClick:a,disabled:i,style:{justifyContent:"center",marginLeft:6},isBlue:!i,isLightGray:i},void 0,t)}function qi(e){const{sortOrder:t}=e,i={width:10,height:10,marginRight:4,fill:"currentColor"};return t===z.CreatedOldest?h.Z.arrowDownSmall({...i,transform:"rotate(180deg)"}):h.Z.arrowDownSmall(i)}function Ki(e){const{auditLogEntry:t,ids:i,shouldShowPrivateNames:a}=e,s=(0,y.useIntl)(),r=(0,ye.O7)(),l=(0,Yt.F)(),d=(0,Yt.y)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:3}})),[]),c=(0,$t.u)();return n()(Le.Z,{delayThreshold:80,placement:Le.Z.Placement.Bottom,render:e=>m().createElement(ei.Z,o()({style:d.button,onClick:()=>{var e;(0,Xt.RD)({environment:r,stringValue:Bt({auditLogEntry:t,intl:s,dateTimezone:U.x7,getAuditLogEventText:(e=i.eventColumnId,t=>{var i;return null===(i=document.getElementById(e))||void 0===i?void 0:i.textContent}),shouldShowWorkspaceOwner:c,shouldShowPrivateNames:a}),copiedMessage:Xt.tq.copiedToClipboard})}},e),h.Z.copy({width:16,height:16,fill:l.mediumIconColor})),renderTooltip:()=>n()(y.FormattedMessage,{id:"AuditLogSettings.copyAuditLogEvent",description:"Tooltip that shows up when you hover over the copy button for copying a row",defaultMessage:"Copy row"})})}const ji=(0,y.injectIntl)((function(e){const{searchResponse:t,spaceStore:i}=e,a=i.id,[s,r]=(0,Se.oR)(X),l=t.results||[],d=t.hasMoreResults,c=Boolean(l.length),u=null==l?void 0:l.map((e=>({auditLogEntry:e,actorStore:(0,vt.Kv)(i,{id:e.actor.actorId,table:e.actor.actorType,spaceId:a})}))),p=e=>{const t={...s,pageNum:e};r(t)},g=(0,Se.VK)((()=>"on"===ie.default.getGroup("show_private_names_in_audit_log")),[]);return m().createElement(m().Fragment,null,n()(ti.Z,{tableStyle:{tableLayout:"fixed"},cellStyle:{wordWrap:"break-word",paddingTop:6,paddingBottom:6},columns:[{key:"user",header:n()(y.FormattedMessage,{id:"auditlog.logTable.userColumn.header",defaultMessage:"User"}),style:{width:"30%",paddingLeft:35}},{key:"event",header:n()(y.FormattedMessage,{id:"auditlog.logTable.eventColumn.header",defaultMessage:"Event"}),style:{width:"40%"}},{key:"Date",header:n()(ei.Z,{disabled:!1,ignoreLocalHoverState:!0,onClick:()=>{const e=s.sortOrder===z.CreatedOldest?z.CreatedNewest:z.CreatedOldest;r({...s,sortOrder:e,pageNum:1})},style:{display:"flex",alignItems:"center"}},void 0,n()(qi,{sortOrder:s.sortOrder}),n()(y.FormattedMessage,{id:"auditlog.logTable.dateColumn.header",defaultMessage:"Date"})),style:{width:"25%"}},{key:"otherActions",header:n()("span",{}),style:{width:"5%"}}],rows:u.map(((e,t)=>{const i="actor-".concat(e.auditLogEntry.actionName,"-").concat(t),a="event-".concat(e.auditLogEntry.actionName,"-").concat(t),s="datetime-".concat(e.auditLogEntry.actionName,"-").concat(t);return{key:t.toString(),columns:[m().createElement(ni,o()({},e,{id:i})),n()(Vi,{auditLogEntry:e.auditLogEntry,id:a}),n()(ri,{auditLogEntry:e.auditLogEntry,id:s}),n()(Ki,{auditLogEntry:e.auditLogEntry,ids:{actorColumnId:i,eventColumnId:a,dateTimeColumnId:s},shouldShowPrivateNames:g})]}}))}),c?n()("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10}},void 0,n()(Hi,{onClick:()=>{p(s.pageNum-1)},disabled:1===s.pageNum},void 0,n()(y.FormattedMessage,{id:"auditlog.logTable.previousPage",defaultMessage:"Previous"})),n()(Hi,{disabled:!d,onClick:()=>{p(s.pageNum+1)}},void 0,n()(y.FormattedMessage,{id:"auditlog.logTable.nextPage",defaultMessage:"Next"}))):n()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40vh",flexDirection:"column"}},void 0,n()("div",{},void 0,n()(ii.Z,{isSecondaryColor:!0,style:{fontWeight:500}},void 0,n()(y.FormattedMessage,{id:"auditlog.logTable.noResults",defaultMessage:"No results"}))),n()(ii.Z,{isSecondaryColor:!0},void 0,n()(y.FormattedMessage,{id:"auditlog.logTable.noResultsHelpText",defaultMessage:"Try different filters. Logs may take some time to show up."}))))}));const Yi=(0,y.injectIntl)((function(e){const{spaceStore:t}=e,i=(0,ye.O7)(),a=null==t?void 0:t.id,[s]=(0,Se.oR)(te),[o]=(0,Se.oR)(X),r=$(o)!==s.filterStr?void 0:s.cachedResponses[o.pageNum];return(0,u.useEffect)((()=>{a&&(async e=>{var t,i;const{environment:a,spaceId:n}=e,s=X.getState();te.startLoading(n,s);const{sortOrder:o,pageSize:r,pageNum:l}=s,d={spaceId:n,limit:r,cursor:te.getCursor(n,s,l),filters:{timeRange:{starting:s.timeRange.starting?U.OQ.toUnixMs(s.timeRange.starting):void 0,ending:s.timeRange.ending?U.OQ.toUnixMs(s.timeRange.ending):void 0},...(null===(t=s.actors)||void 0===t?void 0:t.length)>0?{actors:s.actors}:void 0,...(null===(i=s.actions)||void 0===i?void 0:i.length)>0?{actions:s.actions}:void 0},sort:o||z.CreatedNewest},c=await w.searchAuditLog(a,d);"success"!==c.type?(te.updateError(n,s),C.showErrorMessage(Ce.default.formatMessage(Ze.loadCurrentAuditLogError))):te.updateLoadedResult(n,s,c.data)})({environment:i,spaceId:a})}),[i,a,o]),(0,u.useEffect)((()=>{(async e=>{const{environment:t,spaceId:i}=e;if(ke.getState().spaceId!==i&&ke.reset(),!i)return;const[a,n]=await Promise.all([we.Te({environment:t,membersOnly:!1}),Ae({environment:t,spaceId:i})]),s={spaceId:i,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set};a.userIds.forEach((e=>{s.allUserIds.add(e)})),a.botIds.forEach((e=>{s.allBotIds.add(e)})),n.forEach((e=>{e.actorType!==be.KJ||s.allUserIds.has(e.actorId)?e.actorType!==Me.cZ||s.allBotIds.has(e.actorId)||(s.allBotIds.add(e.actorId),s.removedBotIds.add(e.actorId)):(s.allUserIds.add(e.actorId),s.removedUserIds.add(e.actorId))})),ke.setState(s)})({environment:i,spaceId:a})}),[i,a]),m().createElement(m().Fragment,null,n()(Kt,{}),n()("div",{style:{justifyContent:"space-between",display:"flex",paddingTop:12,paddingBottom:12}},void 0,n()(zt,{spaceStore:t}),n()(We,{})),"loading"===(null==r?void 0:r.status)&&n()(Jt,{}),"success"===(null==r?void 0:r.status)&&n()(ji,{searchResponse:r,spaceStore:t}))}));var Qi=i(26255),Ji=i(41892),Xi=i(74181),$i=i(51582),ea=i(76463),ta=i(22711),ia=i(91584),aa=i(83805),na=i(89475),sa=i(52192),oa=i(89314),ra=i(88632),la=i(30874),da=i(72087),ca=i(35402);function ua(e){const{apps:t,numberOfConnectedApps:i}=e,a=(0,ye.O7)(),[s,r]=(0,u.useState)(!1),l=t.filter((e=>!e.shouldHideInDiscover)),d=l.length>3&&!s,c=s?l:l.slice(0,3);return m().createElement(m().Fragment,null,n()(qt.Z,{large:!0,divider:"full"},void 0,n()("div",{style:{display:"flex",justifyContent:"space-between",height:28}},void 0,n()(y.FormattedMessage,{id:"connectedAppsSettings.discoverNewAppsSection.title",defaultMessage:"Discover new apps"}),d&&n()(ut.Z,{isBlue:!0,onClick:()=>{s||(r(!0),b.trackClickDiscoverAppsShowAll(a,{numberOfConnectedApps:i}))}},void 0,n()(y.FormattedMessage,{id:"connectedAppsSettings.discoverNewAppSection.showAll.label",defaultMessage:"Show all"})))),n()("div",{style:{display:"grid",gridTemplateColumns:"repeat(".concat(3,", 1fr)"),gap:32}},void 0,c.map((e=>m().createElement(ma,o()({},e,{key:e.id}))))))}function ma(e){const{appName:t,caption:i,logo:a,shouldShowNewBadge:s,onConnect:o}=e,r=(0,Yt.y)((e=>({card:{display:"flex",flexDirection:"column",width:160},image:{width:32,height:32,borderRadius:3},title:{fontWeight:v.Z.fontWeight.medium,fontSize:14,marginTop:8},caption:{marginTop:2,fontWeight:v.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:12,maxHeight:64,overflow:"hidden"},button:{marginLeft:-8,marginTop:3}})),[]);return n()("div",{style:r.card},void 0,n()("img",{style:r.image,src:a}),n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()("div",{style:r.title},void 0,t),s&&n()(ca.Z,{})),n()("div",{style:r.caption},void 0,i),n()("div",{style:r.button},void 0,n()(ut.Z,{isBlue:!0,onClick:o},void 0,n()(y.FormattedMessage,{id:"connectedAppSettingsDiscoverItem.connectButton.label",defaultMessage:"Connect"}))))}var pa=i(29368);class ga extends p.Z{renderComponent(){const{account:e,intl:t,showNewBadge:i,shouldHideConnectAccount:a}=this.props;return n()(u.Fragment,{},void 0,n()("div",{style:{display:"flex",alignItems:"center",fontSize:14,paddingTop:2,paddingBottom:2}},void 0,this.renderIcon(),n()("div",{style:{marginRight:"auto"}},void 0,n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()("span",{style:{marginRight:6}},void 0,this.props.appName),i&&n()(ca.Z,{})),n()("div",{style:{fontSize:12,color:this.theme.mediumTextColor}},void 0,this.props.caption)),!Boolean(a)&&n()("div",{style:ga.buttonWrapStyle},void 0,this.renderConnectButton(this.isConnected(e)?t.formatMessage({id:"connectedAppsSettingsItem.connectAnotherAccountLink",defaultMessage:"Connect another account",description:"Link that enables user to connect another account from a 3rd-party app (like Google Drive) to Notion, assuming they've already connected an account previously"}):t.formatMessage({id:"connectedAppsSettingsItem.connectAccountLink",defaultMessage:"Connect",description:"Link that enables user to connect an account from a 3rd-party app (like Google Drive) to Notion"})))),this.isSingleAccount(e)?this.renderAccount({accountName:e,onDisconnect:this.props.onDisconnect}):this.renderMultipleAccounts(),n()(pa.Z,{size:12}))}renderIcon(){const{logo:e}=this.props;return n()("img",{style:ga.imageIconStyle,src:e})}renderConnectButton(e){return n()(ut.Z,{isBlue:!0,onClick:this.props.onConnect,style:ga.buttonStyle},void 0,e)}renderAccount(e){const{accountName:t,onDisconnect:i,key:a}=e;return n()("div",{style:{marginLeft:44}},a,n()(pa.Z,{size:12}),n()("div",{style:{display:"flex",alignItems:"center",height:32,marginBottom:2,fontSize:14}},void 0,n()("div",{style:{marginRight:"auto"}},void 0,n()("div",{style:{color:this.theme.mediumTextColor}},void 0,t)),n()("div",{style:ga.buttonWrapStyle},void 0,n()(ut.Z,{isRed:!0,onClick:()=>i(),style:ga.buttonStyle},void 0,n()(y.FormattedMessage,{id:"connectedAppsSettingsItem.disconnectLink",defaultMessage:"Disconnect",description:"If a user has connected an account from a 3rd-party app (like Google Drive) to Notion, they can click this link to disconnect the account."})))))}renderMultipleAccounts(){const e=this.props.account;if(this.isMultipleAccounts(e))return e.map((e=>this.renderAccount({accountName:e.accountName,onDisconnect:()=>{this.props.onDisconnect(e)},key:e.accountId})))}isMultipleAccounts(e){return Array.isArray(e)}isSingleAccount(e){return"string"==typeof e}isConnected(e){return this.isSingleAccount(e)||this.isMultipleAccounts(e)&&e.length>0}}l()(ga,"iconSize",32),l()(ga,"buttonStyle",{marginLeft:14,marginRight:-4}),l()(ga,"buttonWrapStyle",{minWidth:80,display:"flex",justifyContent:"flex-end"}),l()(ga,"imageIconStyle",{flexShrink:0,width:ga.iconSize,height:ga.iconSize,borderRadius:3,marginRight:12});const ha=(0,y.injectIntl)(ga);var fa=i(74523),va=i(42402),ya=i(68932),Sa=i(7765),Ma=i(11082),ba=i(27386),wa=i(80172);class Ca extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{connectedAppsStatus:da.Z})}renderComponent(){return ra.Z.state.online?n()(Sa.Z,{request:this.environment,performRequest:ta.LN,requestStore:this.stores.connectedAppsStatus,render:(e,t)=>t?this.renderConnectedAppsSettings():n()("div",{style:Ca.loadingWrapStyle},void 0,n()(ya.Z,{}))}):this.renderOfflineMessage()}renderOfflineMessage(){return n()(ba.Z,{},void 0,n()(ii.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,n()(y.FormattedMessage,{id:"connectedAppsSettings.offline.message",defaultMessage:"Please go online to manage connecting to apps."})))}renderConnectedAppsSettings(){const{intl:e}=this.props,{connected:t,discover:i}=this.getAppsByCategory(),a=t.length>0,s="on"===ie.default.getEligibleGroup({experimentId:"better_integrations",defaultGroup:"control"});return n()("div",{style:Ca.wrapStyle},void 0,n()(Ma.Z,{style:Ca.scrollerStyle,type:wa.Z.Y},void 0,a&&m().createElement(m().Fragment,null,n()(qt.Z,{large:!0,divider:"full"},void 0,n()(y.FormattedMessage,s?{id:"connectedAppsSettings.connectionsSection.title",defaultMessage:"My Connections",description:"Section title for user integrations/connections tab in settings modal"}:{id:"connectedAppsSettings.connectedAppsSection.title",defaultMessage:"Connected apps"})),n()(ii.Z,{isMultiline:!0,isSecondaryColor:!0},void 0,n()(y.FormattedMessage,{id:"connectedAppsSettings.connectedAppsSection.subtitle",defaultMessage:"Manage your connections with apps that bring content from other tools into Notion. <helpcenterlink>Learn more.</helpcenterlink>",values:{helpcenterlink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(va.Z,{href:(0,R.UY)("guides.connectedApps"),external:!0},void 0,t)}}})),n()(pa.Z,{size:32}),t.map((e=>m().createElement(ha,o()({},e,{key:e.id}))))),n()("div",{style:{marginTop:a?32:void 0}},void 0,n()(ua,{apps:i,numberOfConnectedApps:t.length})),n()(pa.Z,{size:32}),n()("div",{style:{marginTop:8}},void 0,n()(fa.Z,{title:e.formatMessage({id:"connectedAppsSettings.helpButton.caption",defaultMessage:"Learn more about embedding content in Notion"}),href:(0,R.UY)("guides.import"),analyticsFrom:"connected_apps_settings"}))))}async handleDriveAuth(){b.trackPromptAuthIntegration(this.environment,{integration_name:"google",from:"connected_apps"}),await ia.qN(this.environment),await ta.LN(this.environment),await this.stores.connectedAppsStatus.refresh()}handleDisconnectDrive(e){const{intl:t}=this.props;C.showDialog({message:t.formatMessage({id:"connectedAppsSettings.disconnectGoogleDriveModal.message",defaultMessage:"Disconnecting disables file preview on Google Drive files embedded in all of your workspaces. It would not delete your embeds from Notion, so you can re-connect at anytime."}),showCancel:!0,keepFocus:!0,items:[{label:t.formatMessage({id:"connectedAppsSettings.disconnectGoogleDriveModal.disconnectButton.label",defaultMessage:"Disconnect"}),color:"red",onAccept:async()=>{await w.disconnectDrive(this.environment,{googleUserId:e.accountId}),await ta.LN(this.environment),await this.stores.connectedAppsStatus.refresh()}}]})}getAppsByCategory(){const e=c().groupBy([...this.getExternalIntegrations(),...this.getLegacyConnectedApps()],(e=>e.account&&e.account.length>0?"connected":"discover"));return{connected:e.connected||[],discover:e.discover||[]}}getLegacyConnectedApps(){var e,t,i,a,n,s;const{intl:o}=this.props,r=this.stores.connectedAppsStatus,{currentSpaceStore:l}=Z.default.state,d=null==l?void 0:l.getBotSettingsStore().getValue(),c=!(0,f.CJ)(d)||Boolean((null==d?void 0:d.integration_approval_statuses)&&d.integration_approval_statuses[Xi._o]),u=(null===(e=r.state.result)||void 0===e?void 0:e.drive)&&(null===(t=r.state.result)||void 0===t?void 0:t.drive.length)>0;return[...c||u?[{id:"drive",appName:"Google Drive",caption:o.formatMessage({id:"connectedAppsSettings.googleDrive.caption",defaultMessage:"Find and embed your files."}),shouldHideConnectAccount:!c,logo:Ji.Z.images.import.googleDrivePng,account:null===(i=r.state.result)||void 0===i?void 0:i.drive,onConnect:()=>this.handleDriveAuth(),onDisconnect:e=>{e&&this.handleDisconnectDrive(e)}}]:[],{id:"evernote",appName:"Evernote",caption:o.formatMessage({id:"connectedAppsSettings.evernote.caption",defaultMessage:"Import notebooks."}),logo:Ji.Z.images.import.evernotePng,account:null===(a=r.state.result)||void 0===a?void 0:a.evernote,onConnect:()=>aa.e({environment:this.environment,requestStore:r}),onDisconnect:()=>ta.Lm(this.environment,r)},{id:"trello",appName:"Trello",caption:o.formatMessage({id:"connectedAppsSettings.trello.caption",defaultMessage:"Import your boards."}),logo:Ji.Z.images.import.trelloPng,shouldHideInDiscover:!0,account:null===(n=r.state.result)||void 0===n?void 0:n.trello,onConnect:()=>sa.M({environment:this.environment,requestStore:r}),onDisconnect:()=>ta.C(this.environment,r)},{id:"asana",appName:"Asana",caption:o.formatMessage({id:"connectedAppsSettings.asana.caption",defaultMessage:"Import tasks from boards and lists."}),logo:Ji.Z.images.import.asanaPng,shouldHideInDiscover:!0,account:null===(s=r.state.result)||void 0===s?void 0:s.asana,onConnect:()=>$i.w({environment:this.environment,requestStore:r}),onDisconnect:()=>ta.Ow(this.environment,r)}]}getExternalIntegrations(){const{currentSpaceStore:e}=Z.default.state;if(!e||!e.canEdit())return[];const t=e.getBotSettingsStore().getValue(),i=e.id,{integrations:{state:a},bots:{state:s},externalAuthentications:{state:o}}=la.Z;return a.map((a=>{if(!a.info.icon)return;const r=s.filter((e=>e.integration_id===a.id)),l=c().compact(r.map((e=>{const t=o.find((t=>t.parent_id===e.id));if(t)return{accountId:e.id,accountName:t.account_name}}))),d=(0,f.hU)({spaceBotSettings:t,integrationId:a.id}),u=l.length>0;if(!d&&!u)return;const m=!d;return{id:a.id,appName:a.name,caption:a.info.tagline,logo:a.info.icon,account:l,shouldHideConnectAccount:m,shouldShowNewBadge:!0,onConnect:async()=>{await(0,na.h)({environment:this.environment,integration:a,spaceId:i}),oa.pJ({environment:this.environment}),b.trackConnectExternalIntegration(this.environment,{integrationId:a.id,numberOfAccountsAlreadyConnected:l.length,from:"connected_apps_settings"})},onDisconnect:async t=>{const i=s.find((e=>e.id===(null==t?void 0:t.accountId)));if(i){const s=(0,vt.Kv)(e,{table:Me.cZ,id:i.id,spaceId:i.space_id}),o=null!=t&&t.accountName?n()(y.FormattedMessage,{id:"connectedAppSettings.deleteExternalAuthorization.withAccountName.confirmationMessage",defaultMessage:"Are you sure you want to revoke access for {accountName}?",values:{accountName:t.accountName}}):n()(y.FormattedMessage,{id:"connectedAppSettings.deleteExternalAuthorization.withoutAccountName.confirmationMessage",defaultMessage:"Are you sure you want to revoke access for this account?"});await C.confirmUserAction({message:n()("span",{},void 0,o),acceptLabel:n()(y.FormattedMessage,{id:"connectedAppSettings.deleteExternalAuthorization.confirmDelete.label",defaultMessage:"Yes"})})&&(await(0,ea.P0)({environment:this.environment,botId:s.id,onSuccess:()=>{}}),b.trackDisconnectExternalIntegration(this.environment,{integrationId:a.id}))}}}})).filter(W.$K)}}l()(Ca,"loadingWrapStyle",{alignItems:"center",display:"flex",flexDirection:"column",flex:1,height:"100%",justifyContent:"center"}),l()(Ca,"wrapStyle",{display:"flex",flexDirection:"column",height:"100%"}),l()(Ca,"scrollerStyle",{height:"100%",padding:"36px 60px"});const Ta=(0,y.injectIntl)(Ca);i(85827);var ka=i(9953),Za=i(4615),Aa=i(9844),Ia=i(51878),Pa=i(78948),_a=i(86646),xa=i(40039);function Fa(e){const{query:t}=e,i=(0,ye.O7)(),a=(0,Se.VK)((()=>Z.default.state.currentSpaceStore),[]),s=(0,Se.VK)((()=>null==a?void 0:a.getBotSettingsStore().getValue()),[a]),r="approved_or_built_by_notion"===(null==s?void 0:s.integration_restrictions),l=(0,Se.VK)((()=>null!=s&&s.integration_approval_statuses?Object.keys(s.integration_approval_statuses):[]),[s]),d=(0,Se.VK)((()=>Object.values(Ia.iK).map((e=>{let{id:t}=e;const i=null==a?void 0:a.getRecordValue({id:t,table:Aa.K2});if("published"===(null==i?void 0:i.status))return t})).filter(W.$K)),[a]),c=(0,Se.VK)((()=>d.filter((e=>!l.includes(e))).slice(0,5)),[l,d]);return n()(Be.Z,{menuType:Be.Z.MenuType.Popup,width:255,header:Ea(t,c,r)},void 0,n()(Sa.Z,{request:t,performRequest:e=>async function(e){const{query:t,environment:i,spaceId:a,approvedIntegrationIds:n,popularIntegrationIds:s,autoApproveBuiltByNotion:o}=e;if(!ra.Z.state.online||!a)return[];if((0,Za.e)(t)||(0,Za.qn)(t))return[t];if(""===t&&!o)return s;const r=await w.searchIntegrations(i,{query:t});if("success"===r.type){const e=r.data.integrationIds.filter((e=>!n.includes(e)));if(!o){return e.sort(((e,t)=>(0,Ia.BP)(e)===(0,Ia.BP)(t)?0:(0,Ia.BP)(e)?-1:1)).slice(0,5)}return e.filter((e=>!(0,Ia.BP)(e))).slice(0,5)}if("failed"===r.type)throw r.error;return(0,W.t1)(r)}({query:e,environment:i,spaceId:null==a?void 0:a.id,approvedIntegrationIds:l,popularIntegrationIds:c,autoApproveBuiltByNotion:r}),debounce:we.vp,render:(r,d,c)=>{if(!d||!c)return n()(Re.Z,{},void 0,n()(Pa.Z,{}));const u=Xi.ns.filter((e=>t&&e.name.toLowerCase().includes(t.toLowerCase())&&!l.includes(e.id))),p=[];if(0===d.length&&0===u.length)p.push({key:"no_results",render:()=>n()(ii.Z,{isSmall:!0,style:{marginLeft:8}},void 0,n()(y.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})),action:()=>{}});else{const t=d.map((t=>{const r={table:Aa.K2,id:t},l=null==a?void 0:a.getRecordValue(r);if(l)return{key:"".concat(t),render:e=>m().createElement(Fe.Z,o()({},e,{title:n()(ii.Z,{style:{fontWeight:v.Z.fontWeight.semibold}},void 0,l.name),icon:l.info.icon&&n()(xa.Z,{disabled:!0,icon:{pointer:r,icon:l.info.icon},isEmptyPage:!1,size:20}),style:l.info.icon?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:n()(Da,{tagline:null==l?void 0:l.info.tagline,isNotionIntegration:(0,Ia.BP)(l.id)}),className:"notranslate"})),action:()=>{e.closeDropdown(),Ba({environment:i,currentSpaceStore:a,botSettings:s,integrationId:t})}}})).filter(W.$K),r=u.map((t=>({key:"".concat(t.id),render:e=>m().createElement(Fe.Z,o()({},e,{title:n()(ii.Z,{style:{fontWeight:v.Z.fontWeight.semibold}},void 0,t.name),icon:n()("img",{src:t.info.icon,style:{height:20}}),caption:t.info.tagline,style:{paddingBottom:12},shouldWrapCaption:!0,className:"notranslate"})),action:()=>{e.closeDropdown(),Ba({environment:i,currentSpaceStore:a,botSettings:s,integrationId:t.id})}}))).filter(W.$K);p.push(...t,...r)}return n()(Ee.Z,{type:Ee.Z.Type.Vertical,initialFocus:0,sections:[{key:"results",render:e=>m().createElement(Re.Z,e),items:p}]})}}))}function Ba(e){const{environment:t,currentSpaceStore:i,botSettings:a,integrationId:n}=e;if(i){const e={...null==a?void 0:a.integration_approval_statuses,[n]:{type:"integration",status:"approved"}};(0,A.createAndCommit)({userAction:"AdminIntegrationSettingsSearchResults.handleIntegrationSelection",environment:t,perform:t=>{(0,ka.sW)({store:i,data:{bot_settings:{...a,integration_approval_statuses:e}},transaction:t})}})}}const Ea=(e,t,i)=>!e&&!i&&t.length>0&&n()(_a.Z,{title:n()(ii.Z,{isSmall:!0,style:{marginTop:4,fontWeight:v.Z.fontWeight.medium}},void 0,n()(y.FormattedMessage,{defaultMessage:"Popular integrations",id:"adminIntegrationSettings.search.title.popularIntegrations"}))}),Da=e=>{const{tagline:t,isNotionIntegration:i}=e,a=(0,Yt.F)(),s=i?{}:{maxHeight:48,overflow:"scroll"};return t?n()("div",{style:s},void 0,t,i&&n()("div",{style:{display:"flex",alignItems:"center",marginTop:8}},void 0,n()(y.FormattedMessage,{defaultMessage:"Developed by Notion",id:"adminIntegrationSettings.search.subtitle.notionBuilt"}),h.Z.integrationSecurity({marginLeft:3,width:12,height:12,fill:a.invoiceGreen}))):null},Ra=(0,y.defineMessages)({searchInputPlaceholder:{id:"adminConnectionsSettings.search.input.placeholder",defaultMessage:"Add by name or integration ID",description:"Placeholder text for 'Add approved connection' search bar"}});function La(){const e=(0,ye.O7)(),t=(0,Yt.F)(),[i,a]=(0,u.useState)(!0),[s,o]=(0,u.useState)(!1),[r,l]=(0,u.useState)(""),d=m().createRef();return i?n()(ei.Z,{style:{display:"flex",alignItems:"center",height:28,fontWeight:v.Z.fontWeight.medium,fontSize:v.Z.fontSize.UIRegular.desktop,color:g.ZP.blue,padding:"0px 6px"},onClick:()=>{var e;a(!1),null===(e=d.current)||void 0===e||e.focusInput()}},void 0,n()(y.FormattedMessage,{id:"adminConnectionsSettings.search.button.label",defaultMessage:"{plusIcon} Add approved connection",description:"Text for button to open dropdown menu for selecting and adding a new connection to the approved list",values:{plusIcon:h.Z.plus({fill:g.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})):n()(De.ZP,{alignmentToOrigin:De.ZP.Alignment.Start,keepFocus:e.device.isPhone,onDismiss:()=>{var e;null===(e=d.current)||void 0===e||e.handleBlur(),a(!0),o(!1)},origin:m().createElement(tt.Z,{type:"text",style:{width:255},left:h.Z.plus({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),ref:d,value:r,onFocus:()=>{o(!0)},placeholder:Ce.default.formatMessage(Ra.searchInputPlaceholder),onChange:e=>l(e.target.value)}),open:s,popupType:De.ZP.PopupType.Popup,style:{width:255},render:()=>n()(Fa,{query:r,closeDropdown:()=>o(!1)})})}var Oa=i(88594),Na=i(38755),Ua=i(31942),Wa=i(24736),Va=i(82276),za=i(73581),Ga=i(15102),Ha=i(41493);function qa(e){const{integrationId:t,integrationTable:i,isLegacy:a,disableDisconnectUser:s,disableDisconnectAll:r,disableDisallow:l,botIds:d}=e,[{currentSpaceStore:c}]=(0,Se.oR)(Z.default),p=(0,ye.Fy)(),g=(0,ye.O7)(),h=(0,y.useIntl)(),[v,S]=(0,u.useState)(void 0),[M,b]=(0,u.useState)(!1),[w,C]=(0,u.useState)(!1),[T,k]=(0,u.useState)(!1),[I,P]=(0,u.useState)(void 0),_=(0,Se.VK)((()=>c&&i?(0,vt.Kv)(c,{table:i,id:t}):void 0),[c,t,i]),x=(0,Se.VK)((()=>{if(a){const e=Xi.ns.find((e=>e.id===t));return{name:null==e?void 0:e.name,url:(0,R.UY)("guides.connectedApps")}}if(c&&i){const a=c.getRecordValue({table:i,id:t});if(i===Aa.K2&&!(0,Ia.BP)(t)){var e,n;const t=a;return{name:null==a?void 0:a.name,url:null==t||null===(e=t.info)||void 0===e?void 0:e.website_url,email:null==t||null===(n=t.info)||void 0===n?void 0:n.email}}return{name:null==a?void 0:a.name}}}),[c,t,i,a]),F=(0,Se.VK)((()=>d&&!s?d.map((e=>c&&_?(0,vt.Kv)(_,{table:Me.cZ,id:e,spaceId:c.id}):void 0)):[]),[c,d,_,s]).filter(W.$K),B=(0,Se.VK)((()=>F.map((e=>{var t;return null!==(t=e.getValue())&&void 0!==t&&t.alive?e.getValue():void 0})).filter(W.$K)),[F]),E=(0,Se.VK)((()=>{if(c&&B&&!s){return B.map((e=>e.created_by_id)).map((e=>c.getRecordValue({table:be.KJ,id:e}))).filter(W.$K)}return[]}),[B,c,s]),D=(0,Se.VK)((()=>null==c?void 0:c.getBotSettingsStore().getValue()),[c]),L=null==B?void 0:B.reduce(((e,t)=>{const i=E.find((e=>e.id===t.created_by_id));return e[t.id]={user:i,bot:t},e}),{}),O=v?(0,Ua.ZP)(v,Object.entries(L),(e=>{let[,{user:t}]=e;return(0,be.of)(t)})):Object.entries(L),N=!s&&(null==d?void 0:d.length)&&n()(Re.Z,{isInput:!0,style:{padding:8}},void 0,n()(za.Z,{textWrapperStyle:{margin:0},focus:!p.isMobile||void 0,focusAfterAnimation:!0,value:v||"",onChange:e=>S(e.target.value),placeholder:h.formatMessage({id:"integrationInstallerFilter.userSearch.placeholder",defaultMessage:"Filter by user"})})),U=O.length?[{key:"disconnect user section",render:e=>m().createElement(Re.Z,e),items:ja({users:O,disableDisconnectUser:s,showDisplayModal:()=>C(!0),setSelectedUser:P,intl:h})}]:[],V=(null==x?void 0:x.url)||(null==x?void 0:x.email),z=Boolean(null==d?void 0:d.length)||(0,f.CJ)(D)&&!l,G=m().createElement(m().Fragment,null,V&&n()(Re.Z,{topBorder:Boolean(O.length)},"app-links",(null==x?void 0:x.url)&&n()(Qa,{environment:g,developerWebsite:x.url}),(null==x?void 0:x.email)&&n()(Ja,{environment:g,developerEmail:x.email})),z&&n()(Re.Z,{topBorder:Boolean(O.length||V)},void 0,Boolean(null==d?void 0:d.length)&&n()(Xa,{showDisplayModal:()=>k(!0)}),(0,f.CJ)(D)&&!l&&n()($a,{showDisplayModal:()=>b(!0)})));return(V||z)&&x?n()(qe.Z,{popupType:p.isMobile?qe.Z.PopupType.SlideUp:qe.Z.PopupType.Popup,renderOrigin:e=>m().createElement(Wa.Z,o()({},e,{isMobile:p.isMobile,style:{marginLeft:8,marginRight:8}})),render:()=>m().createElement(m().Fragment,null,n()(Be.Z,{menuType:p.isMobile?Be.Z.MenuType.ActionSheet:Be.Z.MenuType.Popup,header:!s&&N,footer:G,width:230},void 0,n()(Ee.Z,{type:Ee.Z.Type.Vertical,sections:U,initialFocus:void 0})),n()(Ga.Z,{open:!s&&w,onDismiss:()=>{C(!1)},disableAnimation:!0,render:()=>n()(en,{title:n()(on,{integrationName:x.name}),caption:n()(rn,{integrationName:x.name,userName:null==I?void 0:I.userName}),type:"disconnect",handleCancel:()=>{C(!1),P(void 0)},handleConfirmation:async()=>{I&&(await Ka({botIds:[I.botId],environment:g}),P(void 0)),C(!1)}})}),n()(Ga.Z,{open:!r&&T,onDismiss:()=>{k(!1)},disableAnimation:!0,render:()=>n()(en,{title:n()(nn,{integrationName:x.name}),caption:n()(sn,{integrationName:x.name}),type:"disconnect",handleCancel:()=>k(!1),handleConfirmation:async()=>{await Ka({botIds:d,environment:g}),k(!1)}})}),n()(Ga.Z,{open:!l&&M,onDismiss:()=>{b(!1)},disableAnimation:!0,render:()=>n()(en,{title:n()(tn,{integrationName:x.name}),caption:n()(an,{integrationName:x.name,disableDisconnectAll:r}),type:"disapprove",handleCancel:()=>b(!1),handleConfirmation:async()=>{!function(e){const{currentSpaceStore:t,environment:i,integrationId:a}=e;t&&(0,A.createAndCommit)({userAction:"AdminIntegrationSettingsActionMenu.handleDisapproveIntegration",environment:i,perform:e=>{(0,A.applyOperation)({store:t,operation:{pointer:t.pointer,path:["bot_settings","integration_approval_statuses"],command:"update",args:{[a]:null}},transaction:e})}})}({currentSpaceStore:c,environment:g,integrationId:t}),r||await Ka({botIds:d,environment:g}),b(!1)}})}))}):null}async function Ka(e){let{botIds:t,environment:i}=e;t&&await Promise.all(t.map((e=>(0,ea.P0)({environment:i,botId:e,onSuccess:()=>{b.trackDeveloperIntegrationsDisconnectClick(i,{type:"public"})}}))))}function ja(e){const{intl:t,disableDisconnectUser:i,users:a,showDisplayModal:s,setSelectedUser:o}=e;return i?[]:a.map((e=>{let[i,{user:a,bot:r}]=e;return{key:a.id,render:e=>n()(Ya,{buttonMenuProps:e,user:a,botCapabilities:r.capabilities,selectAction:()=>{s(),o({botId:i,userName:(0,be.Nz)(t,a)})}}),action:()=>{s(),o({botId:i,userName:(0,be.Nz)(t,a)})}}}))}function Ya(e){const{buttonMenuProps:t,user:i,botCapabilities:a,selectAction:s}=e,r=(0,ye.Fy)(),[l,d]=(0,u.useState)(!1);return n()(De.ZP,{popupType:r.isMobile?qe.Z.PopupType.SlideUp:qe.Z.PopupType.Popup,placementToOrigin:qe.Z.Placement.Right,open:l,onDismiss:()=>d(!1),origin:m().createElement(Fe.Z,o()({},t,{title:n()("div",{style:{display:"flex",alignContent:"center",justifyContent:"space-between"}},void 0,n()(Ha.Z,{userValue:i,avatarSize:18,inline:!0,avatarShouldShowShadow:!0,style:{flexShrink:1}})),textWrapperStyle:{marginLeft:12,marginRight:12},focused:!1,onClick:()=>d(!0)})),render:()=>n()(Be.Z,{width:240,menuType:r.isMobile?Be.Z.MenuType.ActionSheet:Be.Z.MenuType.Popup,header:n()("div",{style:{padding:2,marginTop:4,marginBottom:4}},void 0,n()(Va.T,{role:a,renderUserCapabilities:!0}))},void 0,n()(Ee.Z,{type:Ee.Z.Type.Vertical,sections:[{key:"integration capabilities",render:e=>m().createElement(Re.Z,o()({},e,{topBorder:!0})),items:[{key:"remove",render:e=>m().createElement(Fe.Z,o()({},e,{focused:!1,title:n()("div",{style:{color:g.ZP.red}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.revokeUserAccess.label",defaultMessage:"Disconnect user"}))})),action:s}]}],initialFocus:void 0}))})}function Qa(e){let{environment:t,developerWebsite:i}=e;return n()(Fe.Z,{onClick:()=>{(0,T.navigateToExternalURL)({environment:t,url:i}),b.trackDeveloperIntegrationsVisitDeveloperWebsiteClick(t,{href:i,from:"integration-settings"})},title:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.visitDeveloperWebsite.label",defaultMessage:"Visit developer website"}),shouldWrapCaption:!0,focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12}})}function Ja(e){let{environment:t,developerEmail:i}=e;return n()(Fe.Z,{onClick:()=>{(0,T.navigateToExternalURL)({environment:t,url:"mailto:".concat(i)}),b.trackDeveloperIntegrationsContactDeveloperClick(t,{from:"integration-settings"})},title:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.contactDeveloperSupport.label",defaultMessage:"Contact support",description:"Label for a button that users can click to contact customer support for an integration that's been added to their workspace"}),shouldWrapCaption:!0,focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12}})}function Xa(e){let{showDisplayModal:t}=e;return n()(Fe.Z,{onClick:t,title:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectAll.label",defaultMessage:"Disconnect all users"}),shouldWrapCaption:!0,focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12,color:g.ZP.red}})}function $a(e){let{showDisplayModal:t}=e;return n()(Fe.Z,{onClick:t,title:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.label",defaultMessage:"Remove from approved list"}),focused:!1,textWrapperStyle:{marginLeft:12,marginRight:12,color:g.ZP.red}})}function en(e){let{title:t,caption:i,handleConfirmation:a,handleCancel:s,type:o}=e;return n()("div",{style:{padding:20,width:333}},void 0,n()(ii.Z,{isMultiline:!0,style:{marginBottom:8,fontWeight:v.Z.fontWeight.semibold}},void 0,t),n()(ii.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginBottom:8}},void 0,i),n()("div",{style:{display:"flex",marginTop:12}},void 0,n()(Ht.Z,{style:{width:140,marginRight:9},isLarge:!0,onClick:s},void 0,n()(ii.Z,{},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.cancel",defaultMessage:"Cancel"}))),n()(Ht.Z,{style:{width:140},isLarge:!0,onClick:a,backgroundColor:g.ZP.red},void 0,n()(ii.Z,{style:{color:g.ZP.white}},void 0,"disconnect"===o&&n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.disconnect",defaultMessage:"Disconnect"}),"disapprove"===o&&n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.remove",defaultMessage:"Remove"})))))}function tn(e){let{integrationName:t}=e;return n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.title",defaultMessage:"Remove {integrationName} from approved integrations",values:{integrationName:t}})}function an(e){let{integrationName:t,disableDisconnectAll:i}=e;return n()(y.FormattedMessage,i?{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.caption",defaultMessage:"Prevent members from installing {integrationName}.",values:{integrationName:t}}:{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApprovalAndDisconnectAll.caption",defaultMessage:"Revoke access for {integrationName} for all users in this workspace and prevent members from installing {integrationName}.",values:{integrationName:t}})}function nn(e){let{integrationName:t}=e;return n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectAll.modal.label",defaultMessage:"Disconnect {integrationName} for all users in workspace",values:{integrationName:t}})}function sn(e){let{integrationName:t}=e;return n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectAll.modal.caption",defaultMessage:"Revoke access for {integrationName} for all users in this workspace.",values:{integrationName:t}})}function on(e){let{integrationName:t}=e;return n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectUser.modal.label",defaultMessage:"Disconnect {integrationName}?",values:{integrationName:t}})}function rn(e){let{integrationName:t,userName:i}=e;return n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectUser.modal.caption",defaultMessage:"Revoke access for {integrationName} for {userName}",values:{integrationName:t,userName:i}})}var ln=i(15070),dn=i(59054),cn=i(61766);function un(e){const{botId:t}=e,[,,i]=(0,Se.oR)(void 0,cn.Z),a=(0,ye.Fy)(),s=(0,ye.O7)(),[{currentSpaceStore:r}]=(0,Se.oR)(Z.default),[l,d]=(0,u.useState)(!1),c=(0,Se.VK)((()=>r?(0,vt.Kv)(r,{table:Me.cZ,id:t,spaceId:r.id}):void 0),[t,r]),p=(0,Se.VK)((()=>null==c?void 0:c.getValue()),[c]),h=(0,Se.VK)((()=>(0,ln.Mh)(p)),[p]),[{value:f}]=(0,dn.r5)((async()=>{if(c){return await(0,ea.VG)({environment:s,botId:null==c?void 0:c.id})}}),[s,c]);if(!c)return null;let S;return S=a.isMobile?{menuType:Be.Z.MenuType.ActionSheet}:{menuType:Be.Z.MenuType.Popup},n()(qe.Z,{popupType:a.isMobile?qe.Z.PopupType.SlideUp:qe.Z.PopupType.Popup,buttonPopupStore:i,renderOrigin:e=>m().createElement(Wa.Z,o()({isMobile:a.isMobile},e,{style:{marginLeft:8,marginRight:8}})),render:()=>m().createElement(m().Fragment,null,m().createElement(Be.Z,S,n()(Ee.Z,{type:Ee.Z.Type.Vertical,sections:[{key:"integration options",render:e=>m().createElement(Re.Z,e),items:[...mn({environment:s,botToken:f}),{key:"delete",action:()=>d(!0),render:e=>m().createElement(Fe.Z,o()({title:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectIntegrationButton.label",defaultMessage:"Disconnect {integrationName}",values:{integrationName:(0,ln.Mh)(p)}}),style:{color:g.ZP.red}},e))}]}],initialFocus:void 0})),n()(Ga.Z,{open:l,onDismiss:()=>{d(!1)},disableAnimation:!0,render:()=>n()("div",{style:{padding:20,width:333}},void 0,n()(ii.Z,{isMultiline:!0,style:{marginBottom:8,fontWeight:v.Z.fontWeight.semibold}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegration.modal.label.title",defaultMessage:"Disconnect {integrationName} in workspace",values:{integrationName:h}})),n()(ii.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginBottom:8}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegration.modal.label.caption",defaultMessage:"Revoke access for {integrationName} in workspace",values:{integrationName:h}})),n()("div",{style:{display:"flex",marginTop:12}},void 0,n()(Ht.Z,{style:{width:140,marginRight:9},isLarge:!0,onClick:()=>d(!1)},void 0,n()(ii.Z,{},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.removeIntegrationApproval.modal.button.cancel",defaultMessage:"Cancel"}))),n()(Ht.Z,{style:{width:140},isLarge:!0,onClick:async()=>{d(!1),await ea.P0({environment:s,botId:c.id,onSuccess:()=>{b.trackDeveloperIntegrationsDisconnectClick(s,{type:"internal"})}})},backgroundColor:g.ZP.red},void 0,n()(ii.Z,{style:{color:g.ZP.white}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.disconnectIntegration..modal.button.disconnect",defaultMessage:"Disconnect"})))))}))})}function mn(e){const{botToken:t,environment:i}=e;return t?[{key:"copy bot token",action:()=>{(0,Xt.RD)({environment:i,stringValue:t,copiedMessage:Xt.tq.copiedLinkToClipboard}),b.trackDeveloperIntegrationsCopySecret(i,{from:"integration-settings",table:Me.cZ})},render:e=>m().createElement(Fe.Z,o()({title:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.actionMenu.copyInternalIntegrationTokenButton.label",defaultMessage:"Copy internal integration token"})},e))}]:[]}var pn=i(52738);const gn={internal:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.internal",defaultMessage:"INTERNAL",description:"This label indicates that an integration is internal to the workspace, as opposed to public."}),databaseSync:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.sync",defaultMessage:"SYNC",description:"This label indicates that the integration type is database sync."}),linkPreview:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.preview",defaultMessage:"LINK PREVIEW",description:"This label indicates that the integration type is link preview."}),importer:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.importer",defaultMessage:"IMPORTER",description:"This label indicates that the integration type is a first-party / legacy importers."})};function hn(e){const{integrationIdToBotIds:t,internalIntegrationIds:i,integrationIdToUsers:a}=e,[{currentSpaceStore:s}]=(0,Se.oR)(Z.default),o=(0,Yt.F)(),r=(0,Se.VK)((()=>null==s?void 0:s.getBotSettingsStore().getValue()),[s]),l=(0,Se.VK)((()=>"approved_or_built_by_notion"===(null==r?void 0:r.integration_restrictions)),[r]),d=(0,Se.VK)((()=>Boolean(null==r?void 0:r.integration_restrictions)),[r]),c=(0,Se.VK)((()=>null!=r&&r.integration_approval_statuses?Object.keys(r.integration_approval_statuses):[]),[r]),u=c.filter((e=>!Object.keys(t).includes(e)&&!Xi.T2.includes(e))),p=(0,Se.VK)((()=>null==s?void 0:s.id),[s]),g=t?Object.entries(t).map((e=>{let[t,i]=e;return fn({integrationPointer:{table:Aa.K2,id:t},users:a[t],botIds:i,autoApproveBuiltByNotion:l})})):[],h=p?i.map((e=>fn({integrationPointer:{table:Me.cZ,id:e,spaceId:p},users:a[e],botIds:[e]}))):[],v=d?u.map((e=>fn({integrationPointer:{table:Aa.K2,id:e},users:[],botIds:[],autoApproveBuiltByNotion:l}))):[],S=Xi.ns.filter((e=>!(0,f.CJ)(r)||c.includes(e.id))).map((e=>function(e){const{legacyIntegration:t}=e,{id:i,name:a,info:s}=t;return{key:i,columns:[n()("div",{style:{display:"flex",alignItems:"center",maxWidth:300}},void 0,n()("img",{src:s.icon,style:{height:28}}),n()("div",{style:{minWidth:0,marginLeft:15}},void 0,n()("div",{style:{display:"flex"}},void 0,n()(ii.Z,{},void 0,a)),n()(ii.Z,{isSmall:!0,style:{display:"flex"}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.legacy",defaultMessage:"Notion Connected App"})))),n()(bn,{renderedUsers:void 0,displayUsers:!1}),n()("div",{},void 0,n()(qa,{integrationId:i,isLegacy:!0,disableDisconnectAll:!0,disableDisconnectUser:!0}))]}}({botSettings:r,legacyIntegration:e}))),M=g.length+h.length+v.length+S.length;return m().createElement(m().Fragment,null,n()(ti.Z,{columns:[{key:"integration",header:n()(y.FormattedMessage,{id:"spaceConnectionsSettings.connectionsTable.connectionsColumn.title",defaultMessage:"Connection",description:"Table header for column that lists names of workspace connections"}),style:{width:"40%"}},{key:"added_by",header:n()(y.FormattedMessage,{id:"spaceConnectionsSettings.connectionsTable.creationInfoColumn.title",defaultMessage:"Users and access",description:"Table header for column that lists members who have access to a connection"})},{key:"more",header:void 0,style:{width:"5%"}}],rows:[...g,...h,...v,...S]}),0===M?n()("div",{style:{height:120,width:"100%",fontSize:12,color:o.lightTextColor,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:"1px solid ".concat(o.lightDividerColor)}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.emptyTable.message",defaultMessage:"No integration installed"})):void 0)}function fn(e){const{integrationPointer:t,users:i,botIds:a,autoApproveBuiltByNotion:s}=e;return t.table===Aa.K2?{key:t.id,columns:[n()(vn,{integrationTable:Aa.K2,integrationId:t.id}),n()(bn,{renderedUsers:i,displayUsers:!(0,Ia.BP)(t.id)}),n()(qa,{integrationId:t.id,integrationTable:Aa.K2,botIds:a,disableDisconnectUser:(0,Ia.BP)(t.id)||void 0,disableDisallow:(0,Ia.BP)(t.id)&&s})]}:t.table===Me.cZ?{key:t.id,columns:[n()(vn,{integrationTable:Me.cZ,integrationId:t.id}),n()(bn,{renderedUsers:i,displayUsers:!1}),n()(un,{botId:t.id})]}:void(0,W.t1)(t)}function vn(e){const{integrationId:t,integrationTable:i}=e,[{currentSpaceStore:a}]=(0,Se.oR)(Z.default),s=(0,ye.O7)(),o=(0,Se.VK)((()=>(0,Oa.fe)(s)),[s]),r=(0,Se.VK)((()=>{if(a)return a.getRecordValue({table:i,id:t})}),[a,t,i]);if(!r)return n()(ya.Z,{});let l;const d=[];let c;if(i===Me.cZ){const e=r;e.icon&&(l={pointer:{table:i,id:t},icon:e.icon}),d.push("internal"),c=n()(yn,{botId:e.id})}else if(i===Aa.K2){const e=r;e.info.icon&&(l={pointer:{table:i,id:t},icon:e.info.icon}),(0,Xi.mo)(e)&&(d.push("linkPreview"),(0,Xi.zc)(e)&&o&&d.push("databaseSync")),c=n()(Sn,{integrationId:e.id})}else(0,W.t1)(i);return n()("div",{style:{display:"flex",alignItems:"center",maxWidth:300}},void 0,n()(xa.Z,{disabled:!0,icon:l,title:r.name,isEmptyPage:!1,size:28,isLarge:!0,useInvertedColors:!0}),n()("div",{style:{minWidth:0,marginLeft:15}},void 0,n()("div",{style:{display:"flex",marginRight:16}},void 0,n()(ii.Z,{},void 0,r.name),d.map((e=>e&&n()(St.Z,{desktopStyle:{marginLeft:4}},void 0,gn[e])))),c))}const yn=e=>{let{botId:t}=e;const[{currentSpaceStore:i}]=(0,Se.oR)(Z.default),a=(0,y.useIntl)(),s=(0,Se.VK)((()=>null==i?void 0:i.getRecordValue({table:Me.cZ,id:t})),[i,t]),o=(0,Se.VK)((()=>{if(i&&s)return i.getRecordValue({table:s.created_by_table,id:s.created_by_id})}),[i,s]);if(o){const e=(0,be.Nz)(a,o);return n()(ii.Z,{className:"notranslate",isSmall:!0},void 0,e)}return n()(Mn,{})},Sn=e=>{let{integrationId:t}=e;const[{currentSpaceStore:i}]=(0,Se.oR)(Z.default),a=(0,Yt.F)(),s=(0,Se.VK)((()=>{const e=null==i?void 0:i.getRecordValue({table:Aa.K2,id:t});return null==e?void 0:e.info.developer_name}),[i,t]);return(0,Ia.BP)(t)?n()(ii.Z,{isSmall:!0,style:{display:"flex",alignItems:"center"}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.notion",defaultMessage:"Notion {icon}",values:{icon:n()(Le.Z,{renderTooltip:()=>n()("div",{},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfo.notion.tooltip",defaultMessage:"Developed by Notion"})),placement:Le.Z.Placement.Right,render:e=>m().createElement("div",e,h.Z.integrationSecurity({width:12,height:12,fill:a.invoiceGreen}))})}})):s?n()(ii.Z,{className:"notranslate",isSmall:!0},void 0,s):n()(Mn,{})},Mn=()=>n()(ii.Z,{isSmall:!0},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.label.unknownDeveloper",defaultMessage:"Unknown developer",description:"The placeholder name of an integration developer if not provided"}));function bn(e){const{renderedUsers:t,displayUsers:i}=e,[{currentSpaceStore:a}]=(0,Se.oR)(Z.default),s=(0,y.useIntl)(),o=(0,ye.O7)(),r=(0,Se.VK)((()=>{if(a)return(0,Na.getSpaceName)(o,a)}),[o,a]);if(t&&0===(null==t?void 0:t.length))return n()(ii.Z,{isSecondaryColor:!0,style:{display:"flex",alignItems:"center"}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.noUsers",defaultMessage:"No users"}));if(!i||!t)return n()(ii.Z,{style:{display:"flex",alignItems:"center"}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.anyone",defaultMessage:"Anyone in {spaceName}",values:{spaceName:n()(ii.Z,{style:{fontWeight:v.Z.fontWeight.medium}},void 0,r)}}));const l=(0,be.Nz)(s,t[0]);return n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()(pn.Z,{userValue:t[0],avatarShouldShowShadow:!0,style:{marginRight:8},size:28}),n()(ii.Z,{},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.listOfUsers",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} +{remainingCount}} other {{firstUser} +{remainingCount}}}",values:{firstUser:l,remainingCount:t.length-1}})))}var wn=i(55422);function Cn(e){const t=(0,ye.O7)(),{isMobile:i}=t.device,{externalBotIds:a,guestBotIds:s}=e,[{currentSpaceStore:o}]=(0,Se.oR)(Z.default),r=(0,Se.VK)((()=>o?[...s,...a].map((e=>{var t;const i=(0,vt.Kv)(o,{table:Me.cZ,id:e,spaceId:o.id});return null!=i&&null!==(t=i.getValue())&&void 0!==t&&t.alive?i.getValue():void 0})).filter(W.$K):[]),[o,s,a]),l=(0,Se.VK)((()=>function(e){return e.reduce(((e,t)=>(t.integration_id&&(e[t.integration_id]=t.integration_id in e?[...e[t.integration_id],t.id]:[t.id]),e)),{})}([...r])),[r]),d=(0,Se.VK)((()=>function(e){return e.filter((e=>!e.integration_id)).map((e=>e.id))}(r)),[r]),c=(0,Se.VK)((()=>function(e,t){if(!t)return{};return e.reduce(((e,i)=>{const a=t.getRecordValue({table:be.KJ,id:i.created_by_id});return i.integration_id?e[i.integration_id]=i.integration_id in e?[...e[i.integration_id],a]:[a]:e[i.id]=[a],e}),{})}(r,o)),[r,o]),u=(0,Se.VK)((()=>null==o?void 0:o.getBotSettingsStore().getValue()),[o]),p=Object.keys(l).length+d.length,g=(0,Se.VK)((()=>null!=u&&u.integration_approval_statuses?Object.keys(u.integration_approval_statuses).length+d.length:d.length),[u,d]);return m().createElement(m().Fragment,null,n()(Tn,{}),(null==u?void 0:u.integration_restrictions)&&n()("div",{style:{marginTop:"19px"}},void 0,n()(kn,{})),n()(pa.Z,{size:i?32:18,isHidden:!i}),Boolean(null==u?void 0:u.integration_restrictions)?n()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"19px"}},void 0,n()(ii.Z,{style:{fontWeight:v.Z.fontWeight.medium,display:"flex",alignItems:"center",height:28}},void 0,n()(y.FormattedMessage,{id:"adminConnectionsSettings.table.allowIntegrations.title",defaultMessage:"Approved connections{numberOfIntegrations}",description:"Title for table that displays admin-approved workspace connections",values:{numberOfIntegrations:0!==g&&n()(ii.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,g)}})),n()(La,{})):n()(ii.Z,{style:{fontWeight:v.Z.fontWeight.medium,display:"flex",height:28,alignItems:"center",marginBottom:"19px"}},void 0,n()(y.FormattedMessage,{id:"adminConnectionsSettings.table.default.title",defaultMessage:"All connections{numberOfIntegrations}",description:"Title for table that shows all connections installed on workspace",values:{numberOfIntegrations:0!==p&&n()(ii.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,p+Xi.T2.length)}})),n()(hn,{integrationIdToBotIds:l,internalIntegrationIds:d,integrationIdToUsers:c}))}const Tn=()=>{const e=(0,ye.O7)(),[{currentSpaceStore:t}]=(0,Se.oR)(Z.default),{isMobile:i}=e.device,a=(0,Se.VK)((()=>"enterprise"===L.CM(e)),[e]),s=(0,Se.VK)((()=>null==t?void 0:t.getBotSettingsStore().getValue()),[t]),o=(0,$t.u)();return n()(wn.Z,{isMobile:i,title:n()(y.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.title",defaultMessage:"Restrict members from adding connections",description:"Section header for restriction settings related to user-installed workspace connections"}),caption:(0,f.CJ)(s)?n()(y.FormattedMessage,o?{id:"adminConnectionsSettings.requireApprovalSetting.allowList.workspaceOwner.caption",defaultMessage:"Workspace members can only install connections pre-approved by workspace owners.",description:"Caption for menu option that restricts member-installed connections to those on workspace owners put on allow list"}:{id:"adminConnectionsSettings.requireApprovalSetting.allowList.caption",defaultMessage:"Workspace members can only install connections pre-approved by admins.",description:"Caption for menu option that restricts member-installed connections to those on an allow list"}):n()(y.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.off.caption",defaultMessage:"Workspace members can install any new connection.",description:"Caption for restriction settings related to user-installed workspace connections"}),upsellOptions:{shouldUpsell:!a,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"dropdown",currentOption:(0,f.CJ)(s)?"allow_list":"any_integrations",options:[{key:"any_integrations",label:n()(y.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.off.title",defaultMessage:"Off"}),caption:n()(y.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.off.caption",defaultMessage:"Workspace members can install any connection.",description:"Caption for menu option that removes member restrictions on installing connections"})},{key:"allow_list",label:n()(y.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.allowList.title",defaultMessage:"From approved list"}),caption:n()(y.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.allowList.caption",defaultMessage:"Workspace members can only install connections pre-approved by an admin.",description:"Caption in workspace connections settings for restricting which connections users may install"})}],onSelectOption:i=>{!function(e){const{environment:t,currentSpaceStore:i,botSettings:a,setting:n}=e;if(i){if("allow_list"===n&&(0,f.CJ)(a))return;const e="allow_list"===n?"approved_only":void 0;A.createAndCommit({userAction:"AdminIntegrationSettings.handleIntegrationRestrictionSelect",environment:t,perform:t=>{ka.sW({store:i,data:{bot_settings:{...a,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:t,botSettings:s,setting:i})},info:[{key:"learn_more",label:n()(y.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.info.title",defaultMessage:"Admins can always install and approve new connections.",description:"Information about admin permissions for workspace connections"})}]})};const kn=()=>{const e=(0,ye.O7)(),t=(0,Yt.F)(),[{currentSpaceStore:i}]=(0,Se.oR)(Z.default),{isMobile:a}=e.device,s=(0,Se.VK)((()=>"enterprise"===L.CM(e)),[e]),o=(0,Se.VK)((()=>null==i?void 0:i.getBotSettingsStore().getValue()),[i]);return n()(wn.Z,{isMobile:a,title:n()(y.FormattedMessage,{id:"adminConnectionsSettings.autoApproveBuiltByNotion.title",description:"This message is for the option to auto approve connections that are built by Notion.",defaultMessage:"Auto-approve <builtbynotion>Built by Notion</builtbynotion> connections",values:{builtbynotion:function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return n()("span",{style:{color:t.invoiceGreen}},void 0,h.Z.integrationSecurity({width:14,display:"inline",verticalAlign:"text-bottom",marginRight:2}),i)}}}),caption:n()(y.FormattedMessage,{defaultMessage:"Toggle this on to approve all workspace members to install connections <helpcenterlink>built by Notion</helpcenterlink>.",id:"adminConnectionsSettings.autoApproveBuiltByNotion.caption",description:"Caption for toggle UI in workspace connections settings",values:{helpcenterlink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(va.Z,{href:(0,R.UY)("guides.enterpriseIntegrationSettings")},void 0,t)}}}),upsellOptions:{shouldUpsell:!s,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"toggle",isOn:"approved_or_built_by_notion"===(null==o?void 0:o.integration_restrictions),onToggle:()=>function(e){const{environment:t,currentSpaceStore:i,botSettings:a}=e;if(i){const e="approved_or_built_by_notion"===(null==a?void 0:a.integration_restrictions)?"approved_only":"approved_or_built_by_notion";A.createAndCommit({userAction:"AdminIntegrationSettings.handleAutoApproveBuiltByNotionToggle",environment:t,perform:t=>{ka.sW({store:i,data:{bot_settings:{...a,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:i,botSettings:o})})};var Zn=i(70578),An=i(4122),In=i(30381),Pn=i.n(In),_n=i(93079);function xn(e){const{botIds:t}=e,i=(0,y.useIntl)(),[{currentSpaceStore:a}]=(0,Se.oR)(Z.default),s=(0,Yt.F)(),o=(0,Se.VK)((()=>a?t.map((e=>function(e,t){const{currentSpaceStore:i}=Z.default.state,a=e.getValue();if(!a||!a.alive||!i||!e.canAdmin()&&!i.canAdmin())return;const s=null==i?void 0:i.getRecordValue({table:be.KJ,id:a.created_by_id}),o=(0,be.Nz)(t,{name:null==s?void 0:s.name}),r=Pn()(a.created_at,"x").format("LLL"),l=!a.integration_id;return{key:a.id,columns:[n()("div",{style:{maxWidth:300,display:"flex"}},void 0,n()(_n.Z,{botValue:a,avatarSize:24,style:{marginRight:6}}),l&&n()(St.Z,{},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.row.internalIntegrationLabel",defaultMessage:"Internal",description:"This label indicates that an integration is internal, as opposed to public."}))),n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.creationInfoColumn.contents",defaultMessage:"{installerName} on {installedTime}",values:{installerName:o,installedTime:r},description:"Text describing who added an integration to a workspace and when. For example: 'Johnny Appleseed on May 13, 2021'"}),n()(un,{botId:a.id})]}}((0,vt.Kv)(a,{table:Me.cZ,id:e,spaceId:a.id}),i))).filter(W.$K):[]),[a,t,i]);return m().createElement(m().Fragment,null,n()("div",{style:{marginBottom:"19px",display:"flex",alignItems:"center"}},void 0,n()(ii.Z,{style:{fontWeight:v.Z.fontWeight.medium}},void 0,n()(y.FormattedMessage,{id:"adminIntegrationSettings.table.default.title",defaultMessage:"All integrations"})),n()(ii.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,o.length)),n()(ti.Z,{columns:[{key:"integration",header:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.integrationColumn.title",defaultMessage:"Integration"}),style:{width:"40%"}},{key:"added_by",header:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationtable.creationInfoColumn.title",defaultMessage:"Added by"})},{key:"more",header:void 0}],rows:o}),0===o.length?n()("div",{style:{height:120,width:"100%",fontSize:12,color:s.lightTextColor,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:"1px solid ".concat(s.lightDividerColor)}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.emptyMessage",defaultMessage:"No integration installed"})):void 0)}class Fn extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{requestStore:da.Z}),l()(this,"renderResult",((e,t,i)=>{const{currentSpaceStore:a}=Z.default.state;if(a)return n()(An.Z,{loaded:i,spinnerSize:16,showSpinnerTimeout:600},void 0,e&&n()("div",{},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.error",defaultMessage:"Something went wrong…"})),t&&(a.canAdmin()?n()(Cn,{guestBotIds:t.guestBotIds,externalBotIds:t.externalBotIds}):n()(xn,{botIds:t.guestBotIds})),n()("div",{style:{marginTop:16,marginBottom:32,display:"grid",gridTemplateColumns:"1fr",gap:4}},void 0,n()(Zn.Z,{})))})),l()(this,"fetchBotsInSpace",(async e=>{let{spaceId:t}=e;const i=await(0,ea.Yw)({environment:this.environment,table:mi.bx,id:t,type:"guest"}),a=await(0,ea.Yw)({environment:this.environment,table:mi.bx,id:t,type:"external"});return{guestBotIds:i.botIds,externalBotIds:a.botIds}}))}renderComponent(){const{device:e}=this.environment;return n()(ba.Z,{},void 0,n()(qt.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",style:{paddingBottom:12}},void 0,n()(y.FormattedMessage,{id:"spaceConnectionsSettings.title",defaultMessage:"Connections",description:"Page title for workspace connections settings tab"})),this.renderRequest())}renderRequest(){const{spaceStore:e,userStore:t}=this.props;return n()(Sa.Z,{requestStore:this.stores.requestStore,request:{spaceId:e.id,userId:t.id},performRequest:this.fetchBotsInSpace,render:this.renderResult})}}const Bn=(0,y.injectIntl)(Fn);i(41817);function En(e){let{title:t,description:i,onDismiss:a,icon:s,primaryAction:o,secondaryAction:r}=e;const l=(0,Yt.y)((e=>({container:{position:"relative",width:"100%",padding:16},multiIconsRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:12},singleIconRow:{position:"absolute",top:10,right:16},dismissButton:{marginTop:-7,marginRight:-7},title:{fontWeight:v.Z.fontWeight.medium,fontSize:v.Z.fontSize.UIRegular.desktop,lineHeight:1.2,color:e.darkTextColor,marginBottom:8},description:{fontWeight:v.Z.fontWeight.regular,fontSize:v.Z.fontSize.UISmall.desktop,color:e.lightTextColor},primaryActionButton:{width:"100%",margin:"12px auto 0"},secondaryActionButton:{width:"100%",margin:"8px auto 0",justifyContent:"center",fontWeight:v.Z.fontWeight.regular,fontSize:v.Z.fontSize.UISmall.desktop,color:e.lightTextColor},secondaryActionIcon:{width:12,height:12,marginRight:4},icon:{width:14,height:14,color:e.regularIconColor}})),[]);return n()("div",{style:l.container},void 0,s?n()("div",{style:l.multiIconsRow},void 0,n()("div",{},void 0,s),n()(ut.Z,{isSmall:!0,style:l.dismissButton,onClick:a},void 0,h.Z.closeSmall(l.icon))):n()("div",{style:l.singleIconRow},void 0,n()(ut.Z,{isSmall:!0,style:l.dismissButton,onClick:a},void 0,h.Z.closeSmall(l.icon))),n()(ii.Z,{style:l.title,isMultiline:!0},void 0,t),n()(ii.Z,{style:l.description,isMultiline:!0,isSmall:!0},void 0,i),o?n()(xe.Z,{isLarge:!0,style:l.primaryActionButton,onClick:e=>o.onClick(e)},void 0,o.text):null,r?n()(ut.Z,{style:l.secondaryActionButton,onClick:e=>r.onClick(e)},void 0,r.icon?r.icon(l.secondaryActionIcon):null,r.text):null)}function Dn(e){const t=(0,ye.O7)();return(0,u.useEffect)((()=>{const{currentSpaceStore:e}=Z.default.state;"enterprise"===(null==e?void 0:e.getSubscriptionTier())&&function(e){var t;const{currentSpaceViewStore:i}=Z.default.state;if(!i)return;const a=null===(t=i.getSettings())||void 0===t?void 0:t.enterprise_settings_prompt;if(!a||"dismissed"===a.status||"hidden"===a.status)return;const n={...a,num_times_shown:a.num_times_shown+1};n.num_times_shown>3&&(n.status="hidden"),A.createAndCommit({userAction:"spaceViewActions.incrementMembersPromptSettings",environment:e,perform:e=>{I(i,e,{enterprise_settings_prompt:n})}})}(t)}),[t]),m().createElement(m().Fragment,null,n()(pa.Z,{size:0}),n()(En,{icon:h.Z.person({width:16}),title:n()(y.FormattedMessage,{id:"enterpriseMembersSettingsPrompt.title",defaultMessage:"A new admin access level for member management",description:"Title message that shows for enterprise plans describing the new access level"}),description:n()(y.FormattedMessage,{id:"enterpriseMembersSettingsPrompt.caption",defaultMessage:"Membership admins can add and remove people to the workspace and groups. They cannot access other admin settings.",description:"Caption message for the members prompt that shows to enterprise workspace owners."}),onDismiss:()=>P(t),primaryAction:{text:n()(y.FormattedMessage,{id:"enterpriseMembersSettingsPrompt.cta",defaultMessage:"Manage members",description:"Text on button CTA that redirects to the settings members tab when clicked"}),onClick:i=>(P(t),e.onMembersTabClick(i))},secondaryAction:{icon:e=>h.Z.help(e),text:n()(y.FormattedMessage,{id:"enterpriseMembersSettingsPrompt.learnMore.button",defaultMessage:"Learn more",description:"Button shown in the members setting prompt to enterprise users that links to the help center."}),onClick:()=>{const e=(0,R.UY)("guides.enterpriseAdmins");T.navigateToExternalURL({environment:t,url:e})}}}))}var Rn=i(79603);function Ln(e){let{spaceStore:t,emailDomains:i}=e;const a=(0,ye.O7)(),[n,s]=(0,u.useState)(i),[o,r]=(0,u.useState)([]),l=(0,Se.VK)((()=>"on"===ie.default.getEligibleGroup({experimentId:"domain_claim_walk",defaultGroup:"unassigned"})),[]);(0,u.useEffect)((()=>{c().isEqual(n,i)||s(i)}),[n,i]);const[{status:d,error:m}]=(0,dn.r5)((async()=>{if(!l)return;const e=await async function(e,t,i){if(0===i.length)return[];const a=[];let n=Date.now(),s=1;for(;void 0!==n&&s++<=10;){const{spaces:s,earliestCreatedAt:o}=await On(e,t,i,n-1);a.push(...s),n=o}return a}(a,t.id,n);r(e)}),[a,n,t,l]);return{loading:"pending"===d,claimableWorkspaces:"resolved"===d?o:[],error:m,setWorkspaceTransfer:function(e,t){r((i=>i.map((i=>i.id===e?{...i,workspaceTransfer:t}:i))))}}}async function On(e,t,i,a){const n=await w.getSpacesCreatedByUserWithDomains(e,{spaceId:t,emailDomains:i,spacesLimit:10,allowedSubscriptionTiers:["personal","personal_free","team","team_free"],spaceCreatedTimeUpperBound:a});if("failed"===n.type)throw n.error;return{spaces:n.data.results.map((e=>({id:e.id,name:e.spaceName,icon:e.spaceIcon,createdAt:e.spaceCreatedTime,memberCount:e.memberCount,subscriptionTier:e.subscriptionTier,creatorEmailDomain:e.spaceCreatedByDomain,creator:e.spaceCreator,admins:e.admins,workspaceTransfer:e.workspaceTransfer}))).filter((e=>"personal"===e.subscriptionTier||"personal_free"===e.subscriptionTier||"team"===e.subscriptionTier||"team_free"===e.subscriptionTier)),earliestCreatedAt:n.data.hasMoreSpaces?n.data.earliestCreatedAt:void 0}}const Nn="settings-page",Un="workspaces-page",Wn=(0,u.createContext)(null),Vn=e=>{let{spaceStore:t,samlConfigStore:i,domainSettingsStore:a,children:s}=e;const[o,r]=(0,u.useState)(Nn),l=(0,Se.VK)((()=>i.state.emailDomains),[i]),{loading:d,error:c,loaded:m}=function(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:a}=e;const n=(0,ye.O7)(),[{status:s,error:o}]=(0,dn.r5)((async()=>{var e;const s=await me({environment:n,spaceId:t.id,store:i}),o=null===(e=s.samlConfig)||void 0===e?void 0:e.id;return o?{samlResponse:s,domainResponse:await a.updateValueForSpace({environment:n,spaceId:o,store:a})}:{samlResponse:s,domainResponse:void 0}}),[n,i,t,a]);return{loading:"pending"===s,loaded:"resolved"===s,error:o}}({spaceStore:t,samlConfigStore:i,domainSettingsStore:a}),{loading:p,error:g,claimableWorkspaces:h,setWorkspaceTransfer:f}=Ln({spaceStore:t,emailDomains:l});const v={page:o,navigateTo:function(e){r(e)},loadingSaml:d,loadingSpaces:p,errorSaml:c,errorSpaces:g,loadedSaml:m,claimableWorkspaces:h,setWorkspaceTransfer:f};return n()(Wn.Provider,{value:v},void 0,s)};function zn(e){let{environment:t,samlConfigStore:i}=e;const a=i.state.emailDomains.length>0,n="enterprise"===L.CM(t);return a||n}var Gn=i(81236);async function Hn(e){let{onRequest:t,onSuccess:i}=e;const a=await t();switch(a.type){case"success":i&&await i(a);break;case"failed":C.showErrorMessage(a.error.message);break;default:(0,W.t1)(a)}}function qn(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:a}=e;const n=(0,ye.O7)(),s=(0,Se.VK)((()=>i.state.emailDomains),[i]),o=(0,Se.VK)((()=>"disabled"!==i.state.status&&"unconfigured"!==i.state.status),[i]),r=(0,Se.VK)((()=>zn({environment:n,samlConfigStore:i})),[i,n]),l=(0,Se.VK)((()=>r&&(!i.state.id||i.state.id===t.id)),[r,i,t]),d=(0,Se.VK)((()=>a.state.emailDomains.length>0&&"enterprise"===L.CM(n)),[a,n]),c=(0,Se.VK)((()=>s.length>0),[s]),m=(0,u.useCallback)((async()=>{if(i.state.emailDomains.length>0)return Hn({onRequest:()=>w.updateWorkspaceCreationForEmailDomains(n,{emailDomains:i.state.emailDomains,workspaceCreationEnum:a.state.spaceCreation,spaceId:t.id}),onSuccess:()=>{a.setState({...a.state,emailDomains:i.state.emailDomains})}})}),[n,t,a,i]);return{verifiedDomains:s,isSamlStatusEnabled:o,isSamlAvailable:r,isSamlEditable:l,isDomainSettingsAvailable:d,canSaveWorkspaceCreationSetting:c,saveWorkspaceCreationSetting:m}}function Kn(e){let{title:t,byline:i,settingItem:a}=e;const s=(0,Yt.y)((()=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},settingLeft:{width:"60%"},settingTitle:{fontWeight:v.Z.fontWeight.regular},settingByline:{marginBottom:4}})),[]);return n()("div",{style:s.settingContainer},void 0,n()("div",{style:s.settingLeft},void 0,n()(qt.Z,{smallMarginBottom:!0,style:s.settingTitle},void 0,t),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:s.settingByline},void 0,i)),a)}var jn=i(93678),Yn=i(61543);function Qn(e){let{title:t,byline:i}=e;const a=(0,ye.O7)(),s=(0,u.useCallback)((()=>jn.y(a,{from:"space_saml",for:"enterprise"})),[a]);return m().createElement(m().Fragment,null,n()(qt.Z,{smallMarginBottom:!0,style:{fontWeight:v.Z.fontWeight.regular,display:"flex",alignItems:"center"}},void 0,n()("span",{style:{marginRight:8}},void 0,t),n()(Yn.Z,{subscriptionTier:"enterprise",analyticsName:"space_saml",onClick:s})),n()(ii.Z,{isSmall:!0,isMultiline:!0},void 0,i))}function Jn(e){let{loading:t,promptUpgrade:i,claimableWorkspaces:a}=e;const{navigateTo:s}=(0,u.useContext)(Wn),r=0===a.length||t,l=0===a.length&&!t,d=n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.title",defaultMessage:"Claim workspaces",description:"Title for this section's content being about claiming domains."}),c=n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.message",defaultMessage:"Claim workspaces created by users with a verified domain or require owners to use an external domain.",description:"Byline talking about how workspaces created with a verified domain can be claimed."}),p=(0,Yt.y)((()=>({settingContainer:{margin:"18px 0"},button:{opacity:r?.5:1,minWidth:160}})),[r]);return(0,Se.VK)((()=>"on"===ie.default.getEligibleGroup({experimentId:"domain_claim_walk",defaultGroup:"unassigned"})),[])?i?n()(Qn,{title:d,byline:c}):n()("div",{style:p.settingContainer},void 0,n()(Kn,{title:d,byline:c,settingItem:n()(Le.Z,{placement:Le.Z.Placement.Top,alignment:Le.Z.Alignment.End,render:e=>m().createElement(Ht.Z,o()({disabled:r,isLarge:!0,style:p.button,onClick:()=>s(Un)},e),t?n()(ya.Z,{}):a.length>0?n()(y.FormattedMessage,{defaultMessage:"Browse {numWorkspaces} workspaces",id:"identityAndProvisioning.claimWorkspaces.button",description:"Message explaining that there are some workspaces that the user can claim.",values:{numWorkspaces:a.length}}):n()(y.FormattedMessage,{defaultMessage:"No workspaces",id:"identityAndProvisioning.claimWorkspaces.buttonEmpty",description:"Message explaining that there are no workspaces to claim."})),disableTooltip:!l,renderTooltip:()=>n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.tooltip",defaultMessage:"There are no available workspaces to claim",description:"Tooltip explaining that the button is disabled because there are no workspaces to claim."})})})):null}var Xn=i(52507),$n=i(51490);function es(e){let{spaceStore:t,samlConfigStore:i,promptUpgrade:a,disabled:s,saveWorkspaceCreationSetting:o}=e;const r=(0,ye.O7)(),l=(0,Se.qz)(void 0,Xn.ZP),d=(0,Yt.y)((()=>({flex:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",margin:"18px 0px"},button:{opacity:s?.5:1}})),[s]),c=n()(y.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.title",defaultMessage:"Verified domains",description:"Title describing how the content in this section is for verified email domains."}),m=n()(y.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.byline",defaultMessage:"Verify ownership of an email domain to access advanced security features including single-sign on.",description:"Caption explaining what it means to verify a domain."}),p=(0,Se.VK)((()=>i.state.emailDomains.map($n.f4)),[i]),g=(0,Se.VK)((()=>i.state.domainVerifications.sort(((e,t)=>e.createdAt-t.createdAt)).map($n.UV)),[i]),h=[...p.filter((e=>!g.some((t=>t.domain===e.domain)))),...g],f=(0,u.useCallback)((async()=>{await me({environment:r,spaceId:t.id,store:i})}),[r,t,i]),S=(0,u.useCallback)((async e=>{switch(e.type){case"verified":return Hn({onRequest:()=>w.setSamlConfig(r,{spaceId:t.id,removedEmailDomains:[e.domain]}),onSuccess:()=>f()});case"unverified":case"invalid":return Hn({onRequest:()=>w.deleteDomainVerificationCode(r,{id:e.id}),onSuccess:()=>f()})}}),[r,t,f]),M=(0,u.useCallback)((()=>Hn({onRequest:()=>w.setSamlConfig(r,{spaceId:t.id}),onSuccess:()=>f()})),[r,f,t]),b=(0,u.useCallback)((async()=>{await f(),await o()}),[o,f]);return a?n()(Qn,{title:c,byline:m}):n()($n.ZP,{disabled:s,domains:h,onRemoveDomain:S,domainVerificationStore:l,verificationType:"saml_config",verificationTargetId:t.id,refreshDomains:b,onClickAddDomain:M,renderOverrideAddDomainButton:e=>n()("div",{style:d.flex},void 0,n()("div",{},void 0,n()(qt.Z,{smallMarginBottom:!0,style:{fontWeight:v.Z.fontWeight.medium}},void 0,c),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginBottom:4}},void 0,m)),n()("div",{},void 0,n()(Ht.Z,{disabled:s,isLarge:!0,style:d.button,onClick:e},void 0,n()(y.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain",description:"Button for adding a new domain verification record."}))))})}var ts=i(61794);function is(e){let{domainSettingsStore:t,samlConfigStore:i,disabled:a,verifiedDomains:s,tooltip:r,saveWorkspaceCreationSetting:l}=e;const d=(0,ye.O7)(),c=(0,Yt.y)((()=>({settingContainer:{margin:"18px 0"}})),[]),p=(0,Se.VK)((()=>{const e=i.state.id;if(!e)return;return new ts.Z(d,{table:mi.bx,id:e}).getName()}),[d,i]),g=(0,Se.VK)((()=>"on"===ie.default.getEligibleGroup({experimentId:"domain_claim",defaultGroup:"unassigned"})),[]),h=(0,u.useCallback)((async e=>{t.setState({...t.state,spaceCreation:e}),await l(),b.trackWorkspaceCreationSettingUpdate(d,{workspace_creation:e})}),[t,l,d]),f=(0,Se.VK)((()=>s.length>0?t.state.spaceCreation:"admins_only"),[t,s]),v=(0,$t.u)();if(!g)return null;const S=n()(y.FormattedMessage,v?{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.titleWithSpaceName",defaultMessage:"{primaryWorkspaceName} workspace owners",description:"Dropdown option to restrict workspace creation to workspace owners",values:{primaryWorkspaceName:p}}:{id:"domainSettings.workspaceCreation.admins_only.titleWithSpaceName",defaultMessage:"{primaryWorkspaceName} admins",description:"Dropdown option to restrict workspace creation to admins",values:{primaryWorkspaceName:p}}),M=n()(y.FormattedMessage,v?{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.title",defaultMessage:"Only workspace owners",description:"Dropdown option to restrict workspace creation to workspace owners"}:{id:"domainSettings.workspaceCreation.admins_only.title",defaultMessage:"Only admins",description:"Dropdown option to restrict workspace creation to admins"});return n()(Le.Z,{placement:Le.Z.Placement.Top,alignment:Le.Z.Alignment.End,render:e=>m().createElement("div",o()({},e,{style:c.settingContainer}),n()(wn.Z,{isMobile:d.device.isMobile,disabled:a,title:n()(y.FormattedMessage,{id:"domainSettings.workspaceCreation.title",defaultMessage:"Workspace creation",description:"Title of workspace creation dropdown"}),caption:n()(y.FormattedMessage,{id:"domainSettings.workspaceCreation.byline",defaultMessage:"Customize who can create new workspaces.",description:"Caption of workspace creation dropdown"}),type:"dropdown",currentOption:f,options:[{key:"unrestricted",label:n()(y.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.title",defaultMessage:"Anyone",description:"Dropdown option to remove restrictions on workspace creation"}),caption:n()(y.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.caption",defaultMessage:"Any user can create new workspaces.",description:"Caption providing more detail for how any users can create a new space with this setting"})},{key:"admins_only",label:p?S:M,caption:n()(y.FormattedMessage,v?{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.captionWithSpaceName",defaultMessage:"Only workspace owners of this workspace can create new workspaces.",description:"Caption providing more detail for how only workspace owners can create a new space with this setting"}:{id:"domainSettings.workspaceCreation.admin_only.captionWithSpaceName",defaultMessage:"Only admins of this workspace can create new workspaces.",description:"Caption providing more detail for how only admins can create a new space with this setting"})}],onSelectOption:h})),disableTooltip:!r,renderTooltip:()=>r})}function as(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:a}=e;const{verifiedDomains:s,isSamlAvailable:o,saveWorkspaceCreationSetting:r,isSamlEditable:l,isDomainSettingsAvailable:d,canSaveWorkspaceCreationSetting:c}=qn({spaceStore:t,samlConfigStore:i,domainSettingsStore:a}),p=(0,Se.VK)((()=>"on"===ie.default.getEligibleGroup({experimentId:"domain_claim_walk",defaultGroup:"unassigned"})),[]),{loadingSpaces:g,claimableWorkspaces:h}=(0,u.useContext)(Wn),f=d&&l;return m().createElement(m().Fragment,null,n()(es,{disabled:!l,promptUpgrade:!o,spaceStore:t,samlConfigStore:i,saveWorkspaceCreationSetting:r}),n()(is,{disabled:!f||!c,verifiedDomains:s,samlConfigStore:i,domainSettingsStore:a,tooltip:0===s.length?n()(y.FormattedMessage,{id:"domainSettings.workspaceCreation.disabledTooltip",defaultMessage:"There must be at least one verified domain to configure the workspace creation setting.",description:"Tooltip explaining that the workspace creation setting is disabled if there are no verified domains."}):void 0,saveWorkspaceCreationSetting:r}),p&&n()(Jn,{claimableWorkspaces:h,promptUpgrade:!o,loading:g}))}var ns=i(47714);function ss(e){let{title:t,byline:i,isOn:a,onToggle:s,disabled:o,tooltipForDisabled:r}=e;function l(){o||s()}return n()(Le.Z,{placement:Le.Z.Placement.Top,alignment:Le.Z.Alignment.End,disableTooltip:!r||!o,renderTooltip:()=>r,render:e=>m().createElement("div",e,n()(Kn,{title:t,byline:i,settingItem:n()(ns.Z,{on:a,disabled:o,onClick:l})}))})}function os(e){let{spaceStore:t,samlConfigStore:i}=e;const a=(0,ye.O7)();return{updateSamlIdpUrl:(0,u.useCallback)((async e=>{let n=!1;return await Hn({onRequest:()=>w.setSamlConfig(a,{spaceId:t.id,idpMetadataUrl:e}),onSuccess:()=>{n=!0,i.setState({...i.state,useMetadataUrl:!0,idpMetadataUrl:e,idpMetadata:void 0})}}),n}),[i,t,a]),updateSamlIdpXml:(0,u.useCallback)((async e=>{let n=!1;return await Hn({onRequest:()=>w.setSamlConfig(a,{spaceId:t.id,idpMetadata:e}),onSuccess:()=>{n=!0,i.setState({...i.state,useMetadataUrl:!1,idpMetadataUrl:void 0,idpMetadata:e})}}),n}),[i,t,a]),updateStatus:(0,u.useCallback)((e=>Hn({onRequest:()=>w.setSamlConfig(a,{spaceId:t.id,status:e}),onSuccess:()=>{i.setState({...i.state,status:e})}})),[i,t,a]),updateCreateAccount:(0,u.useCallback)((e=>Hn({onRequest:()=>w.setSamlConfig(a,{spaceId:t.id,createAccount:e}),onSuccess:()=>{i.setState({...i.state,createAccount:e})}})),[i,t,a])}}function rs(e){let{spaceStore:t,samlConfigStore:i,disabled:a}=e;const{updateCreateAccount:s}=os({samlConfigStore:i,spaceStore:t}),o=(0,Yt.y)((()=>({settingContainer:{margin:"18px 0"}})),[]),r=(0,Se.VK)((()=>i.state.createAccount),[i]);return n()("div",{style:o.settingContainer},void 0,n()(ss,{title:n()(y.FormattedMessage,{id:"identityAndProvisioning.createAccount.title",defaultMessage:"Automatic account creation",description:"Title describing how this setting is for automatically creating accounts on sign in."}),byline:n()(y.FormattedMessage,{id:"identityAndProvisioning.createAccount.byline",defaultMessage:"Automatically create Notion accounts for new users who log in via SAML SSO.",description:"Byline further describing how this setting is for automatically creating accounts on sign in."}),isOn:r,onToggle:async function(){await s(!i.state.createAccount)},disabled:a}))}function ls(e){let{spaceStore:t,samlConfigStore:i,disabled:a}=e;const s=(0,ye.O7)(),{updateStatus:o}=os({samlConfigStore:i,spaceStore:t}),r=(0,Yt.y)((()=>({settingContainer:{margin:"18px 0"}})),[]),l=(0,Se.VK)((()=>"enforced"===i.state.status?"enforced":"not_enforced"),[i]);return n()("div",{style:r.settingContainer},void 0,n()(wn.Z,{isMobile:s.device.isMobile,disabled:a,title:n()(y.FormattedMessage,{id:"identityAndProvisioning.accountAuth.title",defaultMessage:"Login method",description:"Title of authentication dropdown"}),caption:n()(y.FormattedMessage,{id:"identityAndProvisioning.accountAuth.byline",defaultMessage:"Customize how users access SAML SSO-enabled workspaces.",description:"Caption of authentication creation dropdown"}),type:"dropdown",currentOption:l,options:[{key:"enforced",label:n()(y.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.enforced",defaultMessage:"Only SAML SSO",description:"Dropdown option to enforce SSO on log in."})},{key:"not_enforced",label:n()(y.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.notEnforced",defaultMessage:"Any method",description:"Dropdown option to not enforce SSO on log in. Users can log in using SSO or another log method, for example, username/password."})}],onSelectOption:async function(){"enforced"===i.state.status?await o("configured"):await o("enforced")}}))}var ds=i(13991),cs=i(5228),us=i(83328);function ms(e){let{isOpen:t,...i}=e;const a=(0,Se.VK)((()=>({active:i.samlConfigStore.state.useMetadataUrl?"url":"xml",url:i.samlConfigStore.state.idpMetadataUrl||"",xml:i.samlConfigStore.state.idpMetadata||""})),[i.samlConfigStore]);return n()(Ga.Z,{open:t,onDismiss:i.onClose,render:()=>m().createElement(ps,o()({},i,{initialConfiguration:a}))})}function ps(e){let{onSaveChanges:t,initialConfiguration:i,samlConfigStore:a,spaceStore:s,onClose:o}=e;const[r,l]=(0,u.useState)(i),d=(0,ye.O7)(),c=(0,Yt.y)((e=>({container:{background:e.popoverBackground,width:450,padding:24,borderRadius:3,transition:"all 500ms ease"},title:{fontFamily:v.Z.getCompositeFontFamily(ds.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:v.Z.getCompositeFontFamily(ds.SP).sans,fontSize:14,fontWeight:500,lineHeight:"19px",margin:"20px 0 0"},copyButton:{borderRadius:3,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:v.Z.getCompositeFontFamily(ds.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},url:{width:"100%",color:e.mediumTextColor,fontFamily:v.Z.getCompositeFontFamily(ds.SP).sans,fontSize:14,fontWeight:400,lineHeight:"18px"},readonlyInput:{display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid ".concat(e.outlineButtonBorder),height:32,paddingLeft:12,paddingRight:12,borderRadius:3},divider:{margin:"20px auto 20px"},radioContainer:{display:"flex",justifyContent:"space-evenly",flexDirection:"column",height:60},radioOption:{display:"flex",alignItems:"center"},caption:{margin:"4px 0 8px"},centeredCaption:{margin:"4px 24px 8px",textAlign:"center"},buttonContainer:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginTop:24},buttonSpacing:{marginRight:8},feedback:{color:"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400],display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px",height:20}})),[]),p=(0,u.useMemo)((()=>hs(r)),[r]),g=(0,Se.VK)((()=>"unconfigured"===a.state.status),[a]),f=(0,Se.VK)((()=>(0,cs.v9)(s.id,Gt.Z.domainBaseUrl)),[s]),S=(0,u.useCallback)((()=>{Xt.RD({environment:d,stringValue:f,copiedMessage:Xt.tq.copiedLinkToClipboard})}),[d,f]),M=(0,u.useCallback)((()=>{l((e=>({...e,active:"url"})))}),[]),b=(0,u.useCallback)((()=>{l((e=>({...e,active:"xml"})))}),[]),w=(0,Yt.y)((e=>({input:{transition:"all 200ms ease-in-out",boxShadow:"none",margin:"12px 0",width:"100%",background:e.popoverBackground,border:"1px solid ".concat(e.outlineButtonBorder)}})),[]),C=(0,u.useMemo)((()=>"url"===r.active?{placeholder:"https://...",value:r.url,onChange:e=>{const t=e.target.value;l((e=>({...e,url:t})))},style:{height:32,...w.input}}:{placeholder:'<md:EntityDescriptor entityID="...',value:r.xml,onChange:e=>{const t=e.target.value;l((e=>({...e,xml:t})))},textarea:!0,style:{height:118,...w.input},inputStyle:{width:"100%",height:"100%"}}),[r,w]),T=(0,u.useCallback)((()=>{t(r)}),[t,r]);return n()("div",{style:c.container},void 0,n()(ii.Z,{style:c.title},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.title",defaultMessage:"SAML SSO Configuration",description:"Modal title indicating the content is about configuring SAML settings."})),n()(ii.Z,{isSmall:!0,style:c.centeredCaption,isMultiline:!0},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.byline",defaultMessage:"Configure SAML SSO for your Notion workspace with your Identity Provider (IDP). <guidelink>Learn more</guidelink>.",description:"Label explaining what to do with the Assertion Consumer Service (ACS) URL.",values:{guidelink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(va.Z,{href:(0,R.UY)("guides.samlSettings"),external:!0},void 0,t)}}})),n()(ii.Z,{style:c.subtitle},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsTitle",defaultMessage:"Assertion Consumer Service (ACS) URL",description:"Label indicating the URL below is the Assertion Consumer Service (ACS) URL."})),n()(ii.Z,{isSmall:!0,style:c.caption,isMultiline:!0},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsByline",defaultMessage:"Enter this in your IDP's SAML configuration.",description:"Label explaining what to do with the Assertion Consumer Service (ACS) URL."})),n()("div",{style:c.readonlyInput},void 0,n()(ii.Z,{style:c.url},void 0,f),n()(ei.Z,{onClick:S,style:c.copyButton},void 0,h.Z.copy(c.copyIcon),n()(y.FormattedMessage,{id:"verifyDomainModal.editSamlConfig.copy",defaultMessage:"Copy",description:"Button for copying the SSO URL."}))),n()(ii.Z,{style:c.subtitle},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpTitle",defaultMessage:"Identity Provider Details",description:"Label indicating the fields below are for the IDP details."})),n()(ii.Z,{isSmall:!0,style:c.caption},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrlByline",defaultMessage:"Enter the value provided by your IDP.",description:"Label explaining what to do with the IDP SAML URL."})),n()("div",{style:c.radioContainer},void 0,n()(ut.Z,{style:c.radioOption,onClick:M},void 0,n()(us.Z,{isSelected:"url"===r.active}),n()(ii.Z,{},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrl",defaultMessage:"Identity Provider URL",description:"Describes the value of this button to be for the IDP URL"}))),n()(ut.Z,{style:c.radioOption,onClick:b},void 0,n()(us.Z,{isSelected:"xml"===r.active}),n()(ii.Z,{},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpXml",defaultMessage:"Identity Provider Metadata XML",description:"Describes the value of this button to be for the IDP XML"})))),m().createElement(tt.Z,C),n()("div",{style:c.feedback},void 0,n()(gs,{validation:p})),n()("div",{style:c.buttonContainer},void 0,n()(Ht.Z,{isLarge:!0,style:c.buttonSpacing,onClick:o},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.cancel",defaultMessage:"Cancel",description:"Button that cancels changes"})),n()(xe.Z,{isLarge:!0,disabled:"invalid"===p.type,onClick:T},void 0,n()(y.FormattedMessage,g?{id:"identityAndProvisioning.editSamlConfig.enableSaml",defaultMessage:"Enable SAML",description:"Button that saves changes and enables SAML"}:{id:"identityAndProvisioning.editSamlConfig.saveChanges",defaultMessage:"Save changes",description:"Button that saves changes"}))))}function gs(e){let t,{validation:i}=e;if("valid"===i.type)return null;switch(i.reason){case"empty":t=n()(y.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.empty",defaultMessage:"You cannot leave this field blank",description:"Feedback message explaining this field cannot be left blank."});break;case"signed_request":t=n()(y.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.signed_request",defaultMessage:"Requests cannot be signed",description:"Feedback message explaining the WantAuthnRequestsSigned property must be set to false"})}return m().createElement(m().Fragment,null,h.Z.warning({height:16,width:16,margin:"0 4px 0 8px"}),n()("span",{},void 0,t))}function hs(e){return"url"===e.active?(0,cs.jY)(e.url):"xml"===e.active?(0,cs.a7)(e.xml):void(0,W.t1)(e.active)}function fs(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:a,isSamlStatusEnabled:s,promptUpgrade:o,disabled:r}=e;const[l,d]=(0,u.useState)({isOpened:!1,enableSamlOnSave:!1}),{updateStatus:c,updateSamlIdpUrl:p,updateSamlIdpXml:g}=os({samlConfigStore:i,spaceStore:t}),{verifiedDomains:h}=qn({spaceStore:t,samlConfigStore:i,domainSettingsStore:a}),f=(0,Yt.y)((()=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",cursor:r?"default":"pointer"},settingTitle:{fontWeight:v.Z.fontWeight.medium},settingByline:{marginBottom:4},configButton:{marginTop:14,opacity:r?.5:1}})),[r]),S=n()(y.FormattedMessage,{id:"identityAndProvisioning.samlToggle.title",defaultMessage:"Enable SAML SSO",description:"Title describing how the content in this section is for verified email domains."}),M=n()(y.FormattedMessage,{id:"identityAndProvisioning.samlToggle.byline",defaultMessage:"Anyone using email addresses with a verified domain can log in via SAML SSO.",description:"Byline describing how enabling SAML will use verified email domains for SSO."});return o?n()(Qn,{title:S,byline:M}):m().createElement(m().Fragment,null,n()(ss,{title:S,byline:M,isOn:s,disabled:r,tooltipForDisabled:0===h.length?n()(y.FormattedMessage,{id:"identityAndProvisioning.samlToggle.disabledTooltipNoVerifiedDomains",defaultMessage:"Verify a domain to enable SAML.",description:"Tooltip explaining that SAML configuration is disabled if there are no verified domains."}):void 0,onToggle:function(){if(r)return;const{useMetadataUrl:e,idpMetadata:t,idpMetadataUrl:a}=i.state,n=e&&a||!e&&t;switch(i.state.status){case"disabled":n?c("configured"):d({isOpened:!0,enableSamlOnSave:!0});break;case"unconfigured":d({isOpened:!0,enableSamlOnSave:!0});break;case"configured":case"enforced":c("disabled")}}}),n()(Ht.Z,{disabled:r,isLarge:!0,style:f.configButton,onClick:function(){r||d({isOpened:!0,enableSamlOnSave:!1})}},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.samlToggle.configure",defaultMessage:"Edit SAML SSO configuration",description:"Button for opening the modal that allows the user to configure their SSO configuration."})),n()(ms,{isOpen:l.isOpened,onClose:()=>d({isOpened:!1,enableSamlOnSave:!1}),onSaveChanges:async function(e){if("invalid"===hs(e).type)return;let t=!1;switch(e.active){case"url":t=await p(e.url);break;case"xml":t=await g(e.xml)}t&&(l.enableSamlOnSave&&await c("configured"),d({isOpened:!1,enableSamlOnSave:!1}))},spaceStore:t,samlConfigStore:i}))}var vs=i(39634),ys=(i(65069),i(40394));const Ss={id:"name",headerTitle:n()(y.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name",description:"Title of the 'Name' column in the secondary workspaces table.",defaultMessage:"Name"}),renderCell:e=>n()(ii.Z,{},void 0,e.space.name),widthData:{width:50},sortable:!0},Ms={id:"memberCount",headerTitle:n()(y.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.memberCount",description:"Title of the 'Members' column in the secondary workspaces table.",defaultMessage:"Members"}),renderCell:e=>n()(ii.Z,{},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.members",description:"Describes how many members are in the row.",defaultMessage:"{count} members",values:{count:e.space.memberCount}})),widthData:{width:20},sortable:!0},bs={id:"createdAt",headerTitle:n()(y.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.plan",description:"Title of the 'Created At' column in the secondary workspaces table.",defaultMessage:"Created at"}),renderCell:e=>n()(ii.Z,{},void 0,Pn()(e.space.createdTime).format("MMM D, YYYY")),widthData:{width:20},sortable:!0},ws=[Ss,Ms,bs];function Cs(e){let{spaces:t}=e;const[i,a]=(0,u.useState)({column:Ss,sortAscending:!1}),s=t.map((e=>({id:e.id,isClickable:!1,space:e}))),o=(0,Yt.y)((e=>(0,ys.b)({columnRenderInfo:ws,theme:e,containerMarginTop:12})),[]);return n()(ys.D,{hideHeaderRowPadding:!0,columnRenderInfo:ws,rows:Ts(s,i),sortState:i,onSortStateChanged:a,renderNoRowsComponent:()=>n()(ii.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"}},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces.",description:"Message displayed on the table that shows linked workspaces if there are no workspaces to show."})),styles:o})}function Ts(e,t){let{column:i,sortAscending:a}=t,n=[];switch(i.id){case"name":n=c().sortBy(e,(e=>e.space.name));break;case"createdAt":n=c().sortBy(e,(e=>e.space.createdTime));break;case"memberCount":n=c().sortBy(e,(e=>e.space.memberCount))}return a?n:n.reverse()}function ks(e){let{spaceStore:t,spaceIds:i}=e;const a=(0,ye.O7)(),s=(0,Yt.y)((()=>({settingContainer:{margin:"18px 0"}})),[]),o=(0,Se.VK)((()=>i.map((e=>Gn.Z.getPublicSpaceData(a,e)||void 0)).filter(W.$K)),[i,a]),r=(0,u.useCallback)((()=>{vs.j({environment:a,from:"saml_settings",prepopulatedContent:"Request to add or remove a workspace for SAML Single Sign-on on workspace ".concat(t.id,".")})}),[t,a]);return n()("div",{style:s.settingContainer},void 0,n()(Kn,{title:n()(y.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.title",defaultMessage:"Linked workspaces",description:"Title describing that this section contains linked workspaces."}),byline:n()(y.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.message",defaultMessage:"This SAML SSO configuration applies to the following other workspaces. <contactlink>Contact support</contactlink> to add or remove a workspace.",description:"Describes that the SSO configuration on this page is being applied to the following workspaces.",values:{contactlink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(va.Z,{onClick:r},void 0,t)}}}),settingItem:null}),n()(Cs,{spaces:o}))}function Zs(e){let{spaceStore:t,samlConfigStore:i,domainSettingsStore:a}=e;const{verifiedDomains:s,isSamlAvailable:o,isSamlEditable:r,isSamlStatusEnabled:l}=qn({spaceStore:t,samlConfigStore:i,domainSettingsStore:a}),d=!r||!o||!l,c=(0,Se.VK)((()=>i.state.spaceIds.filter((e=>e!==t.id))),[i,t]);return m().createElement(m().Fragment,null,n()(fa.Z,{title:n()(y.FormattedMessage,{id:"identityAndProvisioning.samlToggle.learnMore",defaultMessage:"Learn about SAML SSO",description:"Button that links to help center that talks about SAML SSO."}),href:(0,R.UY)("guides.samlSettings"),style:{marginTop:18,marginBottom:16},analyticsFrom:"saml_settings"}),n()(fs,{disabled:!r||0===s.length,promptUpgrade:!o,isSamlStatusEnabled:l,spaceStore:t,samlConfigStore:i,domainSettingsStore:a}),n()(ls,{disabled:d,spaceStore:t,samlConfigStore:i}),n()(rs,{disabled:d,spaceStore:t,samlConfigStore:i}),n()(ks,{spaceStore:t,spaceIds:c}))}const As=(0,y.defineMessages)({failedCreatingNewScimToken:{id:"scimTokenSettings.error.failedCreatingNewScimToken",defaultMessage:"Failed to create a new SCIM token, please try again later.",description:"The error message shown when a SCIM token cannot be created."}});function Is(e){const[t,i]=(0,u.useState)(!1),a=(0,ye.O7)();const s=!t&&"Able"===e.tokenCreationAbility,r=t||"Able"!==e.tokenCreationAbility,l=n()(ut.Z,{isBlue:s,isLightGray:r,disabled:r,style:{position:"relative",marginLeft:"auto",marginRight:0},icon:e=>h.Z.plus({...e,width:14,height:14,fill:"inherit",marginRight:"6px"}),onClick:async function(){i(!0);try{const t=await async function(e){let{environment:t,spaceStore:i,userStore:a}=e;const{botStore:n,transactionPromise:s}=(0,ea.bf)({environment:t,spaceStore:i,name:"SCIM",userId:a.id,spaceRole:"editor",type:"scim"});return await s,n.id}({...e,environment:a});e.onNewScimToken(t)}catch(t){C.showErrorMessage(Ce.default.formatMessage(As.failedCreatingNewScimToken))}i(!1)}},void 0,n()(y.FormattedMessage,{id:"scimTokenSettings.NewSCIMTokenButton.title",defaultMessage:"Add token",description:"Button to create a new SCIM token."}));let d;switch(e.tokenCreationAbility){case"Able":return l;case"Undefined":d=n()(y.FormattedMessage,{defaultMessage:"Not able to create a new SCIM token right now. Please try again later.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.undefined",description:"Message shown when the user cannot create a new SCIM token just yet. We might be waiting to hear back from the server and update the status."});break;case"SpaceHasExistingToken":d=n()(y.FormattedMessage,{defaultMessage:"To create a new SCIM token, please revoke the existing token.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.spaceHasLegacyToken",description:"Message shown when the user cannot create a new SCIM token because an existing one is present. They must first revoke that token to create a new one."});break;case"UserHasExistingToken":d=n()(y.FormattedMessage,{defaultMessage:"You already have a registered SCIM token. To create a new one, please revoke the token created by you.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.userHasExistingToken",description:"Message shown when the user already has a new SCIM token, and cannot create another one."});break;default:(0,W.t1)(e.tokenCreationAbility)}return n()(Le.Z,{textWrap:!1,renderTooltip:()=>d,placement:Le.Z.Placement.Right,render:e=>m().createElement("div",o()({},e,{style:{paddingLeft:"4px"}}),l)})}function Ps(e){let{userId:t,currentSpaceStore:i}=e;return yt.Z.createChildStore(i,{table:be.KJ,id:t})}const _s={container:{display:"flex",alignItems:"center",fontSize:v.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},userName:{flexShrink:1,...v.Z.textOverflowStyle}};function xs(e){let{userStore:t,componentAfterName:i}=e;const a=(0,y.useIntl)(),s=(0,Se.VK)((()=>null==t?void 0:t.getValue()),[t]),o=(0,Se.VK)((()=>{if(s)return(0,be.Nz)(a,s)}),[s,a]);return n()("div",{style:_s.container},void 0,n()(pn.Z,{style:_s.userAvatar,avatarShouldShowShadow:!0,userValue:s,size:20}),n()("div",{style:_s.userName},void 0,o),i)}var Fs=i(33058);function Bs(e,t){return e.created_by_table===be.KJ&&e.created_by_id===(null==t?void 0:t.id)}const Es={buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,height:20,width:20,marginRight:1},menuItemButton:{minWidth:200}};function Ds(e){let{onRevokeToken:t}=e;const i=(0,Yt.F)();return m().createElement(m().Fragment,null,n()(Le.Z,{textWrap:!1,renderTooltip:()=>m().createElement(m().Fragment,null,n()(y.FormattedMessage,{defaultMessage:"Revoke this token.",id:"revokeTokenButton.tooltip"})),placement:Le.Z.Placement.Right,render:e=>n()(qe.Z,{popupType:qe.Z.PopupType.Popup,placementToOrigin:qe.Z.Placement.Right,renderOrigin:t=>m().createElement(ei.Z,o()({className:B.TA,style:Es.buttonStyle,mobileFeedback:!1},e,t),h.Z.trash({fill:i.mediumIconColor,width:12,height:12})),onClick:()=>{C.confirmUserAction({message:n()(y.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.message",defaultMessage:"Are you sure you want to revoke this token?",description:"Title of the modal asking admin users if they want to revoke a SCIM token."}),description:n()(y.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.description",defaultMessage:"Existing SCIM configurations that use this token will no longer work once the token is revoked, and you'll have to provide them with a new token.",description:"Body of the modal asking admin users if they want to revoke a SCIM token, and explaining that integrations that use the token will only work again once a new token is generated and provided to the integration."}),acceptLabel:n()(y.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.acceptButton.label",defaultMessage:"Revoke token",description:"Button confirming that the SCIM token will be revoked."}),cancelLabel:n()(y.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.cancelButton.label",defaultMessage:"Cancel",description:"Button cancelling the action of deleting a SCIM token."})}).then((e=>e&&t()))},render:e=>(e.close(),m().createElement(m().Fragment,null))})}))}const Rs=()=>{const e=(0,Yt.F)();return n()(Le.Z,{textWrap:!1,renderTooltip:()=>m().createElement(m().Fragment,null,n()(y.FormattedMessage,{defaultMessage:"Outdated token. Revoke this token and generate a new one to view its contents.",id:"manageScimTokenTable.OutdatedWarningIcon.tooltip"})),placement:Le.Z.Placement.Right,render:t=>m().createElement("div",o()({},t,{style:{paddingLeft:"4px"}}),h.Z.warning({fill:(0,g.fi)("orange",e).fill,width:12,height:12}))})};function Ls(e){let{clipboardTextFn:t}=e;const i=(0,ye.O7)();const a=(0,Yt.F)(),s={height:25,background:a.whiteButtonBackground,color:a.regularTextColor,fontWeight:v.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5};return n()(Fs.Z,{onClick:async function(){const e=await t();void 0!==e&&Xt.RD({environment:i,stringValue:e,copiedMessage:Xt.tq.copiedTokenToClipboard,showCopyModal:!!i.device.isSafari||void 0})},style:s},void 0,h.Z.copy({height:16,width:16,paddingRight:4}),n()(y.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"}))}const Os="•••••••••••";function Ns(){return n()(Le.Z,{textWrap:!1,renderTooltip:()=>n()(y.FormattedMessage,{defaultMessage:"This token can only be viewed by its creator.",id:"manageScimTokenTable.renderTokenThatCannotBeViewed.tooltip"}),placement:Le.Z.Placement.Right,render:e=>m().createElement("div",e,Os)})}function Us(e){let{row:t}=e;const i=(0,ye.O7)();return t.legacy?m().createElement(m().Fragment,null,Os,n()(Rs,{})):t.ownedByCurrentUser?m().createElement(m().Fragment,null,Os,n()(Ls,{clipboardTextFn:()=>(0,ea.VG)({environment:i,botId:t.id})})):n()(Ns,{})}const Ws={id:"token",headerTitle:n()(y.FormattedMessage,{id:"manageScimTokenTable.columnTitle.token",description:"Title of the 'Token' column in the manage SCIM token table.",defaultMessage:"Token"}),renderCell:e=>n()(Us,{row:e}),widthData:{width:40},sortable:!1,hasClickableContents:!0},Vs=()=>{const e=_s;return n()(Le.Z,{textWrap:!1,renderTooltip:()=>n()(y.FormattedMessage,{defaultMessage:"This token was created by a user who is no longer an admin in the workspace.",id:"scimTableLegacyUserCell.tooltip"}),placement:Le.Z.Placement.Right,render:t=>m().createElement("div",t,n()("div",{style:e.container},void 0,n()(pn.Z,{style:e.userAvatar,avatarShouldShowShadow:!0,size:20}),n()("div",{style:e.userName},void 0,n()("i",{},void 0,"Deactivated user"))))})},zs={id:"addedBy",headerTitle:n()(y.FormattedMessage,{id:"manageScimTokenTable.columnTitle.addedBy",description:"Title of the 'Added by' column in the manage SCIM token table.",defaultMessage:"Added by"}),renderCell:e=>{if(e.legacy)return n()(Vs,{});{const t=e.ownedByCurrentUser?n()(ii.Z,{isSecondaryColor:!0,style:{marginLeft:4,textAlign:"center"}},void 0,n()(y.FormattedMessage,{id:"manageSCIMTokenTable.colums.addedBy.selfIndicator",defaultMessage:"(you)",description:"Displayed next to a user's name to indicate they're the user who generated a SCIM token. Example: John Doe (you)"})):m().createElement(m().Fragment,null);return n()(xs,{userStore:e.ownerUserStore,componentAfterName:t})}},widthData:{width:40},sortable:!1,hasClickableContents:!1},Gs={id:"created",headerTitle:n()(y.FormattedMessage,{id:"manageScimTokenTable.columnTitle.created",description:"Title of the 'Created' (i.e. when it was created) column in the manage SCIM token table.",defaultMessage:"Created"}),renderCell:e=>m().createElement(m().Fragment,null,(0,Tt.default)(e.createdAt).locale(e.userLocale).format(U.YF)),widthData:{width:40},sortable:!0,hasClickableContents:!1},Hs=[Ws,zs,Gs,{id:"revokeToken",headerTitle:void 0,renderCell:e=>n()(Ds,{onRevokeToken:()=>{e.onRevokeToken()}}),widthData:{width:10},sortable:!1,hasClickableContents:!0}];function qs(e,t){let{column:i,sortAscending:a}=t;const n=null==i?void 0:i.id;let s=e=>e.id;switch(n){case"name":s=e=>e.name;break;case"created":s=e=>e.createdAt;break;case"token":case"addedBy":case"revokeToken":case void 0:break;default:(0,W.t1)(n)}const o=c().sortBy(e,s);return a||o.reverse(),o}function Ks(e){let{botStores:t,onRevokeToken:i}=e;const[{currentUserStore:a,currentSpaceStore:s}]=(0,Se.oR)(Z.default),o=(0,y.useIntl)(),r=(0,Se.VK)((()=>{if(!s)return[];const e=null==a?void 0:a.getValue();return c().compact(t.map((t=>{const a=t.getValue();if(!a||!(0,ln.xe)(a))return;const n={id:a.id,isClickable:!1,createdAt:a.created_at,userLocale:o.locale,name:a.name,onRevokeToken:()=>{i(a.id)}},r="notion_user"===(l=a).created_by_table&&l.created_by_id===be.s$.id;var l;return r?{...n,legacy:r}:{...n,legacy:r,ownedByCurrentUser:Bs(a,e),ownerUserStore:"notion_user"===a.created_by_table?Ps({userId:a.created_by_id,currentSpaceStore:s}):void 0}})))}),[t,s,a,o.locale,i]),[l,d]=(0,u.useState)({column:Gs,sortAscending:!1}),p=(0,Yt.y)((e=>(0,ys.b)({columnRenderInfo:Hs,theme:e,containerMarginTop:0})),[]);return n()(ys.D,{columnRenderInfo:Hs,rows:qs(r,l),sortState:l,onSortStateChanged:d,onRowClick:()=>m().createElement(m().Fragment,null),renderNoRowsComponent:()=>n()(ii.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"}},void 0,n()(y.FormattedMessage,{id:"manageSCIMTokenTable.noTokensFound.message",defaultMessage:"No active SCIM tokens.",description:"Message displayed on the table that shows SCIM tokens if there are no active tokens."})),styles:p})}async function js(e){let{environment:t,spaceId:i}=e;return(await(0,ea.Yw)({environment:t,table:mi.bx,id:i,type:"scim"})).botIds}const Ys=function(e){let{botIds:t,setBotIds:i,spaceStore:a}=e;const s=(0,ye.O7)(),o=a.id;if((0,u.useEffect)((()=>{void 0===t&&js({environment:s,spaceId:o}).then(i)}),[t,s,i,o]),t){const e=t.map((e=>(0,vt.Kv)(a,{table:Me.cZ,id:e,spaceId:o})));return n()(Ks,{botStores:e,onRevokeToken:e=>{(0,ea.P0)({environment:s,botId:e,onSuccess:()=>{js({environment:s,spaceId:o}).then(i)}})}})}return n()(ya.Z,{})};var Qs=i(84619),Js=i(89101),Xs=i(5851),$s=i(33689),eo=i(78454),to=i(5478),io=i(85567),ao=i(719),no=i(69435);class so extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{tokenOptionsButtonPopupStore:cn.Z,domainVerificationStore:Xn.ZP}),l()(this,"removeDomainVerification",(async e=>{switch(e.type){case"verified":this.removeEmailDomainFromSAMLConfig(e.domain),await this.saveSamlConfig(),this.props.securitySettingsStore.state.error&&C.showError(this.props.securitySettingsStore.state.error);break;case"unverified":case"invalid":{const t=await w.deleteDomainVerificationCode(this.environment,{id:e.id});"success"===t.type?await me({environment:this.environment,spaceId:this.props.spaceStore.id,store:this.props.samlConfigStore}):"failed"===t.type&&C.showErrorMessage(t.error.message);break}}})),l()(this,"handleDisablePublicAccessSwitcherClick",(async()=>{const{securitySettingsStore:e}=this.props,t=e.state.disablePublicAccess;if(!t){if(!(await C.confirmUserAction({message:n()(y.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.message",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this workspace."}),acceptLabel:n()(y.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return}e.setState({...e.state,disablePublicAccess:!t})})),l()(this,"handleAllowDisableGuestsSwitcherClick",(async()=>{const{securitySettingsStore:e}=this.props,t=e.state.disableGuests;if(!t){if(!(await C.confirmUserAction({message:n()(y.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.message",defaultMessage:"Are you sure? All guests in this workspace will be removed."}),acceptLabel:n()(y.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return}e.setState({...e.state,disableGuests:!t})})),l()(this,"handleDisableMoveToSwitcherClick",(()=>{const{securitySettingsStore:e}=this.props;e.setState({...e.state,disableMoveToSpace:!e.state.disableMoveToSpace})})),l()(this,"handleAllowDisableWorkspaceTopLevelSwitcherClick",(()=>{const{securitySettingsStore:e}=this.props;e.setState({...e.state,disableSpacePageEdits:!e.state.disableSpacePageEdits})})),l()(this,"handleDisableExportClick",(()=>{const{securitySettingsStore:e}=this.props;e.setState({...e.state,disableExport:!e.state.disableExport})})),l()(this,"handleDisablePublicAccessRequestsClick",(()=>{const{securitySettingsStore:e}=this.props;e.setState({...e.state,disablePublicAccessRequests:!e.state.disablePublicAccessRequests})})),l()(this,"handleUpdateClick",(async()=>{const[,,e]=await Promise.all([Xs.n(this.environment,{securitySettingsState:this.props.securitySettingsStore.state,spaceStore:this.props.spaceStore}),this.saveSamlConfig(),this.saveWorkspaceCreationSetting()]);this.props.securitySettingsStore.state.error?C.showError(this.props.securitySettingsStore.state.error):"failed"===(null==e?void 0:e.type)?C.showError(e):this.closeSettings()})),l()(this,"handleCancelClick",(()=>{this.closeSettings()})),l()(this,"handleEnableSamlToggle",(()=>{if(!this.isSamlEditable())return;const{state:e}=this.props.samlConfigStore,t=!this.isInvalidSamlConfig(e);"unconfigured"===e.status||"disabled"===e.status?t&&this.props.samlConfigStore.setState({...e,status:"configured"}):this.props.samlConfigStore.setState({...e,status:t?"disabled":"unconfigured"})})),l()(this,"handleIdpMetadataUrlChange",(e=>{this.props.samlConfigStore.setState({...this.props.samlConfigStore.state,idpMetadataUrl:e.target.value})})),l()(this,"handleIdpMetadataUrlBlur",(e=>{Boolean(e.target.value)&&this.setUseMetadataUrl(!0)})),l()(this,"handleIdpMetadataChange",(e=>{this.props.samlConfigStore.setState({...this.props.samlConfigStore.state,idpMetadata:e.target.value})})),l()(this,"handleIdpMetadataBlur",(e=>{Boolean(e.target.value)&&this.setUseMetadataUrl(!1)})),l()(this,"handleEnforceSamlToggle",(()=>{const{state:e}=this.props.samlConfigStore;this.isSamlEditable()&&("enforced"===e.status?this.props.samlConfigStore.setState({...e,status:"configured"}):"configured"!==e.status||this.isInvalidSamlConfig(e)||this.props.samlConfigStore.setState({...e,status:"enforced"}))})),l()(this,"handleCreateAccountToggle",(()=>{const{state:e}=this.props.samlConfigStore;this.isSamlEditable()&&this.props.samlConfigStore.setState({...e,createAccount:!e.createAccount})})),l()(this,"handleEmailDomainContactUsClick",(()=>{vs.j({environment:this.environment,from:"saml_settings",prepopulatedContent:"Request to add or change an email domain for SAML Single Sign-on on workspace ".concat(this.props.spaceStore.id,".")})})),l()(this,"handleWorkspaceContactUsClick",(()=>{vs.j({environment:this.environment,from:"saml_settings",prepopulatedContent:"Request to add or remove a workspace for SAML Single Sign-on on workspace ".concat(this.props.spaceStore.id,".")})})),l()(this,"handleUpgradeClick",(()=>{jn.y(this.environment,{from:"space_saml",for:"enterprise"})})),l()(this,"setUseMetadataUrl",(e=>{this.props.samlConfigStore.setState({...this.props.samlConfigStore.state,useMetadataUrl:e})}))}renderComponent(){if(!ra.Z.state.online)return this.renderOfflineMessage();return"on"===ie.default.getEligibleGroup({experimentId:"split_identity_provisioning",defaultGroup:"unassigned"})?n()(ba.Z,{},void 0,this.renderSecuritySettings()):n()(ba.Z,{controlRow:this.renderControlRow()},void 0,this.renderSecuritySettings(),this.renderSamlSettings(),this.renderScimSettings(),this.renderSetupInformationSettings())}renderUpsell(){if(!(0,$s.J)({environment:this.environment}))return n()("div",{style:{border:"1px solid ".concat(this.theme.regularDividerColor),borderRadius:3,padding:16,marginTop:(0,D.uT)(this.environment)?void 0:24,marginBottom:24}},void 0,n()(no.Z,{for:"enterprise",from:"space_saml",icon:h.Z.key,title:n()(y.FormattedMessage,{id:"securitySAMLSettings.upsell.title",defaultMessage:"Upgrade for advanced security, SAML & SCIM"}),caption:n()(y.FormattedMessage,{id:"securitySAMLSettings.upsell.caption",defaultMessage:"Upgrade to the Enterprise Plan for advanced security settings, SAML single sign-on, and automated user and group provisioning."}),learnMoreRoute:"guides.securitySettings"}))}renderSecuritySettings(){const{securitySettingsStore:e}=this.props,t=.5,i=n()(Yn.Z,{subscriptionTier:"enterprise",analyticsName:"space_saml",onClick:this.handleUpgradeClick,desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),a=a=>n()("div",{},void 0,n()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:a?this.handleDisablePublicAccessSwitcherClick:this.handleUpgradeClick},void 0,n()("div",{style:this.getTitleStyle()},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.label",defaultMessage:"Disable public page sharing"}),!a&&i,n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.caption",defaultMessage:"Disable the Share to web option in the Share menu on every page in this workspace."}))),n()("div",{style:{marginTop:5,opacity:a?void 0:t}},void 0,n()(ns.Z,{on:e.state.disablePublicAccess,disabled:!a}))),n()(pa.Z,{size:24,style:{opacity:0}})),s=a=>{if(!(0,O.bq)())return n()("div",{},void 0,n()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:a?this.handleAllowDisableWorkspaceTopLevelSwitcherClick:this.handleUpgradeClick},void 0,n()("div",{style:this.getTitleStyle()},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.label",defaultMessage:"Prevent members from editing the Workspace section"}),!a&&i,n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"}},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.caption",defaultMessage:"Disable the ability for members to create, move, reorder, and delete top-level Workspace pages."}))),n()("div",{style:{marginTop:5,opacity:a?void 0:t}},void 0,n()(ns.Z,{on:e.state.disableSpacePageEdits,disabled:!a}))),n()(pa.Z,{size:24,style:{opacity:0}}))},o=a=>n()("div",{},void 0,n()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:a?this.handleAllowDisableGuestsSwitcherClick:this.handleUpgradeClick},void 0,n()("div",{style:this.getTitleStyle()},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.label",defaultMessage:"Disable guests"}),!a&&i,n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.caption",defaultMessage:"Prevent anyone from inviting people outside the workspace to pages."}))),n()("div",{style:{marginTop:5,opacity:a?void 0:t}},void 0,n()(ns.Z,{on:e.state.disableGuests,disabled:!a}))),n()(pa.Z,{size:24,style:{opacity:0}})),r=a=>n()("div",{},void 0,n()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:a?this.handleDisableMoveToSwitcherClick:this.handleUpgradeClick},void 0,n()("div",{style:this.getTitleStyle()},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.label",defaultMessage:"Disable moving or duplicating pages to other workspaces"}),!a&&i,n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.caption",defaultMessage:"Prevent anyone from moving or duplicating pages to other workspaces via the Move To or Duplicate To actions."}))),n()("div",{style:{marginTop:5,opacity:a?void 0:t}},void 0,n()(ns.Z,{on:e.state.disableMoveToSpace,disabled:!a}))),n()(pa.Z,{size:24,style:{opacity:0}})),{state:l}=e,d=a=>n()("div",{},void 0,n()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:a?this.handleDisableExportClick:this.handleUpgradeClick},void 0,n()("div",{style:this.getTitleStyle()},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.label",defaultMessage:"Disable export"}),!a&&i,n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.caption",defaultMessage:"Prevent anyone from exporting as Markdown, CSV, or PDF."}))),n()("div",{style:{marginTop:5,opacity:a?void 0:t}},void 0,n()(ns.Z,{on:e.state.disableExport,disabled:!a}))),n()(pa.Z,{size:24,style:{opacity:0}}));const c=e=>{(0,D.uT)(this.environment)};return(0,$s.J)({environment:this.environment})?n()(u.Fragment,{},void 0,n()(qt.Z,{large:!0,divider:"full"},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"})),c(),a(!0),s(!0),o(!0),r(!0),d(!0),n()("div",{style:{height:36}})):n()(u.Fragment,{},void 0,this.renderUpsell(),n()("div",{style:this.getHeaderStyle()},void 0,n()("span",{style:{marginRight:8}},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"}))),c(),a(l.disablePublicAccess),s(l.disableSpacePageEdits),o(l.disableGuests),r(l.disableMoveToSpace),d(l.disableExport),n()("div",{style:{height:32}}))}renderSamlSettings(){return n()(Sa.Z,{request:{environment:this.environment,spaceId:this.props.spaceStore.id,samlStore:this.props.samlConfigStore,domainSettingsStore:this.props.domainSettingsStore},performRequest:this.requestSamlSectionData,render:(e,t,i)=>i?t&&!e?this.isSamlAvailable()?this.renderSamlConfig():this.renderUpgradeSamlPrompt():void 0:n()(ya.Z,{})})}async requestSamlSectionData(e){const{environment:t,spaceId:i,samlStore:a,domainSettingsStore:n}=e,[s,o]=await Promise.all([me({environment:t,spaceId:i,store:a}),n.updateValueForSpace({environment:t,spaceId:i,store:n})]);return{samlResponse:s,domainResponse:o}}renderSamlHelp(){return n()("div",{style:{marginTop:18,marginBottom:24}},void 0,n()(fa.Z,{title:n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSection.helpButton.label",defaultMessage:"Learn about SAML and single sign-on"}),href:(0,R.UY)("guides.samlSettings"),analyticsFrom:"saml_settings"}))}renderSamlUneditable(e){if(this.isSamlEditable()||!e)return;const t=Gn.Z.getPublicSpaceData(this.environment,e);return t?n()("div",{style:{marginBottom:24}},void 0,n()(ii.Z,{isMultiline:!0},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSection.uneditableMessage",defaultMessage:"SAML is being managed by the workspace <bold>{workspaceName}</bold>. Please go there to change any SAML settings.",values:{workspaceName:t.name,bold:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("span",{style:{fontWeight:v.Z.fontWeight.semibold}},void 0,t)}}}))):void 0}renderUpgradeSamlPrompt(){return n()("div",{},void 0,n()(u.Fragment,{},void 0,n()("div",{style:this.getHeaderStyle()},void 0,n()("span",{style:{marginRight:8}},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.title",defaultMessage:"SAML single sign-on"})),n()(Yn.Z,{subscriptionTier:"enterprise",analyticsName:"space_saml",onClick:this.handleUpgradeClick,desktopStyle:{marginTop:-1}})),this.renderSamlHelp()))}removeEmailDomainFromSAMLConfig(e){const t=this.props.samlConfigStore.state.emailDomains.filter((t=>t!==e));this.props.samlConfigStore.setState({...this.props.samlConfigStore.state,emailDomains:t})}renderEmailDomains(e){return n()(u.Fragment,{},void 0,n()(qt.Z,{smallMarginBottom:!0},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.emailDomainsSection.title",defaultMessage:"Email domains"})),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{width:"85%",marginBottom:12,marginTop:2}},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.emailDomainsSection.emailInput.captionNoSupportLink",defaultMessage:"Once you enable SAML, anyone using an email address with the domains below will be able to log in using SAML SSO.",description:"Byline describing how enabling SAML will use these email domains for SSO."})),n()($n.ZP,{domains:e,onRemoveDomain:this.removeDomainVerification,domainVerificationStore:this.stores.domainVerificationStore,verificationType:"saml_config",verificationTargetId:this.props.spaceStore.id,refreshDomains:async()=>{await me({environment:this.environment,spaceId:this.props.spaceStore.id,store:this.props.samlConfigStore})},onClickAddDomain:async()=>{await this.saveSamlConfig()}}))}renderWorkspaceCreationDropdown(){const e=this.props.domainSettingsStore.state;if(!e.spaceCreation)return;const t="on"===ie.default.getGroup("show_workspace_owner");return n()("div",{style:{marginTop:16}},void 0,n()(wn.Z,{isMobile:this.environment.device.isMobile,disabled:!this.isDomainSettingsAvailable()||!this.isSamlEditable(),title:n()(y.FormattedMessage,{id:"domainSettings.workspaceCreation.title",defaultMessage:"Workspace creation",description:"Title of workspace creation dropdown"}),caption:n()(y.FormattedMessage,{id:"domainSettings.workspaceCreation.caption",defaultMessage:"Limit workspace creation for your verified domains.",description:"Caption of workspace creation dropdown"}),type:"dropdown",currentOption:e.spaceCreation,options:[{key:"unrestricted",label:n()(y.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.title",defaultMessage:"Anyone",description:"Dropdown option to remove restrictions on workspace creation"})},{key:"admins_only",label:n()(y.FormattedMessage,t?{id:"domainSettings.workspaceCreation.workspaceOwnerOnly.title",defaultMessage:"Only workspace owners",description:"Dropdown option to restrict workspace creation to workspace owners"}:{id:"domainSettings.workspaceCreation.admins_only.title",defaultMessage:"Only admins",description:"Dropdown option to restrict workspace creation to admins"})}],onSelectOption:e=>this.updateWorkspaceCreation(e)}))}updateWorkspaceCreation(e){this.props.domainSettingsStore.setState({...this.props.domainSettingsStore.state,spaceCreation:e})}renderSpaceNames(e){var t=this;if(!this.isSamlEditable())return;const i=e.map((e=>Gn.Z.getPublicSpaceData(this.environment,e))).filter((e=>Boolean(e)));return i.length<=1?void 0:n()(u.Fragment,{},void 0,n()(qt.Z,{smallMarginBottom:!0},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.spaceNamesSection.title",defaultMessage:"Workspaces"})),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{...so.captionStyle,marginBottom:12,marginTop:2}},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.spaceNamesSection.spaceNameInput.caption",defaultMessage:"The SAML settings here apply to multiple workspaces. <contactlink>Contact support</contactlink> to add or remove a workspace.",values:{contactlink:function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return n()(va.Z,{onClick:t.handleWorkspaceContactUsClick},void 0,i)}}})),n()("div",{style:{height:32}},void 0,n()(ao.Z,{placeholder:"",value:"",onChange:()=>{},onRemoveLastToken:()=>{},readOnly:!0,tokens:i.map((e=>n()(io.Z,{showRemoveButton:!1,isSingle:!1,format:Qs.l.Medium,value:e.name},e.id)))})),n()(pa.Z,{size:40}))}renderSingleSignOnUrl(){const e=(0,cs.v9)(this.props.spaceStore.id,Gt.Z.domainBaseUrl);return n()(u.Fragment,{},void 0,n()(qt.Z,{},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.title",defaultMessage:"Single sign-on URL"})),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{...so.captionStyle,marginTop:2}},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.url.caption",defaultMessage:"Enter this in your Identity Provider's SAML configuration."})),n()("div",{},void 0,n()("div",{style:{display:"flex",alignItems:"flex-start",marginTop:12,marginBottom:6}},void 0,n()(tt.Z,{type:"text",format:tt.B.Default,value:e,disabled:!0,style:{borderTopRightRadius:0,borderBottomRightRadius:0,width:"calc(100% - 90px)",height:32}}),n()(xe.Z,{onClick:()=>{Xt.RD({environment:this.environment,stringValue:e,copiedMessage:Xt.tq.copiedLinkToClipboard})},style:{borderTopLeftRadius:0,borderBottomLeftRadius:0},isLarge:!0},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.url.tooltip",defaultMessage:"Copy link"})))))}renderSetupInformation(){const e=(e,t)=>n()(Le.Z,{delayThreshold:0,renderTooltip:()=>t,render:t=>m().createElement(va.Z,o()({onClick:()=>{Xt.RD({environment:this.environment,stringValue:e,copiedMessage:Xt.tq.copiedPropertyToClipboard})}},t),e)}),t="enterprise"===L.CM(this.environment),i={...so.captionStyle,whiteSpace:"nowrap"};return n()("div",{style:{paddingTop:8,display:"flex",gap:20}},void 0,n()("div",{},void 0,n()(ii.Z,{isSmall:!0,isMultiline:!0,style:i},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.workspaceId",defaultMessage:"Workspace ID",description:"Label next to copy workspace ID button"})),t&&m().createElement(m().Fragment,null,n()("div",{style:{paddingTop:6}}),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:i},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl",defaultMessage:"SCIM base URL",description:"Label next to copy scim base URL button"})),n()("div",{style:{paddingTop:8}}),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:i},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityID",defaultMessage:"SSO/SAML Entity ID",description:"Label next to copy saml/sso entity ID button"})))),n()("div",{style:{flexGrow:1}},void 0,n()(ii.Z,{isSmall:!0,isMultiline:!0,style:so.captionStyle},void 0,e(this.props.spaceStore.id,this.props.intl.formatMessage({id:"securitySAMLSettings.SetupInformationSection.workspaceId.copyTooltip",defaultMessage:"Click to copy ID",description:"Tooltip shown when hovering on copy workspace button"}))),t&&m().createElement(m().Fragment,null,n()("div",{style:{paddingTop:6}}),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:so.captionStyle},void 0,e(Gt.Z.domainBaseUrl+Js._j.scimApiBasePath,this.props.intl.formatMessage({id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl.copyTooltip",defaultMessage:"Click to copy link",description:"Tooltip shown when hovering on copy scim base URL button"}))),n()("div",{style:{paddingTop:8}}),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:so.captionStyle},void 0,e((0,cs.AE)(Gt.Z.domainBaseUrl),this.props.intl.formatMessage({id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityID.copyTooltip",defaultMessage:"Click to copy link",description:"Tooltip shown when hovering on copy saml/sso entity ID button"}))))))}renderIdpSettings(e){return n()(u.Fragment,{},void 0,n()(ut.Z,{style:this.getRadioTitleStyle(),onClick:e=>{this.setUseMetadataUrl(!0)},disabled:!this.isSamlEditable()},void 0,n()(us.Z,{isSelected:Boolean(e.useMetadataUrl)})," ",n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.IdentityProviderMetadataURLOption.label",defaultMessage:"IDP metadata URL"})),n()("div",{style:{maxWidth:"100%",marginLeft:32}},void 0,n()(tt.Z,{value:e.idpMetadataUrl,onChange:this.handleIdpMetadataUrlChange,onBlur:this.handleIdpMetadataUrlBlur,placeholder:"https://...",style:{height:32},readOnly:!this.isSamlEditable()})),n()(ut.Z,{style:this.getRadioTitleStyle(),onClick:e=>{this.setUseMetadataUrl(!1)},disabled:!this.isSamlEditable()},void 0,n()(us.Z,{isSelected:!e.useMetadataUrl})," ",n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.IdentityProviderMetadataXMLOption.label",defaultMessage:"IDP metadata XML"})),n()("div",{style:{maxWidth:"100%",marginLeft:32}},void 0,n()(tt.Z,{textarea:!0,value:e.idpMetadata,onChange:this.handleIdpMetadataChange,onBlur:this.handleIdpMetadataBlur,placeholder:this.props.intl.formatMessage({id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.IdentityProviderMetadataXMLOption.input.placeholder",defaultMessage:"IDP metadata XML"}),readOnly:!this.isSamlEditable()}),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:so.captionStyle},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.singleSignOnURLSettings.IdentityProviderMetadataXMLOption.caption",defaultMessage:"Enter the value provided by your Identity Provider (IDP)."}))))}renderCreateAccountToggle(e){const t=!this.isSamlEditable();return n()("div",{},void 0,n()(pa.Z,{size:24,style:{marginTop:12}}),n()("div",{style:so.settingOptionStyle(t),onClick:this.handleCreateAccountToggle},void 0,n()("div",{style:this.getTitleStyle()},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.automaticallyCreateAccounts.label",defaultMessage:"Automatically create accounts on sign-in"}),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:so.captionStyle},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.automaticallyCreateAccounts.caption",defaultMessage:"Allow users to create Notion accounts without provisioning from the IDP."}))),n()(ns.Z,{on:e,disabled:t})),n()(pa.Z,{size:24}))}renderEnableSamlToggle(e,t){return n()("div",{},void 0,n()("div",{style:so.settingOptionStyle(t||!this.isSamlEditable()),onClick:this.handleEnableSamlToggle},void 0,n()("div",{style:this.getTitleStyle()},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.enableSAML.label",defaultMessage:"Enable SAML"}),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:so.captionStyle},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.enableSAML.caption",defaultMessage:"This allows users with emails on the configured domains to log in with SAML. SAML authentication can be enforced below."}))),n()("div",{},void 0,t?n()(Le.Z,{delayThreshold:0,renderTooltip:()=>n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.enableSAML.tooltip",defaultMessage:"SAML can be enabled once it is fully configured."}),alignment:eo.v2.End,render:e=>m().createElement("div",e,n()(ns.Z,{on:!1,disabled:!0}))}):n()(ns.Z,{on:"disabled"!==e&&"unconfigured"!==e,disabled:!this.isSamlEditable()}))),n()(pa.Z,{size:24}))}renderEnforceSamlToggle(e,t){return n()("div",{style:so.settingOptionStyle(t||!this.isSamlEditable()),onClick:this.handleEnforceSamlToggle},void 0,n()("div",{style:this.getTitleStyle()},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.enforceSAML.label",defaultMessage:"Enforce SAML"}),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:so.captionStyle},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.enforceSAML.captionMulti",defaultMessage:"Once enforced, workspace members with an email on the domains configured above can only use SAML SSO to log in. Administrator accounts can still log in using email."}))),n()("div",{},void 0,t?n()(Le.Z,{delayThreshold:0,renderTooltip:()=>n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.enforceSAML.tooltip",defaultMessage:"Enable SAML to access this option."}),alignment:eo.v2.End,render:e=>m().createElement("div",e,n()(ns.Z,{on:!1,disabled:!0}))}):n()(ns.Z,{on:"enforced"===e,disabled:!this.isSamlEditable()})))}renderSamlConfig(){const e="on"===ie.default.getEligibleGroup({experimentId:"domain_claim",defaultGroup:"unassigned"}),t=this.props.samlConfigStore.state,i="configured"!==t.status&&"enforced"!==t.status&&this.isInvalidSamlConfig(t),a=[...t.emailDomains.map((e=>({domain:e,status:to.YF.Success,data:{type:"verified",domain:e}}))),...t.domainVerifications.filter((e=>!t.emailDomains.includes(e.domain))).sort(((e,t)=>e.createdAt-t.createdAt)).map((e=>Date.now()>e.expiresAt||Boolean(e.invalidatedAt)?{domain:e.domain,status:to.YF.Failure,data:{type:"invalid",id:e.id,domain:e.domain,verificationCode:e.verificationCode,createdAt:e.createdAt,expiresAt:e.expiresAt,invalidatedAt:e.invalidatedAt}}:{domain:e.domain,status:to.YF.Pending,data:{type:"unverified",id:e.id,domain:e.domain,verificationCode:e.verificationCode,createdAt:e.createdAt,expiresAt:e.expiresAt,invalidatedAt:e.invalidatedAt}}))];return n()(u.Fragment,{},void 0,n()("div",{style:this.getHeaderStyle()},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SAMLSingleSignOnSection.title",defaultMessage:"SAML single sign-on"})),this.renderSamlHelp(),this.renderSamlUneditable(t.id),this.renderEmailDomains(a),e&&this.renderWorkspaceCreationDropdown(),n()(pa.Z,{size:40}),this.renderSpaceNames(t.spaceIds),this.renderSingleSignOnUrl(),this.renderIdpSettings(t),this.renderCreateAccountToggle(t.createAccount),this.renderEnableSamlToggle(t.status,i),this.renderEnforceSamlToggle(t.status,i))}renderScimSettings(){const e="enterprise"===L.CM(this.environment);return n()(ro,{headerStyle:this.getHeaderStyle(),spaceStore:this.props.spaceStore,userStore:this.props.userStore,handleUpgradeClick:this.handleUpgradeClick,isEnterprise:e})}renderSetupInformationSettings(){return n()(u.Fragment,{},void 0,n()(pa.Z,{size:48,style:{opacity:0}}),n()("div",{style:this.getHeaderStyle()},void 0,n()("span",{style:{marginRight:8}},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.title",defaultMessage:"Setup Information",description:"Section title for Setup Information"}))),this.renderSetupInformation())}renderControlRow(){if((0,$s.J)({environment:this.environment})||(0,D.uT)(this.environment))return n()("div",{style:{display:"flex"}},void 0,n()(xe.Z,{isLarge:!0,onClick:this.handleUpdateClick},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.updateButton.label",defaultMessage:"Update"})),n()(Ht.Z,{isLarge:!0,style:{marginLeft:12},onClick:this.handleCancelClick},void 0,n()(y.FormattedMessage,{id:"securitySAMLSettings.cancelButton.label",defaultMessage:"Cancel"})))}renderOfflineMessage(){return n()(ba.Z,{},void 0,n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,n()(y.FormattedMessage,{defaultMessage:"Please go online to manage security settings.",id:"securitySAMLSettings.offline.message"})))}closeSettings(){he.ZP.setState({...he.ZP.state,open:!1})}isSamlAvailable(){return this.props.samlConfigStore.state.emailDomains.length>0||"enterprise"===L.CM(this.environment)}isDomainSettingsAvailable(){return this.props.domainSettingsStore.state.emailDomains.length>0&&"enterprise"===L.CM(this.environment)}isSamlEditable(){const e=this.props.samlConfigStore.state;return this.isSamlAvailable()&&(!e.id||e.id===this.props.spaceStore.id)}isInvalidSamlConfig(e){return 0===e.emailDomains.length||e.useMetadataUrl&&!e.idpMetadataUrl||!e.useMetadataUrl&&!e.idpMetadata}async saveSamlConfig(){if(!this.isSamlAvailable())return;const e=this.props.samlConfigStore.state,t=await w.adminSamlConfigForSpace(this.environment,{spaceId:this.props.spaceStore.id,status:e.status,useMetadataUrl:e.useMetadataUrl,idpMetadataUrl:e.idpMetadataUrl,idpMetadata:e.idpMetadata,createAccount:e.createAccount,emailDomains:e.emailDomains});"failed"===t.type?this.props.securitySettingsStore.setState({...this.props.securitySettingsStore.state,error:t}):this.props.securitySettingsStore.setState({...this.props.securitySettingsStore.state,error:void 0})}async saveWorkspaceCreationSetting(){if(this.props.domainSettingsStore.state.spaceCreation&&0!==this.props.samlConfigStore.state.emailDomains.length)return await w.updateWorkspaceCreationForEmailDomains(this.environment,{emailDomains:this.props.samlConfigStore.state.emailDomains,workspaceCreationEnum:this.props.domainSettingsStore.state.spaceCreation,spaceId:this.props.spaceStore.id})}static settingOptionStyle(){return{display:"flex",alignItems:"center",width:"100%",cursor:arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"default":"pointer"}}getHeaderStyle(){return{fontWeight:v.Z.fontWeight.medium,fontSize:18,borderBottom:"1px solid ".concat(this.theme.regularDividerColor),paddingBottom:6,marginBottom:12,display:"flex",alignItems:"center"}}getTitleStyle(){return{fontSize:14,marginRight:8,flexGrow:1}}getRadioTitleStyle(){return{marginTop:8,marginBottom:4}}}function oo(e){let{botIds:t,spaceStore:i,environment:a}=e;if(void 0===t)return"Undefined";const n=t.map((e=>(0,vt.Kv)(i,{table:Me.cZ,id:e,spaceId:i.id}))),s=c().compact(n.map((e=>e.getValue())));if(s.some((e=>e.created_by_table===be.KJ&&e.created_by_id===be.s$.id)))return"SpaceHasExistingToken";return s.some((e=>e.created_by_table===be.KJ&&e.created_by_id===a.currentUser.id))?"UserHasExistingToken":"Able"}function ro(e){let{headerStyle:t,spaceStore:i,userStore:a,handleUpgradeClick:s,isEnterprise:o}=e;const[r,l]=(0,u.useState)(void 0),d=(0,ye.O7)(),c=(0,Se.VK)((()=>oo({botIds:r,spaceStore:i,environment:d})),[r,d,i]),m=n()(y.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.title",defaultMessage:"SCIM configuration"}),p=n()(pa.Z,{size:48,style:{opacity:0}});if(o){const e={...t,borderBottom:void 0,marginBottom:2};return n()(u.Fragment,{},void 0,p,n()("div",{style:e},void 0,n()("span",{style:{display:"flex",marginRight:8,width:"100%",justifyContent:"space-between"}},void 0,m,n()(Is,{onNewScimToken:e=>l((t=>[...null!=t?t:[],e])),spaceStore:i,userStore:a,tokenCreationAbility:c}))),n()(Ys,{spaceStore:i,userStore:a,botIds:r,setBotIds:l}),lo())}return n()(u.Fragment,{},void 0,p,n()("div",{style:t},void 0,n()("span",{style:{marginRight:8}},void 0,m),n()(Yn.Z,{subscriptionTier:"enterprise",analyticsName:"space_saml",onClick:s,desktopStyle:{marginTop:-1}})),lo())}function lo(){return n()(fa.Z,{title:n()(y.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.helpButton.label",defaultMessage:"Learn about SCIM"}),style:{marginTop:18,marginBottom:24},href:(0,R.UY)("guides.scim"),analyticsFrom:"scim_settings"})}l()(so,"captionStyle",{marginTop:4,width:"85%"});const co=(0,y.injectIntl)(so);function uo(e){let{userStore:t,spaceStore:i,promptUpgrade:a}=e;const[s,o]=(0,u.useState)(void 0),r=(0,ye.O7)(),l=(0,Se.VK)((()=>oo({botIds:s,spaceStore:i,environment:r})),[s,r,i]),d=n()(y.FormattedMessage,{id:"identityAndProvisioning.scim.title",defaultMessage:"SCIM tokens",description:"Title describing how this section is for SCIM tokens."}),c=n()(y.FormattedMessage,{id:"identityAndProvisioning.scim.byline",defaultMessage:"Generate a token to configure SCIM.",description:"Byline describing how this section is for SCIM tokens."});return a?n()(Qn,{title:d,byline:c}):m().createElement(m().Fragment,null,n()(Kn,{title:d,byline:c,settingItem:n()(Is,{onNewScimToken:e=>o((t=>[...null!=t?t:[],e])),spaceStore:i,userStore:t,tokenCreationAbility:l})}),n()(fa.Z,{title:n()(y.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.helpButton.label",defaultMessage:"Learn about SCIM"}),style:{marginTop:18,marginBottom:24},href:(0,R.UY)("guides.scim"),analyticsFrom:"scim_settings"}),n()(Ys,{spaceStore:i,userStore:t,botIds:s,setBotIds:o}))}function mo(e){let{userStore:t,spaceStore:i}=e;const a=(0,ye.O7)(),s=(0,Se.VK)((()=>"enterprise"===L.CM(a)),[a]);return n()(uo,{promptUpgrade:!s,userStore:t,spaceStore:i})}function po(e){let{primaryWorkspaceName:t}=e;const i=(0,Yt.y)((e=>({container:{background:e.accentColors.blue[100],padding:"18px 24px",borderRadius:4,margin:"0 0 24px"}})),[]);return n()("div",{style:i.container},void 0,n()(ii.Z,{},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableTitle",defaultMessage:"The primary workspace is <bold>{primaryWorkspaceName}</bold>.",description:"Short message pointing out the primary workspace for this current workspace",values:{primaryWorkspaceName:t,bold:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("span",{style:{fontWeight:v.Z.fontWeight.semibold}},void 0,t)}}})),n()("br",{}),n()(ii.Z,{isMultiline:!0},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableMessage",defaultMessage:"The verified domains and SAML SSO configuration are being managed by the workspace <bold>{primaryWorkspaceName}</bold>. Please navigate there or contact an admin of that workspace to edit the verified domains or SSO configuration.",description:"Short message telling the customer that the current workspace has its SAML and domain settings being managed by another workspace.",values:{primaryWorkspaceName:t,bold:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("span",{style:{fontWeight:v.Z.fontWeight.semibold}},void 0,t)}}})))}function go(e){let{spaceStore:t,isEnterprise:i}=e;const a=(0,y.useIntl)(),s=(0,Se.VK)((()=>t.id),[t]);return m().createElement(m().Fragment,null,n()(ho,{left:n()(y.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.workspaceId",defaultMessage:"Workspace ID",description:"Label next to copy workspace ID button"}),right:n()(fo,{text:s,tooltip:a.formatMessage({id:"securitySAMLSettings.SetupInformationSection.workspaceId.copyTooltip",defaultMessage:"Click to copy ID",description:"Tooltip shown when hovering on copy workspace button"})})}),i&&m().createElement(m().Fragment,null,n()(ho,{left:n()(y.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityIDLink",defaultMessage:"SAML SSO/SAML Entity ID",description:"Label next to copy saml/sso entity ID button"}),right:n()(fo,{text:(0,cs.AE)(Gt.Z.domainBaseUrl),tooltip:a.formatMessage({id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityID.copyTooltip",defaultMessage:"Click to copy link",description:"Tooltip shown when hovering on copy saml/sso entity ID button"})})}),n()(ho,{left:n()(y.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl",defaultMessage:"SCIM base URL",description:"Label next to copy scim base URL button"}),right:n()(fo,{text:Gt.Z.domainBaseUrl+Js._j.scimApiBasePath,tooltip:a.formatMessage({id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl.copyTooltip",defaultMessage:"Click to copy link",description:"Tooltip shown when hovering on copy scim base URL button"})})})))}function ho(e){let{left:t,right:i}=e;const a=(0,Yt.y)((()=>({container:{padding:4,display:"flex",alignItems:"center",justifyContent:"flex-start"},leftItem:{width:160,whiteSpace:"nowrap"},rightItem:{whiteSpace:"nowrap"}})),[]);return n()("div",{style:a.container},void 0,n()(ii.Z,{isSmall:!0,isMultiline:!0,style:a.leftItem},void 0,t),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:a.rightItem},void 0,i))}function fo(e){let{tooltip:t,text:i}=e;const a=(0,ye.O7)();return n()(Le.Z,{delayThreshold:0,renderTooltip:()=>t,render:e=>m().createElement(va.Z,o()({onClick:()=>{Xt.RD({environment:a,stringValue:i,copiedMessage:Xt.tq.copiedPropertyToClipboard})}},e),i)})}function vo(e){let{userStore:t,spaceStore:i,samlConfigStore:a,domainSettingsStore:s}=e;const o=(0,ye.O7)(),r=(0,Se.VK)((()=>ra.Z.state.online),[]),{loadingSaml:l,loadedSaml:d,errorSaml:c}=(0,u.useContext)(Wn),m=(0,Se.VK)((()=>function(e){let{environment:t,samlConfigStore:i,spaceStore:a}=e;const n=zn({environment:t,samlConfigStore:i}),s=!i.state.id||i.state.id===a.id;return n&&s}({environment:o,samlConfigStore:a,spaceStore:i})),[o,a,i]),p=(0,Se.VK)((()=>a.state.id?Gn.Z.getPublicSpaceData(o,a.state.id):void 0),[o,a]),g=(0,Yt.y)((()=>({header:{marginTop:48}})),[]),h=(0,Se.VK)((()=>"enterprise"===L.CM(o)),[o]);return r?l?n()(ba.Z,{},void 0,n()(ya.Z,{style:{margin:"0 auto"}})):c?(C.showErrorMessage(c.message),null):d?n()(ba.Z,{},void 0,!m&&p?n()(po,{primaryWorkspaceName:p.name}):null,n()(qt.Z,{large:!0,divider:"full"},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.domain.title",defaultMessage:"Domain management",description:"Domain settings menu title"})),n()(as,{spaceStore:i,samlConfigStore:a,domainSettingsStore:s}),n()(qt.Z,{large:!0,divider:"full",style:g.header},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML Single sign-on (SSO)",description:"SAML SSO settings menu title"})),n()(Zs,{spaceStore:i,samlConfigStore:a,domainSettingsStore:s}),n()(qt.Z,{large:!0,divider:"full",style:g.header},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.scim.title",defaultMessage:"SCIM provisioning",description:"SCIM settings menu title"})),n()(mo,{userStore:t,spaceStore:i}),n()(qt.Z,{large:!0,divider:"full",style:g.header},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.setupInfo.title",defaultMessage:"Setup information",description:"Setup information settings menu title"})),n()(go,{spaceStore:i,isEnterprise:h})):null:n()(ba.Z,{},void 0,n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,n()(y.FormattedMessage,{defaultMessage:"Please go online to manage identity and provisioning settings.",id:"identityProvisioningSettings.offline.message",description:"Offline message for the Identity and Provisioning settings menu"})))}var yo=i(16402);function So(e){let{admin:t}=e;const i=(0,y.useIntl)();return n()(Le.Z,{renderTooltip:()=>n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingExplaination",defaultMessage:"Waiting for {name} to transfer the workspace to an external account.",description:"Indicator that the space in this row is in a pending state for being claimed.",values:{name:(0,be.Nz)(i,t)}}),render:e=>m().createElement(ii.Z,e,n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pending",defaultMessage:"Pending",description:"Indicator that the space in this row is in a pending state for being claimed."}))})}var Mo=i(58945),bo=i(80527);function wo(e){let{space:t,actions:i}=e;const a=(0,Se.qz)(void 0,cn.Z),s=(0,Yt.y)((()=>({container:{minWidth:325}})),[]);return n()(qe.Z,{popupType:De.kQ.Popup,style:s.container,buttonPopupStore:a,renderOrigin:e=>m().createElement(bo.Z,o()({icon:h.Z.dots},e)),render:()=>n()(Co,{space:t,actions:i,popupStore:a})})}function Co(e){let{space:t,actions:i,popupStore:a}=e;const s=(0,Yt.y)((e=>({bottomContainer:{display:"flex",alignItems:"center",justifyContent:"flex-start",marginTop:6,padding:"6px 4px 2px",borderTop:"1px solid ".concat(e.lightDividerColor)},iconContainer:{display:"flex",alignItems:"center",justifyContent:"center",marginLeft:4,marginRight:10},label:{opacity:.5,fontSize:12}})),[]),r={key:"workspace-actions",render:e=>m().createElement(Re.Z,e),items:i.map((e=>({key:e.id,render:t=>m().createElement(Mo.Z,o()({},t,{shouldWrapCaption:!0,svg:t=>e.icon(t),title:e.name,caption:e.caption,style:{paddingTop:8,paddingBottom:8}})),action:()=>e.action(t)}))).concat({key:"terms-and-conditions",render:()=>n()("div",{style:s.bottomContainer},void 0,n()("div",{style:s.iconContainer},void 0,h.Z.help({height:14,width:14,opacity:.5})),n()(ut.Z,{style:s.label,isSmall:!0},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.actionsMenu.terms",defaultMessage:"Terms and conditions",description:"Link for the terms and conditions of claiming a workspace."}))),action:()=>{}})};return n()(Be.Z,{menuType:Be.Z.MenuType.Popup},void 0,n()(Ee.Z,{type:Ee.Z.Type.Vertical,initialFocus:void 0,sections:[r],onAccept:()=>{a.setState({open:!1})}}))}function To(e){let{id:t,name:i,icon:a,subscriptionTier:s,memberCount:o,highlightIconContainer:r}=e;const l=(0,y.useIntl)(),d=a?{pointer:{table:mi.bx,id:t,spaceId:t},icon:a}:void 0,c=(0,Yt.y)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%"},summaryContainer:{width:"calc(100% - ".concat(38,"px)")},iconContainer:{height:38,width:38,flexGrow:0,flexShrink:0,flexBasis:38,marginRight:12,display:"flex",justifyContent:"center",alignItems:"center",background:r?e.selectLightGray[50]:void 0,borderRadius:6},name:{fontSize:14,fontWeight:500},byline:{fontSize:12,opacity:.5}})),[r]);return n()("div",{style:c.container},void 0,n()("div",{style:c.iconContainer},void 0,n()(xa.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:26,title:i,isLarge:!0})),n()("div",{style:c.summaryContainer},void 0,n()(ii.Z,{style:c.name,showTooltipWhenTruncated:!0},void 0,i),n()(ii.Z,{style:c.byline},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.summaryByline",defaultMessage:"{subscriptionTier} · {memberCount, plural, one {{memberCount} member} other {{memberCount} members}}",description:"Label for the workspace indicating number of workspace members and workspace plan type.",values:{subscriptionTier:ko(s,l),memberCount:o}}))))}function ko(e,t){switch(e){case"personal_free":return t.formatMessage(Zo.personalPlan);case"personal":return t.formatMessage(Zo.personalProPlan);case"team_free":return t.formatMessage(Zo.teamTrialPlan);case"team":return t.formatMessage(Zo.teamPlan);default:(0,W.t1)(e)}}const Zo=(0,y.defineMessages)({personalPlan:{id:"identityAndProvisioning.claimWorkspaces.personalPlan",defaultMessage:"Personal",description:"Label for the workspace indicating it has a Personal Plan"},personalProPlan:{id:"identityAndProvisioning.claimWorkspaces.proPlan",defaultMessage:"Personal Pro",description:"Label for the workspace indicating it has a Personal Pro Plan"},teamTrialPlan:{id:"identityAndProvisioning.claimWorkspaces.teamTrialPlan",defaultMessage:"Team (Trial)",description:"Label for the workspace indicating it has a Team (Trial) Plan"},teamPlan:{id:"identityAndProvisioning.claimWorkspaces.teamPlan",defaultMessage:"Team",description:"Label for the team indicating it has a Team Plan"}});function Ao(e){let{users:t,deletedUserEmailDomain:i}=e;const a=(0,Se.qz)(void 0,cn.Z),s=(0,Yt.y)((()=>({container:{minWidth:275}})),[]);return n()(qe.Z,{popupType:De.kQ.Popup,style:s.container,buttonPopupStore:a,renderOrigin:e=>m().createElement(_o,o()({users:t,deletedUserEmailDomain:i},e)),render:()=>n()(Io,{users:t,popupStore:a})})}function Io(e){let{users:t,popupStore:i}=e;const a=(0,ye.O7)(),s={key:"workspace-users-menu",render:e=>m().createElement(Re.Z,e),items:t.map((e=>({key:e.id,render:t=>m().createElement(Po,o()({user:e},t)),action:()=>(0,T.navigateToExternalURL)({environment:a,url:"mailto:".concat(e.email)})})))};return n()(Be.Z,{menuType:Be.Z.MenuType.Popup},void 0,n()(Ee.Z,{type:Ee.Z.Type.Vertical,initialFocus:0,sections:[s],onAccept:()=>{i.setState({open:!1})}}))}function Po(e){let{user:t,...i}=e;const a=(0,y.useIntl)(),s=(0,Yt.y)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8,margin:"0 6px"},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center"},copyContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"auto",opacity:.5},nameContainer:{marginLeft:8,marginRight:8},name:{fontSize:14,lineHeight:1.2,maxWidth:300},email:{fontSize:12,lineHeight:1.2,opacity:.5,maxWidth:300}})),[]);return m().createElement(ut.Z,o()({style:s.container},i),n()("div",{style:s.avatarContainer},void 0,n()(pn.Z,{userValue:t,size:24})),n()("div",{style:s.nameContainer},void 0,n()(ii.Z,{style:s.name},void 0,(0,be.Nz)(a,t)),n()(ii.Z,{style:s.email},void 0,t.email)),n()("div",{style:s.copyContainer},void 0,h.Z.mail({height:18,width:18})))}function _o(e){let{users:t,deletedUserEmailDomain:i,...a}=e;const s=(0,y.useIntl)(),r=(0,Yt.y)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",marginLeft:"-8px",maxWidth:"100%"},empty:{fontSize:14,maxWidth:150,opacity:.5},name:{fontSize:14,maxWidth:150},plusMore:{opacity:.5,display:"inline"}})),[]);return 0===t.length?n()(Le.Z,{render:e=>m().createElement(ut.Z,o()({style:r.container,disabled:!0},a,e),n()(ii.Z,{style:r.empty},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.empty",defaultMessage:"Deleted user",description:"Empty state for when there are no users to display."}))),disableTooltip:!i,renderTooltip:()=>n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.emptyTooltip",defaultMessage:"Deleted user from {domain}",description:"Detailed empty state for when there are no users to display.",values:{domain:"@".concat(i)}})}):m().createElement(ut.Z,o()({style:r.container},a),n()(ii.Z,{},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.name",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} <gray>+{remainingCount}</gray>} other {{firstUser} <gray>+{remainingCount}</gray>}}",description:"Shows the name of the first user in the list, followed by the number of additional users left that are not shown.",values:{firstUser:(0,be.Nz)(s,t[0]),remainingCount:t.length-1,gray:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(ii.Z,{style:r.plusMore},void 0,t)}}})))}const xo={id:"workspaces",headerTitle:n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.name",defaultMessage:"Workspaces",description:"Header for the name column in the unauthorized workspaces table."}),renderCell:e=>n()(To,{id:e.space.id,name:e.space.name,icon:e.space.icon,subscriptionTier:e.space.subscriptionTier,memberCount:e.space.memberCount}),widthData:{width:60},sortable:!0},Fo={id:"admins",headerTitle:n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.admins",defaultMessage:"Workspace owners",description:"Header for the workspace owners column in the unauthorized workspaces table."}),renderCell:e=>n()(Ao,{users:e.space.admins}),widthData:{width:40},sortable:!0},Bo={id:"createdBy",headerTitle:n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdBy",defaultMessage:"Created by",description:"Header for the created by column in the unauthorized workspaces table."}),renderCell:e=>e.space.creator?n()(Ao,{users:[e.space.creator]}):n()(Ao,{users:[],deletedUserEmailDomain:e.space.creatorEmailDomain}),widthData:{width:40},sortable:!0},Eo={id:"createdAt",headerTitle:n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdAt",defaultMessage:"Created at",description:"Header for the created at column in the unauthorized workspaces table."}),renderCell:e=>n()(ii.Z,{style:{opacity:.5}},void 0,(0,yo.gs)(e.space.createdAt)),widthData:{width:30},sortable:!0},Do=[xo,Fo,Bo,Eo,{id:"action",headerTitle:null,renderCell:e=>e.actions.length>0?(0,f.M8)(e.space.workspaceTransfer)?n()(So,{admin:e.space.admins[0]}):n()(wo,{space:e.space,actions:e.actions}):null,widthData:{width:15},sortable:!0}];function Ro(e){let{claimableWorkspaces:t,workspaceActions:i}=e;const[a,s]=(0,u.useState)({column:xo,sortAscending:!1}),o=t.map((e=>({id:e.id,isClickable:!1,space:e,actions:i}))),r=(0,Yt.y)((e=>(0,ys.b)({columnRenderInfo:Do,theme:e,containerMarginTop:12})),[]);return n()(ys.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Do,rows:Lo(o,a),sortState:a,onSortStateChanged:s,renderNoRowsComponent:()=>n()(ii.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"}},void 0,n()(y.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.empty",defaultMessage:"No claimable workspaces.",description:"Message displayed on the table that shows workspaces if there are no workspaces to show."})),styles:r,getStyleForRow:function(e){if((0,f.M8)(e.space.workspaceTransfer))return{opacity:.5}}})}function Lo(e,t){let{column:i,sortAscending:a}=t,n=[];switch(i.id){case"workspaces":n=c().sortBy(e,(e=>e.space.name));break;case"admins":n=c().sortBy(e,(e=>e.space.admins[0].name));break;case"createdBy":n=c().sortBy(e,(e=>{var t;return null===(t=e.space.creator)||void 0===t?void 0:t.name}));break;case"createdAt":n=c().sortBy(e,(e=>e.space.createdAt))}return a?n:n.reverse()}const Oo=e=>{let{onDismiss:t,workspaceQueuedForClaiming:i}=e;const a=(0,Yt.y)((e=>({modalInnerStyle:{width:440,padding:"20px 24px",display:"flex",flexFlow:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:16},dismissButton:{marginTop:-7,marginRight:-7},closeIcon:{width:14,height:14,color:e.regularIconColor},infoIcon:{color:e.lightIconColor,height:16,width:16,marginLeft:4},circleCheckContainer:{position:"absolute",background:e.modalBackground,top:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",width:48,borderRadius:4},check:{color:e.blueColor,height:16,width:16},title:{fontWeight:v.Z.fontWeight.medium,fontSize:16,marginBottom:8,display:"inline-flex",alignItems:"center",justifyContent:"center"},byline:{fontWeight:v.Z.fontWeight.regular,textAlign:"center"},workspaceContainer:{position:"relative",borderRadius:4,boxShadow:e.borderBoxShadow,padding:"0 12px",margin:"24px auto",width:"100%",minHeight:56},primaryActionButton:{width:"100%",margin:"0 auto"},secondaryActionButton:{width:"100%",margin:"8px auto 0",justifyContent:"center",fontWeight:v.Z.fontWeight.regular,color:e.lightTextColor}})),[]),s=Boolean(i);return n()(Ga.Z,{open:s,innerStyle:a.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>m().createElement(m().Fragment,null,n()("div",{style:a.closeIconContainer},void 0,n()(ut.Z,{isSmall:!0,style:a.dismissButton,onClick:t},void 0,h.Z.closeSmall(a.closeIcon))),n()(ii.Z,{style:a.title},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.title",defaultMessage:"Claim workspace",description:"Title for the claim workspace modal."}),h.Z.info(a.infoIcon)),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:a.byline},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.byline",defaultMessage:"You're about to take ownership over a workspace and upgrade it to the Enterprise plan. You'll be made the owner of this workspace and all previous owners will be downgraded to members.",description:"Details explaining what it means to claim and upgrade a workspace."})),n()("div",{style:a.workspaceContainer},void 0,i?n()(To,{id:i.id,name:i.name,icon:i.icon,subscriptionTier:i.subscriptionTier,memberCount:i.memberCount,highlightIconContainer:!0}):null,n()("div",{style:a.circleCheckContainer},void 0,h.Z.thinCheck(a.check))),n()(xe.Z,{isLarge:!0,style:a.primaryActionButton,onClick:()=>{}},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.reviewAndPay",defaultMessage:"Review and pay",description:"Primary action for continuing the claim process to the payment step."})),n()(ut.Z,{style:a.secondaryActionButton,onClick:t},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.cancel",defaultMessage:"Cancel",description:"Canceling the current action"})))})};function No(e){let{spaceStore:t}=e;const i=(0,ye.O7)(),{claimableWorkspaces:a,loadingSpaces:s,errorSpaces:o,navigateTo:r,setWorkspaceTransfer:l}=(0,u.useContext)(Wn),[d,c]=(0,u.useState)();const m=(0,Se.VK)((()=>ie.default.checkGate("domain_claim_run_self_serve")),[]),p=(0,Yt.y)((e=>({link:{fontSize:14,fontWeight:400,color:e.selectLightGray[700],textDecoration:"none"},title:{marginTop:28,fontWeight:600,fontSize:17},byline:{fontSize:14,fontWeight:400,color:e.selectLightGray[700]},header:{marginTop:48,fontWeight:500},count:{marginLeft:4,opacity:.5,fontWeight:400}})),[]);if(s)return n()(ba.Z,{},void 0,n()(ya.Z,{style:{margin:"0 auto"}}));if(o)return C.showErrorMessage(o.message),null;const g=a.filter((e=>function(e){switch(e){case"personal":case"personal_free":return!0;case"enterprise":case"business":case"free":case"student":case"team":case"team_free":return!1}}(e.subscriptionTier))),f=a.filter((e=>function(e){switch(e){case"team":case"team_free":return!0;case"enterprise":case"business":case"free":case"student":case"personal":case"personal_free":return!1}}(e.subscriptionTier))),v=[{id:"external-transfer",icon:e=>h.Z.arrowsDiverging({...e,height:14,width:14}),name:n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransfer",defaultMessage:"Transfer to external account",description:"Button option for starting an external transfer of this workspace's ownership."}),caption:n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransferCaption",defaultMessage:"Swap the current workspace owners with a personal account.",description:"Caption for the external transfer button."}),action:async e=>{const a=t.id,n=await w.initiateWorkspaceTransfer(i,{requestingSpaceId:a,targetSpaceId:e.id,contactEmail:""});if("failed"===n.type)C.showErrorMessage(n.error.message);else{const t=n.data.workspaceTransfer;l(e.id,t)}}}],S=[{id:"claim-and-upgrade",icon:e=>h.Z.roundArrowDown({...e,height:14,width:14}),name:n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgrade",defaultMessage:"Claim and upgrade to Enterprise",description:"Button option for starting a claim and upgrade workflow for the selected workspace."}),caption:n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgradeCaption",defaultMessage:"Take ownership over this workspace and upgrade it to the Enterprise plan.",description:"Caption for the claim and upgrade button."}),action:e=>c(e)}];return n()(ba.Z,{},void 0,n()(va.Z,{style:p.link,onClick:()=>r(Nn)},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.breadcrumb",defaultMessage:"← Identity & Provisioning",description:"Link for navigating back to the previous 'Identity & Provisioning' settings page."})),n()(qt.Z,{large:!0,style:p.title},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.title",defaultMessage:"Claim workspaces",description:"Title for the claim workspaces section."})),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:p.byline},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.byline",defaultMessage:"Claim verified-domain workspaces to your Enterprise plan or require Owners to use an external domain.",description:"Byline for the claim workspaces section."})),n()(qt.Z,{large:!0,style:p.header},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.personalSpaces",defaultMessage:"Personal Plan {spacesCount}",description:"Title for the table that shows all claimable personal plan workspaces.",values:{spacesCount:n()("span",{style:p.count},void 0,g.length)}})),n()(Ro,{claimableWorkspaces:g,workspaceActions:v}),n()(qt.Z,{large:!0,style:p.header},void 0,n()(y.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.teamSpaces",defaultMessage:"Team Plan {spacesCount}",description:"Title for the table that shows all claimable team plan workspaces.",values:{spacesCount:n()("span",{style:p.count},void 0,f.length)}})),n()(Ro,{claimableWorkspaces:f,workspaceActions:m?S:[]}),n()(Oo,{onDismiss:function(){c(void 0)},workspaceQueuedForClaiming:d}))}function Uo(e){let{userStore:t,spaceStore:i,samlConfigStore:a,domainSettingsStore:s}=e;const{page:o}=(0,u.useContext)(Wn);switch(o){case Nn:return n()(vo,{userStore:t,spaceStore:i,samlConfigStore:a,domainSettingsStore:s});case Un:return n()(No,{spaceStore:i})}}const Wo=function(e){let{userStore:t,spaceStore:i,samlConfigStore:a,domainSettingsStore:s}=e;return n()(Vn,{spaceStore:i,samlConfigStore:a,domainSettingsStore:s},void 0,n()(Uo,{userStore:t,spaceStore:i,samlConfigStore:a,domainSettingsStore:s}))};var Vo=i(69972),zo=i(52377);const Go=(0,y.defineMessages)({searchInputPlaceholder:{id:"adminIntegrationSettings.search.input.placeholder",defaultMessage:"Add by name or integration ID"}});function Ho(){const e=(0,ye.O7)(),t=(0,Yt.F)(),[i,a]=(0,u.useState)(!0),[s,o]=(0,u.useState)(!1),[r,l]=(0,u.useState)(""),d=m().createRef();return i?n()(ei.Z,{style:{display:"flex",alignItems:"center",height:28,fontWeight:v.Z.fontWeight.medium,fontSize:v.Z.fontSize.UIRegular.desktop,color:g.ZP.blue,padding:"0px 6px"},onClick:()=>{var e;a(!1),null===(e=d.current)||void 0===e||e.focusInput()}},void 0,n()(y.FormattedMessage,{id:"adminIntegrationSettings.search.button.label",defaultMessage:"{plusIcon} Add approved integration",description:"Text for button to open dropdown menu for selecting and adding a new integration to the approved list",values:{plusIcon:h.Z.plus({fill:g.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})):n()(De.ZP,{alignmentToOrigin:De.ZP.Alignment.Start,keepFocus:e.device.isPhone,onDismiss:()=>{var e;null===(e=d.current)||void 0===e||e.handleBlur(),a(!0),o(!1)},origin:m().createElement(tt.Z,{type:"text",style:{width:255},left:h.Z.plus({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),ref:d,value:r,onFocus:()=>{o(!0)},placeholder:Ce.default.formatMessage(Go.searchInputPlaceholder),onChange:e=>l(e.target.value)}),open:s,popupType:De.ZP.PopupType.Popup,style:{width:255},render:()=>n()(Fa,{query:r,closeDropdown:()=>o(!1)})})}const qo={internal:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.internal",defaultMessage:"INTERNAL",description:"This label indicates that an integration is internal to the workspace, as opposed to public."}),databaseSync:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.sync",defaultMessage:"SYNC",description:"This label indicates that the integration type is database sync."}),linkPreview:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.preview",defaultMessage:"LINK PREVIEW",description:"This label indicates that the integration type is link preview."}),importer:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.pillLabel.importer",defaultMessage:"IMPORTER",description:"This label indicates that the integration type is a first-party / legacy importers."})};function Ko(e){const{integrationIdToBotIds:t,internalIntegrationIds:i,integrationIdToUsers:a}=e,[{currentSpaceStore:s}]=(0,Se.oR)(Z.default),o=(0,Yt.F)(),r=(0,Se.VK)((()=>null==s?void 0:s.getBotSettingsStore().getValue()),[s]),l=(0,Se.VK)((()=>"approved_or_built_by_notion"===(null==r?void 0:r.integration_restrictions)),[r]),d=(0,Se.VK)((()=>Boolean(null==r?void 0:r.integration_restrictions)),[r]),c=(0,Se.VK)((()=>null!=r&&r.integration_approval_statuses?Object.keys(r.integration_approval_statuses):[]),[r]),u=c.filter((e=>!Object.keys(t).includes(e)&&!Xi.T2.includes(e))),p=(0,Se.VK)((()=>null==s?void 0:s.id),[s]),g=t?Object.entries(t).map((e=>{let[t,i]=e;return jo({integrationPointer:{table:Aa.K2,id:t},users:a[t],botIds:i,autoApproveBuiltByNotion:l})})):[],h=p?i.map((e=>jo({integrationPointer:{table:Me.cZ,id:e,spaceId:p},users:a[e],botIds:[e]}))):[],v=d?u.map((e=>jo({integrationPointer:{table:Aa.K2,id:e},users:[],botIds:[],autoApproveBuiltByNotion:l}))):[],S=Xi.ns.filter((e=>!(0,f.CJ)(r)||c.includes(e.id))).map((e=>function(e){const{legacyIntegration:t}=e,{id:i,name:a,info:s}=t;return{key:i,columns:[n()("div",{style:{display:"flex",alignItems:"center",maxWidth:300}},void 0,n()("img",{src:s.icon,style:{height:28}}),n()("div",{style:{minWidth:0,marginLeft:15}},void 0,n()("div",{style:{display:"flex"}},void 0,n()(ii.Z,{},void 0,a)),n()(ii.Z,{isSmall:!0,style:{display:"flex"}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.legacy",defaultMessage:"Notion Connected App"})))),n()($o,{renderedUsers:void 0,displayUsers:!1}),n()("div",{},void 0,n()(qa,{integrationId:i,isLegacy:!0,disableDisconnectAll:!0,disableDisconnectUser:!0}))]}}({botSettings:r,legacyIntegration:e}))),M=g.length+h.length+v.length+S.length;return m().createElement(m().Fragment,null,n()(ti.Z,{columns:[{key:"integration",header:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.integrationColumn.title",defaultMessage:"Integration"}),style:{width:"40%"}},{key:"added_by",header:n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationtable.creationInfoColumn.title",defaultMessage:"Users"})},{key:"more",header:void 0,style:{width:"5%"}}],rows:[...g,...h,...v,...S]}),0===M?n()("div",{style:{height:120,width:"100%",fontSize:12,color:o.lightTextColor,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:"1px solid ".concat(o.lightDividerColor)}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.emptyTable.message",defaultMessage:"No integration installed"})):void 0)}function jo(e){const{integrationPointer:t,users:i,botIds:a,autoApproveBuiltByNotion:s}=e;return t.table===Aa.K2?{key:t.id,columns:[n()(Yo,{integrationTable:Aa.K2,integrationId:t.id}),n()($o,{renderedUsers:i,displayUsers:!(0,Ia.BP)(t.id)}),n()(qa,{integrationId:t.id,integrationTable:Aa.K2,botIds:a,disableDisconnectUser:(0,Ia.BP)(t.id)||void 0,disableDisallow:(0,Ia.BP)(t.id)&&s})]}:t.table===Me.cZ?{key:t.id,columns:[n()(Yo,{integrationTable:Me.cZ,integrationId:t.id}),n()($o,{renderedUsers:i,displayUsers:!1}),n()(un,{botId:t.id})]}:void(0,W.t1)(t)}function Yo(e){const{integrationId:t,integrationTable:i}=e,[{currentSpaceStore:a}]=(0,Se.oR)(Z.default),s=(0,ye.O7)(),o=(0,Se.VK)((()=>(0,Oa.fe)(s)),[s]),r=(0,Se.VK)((()=>{if(a)return a.getRecordValue({table:i,id:t})}),[a,t,i]);if(!r)return n()(ya.Z,{});let l;const d=[];let c;if(i===Me.cZ){const e=r;e.icon&&(l={pointer:{table:i,id:t},icon:e.icon}),d.push("internal"),c=n()(Qo,{botId:e.id})}else if(i===Aa.K2){const e=r;e.info.icon&&(l={pointer:{table:i,id:t},icon:e.info.icon}),(0,Xi.mo)(e)&&(d.push("linkPreview"),(0,Xi.zc)(e)&&o&&d.push("databaseSync")),c=n()(Jo,{integrationId:e.id})}else(0,W.t1)(i);return n()("div",{style:{display:"flex",alignItems:"center",maxWidth:300}},void 0,n()(xa.Z,{disabled:!0,icon:l,title:r.name,isEmptyPage:!1,size:28,isLarge:!0,useInvertedColors:!0}),n()("div",{style:{minWidth:0,marginLeft:15}},void 0,n()("div",{style:{display:"flex",marginRight:16}},void 0,n()(ii.Z,{},void 0,r.name),d.map((e=>e&&n()(St.Z,{desktopStyle:{marginLeft:4}},void 0,qo[e])))),c))}const Qo=e=>{let{botId:t}=e;const[{currentSpaceStore:i}]=(0,Se.oR)(Z.default),a=(0,y.useIntl)(),s=(0,Se.VK)((()=>null==i?void 0:i.getRecordValue({table:Me.cZ,id:t})),[i,t]),o=(0,Se.VK)((()=>{if(i&&s)return i.getRecordValue({table:s.created_by_table,id:s.created_by_id})}),[i,s]);if(o){const e=(0,be.Nz)(a,o);return n()(ii.Z,{className:"notranslate",isSmall:!0},void 0,e)}return n()(Xo,{})},Jo=e=>{let{integrationId:t}=e;const[{currentSpaceStore:i}]=(0,Se.oR)(Z.default),a=(0,Yt.F)(),s=(0,Se.VK)((()=>{const e=null==i?void 0:i.getRecordValue({table:Aa.K2,id:t});return null==e?void 0:e.info.developer_name}),[i,t]);return(0,Ia.BP)(t)?n()(ii.Z,{isSmall:!0,style:{display:"flex",alignItems:"center"}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.notion",defaultMessage:"Notion {icon}",values:{icon:n()(Le.Z,{renderTooltip:()=>n()("div",{},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfo.notion.tooltip",defaultMessage:"Developed by Notion"})),placement:Le.Z.Placement.Right,render:e=>m().createElement("div",e,h.Z.integrationSecurity({width:12,height:12,fill:a.invoiceGreen}))})}})):s?n()(ii.Z,{className:"notranslate",isSmall:!0},void 0,s):n()(Xo,{})},Xo=()=>n()(ii.Z,{isSmall:!0},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.label.unknownDeveloper",defaultMessage:"Unknown developer",description:"The placeholder name of an integration developer if not provided"}));function $o(e){const{renderedUsers:t,displayUsers:i}=e,[{currentSpaceStore:a}]=(0,Se.oR)(Z.default),s=(0,y.useIntl)(),o=(0,ye.O7)(),r=(0,Se.VK)((()=>{if(a)return(0,Na.getSpaceName)(o,a)}),[o,a]);if(t&&0===(null==t?void 0:t.length))return n()(ii.Z,{isSecondaryColor:!0,style:{display:"flex",alignItems:"center"}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.noUsers",defaultMessage:"No users"}));if(!i||!t)return n()(ii.Z,{style:{display:"flex",alignItems:"center"}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.anyone",defaultMessage:"Anyone in {spaceName}",values:{spaceName:n()(ii.Z,{style:{fontWeight:v.Z.fontWeight.medium}},void 0,r)}}));const l=(0,be.Nz)(s,t[0]);return n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()(pn.Z,{userValue:t[0],avatarShouldShowShadow:!0,style:{marginRight:8},size:28}),n()(ii.Z,{},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationTable.installerInfoColumn.listOfUsers",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} +{remainingCount}} other {{firstUser} +{remainingCount}}}",values:{firstUser:l,remainingCount:t.length-1}})))}function er(e){const t=(0,ye.O7)(),{isMobile:i}=t.device,{externalBotIds:a,guestBotIds:s}=e,[{currentSpaceStore:o}]=(0,Se.oR)(Z.default),r=(0,Se.VK)((()=>o?[...s,...a].map((e=>{var t;const i=(0,vt.Kv)(o,{table:Me.cZ,id:e,spaceId:o.id});return null!=i&&null!==(t=i.getValue())&&void 0!==t&&t.alive?i.getValue():void 0})).filter(W.$K):[]),[o,s,a]),l=(0,Se.VK)((()=>function(e){return e.reduce(((e,t)=>(t.integration_id&&(e[t.integration_id]=t.integration_id in e?[...e[t.integration_id],t.id]:[t.id]),e)),{})}([...r])),[r]),d=(0,Se.VK)((()=>function(e){return e.filter((e=>!e.integration_id)).map((e=>e.id))}(r)),[r]),c=(0,Se.VK)((()=>function(e,t){if(!t)return{};return e.reduce(((e,i)=>{const a=t.getRecordValue({table:be.KJ,id:i.created_by_id});return i.integration_id?e[i.integration_id]=i.integration_id in e?[...e[i.integration_id],a]:[a]:e[i.id]=[a],e}),{})}(r,o)),[r,o]),u=(0,Se.VK)((()=>null==o?void 0:o.getBotSettingsStore().getValue()),[o]),p=Object.keys(l).length+d.length,g=(0,Se.VK)((()=>null!=u&&u.integration_approval_statuses?Object.keys(u.integration_approval_statuses).length+d.length:d.length),[u,d]);return m().createElement(m().Fragment,null,n()(tr,{}),(null==u?void 0:u.integration_restrictions)&&n()("div",{style:{marginTop:"19px"}},void 0,n()(ir,{})),n()(pa.Z,{size:i?32:18,isHidden:!i}),Boolean(null==u?void 0:u.integration_restrictions)?n()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"19px"}},void 0,n()(ii.Z,{style:{fontWeight:v.Z.fontWeight.medium,display:"flex",alignItems:"center",height:28}},void 0,n()(y.FormattedMessage,{id:"adminIntegrationSettings.table.allowIntegrations.title",defaultMessage:"Approved integrations{numberOfIntegrations}",values:{numberOfIntegrations:0!==g&&n()(ii.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,g)}})),n()(Ho,{})):n()(ii.Z,{style:{fontWeight:v.Z.fontWeight.medium,display:"flex",height:28,alignItems:"center",marginBottom:"19px"}},void 0,n()(y.FormattedMessage,{id:"adminIntegrationSettings.table.default.title",defaultMessage:"All integrations{numberOfIntegrations}",values:{numberOfIntegrations:0!==p&&n()(ii.Z,{isSecondaryColor:!0,style:{marginLeft:6}},void 0,p+Xi.T2.length)}})),n()(Ko,{integrationIdToBotIds:l,internalIntegrationIds:d,integrationIdToUsers:c}))}const tr=()=>{const e=(0,ye.O7)(),[{currentSpaceStore:t}]=(0,Se.oR)(Z.default),{isMobile:i}=e.device,a=(0,Se.VK)((()=>"enterprise"===L.CM(e)),[e]),s=(0,Se.VK)((()=>null==t?void 0:t.getBotSettingsStore().getValue()),[t]),o=(0,$t.u)();return n()(wn.Z,{isMobile:i,title:n()(y.FormattedMessage,{id:"adminIntegrationSettings.requireApprovalSetting.title",defaultMessage:"Restrict members from installing integrations"}),caption:(0,f.CJ)(s)?n()(y.FormattedMessage,o?{id:"adminIntegrationSettings.requireApprovalSetting.allowList.workspaceOwner.caption",defaultMessage:"Workspace members can only install integrations pre-approved by workspace owners.",description:"Caption shown when integration installation requires approval"}:{id:"adminIntegrationSettings.requireApprovalSetting.allowList.caption",defaultMessage:"Workspace members can only install integrations pre-approved by admins."}):n()(y.FormattedMessage,{id:"adminIntegrationSettings.requireApprovalSetting.off.caption",defaultMessage:"Workspace members can install any new integration."}),upsellOptions:{shouldUpsell:!a,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"dropdown",currentOption:(0,f.CJ)(s)?"allow_list":"any_integrations",options:[{key:"any_integrations",label:n()(y.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.off.title",defaultMessage:"Off"}),caption:n()(y.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.off.caption",defaultMessage:"Workspace members can install any integration."})},{key:"allow_list",label:n()(y.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.allowList.title",defaultMessage:"From approved list"}),caption:n()(y.FormattedMessage,o?{id:"adminIntegrationSettings.integrationRestrictions.allowList.workspaceOwners.caption",defaultMessage:"Workspace members can only install integrations pre-approved by a workspace owner.",description:"Caption describing restriction on integration installation"}:{id:"adminIntegrationSettings.integrationRestrictions.allowList.caption",defaultMessage:"Workspace members can only install integrations pre-approved by an admin."})}],onSelectOption:i=>{!function(e){const{environment:t,currentSpaceStore:i,botSettings:a,setting:n}=e;if(i){if("allow_list"===n&&(0,f.CJ)(a))return;const e="allow_list"===n?"approved_only":void 0;A.createAndCommit({userAction:"AdminIntegrationSettings.handleIntegrationRestrictionSelect",environment:t,perform:t=>{ka.sW({store:i,data:{bot_settings:{...a,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:t,botSettings:s,setting:i})},info:[{key:"learn_more",label:n()(y.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.info.title",defaultMessage:"Admins can always install and approve new integrations."})}]})};const ir=()=>{const e=(0,ye.O7)(),t=(0,Yt.F)(),[{currentSpaceStore:i}]=(0,Se.oR)(Z.default),{isMobile:a}=e.device,s=(0,Se.VK)((()=>"enterprise"===L.CM(e)),[e]),o=(0,Se.VK)((()=>null==i?void 0:i.getBotSettingsStore().getValue()),[i]);return n()(wn.Z,{isMobile:a,title:n()(y.FormattedMessage,{id:"adminIntegrationSettings.autoApproveBuiltByNotion.title",description:"This message is for the option to auto approve integrations that are built by Notion.",defaultMessage:"Auto-approve <builtbynotion>Built by Notion</builtbynotion> integrations",values:{builtbynotion:function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return n()("span",{style:{color:t.invoiceGreen}},void 0,h.Z.integrationSecurity({width:14,display:"inline",verticalAlign:"text-bottom",marginRight:2}),i)}}}),caption:n()(y.FormattedMessage,{defaultMessage:"Toggle this on to approve all workspace members to install integrations <helpcenterlink>built by Notion</helpcenterlink>.",id:"adminIntegrationSettings.autoApproveBuiltByNotion.caption",values:{helpcenterlink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(va.Z,{href:(0,R.UY)("guides.enterpriseIntegrationSettings")},void 0,t)}}}),upsellOptions:{shouldUpsell:!s,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"toggle",isOn:"approved_or_built_by_notion"===(null==o?void 0:o.integration_restrictions),onToggle:()=>function(e){const{environment:t,currentSpaceStore:i,botSettings:a}=e;if(i){const e="approved_or_built_by_notion"===(null==a?void 0:a.integration_restrictions)?"approved_only":"approved_or_built_by_notion";A.createAndCommit({userAction:"AdminIntegrationSettings.handleAutoApproveBuiltByNotionToggle",environment:t,perform:t=>{ka.sW({store:i,data:{bot_settings:{...a,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:i,botSettings:o})})};var ar=i(86512);class nr extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{requestStore:da.Z}),l()(this,"renderResult",((e,t,i)=>{const{currentSpaceStore:a}=Z.default.state;if(a)return n()(An.Z,{loaded:i,spinnerSize:16,showSpinnerTimeout:600},void 0,e&&n()("div",{},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.error",defaultMessage:"Something went wrong…"})),t&&(a.canAdmin()?n()(er,{guestBotIds:t.guestBotIds,externalBotIds:t.externalBotIds}):n()(xn,{botIds:t.guestBotIds})),n()("div",{style:{marginTop:16,marginBottom:32,display:"grid",gridTemplateColumns:"1fr",gap:4}},void 0,n()(ar.Z,{style:{display:"flex",marginLeft:-6},className:"notion-print-ignore",href:(0,R.UY)("guides.publicAPI"),external:!0},void 0,n()(ut.Z,{icon:h.Z.help,isSmall:!0,isLightGray:!0},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationManagement.sitelink",defaultMessage:"Learn more about managing integrations",description:"This link, when clicked, will direct the user to the help center."}))),n()(ar.Z,{style:{display:"flex",marginLeft:-6},className:"notion-print-ignore",href:Js._j.myIntegrations,external:!0,onClick:()=>{b.trackDeveloperIntegrationsMyIntegrationsClick(this.environment,{from:"integration-settings",href:Js._j.myIntegrations})}},void 0,n()(ut.Z,{icon:h.Z.alias,isSmall:!0,isLightGray:!0},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.integrationDevelopment.sitelink",defaultMessage:"Develop your own integrations",description:"This link, when clicked, take users to a page where they can create their own public or private integration."})))))})),l()(this,"fetchBotsInSpace",(async e=>{let{spaceId:t}=e;const i=await(0,ea.Yw)({environment:this.environment,table:mi.bx,id:t,type:"guest"}),a=await(0,ea.Yw)({environment:this.environment,table:mi.bx,id:t,type:"external"});return{guestBotIds:i.botIds,externalBotIds:a.botIds}}))}renderComponent(){const{device:e}=this.environment;return n()(ba.Z,{},void 0,n()(qt.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",style:{paddingBottom:12}},void 0,n()(y.FormattedMessage,{id:"spaceIntegrationSettings.title",defaultMessage:"Integrations"})),this.renderRequest())}renderRequest(){const{spaceStore:e,userStore:t}=this.props;return n()(Sa.Z,{requestStore:this.stores.requestStore,request:{spaceId:e.id,userId:t.id},performRequest:this.fetchBotsInSpace,render:this.renderResult})}}const sr=(0,y.injectIntl)(nr);var or=i(24211),rr=i(79092),lr=i(54153),dr=i(84908),cr=i(39218);var ur=i(65680),mr=i(60709);class pr extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{buttonPopupStore:cn.Z}),l()(this,"handleSelectChange",(e=>{const{label:t}=this.getItemLabelAndCaption(e);if(this.props.confirm){const i=()=>{this.props.onChange(e)};C.showDialog({showCancel:!0,keepFocus:!1,message:n()(y.FormattedMessage,{id:"languagePicker.changeLanguage.confirmationMessage",defaultMessage:"Are you sure you want to update the language to {language}?",values:{language:t}}),items:[{label:n()(y.FormattedMessage,{id:"languagePicker.changeLanguage.updateButton.label",defaultMessage:"Update"}),color:"red",onAccept:i}]})}else this.props.onChange(e)}))}renderComponent(){const{device:e}=this.environment;if(!e.isMobile)return n()(qe.Z,{popupType:qe.Z.PopupType.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>m().createElement(m().Fragment,null,m().createElement(ut.Z,o()({style:{marginLeft:-8,paddingLeft:8,paddingRight:8}},e),this.getItemLabelAndCaption(this.props.currentLocale).label,(0,ur.ay)(this.props.currentLocale)&&n()(St.Z,{desktopStyle:{marginLeft:4}},void 0,n()(y.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})),h.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor}))),placementToOrigin:mr.Iw.Bottom,alignmentToOrigin:mr.lU.Start,render:e=>{let t;t="on"===ie.default.getGroup("polyglot")?[...ur.tp,...ur.is]:[...ur.tp];const i=[{key:"languages",render:e=>m().createElement(Re.Z,o()({},e,{topBorder:0!==e.index})),items:t.map((t=>({key:t,render:e=>this.getItem(t,e.focused,e),action:()=>{this.handleSelect(t),e.close()}})))}],a={menuType:Be.Z.MenuType.Popup,width:240};return m().createElement(Be.Z,o()({className:B.hK},a),n()(Ee.Z,{type:Ee.Z.Type.Vertical,initialFocus:void 0,sections:i}))}})}renderItem(e){return m().createElement(Fe.Z,o()({},e.props,{title:n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()("div",{style:{...e.style,marginRight:0}},void 0,e.label)),caption:e.caption&&n()("span",{style:{color:this.theme.mediumTextColor}},void 0,e.caption),shouldWrapCaption:!0,right:(0,ur.ay)(e.locale)&&n()(St.Z,{},void 0,n()(y.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"}))}))}handleSelect(e){this.props.currentLocale!==e&&this.handleSelectChange(e)}getItemLabelAndCaption(e){var t;return{"en-US":{label:"English",caption:(t=this.props.intl).formatMessage({defaultMessage:"English (US)",id:"languagePicker.captions.englishUS"})},"de-DE":{label:"German",caption:t.formatMessage({defaultMessage:"German",id:"languagePicker.captions.germanDE",description:"The name of a language represented in a list of languages"})},"ko-KR":{label:"한국어",caption:t.formatMessage({defaultMessage:"Korean",id:"languagePicker.captions.koreanKo"})},"zh-CN":{label:"简体中文",caption:t.formatMessage({defaultMessage:"Simplified Chinese",id:"languagePicker.captions.chineseS"})},"zh-TW":{label:"繁體中文",caption:t.formatMessage({defaultMessage:"Traditional Chinese",id:"languagePicker.captions.chineseT"})},"ja-JP":{label:"日本語",caption:t.formatMessage({defaultMessage:"Japanese",id:"languagePicker.captions.japaneseJa"})},"es-ES":{label:"Español (España)",caption:t.formatMessage({defaultMessage:"Spanish (Spain)",id:"languagePicker.captions.spanishEs"})},"es-LA":{label:"Español (Latinoamérica)",caption:t.formatMessage({defaultMessage:"Spanish (Latin America)",id:"languagePicker.captions.spanishLatam"})},"pt-BR":{label:"Português (Brasil)",caption:t.formatMessage({defaultMessage:"Portuguese (Brazil)",id:"languagePicker.captions.portugueseBr"})},"fr-FR":{label:"Français (France)",caption:t.formatMessage({defaultMessage:"French",id:"languagePicker.captions.frenchFr"})}}[e]}getItem(e,t,i){return this.renderItem({...this.getItemLabelAndCaption(e),focused:t,props:i,locale:e})}}const gr=(0,y.injectIntl)(pr);class hr extends p.Z{renderComponent(){return n()("div",{style:this.getSettingsOptionStyle()},void 0,n()("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"}},void 0,n()("div",{style:{flex:1}},void 0,n()(ii.Z,{},void 0,n()(y.FormattedMessage,{id:"languageRegionSettings.language.label",defaultMessage:"Language"})),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,n()(y.FormattedMessage,{id:"languageSettings.languageSwitcher.subtitle",defaultMessage:"Change the language used in the user interface."}))),n()(gr,{confirm:!0,onChange:async e=>{(0,b.trackLocaleChanged)(this.environment,{locale:e});const t=await w.setLocale(this.environment,{locale:e});"success"===t.type?(lr.Z.set("preferredLocale",e),await cr.transactionQueue.drain(),this.environment.device.isElectron?dr.refreshAll({includeFocusedWindow:!0}):window.location.reload()):C.showError(t)},currentLocale:this.props.locale})))}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}const fr=hr;var vr=i(57269),yr=i(32056);function Sr(e){var t,i;return(null==e||null===(t=e.settings)||void 0===t||null===(i=t.regional_format_settings)||void 0===i?void 0:i.region)||"United States"}function Mr(e,t){var i;const a=null==e||null===(i=e.settings)||void 0===i?void 0:i.regional_format_settings;return"full_date"===t?null!=a&&a.use_default_region_settings?br(Sr(e)):(null==a?void 0:a.full_date)||br(Sr(e)):"short_date"===t?null!=a&&a.use_default_region_settings?{type:"short"}:(null==a?void 0:a.short_date)||{type:"short"}:"number"===t?null!=a&&a.use_default_region_settings?"number":(null==a?void 0:a.number)||"number":"week_start_on"===t?null!=a&&a.use_default_region_settings?"sunday":(null==a?void 0:a.week_start_on)||"sunday":(0,W.t1)(t)}function br(e){return"ja"===e?{type:"short"}:{type:"long"}}const wr={full_date:(0,y.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,y.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,y.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,y.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})},Cr=(0,y.defineMessages)({full_date:{defaultMessage:"Full date",id:"regionalFormatSettings.defaultSetting.fullDate"},short_date:{defaultMessage:"Short date",id:"regionalFormatSettings.defaultSetting.shortDate"},number:{defaultMessage:"Numbers",id:"regionalFormatSettings.defaultSetting.numbers"},week_start_on:{defaultMessage:"Week starts",id:"regionalFormatSettings.defaultSetting.weekStart"}});function Tr(e,t){return(0,yr.uf)(1234567,e,t)}const kr=(0,y.defineMessages)({sunday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.sunday",defaultMessage:"Sunday"},monday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.monday",defaultMessage:"Monday"}});function Zr(e,t){const i=(0,Tt.default)();return(0,vr.mT)((0,or.E2)(t),i,e)}function Ar(e,t){const i=(0,Tt.default)();return(0,vr.T0)((0,or.E2)(t),i,e)}var Ir=i(82902);const Pr={full_date:(0,y.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,y.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,y.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,y.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})};function _r(e){const[,,t]=(0,Se.oR)(void 0,cn.Z),i=(0,Yt.F)(),a=(0,Se.VK)((()=>e.userSettingsStore.state),[e.userSettingsStore]);if(!a.ready||!a.value)return n()(ya.Z,{});const s=function(e,t){if("full_date"===t)return wr[t][Mr(e,t).type];if("short_date"===t)return wr[t][Mr(e,t).type];if("number"===t)return wr[t][Mr(e,t)];if("week_start_on"===t)return wr[t][Mr(e,t)];return(0,W.t1)(t)}(a.value,e.option);return n()(qe.Z,{popupType:qe.Z.PopupType.Popup,buttonPopupStore:t,renderOrigin:e=>m().createElement(ut.Z,e,Ce.default.formatMessage(s),h.Z.chevronDown({width:10,marginLeft:4,fill:i.lightIconColor})),placementToOrigin:mr.Iw.Bottom,alignmentToOrigin:mr.lU.Start,render:t=>"week_start_on"===e.option||"number"===e.option?n()(xr,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):"full_date"===e.option||"short_date"===e.option?n()(Fr,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):(0,W.t1)(e.option)})}function xr(e){const t=(0,ye.O7)(),i=(0,Se.VK)((()=>e.userSettingsStore.state),[e.userSettingsStore]),a=(0,y.useIntl)();return n()(Be.Z,{menuType:Be.Z.MenuType.Popup,width:216},void 0,n()(Ee.Z,{type:Ee.Z.Type.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>m().createElement(Re.Z,o()({},e,{topBorder:0!==e.index})),items:(0,W.Yd)(Pr[e.option]).map((n=>({key:n,render:t=>{const i="number"===e.option?Tr(n,a):void 0;return m().createElement(Fe.Z,o()({},t,{title:Ce.default.formatMessage(Pr[e.option][n]),caption:i}))},action:()=>{(0,A.createAndCommit)({userAction:"CustomRegionalFormatSettings.SimpleFormatPicker",environment:t,perform:t=>{var a,s;(0,x.d2)({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...null===(a=i.value)||void 0===a||null===(s=a.settings)||void 0===s?void 0:s.regional_format_settings,use_default_region_settings:!1,region:Sr(e.userSettingsStore.getValue()),[e.option]:n}},transaction:t})}}),e.onAccept()}})))}]}))}function Fr(e){const t=(0,ye.O7)(),i=(0,Se.VK)((()=>e.userSettingsStore.state),[e.userSettingsStore]),[a,s]=(0,u.useState)((()=>{})),r=(0,y.useIntl)(),l=(0,W.Yd)(Pr[e.option]),d=n=>{const s="custom"===n?{type:n,format:a}:{type:n};(0,A.createAndCommit)({userAction:"CustomRegionalFormatSettings.onAction",environment:t,perform:t=>{var a,n;(0,x.d2)({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...null===(a=i.value)||void 0===a||null===(n=a.settings)||void 0===n?void 0:n.regional_format_settings,use_default_region_settings:!1,region:Sr(e.userSettingsStore.getValue()),[e.option]:s}},transaction:t})}}),e.onAccept()};return n()(Be.Z,{menuType:Be.Z.MenuType.Popup,width:216},void 0,n()(Ee.Z,{type:Ee.Z.Type.Vertical,initialFocus:void 0,disableMouseLeaveBlur:!0,sections:[{key:"options",render:e=>m().createElement(Re.Z,o()({},e,{topBorder:0!==e.index})),items:l.map((t=>({key:t,render:i=>{if("custom"===t)return m().createElement(Ir.Z,o()({},i,{renderOrigin:i=>m().createElement(Fe.Z,o()({},i,{title:Ce.default.formatMessage(Pr[e.option][t])})),onFocus:()=>{},renderExtension:()=>n()(Br,{customFormat:a,onChange:e=>{s(e)},onAccept:()=>{d(t)}}),title:Ce.default.formatMessage(Pr[e.option][t])}));{const a="full_date"===e.option?Zr({type:t},r):Ar({type:t},r);return m().createElement(Fe.Z,o()({},i,{title:Ce.default.formatMessage(Pr[e.option][t]),caption:a}))}},action:()=>{d(t)}})))}]}))}function Br(e){const t=(0,Yt.y)((e=>({container:{},label:{color:e.mediumTextColor,fontWeight:v.Z.fontWeight.semibold,paddingTop:6,paddingBottom:6,paddingLeft:14,paddingRight:14},actionButton:{marginTop:6}})),[]);return n()("div",{style:t.container},void 0,n()("div",{},void 0,n()(ii.Z,{isSmall:!0,style:t.label},void 0,n()(y.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.title",defaultMessage:"Custom format"}))),n()(za.Z,{focus:!0,value:e.customFormat||"",onChange:t=>{e.onChange(t.target.value)}}),n()(Fe.Z,{style:t.actionButton,focused:!1,onClick:e.onAccept,title:n()(y.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.applyChanges",defaultMessage:"Apply changes"})}))}function Er(e){const t=(0,Yt.y)((()=>({container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]),i=(0,Se.VK)((()=>e.userSettingsStore.state),[e.userSettingsStore]),a=(0,Se.VK)((()=>e.userSettingsStore.shouldUseDefaultRegionalFormatting()),[e.userSettingsStore]),s=(0,ye.O7)();return i.ready?n()("div",{style:t.container},void 0,n()("div",{style:t.controlRow},void 0,n()("div",{style:t.label},void 0,n()(ii.Z,{},void 0,n()(y.FormattedMessage,{id:"regionalFormatSettings.label.title",defaultMessage:"Use regional defaults"})),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle},void 0,n()(y.FormattedMessage,{id:"regionalFormatSettings.label.subtitle",defaultMessage:"Automatically apply standard formats of your region"}))),n()(ns.Z,{on:a,onClick:()=>{(0,A.createAndCommit)({userAction:"RegionalFormatSettings.RegionalFormatSettings",environment:s,perform:t=>{const i=a?{use_default_region_settings:!1,full_date:void 0,short_date:void 0,time:void 0,number:void 0,week_start_on:void 0}:{use_default_region_settings:!0};(0,x.d2)({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{region:Sr(e.userSettingsStore.getValue()),...i}},transaction:t})}})}})),n()("div",{},void 0,n()(a?Dr:Nr,{userSettingsStore:e.userSettingsStore}))):n()(ya.Z,{})}function Dr(e){const t=(0,Yt.y)((()=>({container:{marginTop:12}})),[]);return n()("div",{style:t.container},void 0,Or.map((t=>n()(Rr,{userSettingsStore:e.userSettingsStore,option:t}))))}function Rr(e){const t=(0,Yt.y)((e=>({container:{display:"flex"},option:{color:e.lightTextColor,fontSize:v.Z.fontSize.UIRegular.desktop,width:100},example:{color:e.mediumTextColor,fontSize:v.Z.fontSize.UIRegular.desktop}})),[]),i=(0,Se.VK)((()=>e.userSettingsStore.state),[e.userSettingsStore]),a=(0,y.useIntl)();if(!i.ready||!i.value)return n()(ya.Z,{});const s=Lr(i.value,a,e.option);return n()("div",{style:t.container},void 0,n()("div",{style:t.option},void 0,Ce.default.formatMessage(Cr[e.option])),n()("div",{style:t.example},void 0,s))}function Lr(e,t,i){if("full_date"===i){return Zr(Mr(e,i),t)}if("short_date"===i){return Ar(Mr(e,i),t)}if("number"===i){return Tr(Mr(e,i),t)}if("week_start_on"===i){return function(e){return"sunday"===e?Ce.default.formatMessage(kr.sunday):"monday"===e?Ce.default.formatMessage(kr.monday):(0,W.t1)(e)}(Mr(e,i))}return(0,W.t1)(i)}const Or=["full_date","short_date","number","week_start_on"];function Nr(e){return n()("div",{},void 0,Or.map((t=>n()(Ur,{userSettingsStore:e.userSettingsStore,option:t}))))}function Ur(e){const t=(0,y.useIntl)(),i=(0,Se.VK)((()=>e.userSettingsStore.state),[e.userSettingsStore]),a=(0,Yt.y)(Wr,[]);if(!i.ready||!i.value)return n()(ya.Z,{});const s=Sr(i.value),o=Lr(i.value,t,e.option);return m().createElement(m().Fragment,null,n()(pa.Z,{size:24}),n()("div",{style:a.container},void 0,n()("div",{style:a.controlRow},void 0,n()("div",{style:a.label},void 0,n()(ii.Z,{},void 0,Ce.default.formatMessage(Cr[e.option])),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:a.subtitle},void 0,o)),n()(_r,{userSettingsStore:e.userSettingsStore,region:s,option:e.option}))))}function Wr(){return{container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}}}const Vr=[{name:"Afghanistan",countryCode:"AF"},{name:"Åland Islands",countryCode:"AX"},{name:"Albania",countryCode:"AL"},{name:"Algeria",countryCode:"DZ"},{name:"American Samoa",countryCode:"AS"},{name:"Andorra",countryCode:"AD"},{name:"Angola",countryCode:"AO"},{name:"Anguilla",countryCode:"AI"},{name:"Antarctica",countryCode:"AQ"},{name:"Antigua and Barbuda",countryCode:"AG"},{name:"Argentina",countryCode:"AR"},{name:"Armenia",countryCode:"AM"},{name:"Aruba",countryCode:"AW"},{name:"Australia",countryCode:"AU",vatApplicable:!0},{name:"Austria",countryCode:"AT",vatApplicable:!0},{name:"Azerbaijan",countryCode:"AZ"},{name:"Bahamas",countryCode:"BS"},{name:"Bahrain",countryCode:"BH"},{name:"Bangladesh",countryCode:"BD"},{name:"Barbados",countryCode:"BB"},{name:"Belarus",countryCode:"BY"},{name:"Belgium",countryCode:"BE",vatApplicable:!0},{name:"Belize",countryCode:"BZ"},{name:"Benin",countryCode:"BJ"},{name:"Bermuda",countryCode:"BM"},{name:"Bhutan",countryCode:"BT"},{name:"Bolivia (Plurinational State of)",countryCode:"BO"},{name:"Bonaire, Sint Eustatius and Saba",countryCode:"BQ"},{name:"Bosnia and Herzegovina",countryCode:"BA"},{name:"Botswana",countryCode:"BW"},{name:"Bouvet Island",countryCode:"BV"},{name:"Brazil",countryCode:"BR"},{name:"British Indian Ocean Territory",countryCode:"IO"},{name:"Brunei Darussalam",countryCode:"BN"},{name:"Bulgaria",countryCode:"BG",vatApplicable:!0},{name:"Burkina Faso",countryCode:"BF"},{name:"Burundi",countryCode:"BI"},{name:"Cabo Verde",countryCode:"CV"},{name:"Cambodia",countryCode:"KH"},{name:"Cameroon",countryCode:"CM"},{name:"Canada",countryCode:"CA",vatApplicable:!0},{name:"Cayman Islands",countryCode:"KY"},{name:"Central African Republic",countryCode:"CF"},{name:"Chad",countryCode:"TD"},{name:"Chile",countryCode:"CL"},{name:"China",countryCode:"CN"},{name:"Christmas Island",countryCode:"CX"},{name:"Cocos (Keeling) Islands",countryCode:"CC"},{name:"Colombia",countryCode:"CO"},{name:"Comoros",countryCode:"KM"},{name:"Congo",countryCode:"CG"},{name:"Congo, Democratic Republic of the",countryCode:"CD"},{name:"Cook Islands",countryCode:"CK"},{name:"Costa Rica",countryCode:"CR"},{name:"Côte d'Ivoire",countryCode:"CI"},{name:"Croatia",countryCode:"HR",vatApplicable:!0},{name:"Curaçao",countryCode:"CW"},{name:"Cyprus",countryCode:"CY",vatApplicable:!0},{name:"Czechia",countryCode:"CZ",vatApplicable:!0},{name:"Denmark",countryCode:"DK",vatApplicable:!0},{name:"Djibouti",countryCode:"DJ"},{name:"Dominica",countryCode:"DM"},{name:"Dominican Republic",countryCode:"DO"},{name:"Ecuador",countryCode:"EC"},{name:"Egypt",countryCode:"EG"},{name:"El Salvador",countryCode:"SV"},{name:"Equatorial Guinea",countryCode:"GQ"},{name:"Eritrea",countryCode:"ER"},{name:"Estonia",countryCode:"EE",vatApplicable:!0},{name:"Eswatini",countryCode:"SZ"},{name:"Ethiopia",countryCode:"ET"},{name:"Falkland Islands (Malvinas)",countryCode:"FK"},{name:"Faroe Islands",countryCode:"FO"},{name:"Fiji",countryCode:"FJ"},{name:"Finland",countryCode:"FI",vatApplicable:!0},{name:"France",countryCode:"FR",vatApplicable:!0},{name:"French Guiana",countryCode:"GF"},{name:"French Polynesia",countryCode:"PF"},{name:"French Southern Territories",countryCode:"TF"},{name:"Gabon",countryCode:"GA"},{name:"Gambia",countryCode:"GM"},{name:"Georgia",countryCode:"GE"},{name:"Germany",countryCode:"DE",vatApplicable:!0},{name:"Ghana",countryCode:"GH"},{name:"Gibraltar",countryCode:"GI"},{name:"Greece",countryCode:"GR",vatApplicable:!0},{name:"Greenland",countryCode:"GL"},{name:"Grenada",countryCode:"GD"},{name:"Guadeloupe",countryCode:"GP"},{name:"Guam",countryCode:"GU"},{name:"Guatemala",countryCode:"GT"},{name:"Guernsey",countryCode:"GG"},{name:"Guinea",countryCode:"GN"},{name:"Guinea-Bissau",countryCode:"GW"},{name:"Guyana",countryCode:"GY"},{name:"Haiti",countryCode:"HT"},{name:"Heard Island and McDonald Islands",countryCode:"HM"},{name:"Holy See",countryCode:"VA"},{name:"Honduras",countryCode:"HN"},{name:"Hong Kong",countryCode:"HK"},{name:"Hungary",countryCode:"HU",vatApplicable:!0},{name:"Iceland",countryCode:"IS"},{name:"India",countryCode:"IN",vatApplicable:!0},{name:"Indonesia",countryCode:"ID"},{name:"Iraq",countryCode:"IQ"},{name:"Ireland",countryCode:"IE",vatApplicable:!0},{name:"Isle of Man",countryCode:"IM"},{name:"Israel",countryCode:"IL"},{name:"Italy",countryCode:"IT",vatApplicable:!0},{name:"Jamaica",countryCode:"JM"},{name:"Japan",countryCode:"JP"},{name:"Jersey",countryCode:"JE"},{name:"Jordan",countryCode:"JO"},{name:"Kazakhstan",countryCode:"KZ"},{name:"Kenya",countryCode:"KE"},{name:"Kiribati",countryCode:"KI"},{name:"Korea, Republic of",countryCode:"KR",vatApplicable:!0},{name:"Kosovo",countryCode:"XK"},{name:"Kuwait",countryCode:"KW"},{name:"Kyrgyzstan",countryCode:"KG"},{name:"Lao People's Democratic Republic",countryCode:"LA"},{name:"Latvia",countryCode:"LV",vatApplicable:!0},{name:"Lebanon",countryCode:"LB"},{name:"Lesotho",countryCode:"LS"},{name:"Liberia",countryCode:"LR"},{name:"Libya",countryCode:"LY"},{name:"Liechtenstein",countryCode:"LI"},{name:"Lithuania",countryCode:"LT",vatApplicable:!0},{name:"Luxembourg",countryCode:"LU",vatApplicable:!0},{name:"Macao",countryCode:"MO"},{name:"Madagascar",countryCode:"MG"},{name:"Malawi",countryCode:"MW"},{name:"Malaysia",countryCode:"MY"},{name:"Maldives",countryCode:"MV"},{name:"Mali",countryCode:"ML"},{name:"Malta",countryCode:"MT",vatApplicable:!0},{name:"Marshall Islands",countryCode:"MH"},{name:"Martinique",countryCode:"MQ"},{name:"Mauritania",countryCode:"MR"},{name:"Mauritius",countryCode:"MU"},{name:"Mayotte",countryCode:"YT"},{name:"Mexico",countryCode:"MX"},{name:"Micronesia (Federated States of)",countryCode:"FM"},{name:"Moldova, Republic of",countryCode:"MD"},{name:"Monaco",countryCode:"MC"},{name:"Mongolia",countryCode:"MN"},{name:"Montenegro",countryCode:"ME"},{name:"Montserrat",countryCode:"MS"},{name:"Morocco",countryCode:"MA"},{name:"Mozambique",countryCode:"MZ"},{name:"Myanmar",countryCode:"MM"},{name:"Namibia",countryCode:"NA"},{name:"Nauru",countryCode:"NR"},{name:"Nepal",countryCode:"NP"},{name:"Netherlands",countryCode:"NL",vatApplicable:!0},{name:"New Caledonia",countryCode:"NC"},{name:"New Zealand",countryCode:"NZ",vatApplicable:!0},{name:"Nicaragua",countryCode:"NI"},{name:"Niger",countryCode:"NE"},{name:"Nigeria",countryCode:"NG"},{name:"Niue",countryCode:"NU"},{name:"Norfolk Island",countryCode:"NF"},{name:"North Macedonia",countryCode:"MK"},{name:"Northern Mariana Islands",countryCode:"MP"},{name:"Norway",countryCode:"NO",vatApplicable:!0},{name:"Oman",countryCode:"OM"},{name:"Pakistan",countryCode:"PK"},{name:"Palau",countryCode:"PW"},{name:"Palestine, State of",countryCode:"PS"},{name:"Panama",countryCode:"PA"},{name:"Papua New Guinea",countryCode:"PG"},{name:"Paraguay",countryCode:"PY"},{name:"Peru",countryCode:"PE"},{name:"Philippines",countryCode:"PH"},{name:"Pitcairn",countryCode:"PN"},{name:"Poland",countryCode:"PL",vatApplicable:!0},{name:"Portugal",countryCode:"PT",vatApplicable:!0},{name:"Puerto Rico",countryCode:"PR"},{name:"Qatar",countryCode:"QA"},{name:"Réunion",countryCode:"RE"},{name:"Romania",countryCode:"RO",vatApplicable:!0},{name:"Russian Federation",countryCode:"RU",vatApplicable:!0},{name:"Rwanda",countryCode:"RW"},{name:"Saint Barthélemy",countryCode:"BL"},{name:"Saint Helena, Ascension and Tristan da Cunha",countryCode:"SH"},{name:"Saint Kitts and Nevis",countryCode:"KN"},{name:"Saint Lucia",countryCode:"LC"},{name:"Saint Martin (French part)",countryCode:"MF"},{name:"Saint Pierre and Miquelon",countryCode:"PM"},{name:"Saint Vincent and the Grenadines",countryCode:"VC"},{name:"Samoa",countryCode:"WS"},{name:"San Marino",countryCode:"SM"},{name:"Sao Tome and Principe",countryCode:"ST"},{name:"Saudi Arabia",countryCode:"SA"},{name:"Senegal",countryCode:"SN"},{name:"Serbia",countryCode:"RS"},{name:"Seychelles",countryCode:"SC"},{name:"Sierra Leone",countryCode:"SL"},{name:"Singapore",countryCode:"SG",vatApplicable:!0},{name:"Sint Maarten (Dutch part)",countryCode:"SX"},{name:"Slovakia",countryCode:"SK",vatApplicable:!0},{name:"Slovenia",countryCode:"SI",vatApplicable:!0},{name:"Solomon Islands",countryCode:"SB"},{name:"Somalia",countryCode:"SO"},{name:"South Africa",countryCode:"ZA"},{name:"South Georgia and the South Sandwich Islands",countryCode:"GS"},{name:"South Sudan",countryCode:"SS"},{name:"Spain",countryCode:"ES",vatApplicable:!0},{name:"Sri Lanka",countryCode:"LK"},{name:"Sudan",countryCode:"SD"},{name:"Suriname",countryCode:"SR"},{name:"Svalbard and Jan Mayen",countryCode:"SJ"},{name:"Sweden",countryCode:"SE",vatApplicable:!0},{name:"Switzerland",countryCode:"CH",vatApplicable:!0},{name:"Taiwan",countryCode:"TW",vatApplicable:!0},{name:"Tajikistan",countryCode:"TJ"},{name:"Tanzania, United Republic of",countryCode:"TZ"},{name:"Thailand",countryCode:"TH"},{name:"Timor-Leste",countryCode:"TL"},{name:"Togo",countryCode:"TG"},{name:"Tokelau",countryCode:"TK"},{name:"Tonga",countryCode:"TO"},{name:"Trinidad and Tobago",countryCode:"TT"},{name:"Tunisia",countryCode:"TN"},{name:"Turkey",countryCode:"TR"},{name:"Turkmenistan",countryCode:"TM"},{name:"Turks and Caicos Islands",countryCode:"TC"},{name:"Tuvalu",countryCode:"TV"},{name:"Uganda",countryCode:"UG"},{name:"Ukraine",countryCode:"UA"},{name:"United Arab Emirates",countryCode:"AE"},{name:"United Kingdom",countryCode:"GB",vatApplicable:!0},{name:"United States",countryCode:"US"},{name:"United States Minor Outlying Islands",countryCode:"UM"},{name:"Uruguay",countryCode:"UY"},{name:"Uzbekistan",countryCode:"UZ"},{name:"Vanuatu",countryCode:"VU"},{name:"Venezuela (Bolivarian Republic of)",countryCode:"VE"},{name:"Viet Nam",countryCode:"VN"},{name:"Virgin Islands (British)",countryCode:"VG"},{name:"Virgin Islands (U.S.)",countryCode:"VI"},{name:"Wallis and Futuna",countryCode:"WF"},{name:"Western Sahara",countryCode:"EH"},{name:"Yemen",countryCode:"YE"},{name:"Zambia",countryCode:"ZM"},{name:"Zimbabwe",countryCode:"ZW"}];function zr(e){const t=(0,Yt.y)((()=>({container:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]);return n()("div",{style:t.container},void 0,n()("div",{style:t.label},void 0,n()(ii.Z,{},void 0,n()(y.FormattedMessage,{id:"regionSettings.region.label",defaultMessage:"Region"})),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle},void 0,n()(y.FormattedMessage,{id:"regionSettings.region.subtitle",defaultMessage:"Affects the default formats for dates, numbers, and currencies"}))),n()(Gr,{userSettingsStore:e.userSettingsStore,onChange:e=>{}}))}function Gr(e){const t=(0,Yt.F)(),[,,i]=(0,Se.oR)(void 0,cn.Z),a=(0,Se.VK)((()=>e.userSettingsStore.state),[e.userSettingsStore]),[s,r]=m().useState("");return n()(qe.Z,{popupType:qe.Z.PopupType.Popup,buttonPopupStore:i,renderOrigin:e=>m().createElement(ut.Z,e,Sr(a.value),h.Z.chevronDown({width:10,marginLeft:4,fill:t.lightIconColor})),placementToOrigin:mr.Iw.Bottom,alignmentToOrigin:mr.lU.Start,render:t=>n()(Be.Z,{menuType:Be.Z.MenuType.Popup,width:216,header:n()(qr,{value:s,onChange:e=>r(e)})},void 0,n()(Ee.Z,{type:Ee.Z.Type.Vertical,initialFocus:void 0,sections:[{key:"regions",render:e=>m().createElement(Re.Z,o()({},e,{topBorder:0!==e.index})),items:(0,Ua.ZP)(s,Vr,(e=>e.name)).map((i=>({key:i.countryCode,render:e=>m().createElement(Fe.Z,o()({},e,{title:i.name})),action:()=>{e.onChange(i.countryCode),t.close(),r("")}})))}]}))})}const Hr=(0,y.defineMessages)({regionSearchPlaceholder:{defaultMessage:"Search for a region...",id:"settings.regionSettings.regionSearch"}});function qr(e){return n()(Re.Z,{isInput:!0},void 0,n()(za.Z,{value:e.value,onChange:t=>{e.onChange(t.target.value)},focus:!0,placeholder:Ce.default.formatMessage(Hr.regionSearchPlaceholder),focusAfterAnimation:!0}))}class Kr extends p.Z{renderComponent(){return ra.Z.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return n()(ba.Z,{},void 0,n()(ii.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,n()(y.FormattedMessage,{defaultMessage:"Please go online to manage your language and region.",id:"languageSettings.offline.message"})))}renderSettings(){var e;const{currentUserSettingsStore:t}=Z.default.state;if(!t)return;const i=(null===(e=t.getSettings())||void 0===e?void 0:e.preferred_locale)||or.al,a="on"===ie.default.getGroup("aloha");return n()(ba.Z,{},void 0,n()(qt.Z,{large:!0,divider:"full"},void 0,n()(y.FormattedMessage,{id:"languageSettings.languageSection.title",defaultMessage:"Language & region"})),n()(fr,{locale:i,userSettingsStore:t}),n()(pa.Z,{size:24}),a?n()("div",{style:{marginTop:12}},void 0,n()(zr,{locale:i,userSettingsStore:t}),n()(pa.Z,{size:24}),n()(qt.Z,{large:!0,divider:"full"},void 0,n()(y.FormattedMessage,{id:"languageSettings.formatsSection.title",defaultMessage:"Formats"})),n()(Er,{locale:i,userSettingsStore:t}),n()(pa.Z,{size:24})):n()(rr.Z,{}))}}const jr=Kr;var Yr=i(52796);class Qr extends p.Z{renderComponent(){return n()("div",{style:this.getStyle(),onMouseDown:this.props.onMouseDown,onClick:this.props.onClick,onDoubleClick:this.props.onDoubleClick,onContextMenu:this.props.onContextMenu},void 0,n()("div",{style:this.getSidebarStyle()},void 0,this.props.sidebar),n()("div",{style:this.getChildrenStyle()},void 0,this.props.children))}getStyle(){return{display:"flex",height:"100%",flexDirection:this.props.isReversed?"row-reverse":"row"}}getSidebarStyle(){return{height:"100%",background:this.theme.cardSidebarBackground,flexGrow:0,flexShrink:0,maxWidth:250,overflowY:"auto"}}getChildrenStyle(){return{flexGrow:1,position:"relative",zIndex:1,height:"100%"}}}const Jr=Qr;let Xr;!function(e){e.Users="users",e.Content="content"}(Xr||(Xr={}));class $r extends N.Z{getInitialState(){return{currentTab:Xr.Users}}}const el=new $r,tl=(0,y.defineMessages)({user:{id:"spaceAnalyticsUsersTab.column.user",defaultMessage:"User",description:"Name of the user column for users tab in workspace analytics"},lastActive:{id:"spaceAnalyticsUsersTab.column.lastActive",defaultMessage:"Last active",description:"Name of the last active column for users tab in workspace analytics"},teamspaces:{id:"spaceAnalyticsUsersTab.column.teamspaces",defaultMessage:"Teamspaces",description:"Name of the teamspaces column for users tab in workspace analytics"},pageViews:{id:"spaceAnalyticsUsersTab.column.pageViews",defaultMessage:"Page views",description:"Name of the page views column for users tab in workspace analytics"},pagesEdited:{id:"spaceAnalyticsUsersTab.column.pagesEdited",defaultMessage:"Pages edited",description:"Name of the pages edited column for users tab in workspace analytics"}}),il={user:tl.user,last_active:tl.lastActive,teamspaces:tl.teamspaces,page_views:tl.pageViews,pages_edited:tl.pagesEdited},al=[];for(const cm in il)al.push({key:cm,header:n()(ei.Z,{disabled:!1,onClick:()=>{}},void 0,Ce.default.formatMessage(il[cm]))});function nl(e){const t=(0,Yt.y)((e=>({sectionTitle:{fontWeight:v.Z.fontWeight.semibold},wrapper:{flexDirection:"row",display:"flex",justifyContent:"space-around"},numUsersCaption:{display:"flex"},overviewText:{textAlign:"center"},table:{marginTop:10}})),[]);return n()("div",{},void 0,n()(ii.Z,{style:t.sectionTitle},void 0,n()(y.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userEngagement.title",defaultMessage:"User engagement",description:"User engagement section title for users tab of workspace analytics."})),n()(sl,{},void 0,n()("div",{style:t.wrapper},void 0,n()("div",{style:t.overviewText},void 0,n()(ii.Z,{},void 0,"179 Members"),n()(ii.Z,{style:t.numUsersCaption,isSmall:!0},void 0,h.Z.plus({height:11,width:11}),n()(y.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.topLevel.membersAdded",defaultMessage:"{numUsers} added in the last 28 days",description:"Caption in workspace analytics describing the number of users who have been added in the last month",values:{numUsers:3}}))),n()("div",{style:t.overviewText},void 0,n()(ii.Z,{},void 0,"58 active"),n()(ii.Z,{isSmall:!0},void 0,n()(y.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.topLevel.active.last28Days",defaultMessage:"In the last 28 days",description:"Caption under the number of active users in the workspace in the workspace analytics tab"}))))),n()(sl,{},void 0,"Placeholder for graph"),n()(ii.Z,{style:t.sectionTitle},void 0,n()(y.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.allUsers.title",defaultMessage:"All users in Notion",description:"Section title above users graph for workspace analytics."})),n()(ti.Z,{tableStyle:t.table,columns:al,rows:[{key:"id",columns:[]}]}))}function sl(e){const t=(0,Yt.y)((e=>({border:{borderRadius:3,overflow:"hidden",border:"1px solid ".concat(e.regularDividerColor),backgroundColor:e.contentBackground,marginTop:12,marginBottom:12,color:e.regularTextColor,padding:20}})),[]);return n()("div",{style:t.border},void 0,e.children)}var ol=i(66957);const rl=function(e){const t=(0,Yt.y)((e=>({headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:v.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"},tabsStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14}})),[]),[i,a]=(0,Se.oR)(el),s={[Xr.Users]:n()(y.FormattedMessage,{id:"workspaceAnalyticsTabs.members.title",defaultMessage:"Members",description:"Title for the members tab in workspace analytics"}),[Xr.Content]:n()(y.FormattedMessage,{id:"workspaceAnalyticsTabs.content.title",defaultMessage:"Content",description:"Title for the content tab in workspace analytics"})},o=[Xr.Users,Xr.Content],r=o.map((e=>s[e])),l=i.currentTab;return n()(ba.Z,{},void 0,n()(qt.Z,{large:!0,style:t.headingStyle},void 0,n()(y.FormattedMessage,{id:"settings.workspaceAnalytics.title",defaultMessage:"Workspace analytics",description:"Header for workspace analytics page in settings modal"})),ba.Z.renderDivider(),n()(ol.Z,{tabs:r,selectedIndex:o.indexOf(l),onChange:e=>{a({currentTab:o[e]})},style:t.tabsStyle}),function(e){switch(e){case Xr.Content:return m().createElement(m().Fragment,null);case Xr.Users:return n()(nl,{});default:(0,W.t1)(e)}}(l))};i(73210);var ll=i(33728),dl=i(86080),cl=i(12318),ul=i(93007),ml=i(92166);const pl=(0,y.defineMessages)({workspaceDomainInputPlaceholder:{id:"spaceBasicSettings.domainSection.workspaceDomainInput.placeholder",defaultMessage:"Your domain"},copyDomainTooltip:{id:"spaceBasicSettings.workspaceDomain.tooltip",defaultMessage:"Click to copy link"}}),gl=()=>{const e=(0,Yt.F)();return n()("div",{style:{color:e.invoiceGreen,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"}},void 0,h.Z.circleCheckFilled({height:16,width:16,margin:"0 4px 0 8px",color:e.invoiceGreen}),n()("span",{},void 0,n()(y.FormattedMessage,{defaultMessage:"Available",description:"website domain is available for selection",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.available"})))},hl=()=>n()("div",{style:{color:g.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"}},void 0,h.Z.warning({height:16,width:16,margin:"0 4px 0 8px"}),n()("span",{},void 0,n()(y.FormattedMessage,{defaultMessage:"Used",description:"website domain is currently in use by another workspace",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.used"}))),fl=()=>n()("div",{style:{color:g.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"}},void 0,h.Z.warning({height:16,width:16,margin:"0 4px 0 8px"}),n()("span",{},void 0,n()(y.FormattedMessage,{defaultMessage:"Not allowed",description:"website domain is not available for selection",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.notAllowed"}))),vl=()=>n()(ml.Z,{show:!0,showDelay:500,showHold:300,render:()=>n()(ya.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})}),yl=e=>{const[t,i]=(0,Se.oR)(e.spaceBasicSettingsStore),{domain:a,domainState:s}=t,r=(0,ye.O7)(),l=(0,Yt.F)(),[d,c]=(0,u.useState)(!0),p=m().createRef();return m().createElement(m().Fragment,null,n()(qt.Z,{},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.domainSection.title",defaultMessage:"Domain"})),n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()("div",{style:{background:l.inputBackground,borderRadius:3,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex"}},void 0,m().createElement(tt.Z,{type:"text",style:{background:"none",boxShadow:"none",padding:"4px 6px",width:255},ref:p,value:a,placeholder:Ce.default.formatMessage(pl.workspaceDomainInputPlaceholder),readOnly:!e.canAdminSpaceStore,onChange:e.handleSpaceUrlChange,onFocus:e=>{c(!1),e.target.select()}})),d&&e.domainIsAutogenerated&&n()("div",{style:{color:g.ZP.blue,fontSize:v.Z.fontSize.UIRegular.desktop,fontWeight:500,textAlign:"right",padding:"4px 6px",whiteSpace:"nowrap"},onClick:()=>{var e;null===(e=p.current)||void 0===e||e.focusInput(),c(!1),i({...t,domain:""})}},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.changeDomain.cta.text",defaultMessage:"Set your own",description:"Prompt beside an autogenerated domain name that encourages the user to set / customize their public website domain name"})),a&&"available"===s&&n()(gl,{}),"inuse"===s&&n()(hl,{}),"disallowed"===s&&n()(fl,{}),"loading"===s&&vl()),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4}},void 0,((e,t)=>{const i=t=>n()(Le.Z,{delayThreshold:0,renderTooltip:()=>Ce.default.formatMessage(pl.copyDomainTooltip),render:i=>m().createElement(va.Z,o()({onClick:()=>{(0,Xt.RD)({environment:e,stringValue:t,copiedMessage:Xt.tq.copiedLinkToClipboard})}},i),t)});return n()("div",{style:{paddingTop:8}},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.viewPublicPage.caption",defaultMessage:"Pages shared to web will be under {linkText}.",values:{linkText:i("".concat(t,".").concat(Gt.Z.publicDomainName))}}),n()("div",{style:{paddingTop:6}}),n()(y.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.joinWorkspace.caption",defaultMessage:"Anyone with an allowed email domain can join this workspace via {linkText}.",values:{linkText:i("".concat(window.location.host,"/").concat(t))}}))})(r,a)))},Sl=e=>{const t=(0,y.useIntl)(),i=(0,Yt.F)(),a=(0,ye.O7)(),s=(0,Se.VK)((()=>(0,L.M9)(a)),[a]),o=!Boolean(s),[r,l]=(0,Se.oR)(se);return n()("div",{onClick:()=>{s&&(0,jn.y)(a,{from:"public_domain_home_page",for:s})}},void 0,m().createElement(tt.Z,{type:"text",ref:e.textInputRef,style:{background:i.inputBackground,borderRadius:3,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex",padding:"4px 6px"},value:r.query,onChange:e=>{l({...r,query:e.target.value})},onFocus:()=>{o&&l({...r,openDropdown:!0})},disabled:!o,left:h.Z.searchThick({fill:i.mediumIconColor,width:16,height:16,marginRight:8,marginLeft:8,flexGrow:0,flexShrink:0}),placeholder:t.formatMessage({defaultMessage:"Select a page shared to web",id:"spaceBasicSettings.PublicHomePageSection.input.placeholder"})}))};var Ml=i(80270),bl=i(29026),wl=i(24042);const Cl=()=>n()(ml.Z,{show:!0,showDelay:500,showHold:300,render:()=>n()(ya.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})}),Tl=async(e,t)=>{if(!ra.Z.state.online)return[];const i=await(0,we.UJ)({environment:t,query:e,source:"public_home_page_menu",limit:bl.Xv});return""===e?i.splice(0,5):i},kl=e=>{const t=(0,ye.O7)(),[i,a]=(0,Se.oR)(e.spaceBasicSettingsStore,re),[s,r]=(0,Se.oR)(se),{query:l}=s,[{value:d,status:c}]=(0,dn.r5)((()=>Tl(l,t)),[l,t]),u=(0,Se.VK)((()=>(0,F.RM)()),[]);if(!(l||d&&0!==d.length))return null;return n()("div",{style:{marginTop:2,marginBottom:2}},void 0,n()(Ee.Z,{type:Ee.Z.Type.Vertical,sections:[{key:"recent public pages section",render:e=>m().createElement(Re.Z,e),items:"idle"===c||"pending"===c?[{key:"loading spinner",render:Cl,action:()=>{}}]:u&&d&&0!==d.length?[...d.map((e=>{const t=Ml.Z.createChildStore(u,{table:ci.iU,id:e.id});return{key:"".concat(e.id," page"),render:e=>m().createElement(wl.Z,o()({store:t},e)),action:()=>{a({...i,publicHomePage:e.id}),r({...s,openDropdown:!1,displaySummary:!0})}}}))]:[{key:"no results",render:()=>n()(ii.Z,{isSmall:!0,style:{marginLeft:8}},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel.noResults",defaultMessage:"No results"})),action:()=>{}}]}],initialFocus:void 0}))};var Zl=i(17755),Al=i(22808);class Il extends m().PureComponent{render(){return n()("div",{style:{height:this.getSize(),width:this.getSize(),...Il.wrapStyle,verticalAlign:"top",marginTop:1,...this.props.style}},void 0,this.renderIcon())}renderIcon(){const{icon:e}=this.props;if(e){if((0,Al.Z)(e.icon))return n()("div",{style:{fontSize:this.getEmojiSize()}},void 0,e.icon);{const t=Zl.EK({url:e.icon,baseUrl:this.props.baseUrl,fullyQualified:!0,permissionRecord:e.pointer,width:this.getImageSize(),userId:void 0});return n()("img",{alt:"icon",src:t,style:{width:this.getImageSize(),height:this.getImageSize(),...Il.imageStyle}})}}}getSize(){return this.props.size}getEmojiSize(){return.9*this.props.size}getImageSize(){return.888*this.props.size}}l()(Il,"wrapStyle",{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3}),l()(Il,"imageStyle",{objectFit:"cover",borderRadius:3,marginTop:1});const Pl=Il;var _l=i(79029);const xl=e=>{const[t,i]=(0,Se.oR)(e.spaceBasicSettingsStore,re),[a,s]=(0,Se.oR)(se),[o,r]=(0,Se.VK)((()=>{const e=(0,F.RM)();if(!e||!t.publicHomePage)return[];const i=Ml.Z.createChildStore(e,{table:ci.iU,id:t.publicHomePage});return[i,i.getIcon()]}),[t]);return o?n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()("div",{style:{display:"flex",paddingRight:8}},void 0,r&&n()(Pl,{baseUrl:"",icon:r,size:18,style:{display:"inline-flex",marginRight:2,verticalAlign:"text-top"}}),n()(_l.Z,{store:o,style:{display:"inline",whiteSpace:"normal",marginRight:Boolean(r)?3:0,wordBreak:"break-word"}})),n()(Ht.Z,{onClick:()=>{s({...a,displaySummary:!1}),i({...t,publicHomePage:void 0})}},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel",defaultMessage:"Clear"}))):null},Fl=e=>{const t=(0,ye.O7)(),i=m().createRef(),[a,s]=(0,Se.oR)(se),[r]=(0,Se.oR)(e.spaceBasicSettingsStore),{openDropdown:l,displaySummary:d}=a,{publicHomePage:c,domain:u}=r,p="".concat(u,".").concat(Gt.Z.publicDomainName),g=(0,Se.VK)((()=>(0,L.M9)(t)),[t]),h=!Boolean(g);return m().createElement(m().Fragment,null,n()(qt.Z,{style:{display:"flex",alignItems:"center"}},void 0,n()("span",{style:{marginRight:8}},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.title",defaultMessage:"Public home page"})),g&&n()(Yn.Z,{subscriptionTier:g,analyticsName:"public_domain_home_page",desktopStyle:{marginTop:-1}})),h&&c&&d?n()(xl,{spaceBasicSettingsStore:e.spaceBasicSettingsStore}):n()(De.ZP,{alignmentToOrigin:De.ZP.Alignment.Start,keepFocus:t.device.isPhone,onDismiss:()=>{var e;null===(e=i.current)||void 0===e||e.handleBlur(),s({...a,openDropdown:!1,displaySummary:!0})},origin:n()(Sl,{textInputRef:i}),open:l,popupType:De.ZP.PopupType.Popup,style:{width:250},render:()=>n()(Be.Z,{menuType:Be.Z.MenuType.Popup,width:250},void 0,n()(kl,{spaceBasicSettingsStore:e.spaceBasicSettingsStore}))}),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8}},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption",defaultMessage:"Access your public home page via {linkText}.",values:{linkText:n()(Le.Z,{delayThreshold:0,renderTooltip:()=>n()(y.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption.tooltip",defaultMessage:"Click to copy link"}),render:e=>m().createElement(va.Z,o()({onClick:()=>{(0,Xt.RD)({environment:t,stringValue:p,copiedMessage:Xt.tq.copiedLinkToClipboard})}},e),p)})}})))};function Bl(){return n()(y.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.nameInput.caption",defaultMessage:"You can use your name or the name of your team. Keep it simple.",description:"The caption below the text input where a user edits the name of their workspace"})}const El=(0,y.defineMessages)({nameInputPlaceholder:{id:"spaceBasicSettings.nameInput.placeholder",defaultMessage:"e.g. company name"},workspaceDomainInputPlaceholder:{id:"spaceBasicSettings.domainSection.workspaceDomainInput.placeholder",defaultMessage:"URL"},allowedEmailDomainsInputPlaceholder:{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.placeholder",defaultMessage:"Type an email domain…"},copyDomainTooltip:{id:"spaceBasicSettings.workspaceDomain.tooltip",defaultMessage:"Click to copy link"}});class Dl extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{spaceBasicSettingsStore:re,tokenQuery:cl.default.of("")}),l()(this,"handleSpaceNameChange",(e=>{this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,name:e.target.value})})),l()(this,"handleCheckDomainAvailability",(e=>{const{spaceBasicSettingsStore:t}=this.stores,{spaceStore:i}=this.props;k._u({environment:this.environment,spaceStore:i,domain:e}).then((e=>{if("success"!==e.type)this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:"loading"});else{const i=e.data.domain===t.state.domain;this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:i?e.data.domainState:t.state.domainState})}}))})),l()(this,"checkSpaceDomainAvailabilityDebounced",d.debounce(this.handleCheckDomainAvailability,250)),l()(this,"handleSpaceUrlChange",(e=>{const t=k.$U(e.target.value);this.checkSpaceDomainAvailabilityDebounced(t),this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domain:t}),this.forceUpdate()})),l()(this,"handleConfirm",(async()=>{const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t}=this.stores;await k.Y5({environment:this.environment,spaceId:e.id,spaceBasicSettingsStore:t})&&(await k.OF({environment:this.environment,spaceStore:e,spaceBasicSettingsStore:t}),se.setState(se.getInitialState()),he.ZP.setState({...he.ZP.state,open:!1}))})),l()(this,"handleCancelClick",(()=>{he.ZP.setState({...he.ZP.state,open:!1}),se.setState(se.getInitialState())})),l()(this,"handleExportClick",(()=>{const{currentSpaceStore:e}=Z.default.state;e&&Ie.q$({environment:this.environment,root:{table:"space",id:e.id,spaceId:e.id}})})),l()(this,"handleExportMembersClick",(()=>{const{currentSpaceStore:e}=Z.default.state,{data:t}=fe.default.state;e&&t&&"subscribed_admin"===t.type&&Ie.$G({spaceStore:e,subscriptionData:t,intl:this.props.intl})})),l()(this,"handleLeaveClick",(()=>{const{spaceStore:e}=this.props,{currentUserSettingsStore:t}=Z.default.state;t&&C.showDialog({message:n()(y.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.prompt",defaultMessage:"Are you sure you want to leave this workspace?"}),showCancel:!0,keepFocus:!0,items:[{label:n()(y.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.leaveButton.label",defaultMessage:"Leave"}),color:"red",onAccept:async()=>{await k.bf({environment:this.environment,spaceId:e.id,userSettingsStore:t})&&(b.trackLeaveSpace(this.environment),he.ZP.setState({...he.ZP.state,open:!1}))}}]})})),l()(this,"handleDeleteClick",(async()=>{const{currentUserSettingsStore:e}=Z.default.state;if(!e)return;const{spaceStore:t,intl:i}=this.props,a=(0,Na.getSpaceName)(this.environment,t)||i.formatMessage({defaultMessage:"Untitled workspace",id:"spaceBasicSettings.deleteWorkspace.untitledWorkspace.placeholder"});await dl.b({message:n()("div",{},void 0,n()("div",{},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.prompt",defaultMessage:"This action cannot be undone. This will permanently delete the workspace, including all pages and files. Please type the name of the workspace to confirm."})),n()(ul.Z,{style:{marginTop:16},translations:{es:"Esta acción no se puede deshacer. Esto eliminará permanentemente el espacio de trabajo, incluidas todas las páginas y archivos. Por favor escriba el nombre del espacio de trabajo para confirmar.",ru:"Это действие не может быть отменено. Это навсегда удалит рабочее пространство, включая все страницы и файлы. Пожалуйста, введите название рабочей области для подтверждения.",zh:"此操作无法撤消。 这将永久删除工作区，包括所有页面和文件。 请输入要确认的工作空间的名称。",de:"Diese Aktion kann nicht rückgängig gemacht werden. Dadurch wird der Arbeitsbereich einschließlich aller Seiten und Dateien dauerhaft gelöscht. Bitte geben Sie den Namen des Arbeitsbereichs zur Bestätigung ein.",fr:"Cette action ne peut pas être annulée. Cela supprimera définitivement l'espace de travail, y compris toutes les pages et tous les fichiers. Veuillez saisir le nom de l'espace de travail pour confirmer.",ja:"この操作を元に戻すことはできません。 これにより、すべてのページとファイルを含むワークスペースが完全に削除されます。 確認するワークスペースの名前を入力してください。",it:"Questa azione non può essere annullata. Questo eliminerà definitivamente l'area di lavoro, incluse tutte le pagine e i file. Digita il nome dell'area di lavoro per confermare.",pt:"Essa ação não pode ser desfeita. Isso excluirá permanentemente o espaço de trabalho, incluindo todas as páginas e arquivos. Por favor, digite o nome do espaço de trabalho para confirmar.",nl:"Deze actie kan niet ongedaan gemaakt worden. Hiermee wordt de werkruimte permanent verwijderd, inclusief alle pagina's en bestanden. Typ de naam van de werkruimte om te bevestigen.",pl:"Tego działania nie można cofnąć. Spowoduje to trwałe usunięcie obszaru roboczego, w tym wszystkich stron i plików. Wpisz nazwę obszaru roboczego, aby potwierdzić.",sv:"Den här åtgärden kan inte ångras. Detta tar bort arbetsytan permanent, inklusive alla sidor och filer. Vänligen skriv in arbetsplatsens namn för att bekräfta.",uk:"Цю дію не можна скасувати. Це дозволить остаточно видалити робочу область, включаючи всі сторінки та файли. Введіть назву робочої області для підтвердження.",no:"Denne handlingen kan ikke fortrykkes. Dette vil permanent slette arbeidsområdet, inkludert alle sider og filer. Vennligst skriv navnet på arbeidsområdet for å bekrefte.",tr:"Bu işlem geri alınamaz. Bu, tüm sayfaları ve dosyaları içeren çalışma alanını kalıcı olarak siler. Lütfen onaylamak için çalışma alanının adını yazın.",cs:"Tuto akci nelze vrátit zpět. Tím se trvale odstraní pracovní prostor včetně všech stránek a souborů. Zadejte prosím název pracovního prostoru, který chcete potvrdit.",vi:"Hành động này không thể được hoàn tác. Điều này sẽ xóa vĩnh viễn không gian làm việc, bao gồm tất cả các trang và tệp. Vui lòng nhập tên của không gian làm việc để xác nhận.",da:"Denne handling kan ikke fortrydes. Dette vil permanent slette arbejdsområdet, inklusive alle sider og filer. Indtast navnet på arbejdsområdet for at bekræfte.",hu:"Ez a művelet nem visszavonható. Ez véglegesen törli a munkaterületet, beleértve az összes oldalt és fájlt. Kérjük, írja be a munkaterület nevét a megerősítéshez.",ar:"لا يمكن التراجع عن هذا الإجراء. سيؤدي ذلك إلى حذف مساحة العمل كليا ، بما يشمل جميع الصفحات والملفات. يرجى كتابة اسم مساحة العمل للتأكيد.",th:"การกระทำนี้ไม่สามารถยกเลิกได้ นี่จะเป็นการลบพื้นที่ทำงานอย่างถาวรรวมถึงหน้าและไฟล์ทั้งหมด โปรดพิมพ์ชื่อของพื้นที่ทำงานเพื่อยืนยัน",he:"לא ניתן לבטל פעולה זו. פעולה זו תמחק לצמיתות את סביבת העבודה, כולל כל הדפים והקבצים. הקלד את שם מרחב העבודה כדי לאשר.",fi:"Tätä toimintoa ei voi peruuttaa. Tämä poistaa työtilan pysyvästi, mukaan lukien kaikki sivut ja tiedostot. Vahvista kirjoittamalla työtilan nimi.",id:"Tindakan ini tidak bisa dibatalkan. Ini akan secara permanen menghapus ruang kerja, termasuk semua halaman dan file. Silakan ketik nama ruang kerja untuk mengonfirmasi."}})),acceptLabel:n()(y.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.deleteWorkspaceButton.label",defaultMessage:"Permanently delete workspace"}),requiredInputValue:a})&&(k.Ns({environment:this.environment,spaceId:t.id,userSettingsStore:e}),b.trackDeleteSpace(this.environment),he.ZP.setState({...he.ZP.state,open:!1}))})),l()(this,"handleRecordIconChange",(e=>{const{spaceStore:t}=this.props;A.createAndCommit({userAction:"SpaceBasicSettings.handleRecordIconChange",environment:this.environment,perform:i=>{ka.sO({store:t.getIconStore(),value:e,transaction:i})}})}))}willMount(e){super.willMount(e);const{spaceStore:t}=this.props,{spaceBasicSettingsStore:i}=this.stores,a=i.getValueForSpace(t);a&&i.setState(a)}renderComponent(){return ra.Z.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return n()(ba.Z,{},void 0,n()(ii.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.offlineMessage",defaultMessage:"Please go online to manage settings."})))}validateDomain(){const{spaceBasicSettingsStore:e}=this.stores,{domain:t,domainState:i}=e.state;return!!t&&("available"===i||"current-space"===i)}renderSettings(){const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t}=this.stores,{name:i}=t.state,{data:a}=fe.default.state;if(!a)return;const s=e.canAdmin(),o=(0,Na.isGuestOfSpace)(e),r=(0,Na.getSpacePermissionItems)(e),l=L.qF(this.environment),d=s&&!e.getDisableExport(),c=s,p="subscribed_admin"===a.type&&"enterprise"===L.CM(this.environment),g=Gn.Z.getPublicSpaceData(this.environment,e.id);return n()(ba.Z,{controlRow:s&&this.renderControlRow()},void 0,this.renderSpaceBasicHeader(),o&&n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"}},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.guestLimitedAccessMessage",defaultMessage:"You are currently a guest in this workspace. Ask an admin to add you as a member in order to see other pages and workspace settings."})),o&&ba.Z.renderDivider(),s&&n()(u.Fragment,{},void 0,n()(qt.Z,{},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.title",defaultMessage:"Name"})),n()(tt.Z,{value:i,placeholder:Ce.default.formatMessage(El.nameInputPlaceholder),readOnly:!s,onChange:this.handleSpaceNameChange}),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4}},void 0,n()(Bl,{})),ba.Z.renderDivider()),s&&n()(u.Fragment,{},void 0,n()(qt.Z,{},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.title",defaultMessage:"Icon"})),n()("div",{style:{width:72,height:72,border:"1px solid ".concat(this.theme.regularDividerColor),borderRadius:6,display:"flex",justifyContent:"center",alignItems:"center"}},void 0,n()(xa.Z,s?{bucket:"public",disabled:!1,icon:(0,Na.getSpaceIcon)(this.environment,e),isEmptyPage:!1,title:i,size:64,iconLoggingData:{recordTable:e.table,source:"workspace_settings"},onChange:this.handleRecordIconChange}:{disabled:!0,icon:(0,Na.getSpaceIcon)(this.environment,e),isEmptyPage:!1,title:i,size:64})),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8}},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.caption",defaultMessage:"Upload an image or pick an emoji. It will show up in your sidebar and notifications."})),ba.Z.renderDivider()),s&&m().createElement(m().Fragment,null,n()(yl,{canAdminSpaceStore:s,domainIsAutogenerated:null==g?void 0:g.domainIsAutogenerated,spaceStore:e,spaceBasicSettingsStore:t,handleSpaceUrlChange:this.handleSpaceUrlChange}),ba.Z.renderDivider()),s&&l&&n()(u.Fragment,{},void 0,n()(qt.Z,{},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.title",defaultMessage:"Allowed email domains"})),this.renderAllowedEmailDomains(),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4}},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.caption",defaultMessage:"Anyone with email addresses at these domains can automatically join your workspace."})),ba.Z.renderDivider()),s&&n()(u.Fragment,{},void 0,n()(Fl,{spaceBasicSettingsStore:t}),ba.Z.renderDivider()),d&&n()(u.Fragment,{},void 0,n()(qt.Z,{},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.title",defaultMessage:"Export content"})),n()("div",{style:{display:"flex"}},void 0,n()(Ht.Z,{isLarge:!0,onClick:this.handleExportClick},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportButton.label",defaultMessage:"Export all workspace content"}))),n()("div",{style:{height:12}}),n()(fa.Z,{title:n()(y.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.helpButton.caption",defaultMessage:"Learn about exporting workspaces."}),href:(0,R.UY)("guides.exportWorkspace"),analyticsFrom:"space_settings"}),ba.Z.renderDivider()),c&&n()(u.Fragment,{},void 0,n()(qt.Z,{style:{display:"flex",alignItems:"center"}},void 0,n()("span",{style:{marginRight:8}},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.title",defaultMessage:"Export members"})),!p&&n()(Yn.Z,{subscriptionTier:"enterprise",analyticsName:"space_export_members",desktopStyle:{marginTop:-1}})),n()("div",{style:{display:"flex"}},void 0,n()(Ht.Z,{isLarge:!0,disabled:!p,onClick:this.handleExportMembersClick,disabledFeedback:!0},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.exportAsCSVButton.label",defaultMessage:"Export members as CSV"}))),n()("div",{style:{height:12}}),n()(fa.Z,{title:n()(y.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.helpButton.caption",defaultMessage:"Learn about exporting members."}),href:(0,R.UY)("guides.exportMembers"),analyticsFrom:"space_settings"}),ba.Z.renderDivider()),n()(qt.Z,{},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.title",defaultMessage:"Danger zone"})),n()("div",{style:{display:"flex"}},void 0,(r.length>1||o)&&n()(Ht.Z,{isLarge:!0,onClick:this.handleLeaveClick,style:{marginRight:s?12:void 0}},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.leaveWorkspaceButton.label",defaultMessage:"Leave workspace"})),s&&n()(Ht.Z,{isLarge:!0,isRed:!0,onClick:this.handleDeleteClick},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceButton.label",defaultMessage:"Delete entire workspace"}))),s&&n()(u.Fragment,{},void 0,n()("div",{style:{height:12}}),n()(fa.Z,{title:n()(y.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceHelpButton.caption",defaultMessage:"Learn about deleting workspaces."}),href:(0,R.UY)("guides.deleteWorkspace"),analyticsFrom:"space_settings"})))}renderSpaceBasicHeader(){return n()(qt.Z,{large:!0,divider:"full"},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.title",defaultMessage:"Workspace settings"}))}renderControlRow(){return n()("div",{style:{display:"flex"}},void 0,n()(xe.Z,{isLarge:!0,onClick:this.handleConfirm,disabled:!this.validateDomain()},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.updateButton.label",defaultMessage:"Update"})),n()(Ht.Z,{isLarge:!0,style:{marginLeft:12},onClick:this.handleCancelClick},void 0,n()(y.FormattedMessage,{id:"spaceBasicSettings.cancelButton.label",defaultMessage:"Cancel"})))}renderAllowedEmailDomains(){const{device:e}=this.environment,{spaceStore:t}=this.props,{spaceBasicSettingsStore:i}=this.stores,{emailDomains:a}=i.state,s=t.canAdmin();return n()(De.ZP,{popupType:e.isMobile?De.ZP.PopupType.SlideUp:De.ZP.PopupType.Popup,sameWidthAsOrigin:!0,open:this.stores.tokenQuery.get().length>0,origin:n()(ao.Z,{placeholder:Ce.default.formatMessage(El.allowedEmailDomainsInputPlaceholder),value:this.stores.tokenQuery.get(),onChange:e=>this.stores.tokenQuery.set(e.target.value),readOnly:!s,onRemoveLastToken:()=>{const e=a.slice(0,a.length-1);i.setState({...i.state,emailDomains:e})},tokens:a.map((e=>n()(io.Z,{showRemoveButton:!0,isSingle:!1,format:Qs.l.Medium,onClickRemove:()=>{const t=a.filter((t=>t!==e));i.setState({...i.state,emailDomains:t})},value:e},e)))}),render:()=>{const t=this.stores.tokenQuery.get().trim(),{data:s}=fe.default.state,{spaceStore:r}=this.props,l=n()(y.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholder",defaultMessage:"Type an email domain…"}),d=n()(y.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholderNoResults",defaultMessage:"Type an email domain of a member of this workspace…"}),c=s?L.hn(s).map((e=>{if(("unsubscribed_admin"===s.type||"unsubscribed_member"===s.type||"subscribed_admin"===s.type)&&s.joinedMemberIds.includes(e.userId)){const t=yt.Z.createChildStore(r,{table:be.KJ,id:e.userId}).getEmail();return t&&(0,ll.Gd)(t)}})).filter(((e,t,i)=>Boolean(e&&t===i.indexOf(e)&&!a.includes(e)))):[],u=(0,Ua.ZP)(t,c,(e=>e)).map(((e,t)=>({key:t,render:t=>m().createElement(Fe.Z,o()({},t,{title:e})),action:()=>{const t=[...a,e];i.setState({...i.state,emailDomains:t}),this.stores.tokenQuery.set("")}})));let p;return p=e.isMobile?{menuType:Be.Z.MenuType.ActionSheet}:{menuType:Be.Z.MenuType.Popup,width:"100%"},m().createElement(Be.Z,p,n()(Ee.Z,{type:Ee.Z.Type.Vertical,initialFocus:u.length>0?0:void 0,sections:[{key:0,render:e=>m().createElement(Re.Z,o()({},e,{disableDesktopPadding:!0,title:u.length>0?l:d})),items:u}]}))},onDismiss:()=>{this.stores.tokenQuery.set("")}})}}const Rl=(0,y.injectIntl)(Dl);var Ll=i(93192),Ol=i(53471),Nl=i(97832),Ul=i(33954),Wl=i(78873);let Vl;!function(e){e.Password="Password",e.CurrentEmail="TemporaryPasscode"}(Vl||(Vl={}));class zl extends N.Z{getInitialState(){return{open:!1,authorized:!1,authorizationType:void 0}}}const Gl=zl;var Hl=i(37770),ql=i(13490);class Kl extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{store:Gl}),l()(this,"renderModalContent",(()=>{const{store:e}=this.stores,{state:t}=e;return n()("div",{style:{...this.styles.modal,...this.getColors().modal}},void 0,n()(Hl.Z,{fetch:this.getAuthorizationType,loading:e=>e&&n()("div",{style:this.styles.loadingSpinner},void 0,n()(ya.Z,{})),render:()=>n()(m().Fragment,{},void 0,t.authorizationType===Vl.Password?this.renderVerifyPassword(t):t.authorizationType===Vl.CurrentEmail?this.renderVerifyCurrentEmail(t):void 0,t.authorized&&this.renderSetNewEmail(t))}))})),l()(this,"renderSetNewEmail",(e=>{const{store:t}=this.stores;if(t.state.authorized)return n()(m().Fragment,{},void 0,n()("p",{style:this.styles.paragraph},void 0,n()(y.FormattedMessage,{id:"profileSettings.changeEmailModal.newEmailInstructions",defaultMessage:"Please enter a new email and we will send you a verification code."})),n()("div",{},void 0,this.renderNewEmailInput()),t.state.newEmailPasscodeSent?this.renderNewEmailPasscodeInput(e):this.renderSendNewEmailPasscodeButton(e),this.renderEducationPlanDowngradeWarning())})),l()(this,"handleSendCurrentEmailVerification",(async()=>{const{userValue:e}=this.props,{store:t}=this.stores;if(!e)return;const i=await w.sendTemporaryPassword(this.environment,{email:e.email,disableLoginLink:!0,isSignup:!1});"success"===i.type?t.setState({...t.state,currentEmailPasscodeSent:!0,currentEmailPasscode:"",error:void 0}):t.setState({...t.state,currentEmailPasscodeSent:!0,error:(0,Ul.wf)(this.props.intl,i)})})),l()(this,"handleChangeCurrentEmailPasscode",(e=>{const{store:t}=this.stores;t.setState({...t.state,currentEmailPasscode:e.currentTarget.value,error:void 0})})),l()(this,"handleChangePassword",(e=>{const{store:t}=this.stores;t.setState({open:!0,authorized:!1,authorizationType:Vl.Password,password:e.currentTarget.value,error:void 0})})),l()(this,"handleClearPassword",(()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:Vl.Password,password:""})})),l()(this,"handleSubmitAuthorization",(async()=>{const{store:e}=this.stores;if(!e.state.authorized)if(e.state.authorizationType===Vl.Password){const t=this.getUserCurrentEmail();if(!t)return;const i=await w.loginWithEmail(this.environment,{email:t,password:e.state.password});if("failed"===i.type)return void e.setState({...e.state,error:(0,Ul.wf)(this.props.intl,i)});e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1})}else e.state.authorizationType===Vl.CurrentEmail&&e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1})})),l()(this,"handleChangeNewEmail",(e=>{const{store:t}=this.stores;t.setState({...t.state,newEmail:e.currentTarget.value,error:void 0})})),l()(this,"handleClearNewEmail",(()=>{const{store:e}=this.stores;e.setState({...e.state,newEmail:"",newEmailPasscodeSent:!1,error:void 0})})),l()(this,"handleSendNewEmailVerification",(async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=await w.sendEmailVerification(this.environment,{email:e.state.newEmail});"success"===t.type?e.setState({...e.state,newEmailPasscodeSent:!0,newEmailPasscode:"",error:void 0}):e.setState({...e.state,error:(0,Ul.wf)(this.props.intl,t)})})),l()(this,"handleChangeNewEmailPasscode",(e=>{const{store:t}=this.stores;t.setState({...t.state,newEmailPasscode:e.currentTarget.value,error:void 0})})),l()(this,"handleSubmit",(async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=e.state.authorizationType===Vl.Password?{type:"Password",password:e.state.password,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode}:{type:"CurrentEmail",currentEmailPasscode:e.state.currentEmailPasscode,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode},i=await w.changeEmail(this.environment,t);"success"===i.type?await this.closeModal():e.setState({...e.state,error:(0,Ul.wf)(this.props.intl,i)})})),l()(this,"handleSendUsMessageClick",(()=>{vs.j({environment:this.environment,from:"change_email_student"})})),l()(this,"openModal",(()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:void 0})})),l()(this,"closeModal",(async()=>{const{store:e}=this.stores,{hasEducationPlan:t}=this.props;e.reset(),t&&await _.bi(this.environment)})),l()(this,"getAuthorizationType",(async()=>{const{store:e}=this.stores,{intl:t}=this.props,i=this.getUserCurrentEmail();if(!i)return;const a=await Wl.c({environment:this.environment,userEmail:i});a.error?e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:t.formatMessage({id:"profileSettings.changeEmailModal.errorFetchingAccountData",defaultMessage:"Could not fetch account information for {currentEmail}."},{currentEmail:i})}):a.value.isSamlEnforced||!a.value.hasPassword?e.setState({open:!0,authorized:!1,authorizationType:Vl.CurrentEmail,currentEmailPasscodeSent:!1,currentEmailPasscode:""}):e.setState({open:!0,authorized:!1,authorizationType:Vl.Password,password:""})})),l()(this,"styles",{modal:{width:460,padding:32,borderRadius:3,fontSize:14},loadingSpinner:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},paragraph:{marginTop:12,marginBottom:14},error:{color:g.ZP.red,fontSize:12,marginTop:4,marginLeft:8},bold:{fontWeight:v.Z.fontWeight.bold},input:{padding:"4px 8px"},button:{marginTop:14},educationPlanWarning:{display:"flex",marginTop:14,paddingTop:14}})}renderComponent(){const{userValue:e}=this.props,{store:t}=this.stores;return n()(m().Fragment,{},void 0,n()(ql.Z,{},void 0,n()(y.FormattedMessage,{id:"profileSettings.personalInfoSection.emailSetting.label",defaultMessage:"Email"})),n()("div",{},void 0,n()("span",{style:{marginRight:12}},void 0,e&&e.email),n()(Fs.Z,{onClick:this.openModal},void 0,n()(y.FormattedMessage,{id:"profileSettings.personalInfoSection.emailSetting.changeEmailButton.label",defaultMessage:"Change email"}))),n()(Ga.Z,{open:t.state.open,onDismiss:this.closeModal,render:this.renderModalContent}))}renderVerifyPassword(e){const{userValue:t}=this.props;if(t)return n()(m().Fragment,{},void 0,n()("p",{style:{margin:0}},void 0,this.renderCurrentEmail()),n()("p",{style:this.styles.paragraph},void 0,n()(y.FormattedMessage,{id:"profileSettings.changeEmailModal.enterPasswordInstructions",defaultMessage:"Please enter your password."})),n()(tt.Z,{style:{display:"none"},type:"text",value:t.email,autoComplete:"username",disabled:!0}),n()(tt.Z,{type:"password",disabled:e.authorized,value:e.password,onChange:this.handleChangePassword,showClearButton:!0,onClearButtonClick:this.handleClearPassword,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.passwordInput.label",defaultMessage:"Password"}),style:this.styles.input,focusInitial:!0,autoComplete:"current-password"}),!e.authorized&&e.error&&n()("div",{style:this.styles.error},void 0,e.error),!e.authorized&&n()(xe.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmitAuthorization},void 0,n()(y.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue",description:"After the user verifies their current password or email, they click this button to continue changing their email."})))}renderVerifyCurrentEmail(e){return n()(m().Fragment,{},void 0,n()("p",{style:{...this.styles.paragraph,marginTop:0}},void 0,this.renderCurrentEmail()," ",e.currentEmailPasscodeSent?n()(y.FormattedMessage,{id:"profileSettings.changeEmailModal.sentVerificationCodeToCurrentEmail",defaultMessage:"We've sent a temporary verification code to this email."}):n()(y.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeToCurrentEmail",defaultMessage:"We'll send a temporary verification code to this email."})),e.currentEmailPasscodeSent?this.renderCurrentEmailPasscodeInput(e):this.renderSendCurrentEmailPasscodeButton())}renderSendCurrentEmailPasscodeButton(){return n()(xe.Z,{isLarge:!0,onClick:this.handleSendCurrentEmailVerification},void 0,n()(y.FormattedMessage,{id:"profileSettings.changeEmailModal.sendCurrentEmailVerificationCode.label",defaultMessage:"Send verification code",description:"Sends a temporary verification passcode to the user's current email."}))}renderCurrentEmailPasscodeInput(e){return n()(m().Fragment,{},void 0,n()(tt.Z,{value:e.currentEmailPasscode,onChange:this.handleChangeCurrentEmailPasscode,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterCurrentEmailVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:this.styles.input}),!e.authorized&&n()(xe.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmitAuthorization},void 0,n()(y.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue",description:"After the user verifies their current password or email, they click this button to continue changing their email."})))}renderNewEmailInput(){const{store:e}=this.stores;if(e.state.authorized)return n()(tt.Z,{value:e.state.newEmail,onChange:this.handleChangeNewEmail,onSubmit:this.handleSendNewEmailVerification,showClearButton:!0,onClearButtonClick:this.handleClearNewEmail,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.newEmailInput.placeholder",defaultMessage:"Enter new email"}),style:this.styles.input,focusInitial:!0})}renderSendNewEmailPasscodeButton(e){return n()(m().Fragment,{},void 0,e.error&&n()("div",{style:this.styles.error},void 0,e.error),n()(xe.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSendNewEmailVerification},void 0,n()(y.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeButton.label",defaultMessage:"Send verification code"})))}renderNewEmailPasscodeInput(e){return n()(m().Fragment,{},void 0,n()("p",{style:this.styles.paragraph},void 0,n()(y.FormattedMessage,{id:"profileSettings.changeEmailModal.verificationCodeSentMessage",defaultMessage:"We just sent you a temporary verification code to {newEmail}.",values:{newEmail:n()("span",{style:this.styles.bold},void 0,e.newEmail)}})),n()(tt.Z,{value:e.newEmailPasscode,onChange:this.handleChangeNewEmailPasscode,onSubmit:this.handleSubmit,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:this.styles.input}),e.error&&n()("div",{style:this.styles.error},void 0,e.error),n()(xe.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmit},void 0,n()(y.FormattedMessage,{id:"profileSettings.changeEmailModal.changeEmailButton.label",defaultMessage:"Change email"})))}renderEducationPlanDowngradeWarning(){var e=this;const{hasEducationPlan:t}=this.props;if(t)return n()("div",{style:{...this.styles.educationPlanWarning,...this.getColors().educationPlanWarning}},void 0,h.Z.help({width:14,marginTop:4,marginRight:6,fill:this.theme.lightIconColor})," ",n()("div",{},void 0,n()(y.FormattedMessage,{defaultMessage:"Changing your email may downgrade your workspace on a Free Education Plan to the basic Free Plan. You won't lose any data, but you'll need to upgrade to re-access paid features. Have questions about this? <sendmessagelink>Message support</sendmessagelink>.",id:"emailChangeSettings.downgradeEducationPlan.warning.message",values:{sendmessagelink:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n()(va.Z,{onClick:e.handleSendUsMessageClick},void 0,i)}}})))}renderCurrentEmail(){const{userValue:e}=this.props;if(e)return n()(y.FormattedMessage,{id:"profileSettings.changeEmailModal.currentEmail",defaultMessage:"Your current email is {currentEmail}.",values:{currentEmail:n()("span",{style:this.styles.bold},void 0,e&&e.email)}})}getUserCurrentEmail(){const{store:e}=this.stores,{userValue:t,intl:i}=this.props;if(t)return t.email;e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:i.formatMessage({id:"profileSettings.changeEmailModal.errorNoUserValue",defaultMessage:"User value is undefined."})})}getColors(){return{modal:{background:this.theme.contentBackground},educationPlanWarning:{color:this.theme.lightTextColor,borderTop:"1px solid ".concat(this.theme.regularDividerColor)}}}}const jl=(0,y.injectIntl)(Kl);var Yl=i(4637);class Ql extends N.Z{getInitialState(){return{open:!1}}}const Jl=new Ql;class Xl extends p.Z{constructor(){super(...arguments),l()(this,"handleLogOutFromActiveSessions",(async()=>{b.trackLogOutFromActiveSessions(this.environment),await w.logoutActiveSessions(this.environment,{}),this.openConfirmationModal()}))}renderComponent(){return m().createElement(m().Fragment,null,n()("div",{style:this.getSettingsOptionStyle()},void 0,n()(qt.Z,{smallMarginBottom:!0},void 0,n()(y.FormattedMessage,{id:"manageActiveSessions.title",defaultMessage:"Log out of all devices"})),n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,n()(y.FormattedMessage,{id:"manageActiveSessions.logOutActiveSessions.label",defaultMessage:"You will be logged out of all other active sessions besides this one and will have to log back in."})),n()(Ht.Z,{isLarge:!0,isRed:!0,onClick:this.handleLogOutFromActiveSessions,style:{marginTop:12}},void 0,n()(y.FormattedMessage,{id:"manageActiveSessions.logOutActiveSessions.button",defaultMessage:"Log out"}))),this.renderManageActiveSessionsModal())}renderManageActiveSessionsModal(){const{device:e}=this.environment,{open:t}=Jl.state,i=this.getUserEmailAddress();return n()(Ga.Z,{open:t,onDismiss:this.closeConfirmationModal,innerStyle:{width:e.isPhone?"90%":350,padding:24,display:"flex",flexDirection:"column"},render:()=>m().createElement(m().Fragment,null,n()("div",{style:{marginBottom:24}},void 0,n()(y.FormattedMessage,i?{id:"manageActiveSessions.confirmationModal.withEmail",defaultMessage:"You have been logged out from other active sessions for {email}.",values:{email:i}}:{id:"manageActiveSessions.confirmationModal.withoutEmail",defaultMessage:"You have been logged out from other active sessions for your account."})),n()(xe.Z,{onClick:this.closeConfirmationModal},void 0,n()(y.FormattedMessage,{id:"manageActiveSessions.confirmationModal.close",defaultMessage:"Close"})))})}openConfirmationModal(){Jl.setState({...Jl.state,open:!0})}closeConfirmationModal(){Jl.setState({...Jl.state,open:!1})}getUserEmailAddress(){let e;const{currentUserStore:t}=Z.default.state;if(t){const i=t.getValue();e=i&&i.email}return e}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}const $l=Xl;var ed=i(1548),td=i(48243),id=i(30045);class ad extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{spaceProfileSettingsStore:ue,passwordRequestStore:da.Z,isEducationStore:cl.default.of(!1)}),l()(this,"handleUploadProfilePhoto",(()=>{b.trackUploadProfilePhoto(this.environment),Ol.cR({environment:this.environment,onStart:this.handleUploadStart,bucket:"public",onError:this.handleUploadError,onComplete:this.handleUploadComplete,accept:"image/*"})})),l()(this,"handleDeleteProfilePhoto",(()=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,profilePhoto:void 0})})),l()(this,"handleUpdateClick",(()=>{const{name:e,profilePhoto:t}=this.stores.spaceProfileSettingsStore.state;e?(A.createAndCommit({userAction:"SpaceProfileSettings.handleUpdateClick",environment:this.environment,perform:i=>{const{currentUserStore:a}=Z.default.state;a&&M.A({userStore:a,data:{profilePhoto:t,name:e},transaction:i})}}),he.ZP.setState({...he.ZP.state,open:!1})):C.showErrorMessage(n()(y.FormattedMessage,{id:"profileSettings.personalInfoSection.nameMissing.message",defaultMessage:"Please fill in name."}))})),l()(this,"handleCancelClick",(()=>{he.ZP.setState({...he.ZP.state,open:!1})})),l()(this,"handleNameChange",(e=>{b.trackNameChanged(this.environment,{from:this.stores.spaceProfileSettingsStore.state.name,to:e.target.value}),this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,name:e.target.value})})),l()(this,"handleUploadStart",(()=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,uploadingProfilePhoto:!0})})),l()(this,"handleUploadError",(()=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,uploadingProfilePhoto:!1}),C.showErrorMessage(n()(y.FormattedMessage,{id:"profileSettings.profilePhotoSection.uploadProfilePhotoError.message",defaultMessage:"Upload failed."}))})),l()(this,"handleUploadComplete",(e=>{this.stores.spaceProfileSettingsStore.setState({...this.stores.spaceProfileSettingsStore.state,profilePhoto:e[0],uploadingProfilePhoto:!1})}))}willMount(e){super.willMount(e);const{spaceProfileSettingsStore:t,isEducationStore:i}=this.stores,{currentUserStore:a,currentUserSettingsStore:n,currentUserRootStore:s}=Z.default.state;if(a&&n){const e=t.getValueForUser(a,n);e&&t.setState(e)}if(s){const e=((0,L.xR)({environment:this.environment,userRootStore:s})||[]).some((e=>e===Gt.Z.pricing.student.productId));i.set(e)}}renderComponent(){return ra.Z.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return n()(ba.Z,{},void 0,n()(ii.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,n()(y.FormattedMessage,{defaultMessage:"Please go online to manage your profile.",id:"profileSettings.offline.message"})))}renderSettings(){const{currentUserStore:e}=Z.default.state;if(!e)return;e.getValue();const{profilePhoto:t,uploadingProfilePhoto:i,name:a}=this.stores.spaceProfileSettingsStore.state,{passwordRequestStore:s}=this.stores,o="on"===ie.default.getGroup("user-data-consent");return s.state.loading?n()(ya.Z,{style:{margin:"50% auto"}}):n()(ba.Z,{controlRow:this.renderControlRow()},void 0,this.renderSpaceProfileHeader(),n()("div",{style:{marginBottom:24}},void 0,n()(fa.Z,{style:{display:"block"},buttonStyle:{height:"inherit",whiteSpace:"inherit"},title:n()("div",{style:{display:"block"}},void 0,n()(y.FormattedMessage,{id:"profileSettings.helpButton.caption",defaultMessage:"Changes to account settings will apply to all of your workspaces."})," ",n()(y.FormattedMessage,{id:"profileSettings.helpButton.learnMoreLink",defaultMessage:"<s>Learn more.</s>",values:{s:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("span",{style:{textDecoration:"underline"}},void 0,t)}}})),href:(0,R.UY)("guides.profileSettings"),analyticsFrom:"profile_settings"})),n()(qt.Z,{},void 0,n()(y.FormattedMessage,{id:"profileSettings.profilePhotoSection.title",defaultMessage:"Photo"})),t&&n()(td.Z,{url:t,isAuthenticated:!1,stripGoogleIconQuery:!0,width:90,render:(e,t)=>n()("div",{style:{width:90,height:90}},void 0,n()(Yl.Z,{src:t,style:{width:90,height:90,objectFit:"cover",borderRadius:"100%"}}))}),n()(Ht.Z,{isLarge:!0,onClick:this.handleUploadProfilePhoto,style:{marginTop:8,marginBottom:4}},void 0,n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()(y.FormattedMessage,{id:"profileSettings.profilePhotoSection.uploadPhotoButton.label",defaultMessage:"Upload photo"}),i&&n()(ya.Z,{style:{marginLeft:4}}))),t&&"on"===ie.default.getGroup("remove-profile-photo-string")&&n()(Ht.Z,{onClick:this.handleDeleteProfilePhoto,style:{marginTop:4,marginLeft:12,marginBottom:2}},void 0,n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()(y.FormattedMessage,{id:"profileSettings.profilePhotoSection.removePhotoButton.label",defaultMessage:"Remove"}))),ba.Z.renderDivider(),n()(qt.Z,{},void 0,n()(y.FormattedMessage,{id:"profileSettings.personalInfoSection.title",defaultMessage:"Personal info"})),n()(jl,{userValue:(0,F.S4)(this.environment),hasEducationPlan:this.stores.isEducationStore.get()}),this.renderNameRow(a),ba.Z.renderDivider(),n()(ed.Z,{isEducationPlan:this.props.isEducationPlan,requestStore:s}),o&&ba.Z.renderDivider(),o&&n()(id.Z,{}),ba.Z.renderDivider(),n()($l,{}),ba.Z.renderDivider(),n()(Nl.Z,{}))}renderNameRow(e){return m().createElement(m().Fragment,null,n()(ql.Z,{hasMarginTop:!0},void 0,n()(y.FormattedMessage,{id:"profileSettings.personalInfoSection.nameInput.label",defaultMessage:"Preferred name",description:"User's name, may be full name or a nickname."})),n()(tt.Z,{value:e,onChange:this.handleNameChange}))}renderControlRow(){return n()("div",{style:{display:"flex"}},void 0,n()(xe.Z,{isLarge:!0,onClick:this.handleUpdateClick},void 0,n()(y.FormattedMessage,{id:"profileSettings.updateButton.label",defaultMessage:"Update"})),n()(Ht.Z,{isLarge:!0,style:{marginLeft:12},onClick:this.handleCancelClick},void 0,n()(y.FormattedMessage,{id:"profileSettings.cancelButton.label",defaultMessage:"Cancel"})))}renderSpaceProfileHeader(){return n()(qt.Z,{large:!0,divider:"full"},void 0,n()(y.FormattedMessage,{id:"profileSettings.title",defaultMessage:"Account"}))}}const nd=(0,y.injectIntl)(ad);function sd(e){let{users:t,store:i,extraColumns:a,initialSort:s}=e;const[o,r]=(0,u.useState)(s);function l(e,t){return n()(ei.Z,{disabled:!t.sortable,ignoreLocalHoverState:!0,onClick:()=>{!function(e){r({column:e,asc:(null==o?void 0:o.column)===e&&!(null!=o&&o.asc)})}(e)},style:{display:"flex",alignItems:"center"}},void 0,t.title,t.sortable&&o&&o.column===e&&function(e){const{up:t}=e,i={width:10,height:10,marginLeft:4};return t?h.Z.arrowDownSmall({...i,transform:"rotate(180deg)"}):h.Z.arrowDownSmall(i)}({up:o.asc}))}const d={name:{title:n()(y.FormattedMessage,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),style:{width:"60%"},sortable:!0,renderer:e=>n()(ai.Z,{userValue:e}),getValue:e=>e.name||"Unknown"},...a},p=c().keys(d).map((e=>({key:e,header:l(e,d[e]),style:d[e].style}))),g=(0,Se.VK)((()=>t.map((e=>({member:e,store:yt.Z.createChildStore(i,{table:be.KJ,id:e.userId})}))).filter((e=>void 0!==e.store.getValue())).map((e=>{let{store:t}=e;return t.getValue()})).filter(W.$K)),[t,i]),f=o?g.sort(((e,t)=>{const i=d[o.column].getValue(e),a=d[o.column].getValue(t);var n=i<a?-1:i>a?1:0;return o.asc?n:-1*n})):g;return n()(ti.Z,{columns:p,rows:f.map((e=>{const t=Object.values(d).map((t=>t.renderer?t.renderer(e):m().createElement(m().Fragment,null,t.getValue(e))));return{key:e.id,columns:t}}))})}var od;!function(e){e[e.UserUserSimilarity=0]="UserUserSimilarity"}(od||(od={}));const rd={[od.UserUserSimilarity]:n()(y.FormattedMessage,{id:"spaceSettingsDebugZone.userUserSimilarity.title",defaultMessage:"User Similarity",description:"Title for a tab in a debug view where users can see how similar they are to other users in their workspace."})};function ld(){const e=(0,Rn.mS)();return["on"===ie.default.getGroup("user_similarity_debugging")||e?od.UserUserSimilarity:void 0].filter(W.$K)}function dd(e){let{store:t}=e;const{isOnline:i,subscriptionDataStoreData:a,userSimilarityData:s,visibleUsersLoaded:o,visibleUsers:r}=(0,Se.VK)((()=>{var e,i;const a=null===(e=fe.default.state)||void 0===e?void 0:e.data,n=a?L.uF(a):[],s=c().every(n.map((e=>yt.Z.createChildStore(t,{table:be.KJ,id:e.userId}).isReady())));return{isOnline:ra.Z.state.online,subscriptionDataStoreData:a,userSimilarityData:(null===(i=fe.default.state.data)||void 0===i?void 0:i.userSimilarity)||{},visibleUsersLoaded:s,visibleUsers:n}}),[t]);if(!i)return n()(ii.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,n()(y.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."}));if(!a)return n()(ya.Z,{style:{margin:"calc(50% - 1em) auto"}});if(!o)return n()(ya.Z,{style:{margin:"calc(50% - 1em) auto"}});const l={style:{},title:m().createElement(m().Fragment,null,"Similarity Score"),sortable:!0,renderer:e=>{var t;return m().createElement(m().Fragment,null,(null===(t=s[e.id])||void 0===t?void 0:t.toFixed(3))||0)},getValue:e=>s[e.id]||0};return n()(sd,{users:r,store:t,extraColumns:{similarityColumn:l},initialSort:{column:"similarityColumn",asc:!1}})}function cd(e){let{store:t}=e;const{tabs:i}=(0,Se.VK)((()=>({tabs:ld()})),[]),[a,s]=(0,u.useState)(i[0]);return n()(ba.Z,{},void 0,n()(ol.Z,{tabs:i.map((e=>rd[e])),selectedIndex:i.indexOf(a),onChange:e=>s(i[e]),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),a===od.UserUserSimilarity&&n()(dd,{store:t}))}var ud=i(6906),md=i(60897);var pd=i(80567);const gd={workspaceBalance:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.workspaceSubscriptionBalance.title",defaultMessage:"Workspace balance"}),applyCoupon:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.applyCoupon.title",defaultMessage:"Apply coupon"}),discount:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.discount.title",defaultMessage:"Discount"})};var hd=i(77907);class fd extends N.Z{getInitialState(){return{paymentMethodModalOpen:!1,billingIntervalModalOpen:!1,billingEmailModalOpen:!1,vatIdModalOpen:!1,addressModalOpen:!1,applyCreditModalOpen:!1,billingEventsLimit:20,applyCouponModalOpen:!1,addressErrorMessage:void 0}}setAddressField(e){const t=this.state.temporaryAddress?this.state.temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""};this.setState({...this.state,temporaryAddress:{...t,...e},addressErrorMessage:void 0})}}const vd=fd;class yd extends N.Z{getInitialState(){return{inputValue:void 0}}}const Sd=yd;class Md extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{store:Sd}),l()(this,"handleInputChange",(e=>{const{store:t}=this.stores,i=e.target.value,a=this.inputValueToCents(i);let n;n=i?void 0!==a?i:this.getCurrentInputValue():"",t.setState({inputValue:n}),this.forceUpdate(),this.props.onChange(this.inputValueToCents(n)||0)}))}renderComponent(){const{focus:e,selectAll:t,availableCredit:i}=this.props,a=this.getCurrentInputValue();return n()(tt.Z,{value:a,onChange:this.handleInputChange,focus:e,selectAll:t,disabled:i<=0,style:{maxWidth:120},inputStyle:{textAlign:"right"}})}getCurrentInputValue(){const{availableCredit:e}=this.props,{inputValue:t}=this.stores.store.state;return void 0===t?"".concat(Math.floor(e/100)):t}inputValueToCents(e){const{availableCredit:t}=this.props,i=Math.floor(100*parseFloat(e));if(!isNaN(i)&&i<=t&&i>=0)return i}}const bd=Md;var wd=i(17256),Cd=i(28240);class Td extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{store:vd,billingHistoryRequestStore:da.Z}),l()(this,"performGetBillingHistoryRequest",(async e=>{const{spaceStore:t}=this.props,i=await w.getBillingHistory(this.environment,{spaceId:t.id,limit:e});if("failed"===i.type)throw i.error;return i.data})),l()(this,"renderBillingHistoryResults",((e,t)=>{this.props.mockBillingHistoryResult&&(t=this.props.mockBillingHistoryResult);const{billingHistoryRequestStore:i}=this.stores;return n()("div",{},void 0,t&&0===t.events.length&&n()("div",{style:{color:this.theme.mediumTextColor,fontSize:14}},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.noInvoicesMessage",defaultMessage:"This workspace has no payments yet."})),t&&t.events.length>0&&n()("table",{},void 0,n()("tbody",{},void 0,t.events.map(this.renderBillingHistoryEvent))),t&&!t.reachedEndOfResults&&n()(ut.Z,{onClick:this.handleLoadMoreBillingEventsClick,style:{marginLeft:-4,width:"100%"}},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.loadMoreInvoicesButton.label",defaultMessage:"Load more"})),i.state.loading&&n()(ya.Z,{}))})),l()(this,"renderBillingHistoryEvent",((e,t)=>{let i;const{intl:a}=this.props;return i="paid"===e.status?e.total<0?n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.credited",defaultMessage:"Credited"}):n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.paid",defaultMessage:"Paid"}):e.attempted?n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.failed",defaultMessage:"Failed"}):n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.due",defaultMessage:"Due",description:"Label for the amount that the user owes on a given invoice"}),n()("tr",{style:{height:28,fontSize:14,whiteSpace:"nowrap"}},t,n()("td",{style:{width:"100%",paddingRight:18,color:this.theme.mediumTextColor}},void 0,(0,wd.Z)(e.timestamp).format("LL")),n()("td",{style:{paddingRight:18}},void 0,i),n()("td",{style:{paddingRight:18,textAlign:"right"}},void 0,(0,yr.Dx)({amount:e.total,currency:"dollar",intl:a})),n()("td",{},void 0,n()(Cd.Z,{inline:!0,href:"/invoice/".concat(e.id),external:!0,innerStyle:this.getViewInvoiceButtonStyle()},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.viewInvoiceButton",defaultMessage:"View invoice"}))))})),l()(this,"handleLoadMoreBillingEventsClick",(()=>{this.stores.store.setState({...this.stores.store.state,billingEventsLimit:this.stores.store.state.billingEventsLimit+Td.billingEventsLimitIncrement})}))}renderComponent(){const{store:e,billingHistoryRequestStore:t}=this.stores,i={request:e.state.billingEventsLimit,performRequest:this.performGetBillingHistoryRequest,render:this.renderBillingHistoryResults};return n()("div",{},void 0,n()(qt.Z,{large:!0,divider:"full",style:{marginTop:36}},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.title",defaultMessage:"Invoices"})),m().createElement(Sa.Z,o()({},i,{requestStore:t})))}static getModalStyle(e){return{width:480,background:e.popoverBackground,padding:24,borderRadius:3}}getViewInvoiceButtonStyle(){return{color:this.theme.mediumTextColor,padding:"2px 3px",borderRadius:3}}}l()(Td,"billingEventsLimitIncrement",20),l()(Td,"modalTitleStyle",{fontSize:18,marginBottom:16,fontWeight:v.Z.fontWeight.medium});const kd=(0,y.injectIntl)(Td);var Zd=i(90850);class Ad extends N.Z{getInitialState(){return{temporaryCouponCode:void 0,couponCodeInput:void 0,error:void 0}}}const Id=Ad,Pd=(0,y.defineMessages)({couponCodePlaceholder:{id:"couponEntryInput.placeholder",defaultMessage:"Coupon code"},couponCodeNotFoundError:{id:"couponEntryInput.error.noPromo",defaultMessage:"Invalid coupon code"}});class _d extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{couponCode:Id})}didMount(){const e=(0,Zd.Zk)(this.environment.currentUser.id);e&&this.stores.couponCode.setState({...this.stores.couponCode.state,temporaryCouponCode:e})}renderComponent(){return n()("div",{style:this.getContainerStyle()},void 0,n()("div",{style:{display:"flex",flexDirection:"row"}},void 0,n()(tt.Z,{textarea:!1,value:this.stores.couponCode.state.couponCodeInput,placeholder:Ce.default.formatMessage(Pd.couponCodePlaceholder),onSubmit:()=>this.checkCouponCode(),onChange:e=>{this.stores.couponCode.setState({...this.stores.couponCode.state,couponCodeInput:e.target.value})},style:{height:32,paddingLeft:10,marginRight:this.props.hideApply?0:10}}),n()(Sa.Z,{request:this.stores.couponCode.state.temporaryCouponCode||null,performRequest:async e=>{if(e)return this.applyCouponCode(e)},render:(e,t,i)=>{if(!this.props.hideApply)return n()(Ht.Z,{isLarge:!1,onClick:()=>this.checkCouponCode()},void 0,n()(An.Z,{loaded:i,spinnerSize:16,showSpinnerTimeout:500},void 0,n()(y.FormattedMessage,{id:"couponEntryInput.button.apply",defaultMessage:"Apply"})))}})),this.stores.couponCode.state.error&&n()(ii.Z,{isMultiline:!1,style:{paddingTop:8,color:g.ZP.red}},void 0,this.stores.couponCode.state.error))}checkCouponCode(){const e=this.stores.couponCode.state.couponCodeInput;e&&(this.stores.couponCode.setState({...this.stores.couponCode.state,temporaryCouponCode:e}),this.stores.couponCode.setState({...this.stores.couponCode.state,couponCodeInput:""}))}async applyCouponCode(e){const t=await w.getPromoCode(this.environment,{code:e});if("success"===t.type){var i;if(t.data.promo)return null!==(i=t.data.promo.applies_to)&&void 0!==i&&i.length&&!t.data.promo.applies_to.includes(this.props.plan)?void this.showError(e):(this.stores.couponCode.setState({...this.stores.couponCode.state,error:void 0}),this.props.handlePromo(t.data.promo),b.trackCouponCodeEntered(this.environment,{code:e,valid:!0,id:t.data.promo.id}),t.data.promo);this.showError(e)}else if("failed"===t.type){const e=t.error.name;this.stores.couponCode.setState({...this.stores.couponCode.state,error:e})}else(0,W.t1)(t)}showError(e){this.stores.couponCode.setState({...this.stores.couponCode.state,error:Ce.default.formatMessage(Pd.couponCodeNotFoundError)}),b.trackCouponCodeEntered(this.environment,{code:e,valid:!1,id:void 0})}getContainerStyle(){return{display:"flex",flexDirection:"column",...this.props.style?this.props.style:void 0}}}const xd=_d;var Fd=i(93039),Bd=i(1063);const Ed=(0,y.defineMessages)({apply_credit:{id:"spaceSubscriptionBilling.applyCreditButton.label",defaultMessage:"Apply credit",description:"Button a user clicks to apply Notion credits towards their Notion bill."},update:{id:"spaceSubscriptionBilling.updateButton.label",defaultMessage:"Update"},add:{id:"spaceSubscriptionBilling.addButton.label",defaultMessage:"Add"},apply:{id:"spaceSubscriptionBilling.apply.label",defaultMessage:"Apply"}});class Dd extends p.Z{renderComponent(){const{title:e,caption:t,buttonArgs:i}=this.props,a=m().createElement(y.FormattedMessage,Ed[i.buttonPurpose]);return n()("div",{style:{display:"flex",alignItems:"center",fontSize:14}},void 0,n()("div",{style:{marginRight:"auto"}},void 0,e),n()("div",{style:{color:this.theme.mediumTextColor}},void 0,t),n()("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"}},void 0,i.showButton&&n()(ut.Z,{isBlue:!0,onClick:i.onClick,style:Dd.buttonStyle},void 0,a)))}}l()(Dd,"buttonStyle",{marginLeft:18,marginRight:-4,fontWeight:v.Z.fontWeight.medium});const Rd=(0,y.injectIntl)(Dd),Ld={offline:n()(y.FormattedMessage,{defaultMessage:"Please go online to manage billing.",id:"spaceSubscriptionBilling.offline.message"})};class Od extends p.Z{constructor(){super(...arguments),l()(this,"couponEntryInput",null),l()(this,"storeTypes",{store:vd,billingHistoryRequestStore:da.Z}),l()(this,"renderPaymentMethodModal",(()=>{const{customerData:e,spaceStore:t}=this.props;return n()(hd.LazySpaceSubscriptionUpdatePaymentMethodModal,{customerData:e,spaceStore:t,onComplete:this.handleModalClose})})),l()(this,"renderBillingIntervalModal",(()=>{const{temporaryBillingInterval:e}=this.stores.store.state,{customerData:t}=this.props,i=e||t.interval,{monthlyPlanAmount:a,yearlyPlanAmount:s}=t,o=1-s/(12*a);return n()(Nd,{theme:this.theme,title:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingInterval.title",defaultMessage:"Change billing interval"}),helpButton:n()(fa.Z,{title:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingInterval.helpButton.label",defaultMessage:"Learn about how this change will impact what you pay."}),href:(0,R.UY)("guides.changeBillingInterval"),analyticsFrom:"billing_interval_settings"}),acceptAction:"update",onAccept:this.handleBillingIntervalAccept,onClose:this.handleModalClose},void 0,n()("div",{style:{marginTop:12,marginBottom:16}},void 0,L.Rj({environment:this.environment,productId:t.productId,yearlyPlanAmount:s,monthlyPlanAmount:a,yearlySavingsPercent:o,currentBillingInterval:i,handleMonthlyBillingClick:this.handleMonthlyBillingClick,handleYearlyBillingClick:this.handleYearlyBillingClick})))})),l()(this,"renderApplyCreditModal",(()=>{const{subscriptionData:e,customerData:t,intl:i}=this.props,{availableCredit:a}=e,s=this.getCurrentFormCreditAmount(),o=Math.max(0,(t.nextInvoiceAmount||0)-s);return n()("div",{style:Od.getModalStyle(this.theme)},void 0,n()("div",{style:Od.modalTitleStyle},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.title",defaultMessage:"Use Notion credit - {creditInDollars} available",values:{creditInDollars:(0,yr.Dx)({amount:a,currency:"dollar",intl:i})}})),n()("div",{style:{fontSize:14,display:"flex",alignItems:"center",marginBottom:16}},void 0,n()("div",{style:{width:"100%",marginRight:20,color:this.theme.mediumTextColor}},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.amountOfCreditQuestion",defaultMessage:"How much credit would you like to apply to your next invoice?"})),n()(bd,{availableCredit:a,focus:!0,selectAll:!0,onChange:this.handleApplyCreditAmountInputChange}),n()("div",{style:{whiteSpace:"nowrap",marginLeft:8}},void 0,"/"," ",(0,yr.Dx)({amount:a,currency:"dollar",intl:i}))),n()("div",{style:{borderTop:"1px solid ".concat(this.theme.regularDividerColor),paddingTop:16}},void 0,n()("div",{style:{paddingBottom:18,fontSize:12,color:this.theme.mediumTextColor}},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.warning",defaultMessage:"Applying credit to your account <bold>cannot be undone</bold>.",values:{bold:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("b",{},void 0,t)}}})),n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()("div",{style:{fontSize:36,lineHeight:1}},void 0,(0,yr.Dx)({amount:o,currency:"dollar",intl:i})),n()("div",{style:{marginLeft:8,fontSize:12,color:this.theme.mediumTextColor,alignSelf:"flex-end"}},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.nextInvoiceAmount",defaultMessage:"next invoice total",description:"Text that appears next to the amount, in dollars, that the user's next invoice will be after applying their Notion credits to their bill."})),n()(Ht.Z,{isLarge:!0,style:{marginLeft:"auto"},onClick:this.handleModalClose},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.cancelButton.label",defaultMessage:"Cancel"})),n()(xe.Z,{isLarge:!0,style:{marginLeft:12},disabled:s<=0,onClick:this.handleApplyCreditAccept},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.useCreditModal.applyCreditButton.label",defaultMessage:"Apply credit"})))))})),l()(this,"renderSingleTextFieldModal",((e,t,i,a,s)=>n()(Nd,{theme:this.theme,title:t,acceptAction:s,onAccept:a,onClose:this.handleModalClose},void 0,n()(tt.Z,{focus:!0,selectAll:!0,value:e,onChange:i,onSubmit:a,style:Od.modalInputStyle})))),l()(this,"renderBillingEmailModal",(()=>{const{customerData:e}=this.props,{temporaryBillingEmail:t}=this.stores.store.state,i=void 0!==t?t:e.billingEmail||"",a=e.billingEmail?"update":"add";return this.renderSingleTextFieldModal(i,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingEmailModal.title",defaultMessage:"Change billing email"}),this.handleBillingEmailChange,this.handleBillingEmailAccept,a)})),l()(this,"renderVatIdModal",(()=>{const{customerData:e}=this.props,{temporaryVatId:t}=this.stores.store.state,i=void 0!==t?t:e.vatId||"",a=e.vatId?"update":"add";return n()(Nd,{theme:this.theme,title:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.changeVATIDModal.title",defaultMessage:"Change VAT/GST number"}),acceptAction:a,onAccept:this.handleVatIdAccept,onClose:this.handleModalClose},void 0,n()(tt.Z,{focus:!0,selectAll:!0,value:i,onChange:this.handleVatIdChange,onSubmit:this.handleVatIdAccept,style:Od.modalInputStyle}),n()("div",{style:{color:this.theme.mediumTextColor,fontSize:v.Z.fontSize.UISmall.desktop,marginTop:-10}},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.changeVATIDModal.subtitle",defaultMessage:"Please include your country code"})))})),l()(this,"renderApplyCouponModal",(()=>n()(Nd,{theme:this.theme,title:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.applyCouponModal.title",defaultMessage:"Apply coupon"}),acceptAction:"apply",onAccept:()=>{this.couponEntryInput&&this.couponEntryInput.checkCouponCode()},onClose:this.handleModalClose},void 0,m().createElement(xd,{ref:e=>this.couponEntryInput=e,hideApply:!0,plan:this.props.customerData.plan,handlePromo:async e=>{this.handleModalClose();await _.Mg({environment:this.environment,spaceStore:this.props.spaceStore,coupon:e&&"coupon"===e.source?e.code:void 0,promoCodeId:e&&"promo_code"===e.source?e.code:void 0,from:"space_settings-billing_tab"})&&(0,C.showMessage)({message:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.applyCouponModal.successMessage",defaultMessage:"Coupon applied!"})})}})))),l()(this,"updateTemporaryAddress",(e=>{const{temporaryAddress:t}=this.stores.store.state;this.stores.store.setState({...this.stores.store.state,temporaryAddress:{...this.props.customerData.address,...t,...e}})})),l()(this,"renderAddressModal",(()=>{const{customerData:e}=this.props,{temporaryAddress:t,addressErrorMessage:i}=this.stores.store.state,a=L.CM(this.environment);return n()("div",{style:{display:"flex",flexDirection:"column",maxHeight:"75vh"}},void 0,n()("div",{style:Od.getModalStyle(this.theme)},void 0,n()("div",{style:Od.modalTitleStyle},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.changeYourAddressModal.title",defaultMessage:"Change your address"})),n()(Fd.J,{address:t||{name:e.customerName||"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},updateAddress:e=>{this.stores.store.setAddressField(e)},shouldShowBusinessName:Boolean(a&&["team","enterprise"].includes(a))}),n()("div",{style:{color:g.ZP.red,marginTop:10}},void 0,i)),n()("div",{style:{display:"flex",justifyContent:"flex-end",padding:"16px 24px",background:this.theme.cardContentBackground}},void 0,n()(Ht.Z,{isLarge:!0,onClick:this.handleModalClose},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingAddressModal.cancelButton.label",defaultMessage:"Cancel"})),n()(xe.Z,{style:{marginLeft:12},isLarge:!0,disabled:void 0===this.getUpdatedAddress(),onClick:this.handleAddressAccept},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.changeBillingAddressModal.updateButton.label",defaultMessage:"Update"}))))})),l()(this,"handleChangePlanClick",(()=>{he.ZP.setState({open:!0,currentTab:"plans",defaultSubtab:void 0})})),l()(this,"handlePaymentMethodChangeClick",(()=>{this.stores.store.setState({...this.stores.store.state,paymentMethodModalOpen:!0})})),l()(this,"handleBillingIntervalChangeClick",(()=>{this.stores.store.setState({...this.stores.store.state,billingIntervalModalOpen:!0})})),l()(this,"handleBillingEmailChangeClick",(()=>{this.stores.store.setState({...this.stores.store.state,billingEmailModalOpen:!0})})),l()(this,"handleAddressChangeClick",(()=>{this.stores.store.setState({...this.stores.store.state,addressModalOpen:!0})})),l()(this,"handleVatIdChangeClick",(e=>{const t=e.address.country;if(!t)return void(0,C.showErrorMessage)(n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.vatId.missingCountry",defaultMessage:"To update your VAT/GST number, please update your billing address."}));!{AE:"ae_trn",AU:"au_abn",CA:"ca_bn",CH:"ch_vat",ES:"eu_vat",AT:"eu_vat",BE:"eu_vat",BG:"eu_vat",CY:"eu_vat",CZ:"eu_vat",DE:"eu_vat",EE:"eu_vat",FI:"eu_vat",FR:"eu_vat",GR:"eu_vat",HR:"eu_vat",HU:"eu_vat",IE:"eu_vat",IT:"eu_vat",LT:"eu_vat",LU:"eu_vat",LV:"eu_vat",MT:"eu_vat",NL:"eu_vat",PL:"eu_vat",PT:"eu_vat",RO:"eu_vat",RU:"ru_inn",SE:"eu_vat",SI:"eu_vat",SK:"eu_vat",GB:"gb_vat",IN:"in_gst",KR:"kr_brn",NZ:"nz_gst",SG:"sg_gst"}[t]?(0,C.showErrorMessage)(n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.vatId.vatNotRequired",defaultMessage:"A VAT/GST number is not required for your tax jurisdiction."})):this.stores.store.setState({...this.stores.store.state,vatIdModalOpen:!0})})),l()(this,"handleApplyCouponClick",(()=>{this.stores.store.setState({...this.stores.store.state,applyCouponModalOpen:!0})})),l()(this,"handleModalClose",(()=>{this.stores.store.reset()})),l()(this,"handleBillingEmailChange",(e=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingEmail:e.target.value})})),l()(this,"handleBillingEmailAccept",(async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryBillingEmail:i}=this.stores.store.state;i!==t.billingEmail&&await _.Mg({environment:this.environment,spaceStore:e,billingEmail:i,from:"space_settings-billing_tab"}),this.handleModalClose()})),l()(this,"handleVatIdChange",(e=>{this.stores.store.setState({...this.stores.store.state,temporaryVatId:e.target.value})})),l()(this,"handleVatIdAccept",(async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryVatId:i}=this.stores.store.state;i!==t.vatId&&await _.Mg({environment:this.environment,spaceStore:e,vatId:i,from:"space_settings-billing_tab"}),this.handleModalClose()})),l()(this,"handleAddressAccept",(async()=>{const{spaceStore:e}=this.props,t=this.getUpdatedAddress();if(!t)return void this.stores.store.setState({...this.stores.store.state,addressErrorMessage:this.props.intl.formatMessage({id:"spaceSubscriptionBilling.address.invalidError",defaultMessage:"Your address is invalid. Please update your address so we can process your payment."})});const i=await(0,pd.a)(this.environment,t);if(!i.valid)return void this.stores.store.setState({...this.stores.store.state,addressErrorMessage:this.props.intl.formatMessage({id:"spaceSubscriptionBilling.address.invalidError",defaultMessage:"Your address is invalid. Please update your address so we can process your payment."})});const a={...t,...i.validatedAddresses?i.validatedAddresses[0]:void 0};if(t)try{await _.y3({environment:this.environment,spaceStore:e,address:a}),this.handleModalClose()}catch(n){}})),l()(this,"getUpdatedAddress",(()=>{const{customerData:e}=this.props,{temporaryAddress:t}=this.stores.store.state;if(t&&t!==e.address)return t})),l()(this,"handleMonthlyBillingClick",(()=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingInterval:"month"})})),l()(this,"handleYearlyBillingClick",(()=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingInterval:"year"})})),l()(this,"handleBillingIntervalAccept",(async()=>{const{spaceStore:e,customerData:t}=this.props,{temporaryBillingInterval:i}=this.stores.store.state;if(i&&i!==t.interval){const t=this.getPlanForOppositeBillingInterval();t&&await _.Mg({environment:this.environment,spaceStore:e,plan:t,from:"space_settings-billing_tab"})}this.handleModalClose()})),l()(this,"handleUseCardClick",(()=>{this.stores.store.setState({...this.stores.store.state,temporaryBillingType:"charge_automatically"})})),l()(this,"handleCardUpdateClick",(async()=>{const{spaceStore:e}=this.props,{customerData:t}=this.props;if(t.billingEmail){const i=await _.Ay({name:"Update your Card",panelLabel:"Update",email:t.billingEmail});await _.Mg({environment:this.environment,spaceStore:e,stripeToken:i,from:"space_settings-billing_tab"})}this.handleModalClose()})),l()(this,"handlePaymentMethodAccept",(async()=>{const{spaceStore:e}=this.props,{customerData:t}=this.props,{temporaryBillingType:i}=this.stores.store.state;if("charge_automatically"===(i||t.billing)&&!t.brand){const{currentUserStore:i}=Z.default.state,a=i?i.getValue():void 0,n=t.billingEmail||(a?a.email:void 0);if(!n)throw new Error("No billing email found.");const s=await _.Ay({name:"Update your Card",panelLabel:"Update",email:n});await _.Mg({environment:this.environment,spaceStore:e,stripeToken:s,billingEmail:n,from:"space_settings-billing_tab"})}this.handleModalClose()})),l()(this,"handleApplyCreditClick",(()=>{this.stores.store.setState({...this.stores.store.state,applyCreditModalOpen:!0})})),l()(this,"handleApplyCreditAccept",(async()=>{const e=this.getCurrentFormCreditAmount(),{spaceStore:t}=this.props;e>0&&await _.Mg({environment:this.environment,spaceStore:t,creditAmount:e,from:"space_settings-billing_tab"}),this.handleModalClose(),b.trackSubscriptionApplyCredit(this.environment,{amount:e})})),l()(this,"handleApplyCreditAmountInputChange",(e=>{this.stores.store.setState({...this.stores.store.state,temporaryApplyCreditCents:e})})),l()(this,"handleRestartSubscriptionClick",(async()=>{const{spaceStore:e}=this.props,{customerData:t}=this.props;await _.Mg({environment:this.environment,spaceStore:e,plan:t.plan,from:"space_settings-billing_tab"}),this.handleModalClose()}))}willMount(){_.bi(this.environment)}renderComponent(){return ra.Z.state.online?this.renderBilling():Od.renderOfflineMessage()}static renderOfflineMessage(){return n()(ba.Z,{},void 0,n()(ii.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,Ld.offline))}renderBilling(){const{customerData:e,subscriptionData:t}=this.props,{paymentMethodModalOpen:i,billingIntervalModalOpen:a,billingEmailModalOpen:s,addressModalOpen:r,applyCreditModalOpen:l,vatIdModalOpen:d,applyCouponModalOpen:c}=this.stores.store.state;return n()("div",{style:Od.wrapStyle},void 0,n()(Ma.Z,{style:Od.scrollerStyle,type:wa.Z.Y},void 0,this.renderHeader(e),this.renderSummary(t),this.renderPaymentMethod(e),this.renderSeparator(),this.renderBillingInterval(e),this.renderSeparator(),this.renderBillingEmail(e),this.renderSeparator(),this.renderAddress(e),this.renderSeparator(),this.renderVatId(e),this.renderSeparator(),this.renderCredit(e),this.renderSeparator(),this.renderCoupon(),this.renderDiscount(),m().createElement(kd,o()({},this.props,{data:t})),n()(Ga.Z,{open:i,render:this.renderPaymentMethodModal,onDismiss:this.handleModalClose}),n()(Ga.Z,{open:a,render:this.renderBillingIntervalModal,onDismiss:this.handleModalClose}),n()(Ga.Z,{open:l,render:this.renderApplyCreditModal,onDismiss:this.handleModalClose}),n()(Ga.Z,{open:s,render:this.renderBillingEmailModal,onDismiss:this.handleModalClose}),n()(Ga.Z,{open:r,render:this.renderAddressModal,onDismiss:this.handleModalClose}),n()(Ga.Z,{open:d,render:this.renderVatIdModal,onDismiss:this.handleModalClose}),n()(Ga.Z,{open:c,render:this.renderApplyCouponModal,onDismiss:this.handleModalClose})))}renderHeader(e){let t=n()(y.FormattedMessage,{id:"legacyPlan.title",defaultMessage:"Legacy Plan",description:"Shown in settings and the sidebar to describe which plan you have."});switch(e.productId){case Gt.Z.pricing.personal.productId:t=n()(y.FormattedMessage,{id:"personalPlan.title",defaultMessage:"Personal Pro Plan",description:"Shown in settings and the sidebar to describe which plan you have."});break;case Gt.Z.pricing.student.productId:t=n()(y.FormattedMessage,{id:"personalEducationPlan.title",defaultMessage:"Personal Pro Plan (Education)",description:"Shown in settings and the sidebar to describe which plan you have."});break;case Gt.Z.pricing.team.productId:t=n()(y.FormattedMessage,{id:"teamPlan.title",defaultMessage:"Team Plan",description:"Shown in settings and the sidebar to describe which plan you have."});break;case Gt.Z.pricing.business.productId:t=n()(y.FormattedMessage,{id:"businessPlan.title",defaultMessage:"Business Plan",description:"Shown in settings and the sidebar to describe which plan you have."});break;case Gt.Z.pricing.enterprise.productId:t=n()(y.FormattedMessage,{id:"enterprisePlan.title",defaultMessage:"Enterprise Plan",description:"Shown in settings and the sidebar to describe which plan you have."})}return n()(qt.Z,{large:!0,divider:"full"},void 0,t)}renderSummary(e){const{spaceStore:t}=this.props,i=L.D0(this.environment,t,e),a=L.DH(e),s="subscribed_admin"===e.type;return n()("div",{style:Od.summaryStyle},void 0,n()("div",{style:Od.summaryMessageStyle},void 0,i),a&&n()(xe.Z,{isLarge:!0,onClick:this.handleRestartSubscriptionClick,style:{marginRight:8}},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.restartSubscriptionButton.label",defaultMessage:"Restart subscription"})),s&&n()(Ht.Z,{isLarge:!0,onClick:this.handleChangePlanClick},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.changePlanButton.label",defaultMessage:"Change plan"})))}renderSeparator(){return n()("div",{style:{flex:"none",height:1,marginTop:10,marginBottom:10,background:this.theme.regularDividerColor}})}renderPaymentMethod(e){return n()(Rd,{title:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.title",defaultMessage:"Payment method"}),caption:n()(u.Fragment,{},void 0,"send_invoice"===e.billing&&n()("div",{},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.achOrWireTransfer",defaultMessage:"ACH or Wire Transfer"})),"charge_automatically"===e.billing&&(e.last4&&e.brand?n()("div",{},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.creditCard",defaultMessage:"{creditCardBrand} ending in {lastFourDigits}",values:{creditCardBrand:(0,ud.Z)(e.brand),lastFourDigits:e.last4}})):n()("div",{},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.none",defaultMessage:"None",description:"The payment method setting we display for users who haven't set up a payment method yet"})))),buttonArgs:{showButton:!0,buttonPurpose:"update",onClick:this.handlePaymentMethodChangeClick}})}renderBillingInterval(e){return n()(Rd,{title:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingInterval.title",defaultMessage:"Billing interval"}),caption:n()("div",{},void 0,"month"===e.interval?n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingInterval.value.monthly",defaultMessage:"Monthly"}):n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingInterval.value.yearly",defaultMessage:"Yearly"})),buttonArgs:{showButton:Boolean(this.getPlanForOppositeBillingInterval()),buttonPurpose:"update",onClick:this.handleBillingIntervalChangeClick}})}renderBillingEmail(e){return n()(Rd,{title:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.billingEmail.title",defaultMessage:"Billing email"}),caption:n()("div",{},void 0,e.billingEmail||""),buttonArgs:{showButton:!0,buttonPurpose:Boolean(e.billingEmail)?"update":"add",onClick:this.handleBillingEmailChangeClick}})}renderVatId(e){return n()(Rd,{title:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.VATID.title",defaultMessage:"VAT/GST number",description:"Title for the section where users can update their VAT (value added tax) identification number"}),caption:n()("div",{},void 0,e.vatId||""),buttonArgs:{showButton:!0,buttonPurpose:Boolean(e.vatId)?"update":"add",onClick:()=>this.handleVatIdChangeClick(e)}})}renderAddress(e){return n()(Rd,{title:n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.yourAddress.title",defaultMessage:"Your address"}),caption:n()("div",{style:{textAlign:"right",width:"80%",float:"right"}},void 0,this.renderAddressString(e.address)||""),buttonArgs:{showButton:!0,buttonPurpose:e.address&&!c().isEmpty(e.address)?"update":"add",onClick:this.handleAddressChangeClick}})}renderCredit(e){const t=-Math.min(0,e.accountBalance),{intl:i}=this.props;return n()(Rd,{title:gd.workspaceBalance,caption:n()("div",{},void 0,(0,yr.Dx)({amount:t,currency:"dollar",intl:i})),buttonArgs:{showButton:!0,buttonPurpose:"apply_credit",onClick:this.handleApplyCreditClick}})}renderCoupon(){const e=L.CM(this.environment);return e&&L.Fu(e)?n()("div",{style:{display:"flex",alignItems:"center",fontSize:14,justifyContent:"end"}},void 0,n()("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"}},void 0,n()(Bd.X,{tier:e}))):null}renderDiscount(){var e;const{customerData:t}=this.props;return null!==(e=t.promo)&&void 0!==e&&e.percent_off?n()(Rd,{title:gd.discount,caption:n()("div",{},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.discount.percentOff",defaultMessage:"{percentOff}% off",values:{percentOff:t.promo.percent_off}})),buttonArgs:{showButton:!1,buttonPurpose:"add",onClick:()=>{}}}):null}renderAddressString(e){return e?this.props.intl.formatList([e.name,e.businessName,e.addressLine1,e.country].filter(Boolean),{type:"conjunction",style:"narrow"}):""}getCurrentFormCreditAmount(){const{subscriptionData:e}=this.props,{store:t}=this.stores,{temporaryApplyCreditCents:i}=t.state;return void 0!==i?i:e.availableCredit}getPlanForOppositeBillingInterval(){const{customerData:e}=this.props,t=md.KK.find((t=>t.indexOf(e.plan)>=0));if(t){const i=t.indexOf(e.plan);return t[0===i?1:0]}}static getModalStyle(e){return{width:500,background:e.popoverBackground,padding:24,borderRadius:3}}}function Nd(e){const t=m().createElement(y.FormattedMessage,Ed[e.acceptAction]);return n()("div",{style:Od.getModalStyle(e.theme)},void 0,n()("div",{style:Od.modalTitleStyle},void 0,e.title),e.children,n()("div",{style:{marginBottom:20}},void 0,e.helpButton),n()("div",{style:{display:"flex",justifyContent:"flex-end"}},void 0,n()(Ht.Z,{isLarge:!0,onClick:e.onClose,style:{marginRight:12}},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionBilling.cancelButton.label",defaultMessage:"Cancel"})),n()(xe.Z,{isLarge:!0,onClick:e.onAccept},void 0,t)))}l()(Od,"modalTitleStyle",{fontSize:18,marginBottom:16,fontWeight:v.Z.fontWeight.medium}),l()(Od,"wrapStyle",{display:"flex",flexDirection:"column",height:"100%"}),l()(Od,"scrollerStyle",{height:"100%",padding:"36px 60px"}),l()(Od,"summaryStyle",{display:"flex",alignItems:"flex-start",fontSize:14,marginBottom:36}),l()(Od,"summaryMessageStyle",{marginRight:"auto",paddingRight:32}),l()(Od,"modalInputStyle",{marginTop:12,marginBottom:20});const Ud=(0,y.injectIntl)(Od);class Wd extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{store:vd,billingHistoryRequestStore:da.Z})}willMount(){_.bi(this.environment)}renderComponent(){const{data:e}=this.props;return ra.Z.state.online?n()("div",{style:Wd.wrapStyle},void 0,n()(Ma.Z,{style:Wd.scrollerStyle,type:wa.Z.Y},void 0,n()(qt.Z,{large:!0,divider:"full"},void 0,m().createElement(y.FormattedMessage,he.sY.billingTab)),this.renderCredit(e),this.renderSeparator(),m().createElement(kd,this.props))):Wd.renderOfflineMessage()}static renderOfflineMessage(){return n()(ba.Z,{},void 0,n()(ii.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,Ld.offline))}renderCredit(e){const t=-Math.min(0,e.accountBalance),{intl:i}=this.props;return n()(Rd,{title:gd.workspaceBalance,caption:n()("div",{},void 0,(0,yr.Dx)({amount:t,currency:"dollar",intl:i})),buttonArgs:{showButton:!1,buttonPurpose:"apply_credit",onClick:c().noop}})}renderSeparator(){return n()("div",{style:{flex:"none",marginTop:30}})}}l()(Wd,"wrapStyle",{display:"flex",flexDirection:"column",height:"100%"}),l()(Wd,"scrollerStyle",{height:"100%",padding:"36px 60px"});const Vd=(0,y.injectIntl)(Wd);var zd=i(2438),Gd=i(64684);const Hd=["not_using_enough","switching","too_expensive","too_difficult","missing_features","upgraded_by_mistake","consolidating_workspaces","other"];class qd extends N.Z{getInitialState(){return{reasons:[],reasonOther:"",stage:"questionnaire",churnSurveyId:(0,Za.ZP)()}}handleNextStage(e){const{downgradeCoupon:t,acceptedOffer:i}=e;switch(this.state.stage){case"questionnaire":return t?void this.setState({...this.state,stage:t}):void this.setState({...this.state,stage:"downgrade"});case"enterprise_annual":case"enterprise_three_months":return i?void this.setState({...this.state,stage:"accepted_enterprise_offer"}):void this.setState({...this.state,stage:"confirmation"});case"team_annual":case"team_three_months":return i?void this.setState({...this.state,stage:"accepted_team_offer"}):void this.setState({...this.state,stage:"confirmation"});case"downgrade":return void this.setState({...this.state,stage:"confirmation"});case"confirmation":this.setState({...this.state,stage:"closed"})}}}const Kd=qd;class jd extends N.Z{getInitialState(){return{termType:"yearly"}}}const Yd=new jd;class Qd extends N.Z{getInitialState(){return{churnSurveyModalOpen:!1}}}const Jd=Qd;var Xd=i(24684);const $d=(0,y.defineMessages)({reasonOtherPlaceholder:{id:"churnSurvey.reasons.reasonOtherPlaceholder",defaultMessage:"Tell us more...",description:"Shown in the downgrade survey in case they want to put a custom reason for why they downgraded."},tenPercentOff:{id:"churnSurvey.offer.tenPercent",defaultMessage:"Get 10% off",description:"Shown in a button to confirm a customer wants to accept the 10% off discount we presented to them."},fiftyPercentOff:{id:"churnSurvey.offer.fiftyPercent",defaultMessage:"Get 50% off",description:"Shown in a button to confirm a customer wants to accept the 50% off discount we presented to them."},collaborativeTeamspaces:{id:"churnSurvey.features.collaborativeTeamspaces",defaultMessage:"Collaborative teamspaces",description:"Describes feature customers will lose access to if they downgrade."},sharingPermissions:{id:"churnSurvey.features.sharingPermissions",defaultMessage:"Sharing permissions",description:"Describes feature customers will lose access to if they downgrade."},versionHistory:{id:"churnSurvey.features.versionHistory",defaultMessage:"30 day version history",description:"Describes feature customers will lose access to if they downgrade."},adminTools:{id:"churnSurvey.features.adminTools",defaultMessage:"Admin tools",description:"Describes feature customers will lose access to if they downgrade."},saml:{id:"churnSurvey.features.saml",defaultMessage:"SAML SSO",description:"Describes feature customers will lose access to if they downgrade."},auditLog:{id:"churnSurvey.features.auditLog",defaultMessage:"Audit log",description:"Describes feature customers will lose access to if they downgrade."},security:{id:"churnSurvey.features.securityAndControls",defaultMessage:"Advanced security and controls",description:"Describes feature customers will lose access to if they downgrade."}}),ec={free:n()(y.FormattedMessage,{id:"churnSurveyMenu.free.title",defaultMessage:"Free",description:"Describes which plan the customer is downgrading to when downgrading plans."}),personal:n()(y.FormattedMessage,{id:"churnSurveyMenu.personal.title",defaultMessage:"Pro",description:"Describes which plan the customer is downgrading to when downgrading plans."}),team:n()(y.FormattedMessage,{id:"churnSurveyMenu.team.title",defaultMessage:"Team",description:"Describes which plan the customer is downgrading to when downgrading plans."}),business:n()(y.FormattedMessage,{id:"churnSurveyMenu.business.title",defaultMessage:"Business",description:"Describes which plan the customer is downgrading to when downgrading plans."})};class tc extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{store:Kd}),l()(this,"handleDowngrade",(e=>{this.handleNextStage(e),this.props.onAccept()})),l()(this,"handleNextStage",(e=>{this.stores.store.handleNextStage(e)}))}renderComponent(){const{churnType:e,onClose:t,periodEnd:i}=this.props,{store:a}=this.stores,s=(0,wd.Z)(i).format("LL"),o=ec[e];return(0,b.trackChurnSurvey)(this.environment,this.stores.store.state),n()("div",{style:{fontSize:14}},void 0,n()("div",{style:{textAlign:"center",padding:"16px 8px 0px"}},void 0,n()(ei.Z,{onClick:()=>{(0,b.trackChurnSurveyClose)(this.environment,a.state),t()},style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground}},void 0,h.Z.closeSmall({width:14,fill:this.theme.mediumTextColor})),this.renderStageIcon(a),n()("div",{style:{padding:"0px 10px"}},void 0,this.renderTitle(a,o),this.renderDescription(a,s))),this.renderContent(a,e,o),n()("div",{style:{padding:"20px 24px"}},void 0,this.renderFooter(a,t,o)))}renderMessageForReason(e){switch(e){case"not_using_enough":return n()(y.FormattedMessage,{id:"churnSurvey.reasons.notUsingEnough",defaultMessage:"Not using it enough",description:"Shown as a checkbox option when asked why a customer is downgrading their plan."});case"switching":return n()(y.FormattedMessage,{id:"churnSurvey.reasons.switching",defaultMessage:"Switching to another tool",description:"Shown as a checkbox option when asked why a customer is downgrading their plan."});case"too_expensive":return n()(y.FormattedMessage,{id:"churnSurvey.reasons.tooExpensive",defaultMessage:"Cost (too expensive or budget cuts)",description:"Shown as a checkbox option when asked why a customer is downgrading their plan."});case"too_difficult":return n()(y.FormattedMessage,{id:"churnSurvey.reasons.tooDifficult",defaultMessage:"Too difficult to use",description:"Shown as a checkbox option when asked why a customer is downgrading their plan."});case"missing_features":return n()(y.FormattedMessage,{id:"churnSurvey.reasons.missingFeatures",defaultMessage:"Missing features",description:"Shown as a checkbox option when asked why a customer is downgrading their plan."});case"upgraded_by_mistake":return n()(y.FormattedMessage,{id:"churnSurvey.reasons.upgradedByMistake",defaultMessage:"Upgraded by mistake",description:"Shown as a checkbox option when asked why a customer is downgrading their plan."});case"consolidating_workspaces":return n()(y.FormattedMessage,{id:"churnSurvey.reasons.consolidating_workspaces",defaultMessage:"Consolidating Notion workspaces",description:"Shown as a checkbox option when asked why a customer is downgrading their plan."});case"other":return n()(y.FormattedMessage,{id:"churnSurvey.reasons.other",defaultMessage:"Other",description:"Shown as a checkbox option when asked why a customer is downgrading their plan."});default:(0,W.t1)(e)}}renderStageIcon(e){const{stage:t}=e.state;switch(t){case"questionnaire":case"enterprise_annual":case"enterprise_three_months":case"team_annual":case"team_three_months":return h.Z.settingsCredit(this.getIconStyle());case"downgrade":return h.Z.arrowDown(this.getIconStyle());case"accepted_enterprise_offer":case"accepted_team_offer":case"confirmation":return h.Z.statusCompleteGroup(this.getIconStyle());case"closed":return;default:(0,W.t1)(t)}}renderTitle(e,t){const i=e.state.stage;let a;switch(i){case"questionnaire":a=n()(y.FormattedMessage,{id:"churnSurvey.header.questionnaire.title",defaultMessage:"Why do you want to downgrade?",description:"Shown when a customer attempts to downgrade from a paid plan."});break;case"team_three_months":a=n()(y.FormattedMessage,{id:"churnSurvey.header.teamOfferMonthly.title",defaultMessage:"50% off your Team Plan, on us.",description:"Shown when a customer attempts to downgrade from a paid plan."});break;case"team_annual":a=n()(y.FormattedMessage,{id:"churnSurvey.header.teamOfferAnnual.title",defaultMessage:"10% off your Team Plan, on us.",description:"Shown when a customer attempts to downgrade from a paid plan."});break;case"enterprise_three_months":case"enterprise_annual":a=n()(y.FormattedMessage,{id:"churnSurvey.header.enterpriseOffer.title",defaultMessage:"10% off your Enterprise plan.",description:"Shown when a customer attempts to downgrade from a paid plan."});break;case"downgrade":a=n()(y.FormattedMessage,{id:"downgradeModal.header.downgrade.title",defaultMessage:"Continue downgrading to {planMessage}?",description:"Shown when a customer attempts to downgrade from a paid plan.",values:{planMessage:t}});break;case"accepted_enterprise_offer":a=n()(y.FormattedMessage,{id:"downgradeModal.header.acceptedEnterpriseOfferConfirmation.title",defaultMessage:"Thank you for staying on your Enterprise Plan",description:"Shown when a customer accepted the offer to stay in their Enterprise plan."});break;case"accepted_team_offer":a=n()(y.FormattedMessage,{id:"downgradeModal.header.acceptedTeamOfferConfirmation.title",defaultMessage:"Thank you for staying on your Team Plan",description:"Shown when a customer accepted the offer to stay in their Team plan."});break;case"confirmation":a=n()(y.FormattedMessage,{id:"downgradeModal.header.confirmation.title",defaultMessage:"Thank you for switching to {planMessage}",description:"Shown when a customer attempts to downgrade from a paid plan.",values:{planMessage:t}});break;case"closed":break;default:(0,W.t1)(i)}return n()("h3",{style:tc.headerStyle},void 0,a)}renderDescription(e,t){const{stage:i}=e.state;let a;switch(i){case"questionnaire":a=n()(y.FormattedMessage,{id:"churnSurvey.reasons.description",defaultMessage:"We'd love your input to make Notion better",description:"Shown when a customer attempts to downgrade from a paid plan."});break;case"team_three_months":a=n()(y.FormattedMessage,{id:"churnSurvey.teamMonthlyOffer.description",defaultMessage:"Get 50% off for 3 months if you keep your plan.",description:"Shown when a customer attempts to downgrade from a paid plan."});break;case"team_annual":a=n()(y.FormattedMessage,{id:"churnSurvey.teamAnnualOffer.description",defaultMessage:"Get 10% off if you keep your plan.",description:"Shown when a customer attempts to downgrade from a paid plan."});break;case"enterprise_three_months":a=n()(y.FormattedMessage,{id:"churnSurvey.enterpriseMonthlyOffer.description",defaultMessage:"Get 10% off for 3 months if you keep your plan.",description:"Shown when a customer attempts to downgrade from a paid plan."});break;case"enterprise_annual":a=n()(y.FormattedMessage,{id:"churnSurvey.enterpriseAnnualOffer.description",defaultMessage:"Get 10% off if you keep your plan.",description:"Shown when a customer attempts to downgrade from a paid plan."});break;case"downgrade":a=n()(y.FormattedMessage,{id:"churnSurvey.downgrade.description",defaultMessage:"You'll still enjoy all features of your current plan until {periodEnd}. You can resubscribe or switch to another plan anytime.",description:"Shown when a customer attempts to downgrade from a paid plan.",values:{periodEnd:n()("span",{style:{fontWeight:600}},void 0,t)}});break;case"accepted_team_offer":case"accepted_enterprise_offer":a=n()(y.FormattedMessage,{id:"churnSurvey.acceptedOfferConfirmation.description",defaultMessage:"Your updated pricing will kick in on your upcoming renewal date of {periodEnd}",description:"Shown when a customer attempts to downgrade from a paid plan.",values:{periodEnd:n()("span",{style:{fontWeight:600}},void 0,t)}});break;case"confirmation":a=n()(y.FormattedMessage,{id:"churnSurvey.confirmation.description",defaultMessage:"You'll still enjoy all features of your current plan until {periodEnd}. You can resubscribe or switch to another plan anytime.",description:"Shown when a customer attempts to downgrade from a paid plan.",values:{periodEnd:n()("span",{style:{fontWeight:600}},void 0,t)}});break;case"closed":break;default:(0,W.t1)(i)}return n()("p",{style:{lineHeight:1.4,marginTop:8}},void 0,n()("div",{style:this.getDescriptionStyle()},void 0,a))}renderSurveySection(e){const{reasons:t,reasonOther:i}=e.state;return n()("div",{style:tc.surveySectionStyle},void 0,Hd.map((a=>{const s=t.includes(a);return m().createElement(m().Fragment,null,n()("div",{style:tc.optionRowStyle,onClick:()=>{e.setState({...e.state,reasons:s?c().without(t,a):[...t,a]})}},a,n()(Nt.Z,{checked:s,size:14}),n()("span",{style:{marginLeft:4}},void 0,this.renderMessageForReason(a))),"other"===a&&s&&n()(tt.Z,{style:tc.inlineInputStyle,autoFocus:!0,value:i,placeholder:Ce.default.formatMessage($d.reasonOtherPlaceholder),onChange:t=>{e.setState({...e.state,reasonOther:t.target.value})}}))})))}renderDowngradeSection(e,t){let i=[];return i="personal_free"===e||"free"===e?Xd.k0:"personal"===e?Xd.rs:Xd.X3,n()("div",{style:{padding:"0px 24px 0px"}},void 0,n()("p",{style:this.getDowngradeDescriptionStyle()},void 0,n()(y.FormattedMessage,{id:"churnSurvey.downgradeSection.description",defaultMessage:"The following restrictions will apply when plan switches to {planMessage}",description:"Describes the changes a user will experience when downgrading.",values:{planMessage:t}})),n()("div",{},void 0,i.map((e=>m().createElement(m().Fragment,null,n()("div",{style:tc.optionRowStyle},void 0,e.icon(this.getDowngradeSectionIconStyle(!1)),n()("span",{style:this.getRestrictionDurationStyle()},void 0,n()("s",{},void 0,e.duration)),h.Z.arrowRight(this.getDowngradeSectionIconStyle(!0)),n()("span",{style:this.getRestrictionHighlightedMessageStyle()},void 0,e.highlightedMessage),e.message))))))}renderTeamOfferSection(){return m().createElement(m().Fragment,null,n()("li",{},void 0,Ce.default.formatMessage($d.collaborativeTeamspaces)),n()("li",{},void 0,Ce.default.formatMessage($d.sharingPermissions)),n()("li",{},void 0,Ce.default.formatMessage($d.versionHistory)),n()("li",{},void 0,Ce.default.formatMessage($d.adminTools)))}renderEnterpriseOfferSection(){return m().createElement(m().Fragment,null,n()("li",{},void 0,Ce.default.formatMessage($d.saml)),n()("li",{},void 0,Ce.default.formatMessage($d.auditLog)),n()("li",{},void 0,Ce.default.formatMessage($d.security)))}renderOfferSection(e){return n()("div",{style:{padding:"0px 24px 0px"}},void 0,n()("p",{style:this.getDowngradeDescriptionStyle()},void 0,n()(y.FormattedMessage,{id:"churnSurvey.offerSection.description",defaultMessage:"You'll get to keep",description:"Describes the changes a user will keep if they don't downgrade their plan."})),n()("ul",{style:{margin:0,paddingLeft:28,color:this.theme.mediumTextColor}},void 0,e.startsWith("team")&&this.renderTeamOfferSection(),e.startsWith("enterprise")&&this.renderEnterpriseOfferSection()))}renderContent(e,t,i){const{stage:a}=e.state;switch(a){case"questionnaire":return this.renderSurveySection(e);case"downgrade":return this.renderDowngradeSection(t,i);case"team_three_months":case"team_annual":case"enterprise_three_months":case"enterprise_annual":return this.renderOfferSection(a);default:return}}renderOfferAcceptButton(e){const{customerId:t,churnType:i}=this.props,a="team_three_months"===e;return n()(xe.Z,{isLarge:!0,style:{width:"100%"},onClick:async()=>{await async function(e,t){const{customerId:i,newPlan:a,downgradeCoupon:n}=t,s=await w.applyCustomerOffer(e,{customerId:i,newPlan:a,offerType:"downgrade_flow",downgradeCoupon:n});"failed"===s.type&&C.showError(s)}(this.environment,{customerId:t,newPlan:i,downgradeCoupon:e}),this.handleNextStage({downgradeCoupon:e,acceptedOffer:!0})}},void 0,a&&Ce.default.formatMessage($d.fiftyPercentOff),!a&&Ce.default.formatMessage($d.tenPercentOff))}renderTopButton(e,t){const{customerId:i,churnType:a}=this.props;return n()("div",{style:{display:"flex"}},void 0,"questionnaire"===e&&n()(xe.Z,{isLarge:!0,style:{width:"100%"},onClick:async()=>{const e=await async function(e,t){const{customerId:i,newPlan:a}=t,n=await w.getCustomerOffer(e,{customerId:i,newPlan:a,offerType:"downgrade_flow"});if("failed"!==n.type)return n.data.coupon;C.showError(n)}(this.environment,{customerId:i,newPlan:a});this.handleNextStage({downgradeCoupon:e})}},void 0,n()(y.FormattedMessage,{id:"churnSurvey.continueButton.title",defaultMessage:"Continue",description:"Shown in downgrade modal so users can continue downgrading."})),"downgrade"===e&&n()(ei.Z,{style:this.getDowngradeButtonStyle(e),onClick:()=>this.handleDowngrade({}),hoveredStyle:{background:g.ZP.redWithAlpha(.8)}},void 0,n()(y.FormattedMessage,{id:"churnSurvey.downgradeButton.title",defaultMessage:"Downgrade",description:"Button shown in case the user no longer wants to downgrade their subscription."})),t&&this.renderOfferAcceptButton(e))}renderFooter(e,t,i){const{stage:a}=e.state;if(!a)return;const s=this.isShowingOfferStages(a),o=this.isShowingAcceptedOfferStages(a);return m().createElement(m().Fragment,null,this.renderTopButton(a,s),"confirmation"!==a&&n()("div",{style:{display:"flex"}},void 0,n()(ei.Z,{style:this.getDowngradeButtonStyle(),onClick:()=>{s?this.handleDowngrade({}):((0,b.trackChurnSurveyClose)(this.environment,e.state),t())}},void 0,s&&n()(y.FormattedMessage,{id:"churnSurvey.offer.continueDowngrading.title",defaultMessage:"Downgrade to {planMessage}",description:"Shown in the downgrade modal in case they no longer want to downgrade.",values:{planMessage:i}}),!s&&!o&&n()(y.FormattedMessage,{id:"churnSurvey.cancelButton.title",defaultMessage:"Cancel",description:"Shown in the downgrade modal in case they no longer want to downgrade."}))))}isShowingOfferStages(e){switch(e){case"team_three_months":case"team_annual":case"enterprise_annual":case"enterprise_three_months":return!0;case"questionnaire":case"downgrade":case"accepted_enterprise_offer":case"accepted_team_offer":case"confirmation":case"closed":return!1;default:(0,W.t1)(e)}}isShowingAcceptedOfferStages(e){switch(e){case"accepted_enterprise_offer":case"accepted_team_offer":return!0;case"questionnaire":case"team_three_months":case"team_annual":case"enterprise_annual":case"enterprise_three_months":case"downgrade":case"confirmation":case"closed":return!1;default:(0,W.t1)(e)}}getDescriptionStyle(){return{margin:0,color:this.theme.mediumTextColor,marginBottom:8}}getIconStyle(){return{display:"inline",height:36,fill:this.theme.accentColors.gray[500],marginTop:8,marginBottom:8}}getDowngradeDescriptionStyle(){return{lineHeight:1.4,marginTop:8,fontWeight:v.Z.fontWeight.medium}}getDowngradeSectionIconStyle(e){return{display:"inline",height:e?14:18,fill:this.theme.accentColors.gray[500],width:void 0,padding:"0px 8px"}}getRestrictionDurationStyle(){return{marginLeft:4,color:this.theme.accentColors.gray[500]}}getRestrictionHighlightedMessageStyle(){return{marginRight:4,color:this.theme.redBadgeBackground}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}getDowngradeButtonStyle(e){const t="downgrade"===e;return{width:"100%",color:t?g.ZP.white:this.theme.mediumTextColor,background:t?this.theme.redBadgeBackground:this.theme.whiteButtonBackground,boxShadow:void 0,display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:3,fill:g.ZP.lightTextColor,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontSize:14,fontWeight:v.Z.fontWeight.medium,marginTop:4}}}l()(tc,"optionRowStyle",{display:"flex",alignItems:"center",cursor:"pointer",marginBottom:4}),l()(tc,"surveySectionStyle",{padding:"0px 24px"}),l()(tc,"headerStyle",{margin:0,marginBottom:8}),l()(tc,"inlineInputStyle",{marginBottom:12,width:"calc(100% - 18px)"});const ic=tc,ac=["not_using_enough","too_difficult","trial_over","too_expensive","security_compliance_requirements","company_shutting_down","upgraded_by_mistake","using_alternative","missing_features","other"],nc=["google_drive_docs","asana","trello","microsoft_office","atlassian_confluence","atlassian_jira","airtable","coda","dropbox_paper","quip","evernote","other"];class sc extends N.Z{getInitialState(){return{reasons:[],reasonMissingFeatures:"",reasonOther:"",alternatives:[],alternativeOther:"",otherFeedback:""}}}const oc=sc,rc=(0,y.defineMessages)({missingFeaturesPlaceholder:{id:"churnSurveyMenu.reasons.missingFeaturesPlaceholder",defaultMessage:"Let us know which features are missing..."},reasonOtherPlaceholder:{id:"churnSurveyMenu.reasons.reasonOtherPlaceholder",defaultMessage:"Tell us more..."},alternativeOtherPlaceholder:{id:"churnSurveyMenu.alternatives.alternativeOtherPlaceholder",defaultMessage:"Tell us more..."},otherFeedbackPlaceholder:{id:"churnSurveyMenu.other.otherFeedbackPlaceholder",defaultMessage:"Our team will review your feedback to make Notion better."}});class lc extends p.Z{constructor(){super(...arguments),l()(this,"shuffledReasons",[...c().shuffle(c().without(ac,"other")),"other"]),l()(this,"shuffledAlternatives",[...c().shuffle(c().without(nc,"other")),"other"]),l()(this,"storeTypes",{store:oc}),l()(this,"handleAccept",(()=>{(0,b.trackChurnSurvey)(this.environment,this.stores.store.state),this.props.onAccept()}))}renderComponent(){var e=this;const{churnType:t,onClose:i,periodEnd:a}=this.props,{store:s}=this.stores,{reasons:o,reasonMissingFeatures:r,reasonOther:l,alternatives:d,alternativeOther:u,otherFeedback:p}=s.state,g=(0,wd.Z)(a).format("LL");return n()("div",{style:{fontSize:14}},void 0,n()("div",{style:{display:"flex",fontSize:14,padding:24,paddingBottom:20,borderBottom:"1px solid ".concat(this.theme.lightDividerColor)}},void 0,n()("div",{},void 0,n()("h3",{style:lc.headerStyle},void 0,n()(y.FormattedMessage,"personal"===t?{id:"churnSurveyMenu.header.personal.title",defaultMessage:"Downgrade to Personal"}:{id:"churnSurveyMenu.header.team.title",defaultMessage:"Downgrade to Team Trial"})),n()("p",{style:{lineHeight:1.4,margin:"8px 0 12px"}},void 0,n()(y.FormattedMessage,{id:"churnSurveyMenu.header.description",defaultMessage:"Notion is constantly improving. Before you downgrade, we’d love your input to help us make Notion better for everyone. Thank you for your feedback."})),n()(Ht.Z,{onClick:i},void 0,n()(y.FormattedMessage,{id:"churnSurveyMenu.goBackButton.title",defaultMessage:"Back to Plans"}))),n()("div",{style:{alignSelf:"center",padding:"0px 8px"}},void 0,n()("img",{src:Ji.Z.images.downgradeFeedbackPng,style:{filter:this.theme.illustrationFilter},width:160}))),n()("div",{style:{padding:"8px 12px",margin:"20px 24px 12px 24px",background:this.theme.sidebarBackground,borderRadius:3}},void 0,n()(y.FormattedMessage,{id:"churnSurveyMenu.header.covidMessage",defaultMessage:"💛 If you are impacted by COVID-19, <contactuslink>contact us</contactuslink> for assistance.",values:{contactuslink:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n()(va.Z,{onClick:()=>{(0,vs.j)({environment:e.environment,from:"churn_survey"})}},void 0,i)}}})),n()("div",{style:lc.surveySectionStyle},void 0,n()("h4",{style:lc.subheaderStyle},void 0,n()(y.FormattedMessage,{id:"churnSurveyMenu.reasons.title",defaultMessage:"1. What are your reasons for downgrading?"})),n()("div",{style:this.getDescriptionStyle()},void 0,n()(y.FormattedMessage,{id:"churnSurveyMenu.reasons.description",defaultMessage:"Please select one or more"})),this.shuffledReasons.map((e=>{const t=o.includes(e);return m().createElement(m().Fragment,null,n()("div",{style:lc.optionRowStyle,onClick:()=>{s.setState({...s.state,reasons:t?c().without(o,e):[...o,e]})}},e,n()(Nt.Z,{checked:t,size:14}),n()("span",{style:{marginLeft:4}},void 0,this.renderMessageForReason(e))),"missing_features"===e&&t&&n()(tt.Z,{style:lc.inlineInputStyle,autoFocus:!0,value:r,placeholder:Ce.default.formatMessage(rc.missingFeaturesPlaceholder),onChange:e=>{s.setState({...s.state,reasonMissingFeatures:e.target.value})}}),"other"===e&&t&&n()(tt.Z,{style:lc.inlineInputStyle,autoFocus:!0,value:l,placeholder:Ce.default.formatMessage(rc.reasonOtherPlaceholder),onChange:e=>{s.setState({...s.state,reasonOther:e.target.value})}}))}))),n()("div",{style:lc.surveySectionStyle},void 0,n()("h4",{style:lc.subheaderStyle},void 0,n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.title",defaultMessage:"2. What tools are you using instead?"})),n()("div",{style:this.getDescriptionStyle()},void 0,n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.description",defaultMessage:"Please select one or more"})),this.shuffledAlternatives.map((e=>{const t=d.includes(e);return m().createElement(m().Fragment,null,n()("div",{style:lc.optionRowStyle,onClick:()=>{s.setState({...s.state,alternatives:t?c().without(d,e):[...d,e]})}},e,n()(Nt.Z,{checked:t,size:14}),n()("span",{style:{marginLeft:4}},void 0,this.renderMessageForAlternative(e))),"other"===e&&t&&n()(tt.Z,{style:lc.inlineInputStyle,autoFocus:!0,value:u,placeholder:Ce.default.formatMessage(rc.alternativeOtherPlaceholder),onChange:e=>{s.setState({...s.state,alternativeOther:e.target.value})}}))}))),n()("div",{style:lc.surveySectionStyle},void 0,n()("h4",{style:lc.subheaderStyle},void 0,n()(y.FormattedMessage,{id:"churnSurveyMenu.otherFeedback.title",defaultMessage:"3. Any other feedback for us?"})),n()(tt.Z,{textarea:!0,style:{marginTop:4},value:p,placeholder:Ce.default.formatMessage(rc.otherFeedbackPlaceholder),onChange:e=>{s.setState({...s.state,otherFeedback:e.target.value})}})),n()("div",{style:{padding:"20px 24px",marginTop:20,borderTop:"1px solid ".concat(this.theme.lightDividerColor)}},void 0,n()("h4",{style:lc.subheaderStyle},void 0,n()(y.FormattedMessage,{id:"churnSurveyMenu.continueDowngrade.title",defaultMessage:"Continue downgrade?"})),n()("p",{style:{margin:"4px 0 20px",lineHeight:1.4}},void 0,n()(y.FormattedMessage,"personal"===t?{id:"churnSurveyMenu.continueDowngrade.downgradeMessage.personal",defaultMessage:"If you cancel now, you'll still enjoy all the features of your paid plan until {periodEnd}. You can resubscribe or switch to another paid plan anytime.{br}After {periodEnd}, this workspace will be downgraded to the free Personal plan, with these restrictions: <li>Single-person use</li><li>Guest limit of 5 per workspace</li><li>Upload files up to 5 MB</li><li>No version history</li><li>No member shared workspace</li>",values:{periodEnd:n()("span",{style:{fontWeight:600}},void 0,g),br:n()("div",{style:{height:8}}),li:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("ul",{style:lc.restrictionListItemStyle},void 0,n()("li",{},void 0,t))}}}:{id:"churnSurveyMenu.continueDowngrade.downgradeMessage.team",defaultMessage:"If you cancel now, you'll still enjoy all the features of your paid plan until {periodEnd}. You can resubscribe or switch to another paid plan anytime.{br}After {periodEnd}, this workspace will be downgraded to a free trial of the Team Plan, with these restrictions: <li>1,000 block limit</li><li>Upload files up to 5 MB</li><li>No version history</li><li>No bulk exports</li><li>No advanced permissions</li><li>No permission groups</li>",values:{periodEnd:n()("span",{style:{fontWeight:600}},void 0,g),br:n()("div",{style:{height:8}}),li:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("ul",{style:lc.restrictionListItemStyle},void 0,n()("li",{},void 0,t))}}})),n()("div",{style:{display:"flex"}},void 0,n()(Ht.Z,{isRed:!0,onClick:this.handleAccept},void 0,n()(y.FormattedMessage,{id:"churnSurveyMenu.downgradeButton.title",defaultMessage:"Downgrade"})),n()(Ht.Z,{onClick:i,style:{marginLeft:12}},void 0,n()(y.FormattedMessage,{id:"churnSurveyMenu.cancelButton.title",defaultMessage:"Cancel"})))))}renderMessageForReason(e){return"not_using_enough"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.reasons.notUsingEnough",defaultMessage:"Not using it enough"}):"too_difficult"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.reasons.toDifficult",defaultMessage:"Too difficult to use"}):"trial_over"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.reasons.trialOver",defaultMessage:"Trial is over"}):"too_expensive"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.reasons.tooExpensive",defaultMessage:"Too expensive"}):"security_compliance_requirements"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.reasons.securityComplianceRequirements",defaultMessage:"Security or compliance requirements"}):"company_shutting_down"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.reasons.companyShuttingDown",defaultMessage:"Company is shutting down or making cuts"}):"upgraded_by_mistake"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.reasons.upgradedByMistake",defaultMessage:"Upgraded by mistake"}):"using_alternative"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.reasons.usingAlternative",defaultMessage:"Using an alternative"}):"missing_features"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.reasons.missingFeatures",defaultMessage:"Missing features"}):"other"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.reasons.other",defaultMessage:"Other"}):void(0,W.t1)(e)}renderMessageForAlternative(e){return"google_drive_docs"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.googleDriveDocs",defaultMessage:"Google Drive / Docs"}):"asana"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.asana",defaultMessage:"Asana"}):"trello"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.trello",defaultMessage:"Trello"}):"microsoft_office"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.microsoftOffice",defaultMessage:"Microsoft 365 / Office"}):"atlassian_confluence"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.atlassianConfluence",defaultMessage:"Confluence"}):"atlassian_jira"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.atlassianJira",defaultMessage:"Jira"}):"airtable"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.airtable",defaultMessage:"Airtable"}):"coda"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.coda",defaultMessage:"Coda"}):"dropbox_paper"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.dropboxPaper",defaultMessage:"Dropbox Paper"}):"quip"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.quip",defaultMessage:"Quip"}):"evernote"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.evernote",defaultMessage:"Evernote"}):"other"===e?n()(y.FormattedMessage,{id:"churnSurveyMenu.alternatives.other",defaultMessage:"Other"}):void(0,W.t1)(e)}getDescriptionStyle(){return{margin:0,color:this.theme.mediumTextColor,marginBottom:8}}}l()(lc,"optionRowStyle",{display:"flex",alignItems:"center",cursor:"pointer",marginBottom:4}),l()(lc,"restrictionListItemStyle",{paddingLeft:20,margin:"6px 0"}),l()(lc,"surveySectionStyle",{padding:"8px 24px"}),l()(lc,"headerStyle",{margin:0,marginBottom:8}),l()(lc,"subheaderStyle",{margin:0,marginTop:8,fontSize:16,fontWeight:600}),l()(lc,"inlineInputStyle",{marginBottom:12,marginLeft:18,width:"calc(100% - 18px)"});const dc=lc;var cc=i(7678),uc=i(95256);const mc={"en-US":{enterpriseContact:"https://notionup.typeform.com/to/FbZ6Tk",enterpriseTrial:"https://notionup.typeform.com/to/OHk8LR",startupFounder:"https://notionup.typeform.com/to/HgYsu8",startupPartner:"https://notionup.typeform.com/to/XEqmGB",nonprofit:"https://notionup.typeform.com/to/nlhrVv",apiPrivateBeta:"https://notionup.typeform.com/to/dSurQQp2"},"ko-KR":{enterpriseContact:"https://notionup.typeform.com/to/K5knuI18",enterpriseTrial:"https://notionup.typeform.com/to/XkdAkTfV",startupFounder:"https://notionup.typeform.com/to/DYAiiu7x",startupPartner:"https://notionup.typeform.com/to/GfPkKEJZ",nonprofit:"https://notionup.typeform.com/to/cSKAL2LL",apiPrivateBeta:"https://notionup.typeform.com/to/dSurQQp2"}};const pc=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("p",{style:{marginTop:8,marginBottom:8}},void 0,1===t.length?t[0]:m().Children.toArray(t))},gc=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(va.Z,{external:!0,href:(0,R.UY)("guides.guides")},void 0,t)},hc=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(va.Z,{external:!0,href:(0,R.UY)("guides.billingAndPayment")},void 0,t)};function fc(e,t,i){!async function(e){const t=mc[ds.SP][e.typeform];let i={};e.params&&(i={...i,...e.params});const a=t+"?".concat(Object.keys(i).map((e=>"".concat(e,"=").concat(i[e]))).join("&"));b.trackOpenTypeform(e.environment,{from:e.frontContext,typeform_name:e.typeform}),await(0,uc.Z)("https://embed.typeform.com/embed.js"),window.typeformEmbed.makePopup(a,{hideHeaders:!0,hideFooter:!1}).open()}({environment:e,typeform:"enterpriseContact",frontContext:t,params:{source:i}})}const vc={general:function(e){return[{question:n()(y.FormattedMessage,{id:"faq.freeVsPersonalAndTeam.question",defaultMessage:"How is the free Personal Plan different from the Personal Pro and Team Plans?"}),answer:n()(y.FormattedMessage,{id:"faq.freeVsPersonalAndTeam.answer",defaultMessage:'<p>The biggest difference is how you can collaborate with others.</p><p>The free Personal Plan is designed for individual use, but allows up to 5 unique guests. These are friends, family members, and others you can invite to collaborate with you privately on any page. You can also share a page publicly and turn on commenting or editing access. In the Share menu at the top right, turn on "Share to web" then "Allow editing." Any Notion user with the link will be able to edit your page.</p><p>With the Personal Pro Plan, you can invite unlimited guests for private collaboration. For example, if you run your own business, you can invite all your clients to provide feedback on your work. </p><p>With the Team Plan, you can add members to your workspace so you all share and work on the same content. It also comes with more permission and admin controls so you and your teammates can work together securely. See the plan comparison chart for more details.</p>',values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.overGuestLimitInFreePlan.question",defaultMessage:"What happens when I go over the guest limit on my Personal Plan?"}),answer:n()(y.FormattedMessage,{id:"faq.overGuestLimitInFreePlan.answer",defaultMessage:"<p>Upgrade to the Personal Pro Plan for unlimited guests, or the Team Plan if you collaborate with the same group of people automatically. You can also review and remove inactive guests in Settings & Members.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.teamTrial.question",defaultMessage:"How do I try out the Team Plan for free?"}),answer:n()(y.FormattedMessage,{id:"faq.teamTrial.answer",defaultMessage:"<p>When asked how you would like to set up Notion during sign up, select Team, and you’ll be automatically enrolled in a Team Plan trial. You’ll get access to most features of a paid Team Plan, with a 1,000 block storage limit. If your team wants to add more than that, upgrade to the full Team Plan. Details above.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.overStorageLimitInFreePlan.question",defaultMessage:"What happens when I go over the block storage limit on my Team trial?"}),answer:n()(y.FormattedMessage,{id:"faq.overStorageLimitInFreePlan.answer",defaultMessage:"<p>You can still read, edit, and organize existing content blocks as usual, but you won’t be able to add new content blocks.</p><p>However, you can delete existing content blocks to free up your storage.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.useNotionForFree.question",defaultMessage:"Can I use Notion for free?"}),answer:n()(y.FormattedMessage,{id:"faq.useNotionForFree.answer",defaultMessage:"<p>Absolutely! Notion is free to use indefinitely.</p><p>The Personal Plan is completely free for individual use. The Team Plan has a free trial with a 1,000 block limit, more than enough to try out Notion with your team before upgrading.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.whatIsABlock.question",defaultMessage:"What is a block?"}),answer:n()(y.FormattedMessage,{id:"faq.whatIsABlock.answer",defaultMessage:"<p>A block is any single piece of content you add to your page, like a paragraph of text, a to-do item, an image, a code block, an embedded file, etc. Think of your page as being made up of these building blocks.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.deleteBlocks.question",defaultMessage:"Can I delete blocks to free up my storage?"}),answer:n()(y.FormattedMessage,{id:"faq.deleteBlocks.answer",defaultMessage:"<p>Of course! It works just like the storage limit on your phone or computer. If you delete something, you will free up space for more.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.studentDiscount.question",defaultMessage:"Do you offer student discounts?"}),answer:n()(y.FormattedMessage,{id:"faq.studentDiscount.answer",defaultMessage:"<p>The Personal Pro Plan is free for students and educators. This lets you collaborate with unlimited guests and gives you version history. Simply sign up with your school email address and you’ll immediately gain access to these features.</p><p>If you’re already on a Personal Pro Plan, change the email associated with your account to your school email address to get it for free. If you're already on our free Education Plan, you've been automatically upgraded to the Personal Pro Plan.</p><p><helpcenterlink>Visit the help center to learn more</helpcenterlink></p>",values:{p:pc,helpcenterlink:gc}})},{question:n()(y.FormattedMessage,{id:"faq.howToEarnCredit.question",defaultMessage:"How do I earn credit?"}),answer:n()(y.FormattedMessage,{id:"faq.howToEarnCredit.answer",defaultMessage:"<p>You can earn credit by using Notion across your devices and trying out new features. Go to the Earn Credit tab in Settings & Members to learn more.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.howToApplyCredit.question",defaultMessage:"How do I apply credit to my workspace?"}),answer:n()(y.FormattedMessage,{id:"faq.howToApplyCredit.answer",defaultMessage:"<p>To apply credit, you must first upgrade to a paid plan. As part of this process, you can choose to apply some or all of your account credit to the plan.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.whyBillingInformation.question",defaultMessage:"Why do you need my billing information if I have enough credit to pay for Notion?"}),answer:n()(y.FormattedMessage,{id:"faq.whyBillingInformation.answer",defaultMessage:"<p>We still require your billing information, even if you applied enough credit to make your first bill $0, because you may run out of credit in the future and we need to be able to charge your account.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.runOutOfCredit.question",defaultMessage:"What happens if I run out of credit?"}),answer:n()(y.FormattedMessage,{id:"faq.runOutOfCredit.answer",defaultMessage:"<p>If you run out of credit, your account will be charged via your selected payment method.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.maximumEarnedCredit.question",defaultMessage:"Is there a maximum amount of credit I can earn?"}),answer:n()(y.FormattedMessage,{id:"faq.maximumEarnedCredit.answer",defaultMessage:"<p>Yes, you can earn up to {maximumAmountInDollars} in credit.</p>",values:{p:pc,maximumAmountInDollars:(0,yr.Dx)({amount:cc.cw,currency:"dollar",intl:Ce.default.getIntl()})}})},{question:n()(y.FormattedMessage,{id:"faq.advancedPermissions.question",defaultMessage:"What advanced permissions does the paid Team & Enterprise Plans offer?"}),answer:n()(y.FormattedMessage,{id:"faq.advancedPermissions.answer",defaultMessage:'<p>If you are on a free Team trial, you can set the access level on each page to "Full access," "Can view," or "Can comment." That dictates how other users can interact with that page. "Full access" means someone can edit, comment, and share the page with others.</p><p>On paid Team and Enterprise Plans, you have the ability to grant "Can edit" access to other users. This gives someone the ability to edit and comment on that page, but not share it with others. This is especially useful if you do not want your content leaking outside your team.</p><p><contactsales>Contact sales to learn more</contactsales></p>',values:{p:pc,contactsales:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n()(va.Z,{onClick:()=>fc(e,"faq","Advanced permissions")},void 0,i)}}})},{question:n()(y.FormattedMessage,{id:"faq.teamAdminTools.question",defaultMessage:"What admin tools come with the Team Plan? "}),answer:n()(y.FormattedMessage,{id:"faq.teamAdminTools.answer",defaultMessage:"<p>On a free Team trial, every member in your workspace is an admin. This means all of you can adjust team settings and invite other people into the workspace.</p><p>If you want only a few people to have admin abilities, we recommend upgrading to the full Team Plan. It comes with tools that allow you to make only select people admins while everyone else is a member. Members can't edit billing information or security options, and can't share your content outside the workspace.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.personalPricing.question",defaultMessage:"How is pricing calculated for the Personal Pro Plan?"}),answer:n()(y.FormattedMessage,{id:"faq.personalPricing.answer",defaultMessage:"<p>If you upgrade your workspace to Personal Pro, you will be charged a flat fee ($5 monthly or $48 yearly).</p><p>Guests are free of charge, but they can only be added to one page at a time.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.teamPricing.question",defaultMessage:"How is pricing calculated for the Team Plan?"}),answer:n()(y.FormattedMessage,{id:"faq.teamPricing.answer",defaultMessage:'<p>If you upgrade your workspace to the Team Plan, you will be charged a fee per member ($10 monthly or $96 yearly). For example, if you pay per month and have 5 members, you will be charged $50 each month.</p><p>Guests are free of charge – but they can only access individual pages they are invited to. In other words, guests won’t be able to see all the team pages under the "Workspace" section in the left sidebar.</p>',values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.monthlyAndYearlyBilling.question",defaultMessage:"Do you have monthly and yearly billing options?"}),answer:n()(y.FormattedMessage,{id:"faq.monthlyAndYearlyBilling.answer",defaultMessage:"<p>Yes! We offer both monthly and yearly billing options. The yearly billing option is always cheaper (an estimated 20% discount). For example, the Team Plan is $10 per member per month when you choose the monthly option, but $8 per member per month if you choose to pay yearly.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.addingAndRemovingMembers.question",defaultMessage:"How does adding and removing members work?"}),answer:n()(y.FormattedMessage,{id:"faq.addingAndRemovingMembers.answer",defaultMessage:"<p>Whether you're on a monthly or yearly billing schedule, your account may be charged on a monthly basis if you make these types of changes. If you added members, your account will be charged a prorated amount based on the percentage of the billing cycle left at the time each member was added. If you removed members, your account will be credited in the same way.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.changePlans.question",defaultMessage:"What happens when I change plans?"}),answer:n()(y.FormattedMessage,{id:"faq.changePlans.answer",defaultMessage:"<p>Upgrading or downgrading your plan works similarly to adding and removing members. Your account will be charged or credited based on the percentage of the billing cycle left at the time the plan was changed.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.cancelPlan.question",defaultMessage:"How do I cancel my paid plan?"}),answer:n()(y.FormattedMessage,{id:"faq.cancelPlan.answer",defaultMessage:'<p>Your Notion subscription, annual or monthly, will automatically renew until you cancel it. You can cancel your subscription by going to "Settings & members" in the left-hand sidebar on a desktop computer, then selecting "Plans," then "Downgrade." After you cancel, you’ll still have access to all the paid features until the end of your billing cycle.</p><p><billingandpaymentlink>More on billing & payment here</billingandpaymentlink></p>',values:{p:pc,billingandpaymentlink:hc}})},{question:n()(y.FormattedMessage,{id:"faq.paymentFailure.question",defaultMessage:"What happens if my payment fails? Like if my credit card expires?"}),answer:n()(y.FormattedMessage,{id:"faq.paymentFailure.answer",defaultMessage:"<p>Your account email will be notified after each failed payment. Payments may be retried up to 4 times within the next month. After this, if the payment did not succeed, you will be downgraded to the free plan.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.changePaymentMethod.question",defaultMessage:"Can I change my payment method?"}),answer:n()(y.FormattedMessage,{id:"faq.changePaymentMethod.answer",defaultMessage:"<p>You can change your payment method at any time in your billing settings.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.refund.question",defaultMessage:"How do refunds work?"}),answer:n()(y.FormattedMessage,{id:"faq.refund.answer",defaultMessage:"<p>Our refund policy is simple. If you believe you've made a mistake signing up for a paid Notion subscription online or in-app, please contact us inside the app or email team@makenotion.com. We'll be happy to refund you the full amount (not pro-rated) if you downgrade your subscription within 72 hours of signing up for monthly billing, or within 30 days of signing up for annual billing.</p><p>And if for any reason you're unhappy with Notion, please let us know at team@makenotion.com — we'd love to hear your feedback, and will be happy to work with you to create the best experience possible.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.mandatoryRefund.question",defaultMessage:"What if I live in a region with a mandatory refund policy?"}),answer:n()(y.FormattedMessage,{id:"faq.mandatoryRefund.answer",defaultMessage:"<p>If you live in the European Union, United Kingdom, or another region with a mandatory refund policy, you may be eligible for a monthly subscription refund past 72 hours. For example, customers in the European Union can receive a full refund for a monthly subscription within 14 days of purchase, rather than 72 hours.</p><p>To request a refund, please contact us inside the app or email team@makenotion.com. If you live in a region with a mandatory refund policy, please let us know and we'll be happy to assist you.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.serviceLevelAgreement.question",defaultMessage:"Do you have a Service-Level Agreement (SLA)?"}),answer:n()(y.FormattedMessage,{id:"faq.serviceLevelAgreement.answer",defaultMessage:"<p>We do not offer a standard SLA. For teams with greater than 100 members, we can offer a custom SLA.</p><p><contactsales>Contact sales to learn more</contactsales></p>",values:{p:pc,contactsales:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n()(va.Z,{onClick:()=>fc(e,"faq","SLA")},void 0,i)}}})},{question:n()(y.FormattedMessage,{id:"faq.importStorageLimit.question",defaultMessage:"How does importing content from another app affect my block storage limit if I'm on the Team Plan trial?"}),answer:n()(y.FormattedMessage,{id:"faq.importStorageLimit.answer",defaultMessage:"<p>Content created via import doesn’t count toward your workspace’s storage limit. We want to make sure you get started with Notion as smoothly as possible.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.paymentProcessor.question",defaultMessage:"How is my payment being processed?"}),answer:n()(y.FormattedMessage,{id:"faq.paymentProcessor.answer",defaultMessage:"<p>We use Stripe to process your payment. It’s the same payment provider used by products such as Twitter, Pinterest, and Lyft. We do not handle your credit card information directly.</p>",values:{p:pc}})},{question:n()(y.FormattedMessage,{id:"faq.multipleTeams.question",defaultMessage:"Can I belong to multiple teams on Notion? "}),answer:n()(y.FormattedMessage,{id:"faq.multipleTeams.answer",defaultMessage:"<p>Yes! You can use the same email address to create and join multiple teams. However, each one of these workspaces is on its own plan and needs to be upgraded individually.</p>",values:{p:pc}})}]}};class yc extends p.Z{constructor(){super(...arguments),l()(this,"renderFaqItem",((e,t)=>n()(u.Fragment,{},t,n()("div",{style:yc.questionStyle},void 0,e.question),n()("div",{style:this.getAnswerStyle()},void 0,e.answer)))),l()(this,"handleHelpButtonClick",(()=>{vs.j({environment:this.environment,from:"pricing"})}))}renderComponent(){return n()("div",{style:{maxWidth:600}},void 0,this.getFaqList().map(((e,t)=>this.renderFaqItem(e,t))),n()("div",{style:{color:this.props.isSettings?this.theme.mediumTextColor:g.ZP.frontTextMedium}},void 0,this.props.cta?"intercom"===this.props.cta?this.renderIntercomCTA():this.renderGuidesCTA():null))}renderIntercomCTA(){var e=this;return n()(y.FormattedMessage,{id:"faqList.moreQuestionsTextIntercom",defaultMessage:"Still have more questions? <messagelink>Message support</messagelink>",values:{messagelink:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n()(va.Z,{onClick:e.handleHelpButtonClick},void 0,i)}}})}renderGuidesCTA(){return n()(y.FormattedMessage,{id:"faqList.moreQuestionsTextHelpCenter",defaultMessage:"Still have more questions? Learn more in our <messagelink>help center</messagelink>.",values:{messagelink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(va.Z,{href:(0,R.UY)("guides.guides")},void 0,t)}}})}getFaqList(){return vc[this.props.type](this.environment)}getAnswerStyle(){return{color:this.props.isSettings?this.theme.mediumTextColor:g.ZP.frontTextMedium,marginBottom:"1.5rem",lineHeight:1.5}}}l()(yc,"questionStyle",{fontWeight:v.Z.fontWeight.semibold,marginBottom:4});const Sc=yc;const Mc=function(e){return!!e.device.isMobile||e.WindowSizeStore.state.width<960};var bc=i(66205);class wc extends p.Z{renderComponent(){const e="yearly"===Yd.state.termType?"monthly":"yearly";return n()("div",{style:wc.getTermToggleStyle(this.theme),onClick:()=>{b.trackFrontTogglePricingTerm(this.environment,{from:"pricing_grid_top",toggle_to:e}),Yd.setState({...Yd.state,termType:e})}},void 0,n()("div",{style:{marginRight:8}},void 0,n()(y.FormattedMessage,{id:"pricingGrid.pricingTermToggle.payAnnually.label",defaultMessage:"Pay annually"})),n()(ns.Z,{on:"monthly"===Yd.state.termType}),n()("div",{style:{marginLeft:8}},void 0,n()(y.FormattedMessage,{id:"pricingGrid.pricingTermToggle.payMonthly.label",defaultMessage:"Monthly"})))}static getTermToggleStyle(e){return{cursor:"pointer",fontSize:14,color:e.mediumTextColor,display:"flex",alignItems:"center",marginBottom:8}}}const Cc=wc,Tc=["free","personal","team","business","enterprise"];class kc extends p.Z{willMount(e){const t=L.XX(e.data);t&&e.data&&Yd.setState({termType:"year"===t.interval?"yearly":"monthly"})}renderComponent(){const e="on"===ie.default.getGroup("show-business-plan"),t="on"===ie.default.getGroup("teams-education"),i=(0,Xd.Sl)({showingBusinessPlan:e,showingTeamsFeature:t});return n()("div",{},void 0,n()("table",{style:kc.getTableStyle()},void 0,this.renderHeader(e),n()("tbody",{},void 0,i.map(((e,t)=>this.renderSection(e,t))))))}renderCheck(){return h.Z.thinCheck({display:"inline",height:12,width:12,color:this.theme.regularTextColor})}upgradeLink(e,t){const{planState:i}=this.props;if(i)return n()(va.Z,{onClick:i.plans[e].onClick,style:{fontSize:12,fontWeight:500,textDecoration:"none",color:this.theme.mediumTextColor,lineHeight:1.2}},void 0,t||n()(y.FormattedMessage,{id:"pricingGrid.planAttribute.button.upgrade",defaultMessage:"Upgrade"}))}renderPlanContent(e){const{label:t,upgradeCta:i,upgradeCTALabel:a}=e;return t&&i?n()(u.Fragment,{},void 0,t,n()("br",{}),this.upgradeLink(i,a)):t||(i?n()(u.Fragment,{},void 0,n()(y.FormattedMessage,{id:"pricingGrid.planAttribute.notInTrial",defaultMessage:"Not in trial"}),n()("br",{}),this.upgradeLink(i,a)):this.renderCheck())}renderPlan(e,t,i){return n()("td",{style:{...kc.getRowStyle(this.theme),...kc.getValueStyle(),...kc.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)}},void 0,i.hasFeature&&n()(Le.Z,{delayThreshold:0,placement:Le.Z.Placement.Right,renderTooltip:()=>(0,Xd.O_)(t),textWrap:!0,render:e=>m().createElement("div",o()({style:{cursor:"help",lineHeight:1.3,padding:"6px 0"}},e),this.renderPlanContent(i))}))}renderItem(e,t){const i="auto",a=this.props.planState&&this.props.planState.isTeamTrial,s="on"===ie.default.getGroup("show-business-plan");return n()("tr",{},"table-row-".concat(t),n()("td",{style:{...kc.getRowStyle(this.theme),...kc.getRowLabelStyle(this.theme),width:i,maxWidth:i,minWidth:i}},void 0,n()(Le.Z,{delayThreshold:0,placement:Le.Z.Placement.Right,renderTooltip:()=>(0,Xd.O_)(e.tooltip),textWrap:!0,render:t=>m().createElement("span",o()({},t,{style:kc.getTooltipInnerStyle()}),e.label,e.isComingSoon&&this.renderBadge("comingSoon"),e.isBeta&&this.renderBadge("beta"))})),Tc.map((t=>{const i="team"===t&&a?"teamTrial":t;if(s||"business"!==t)return this.renderPlan(t,e.tooltip,e.plans[i])})))}renderEmptyTableCell(e,t){return n()("td",{style:{...kc.getSectionStyle(this.theme,t),...kc.getValueStyle(),...kc.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e),color:g.ZP.lightTextColor,fontWeight:400}})}renderEmptyTableCells(e){return n()(u.Fragment,{},void 0,Tc.map((t=>this.renderEmptyTableCell(t,e))))}renderSection(e,t){const i="auto";return n()(u.Fragment,{},"table-section-".concat(t),n()("tr",{},void 0,n()("td",{style:{...kc.getSectionStyle(this.theme,t),width:i,maxWidth:i,minWidth:i}},void 0,e.label),this.renderEmptyTableCells(t)),e.items.map(((e,t)=>this.renderItem(e,t))))}renderButton(e,t){const i=t.plans[e],a="notion-pricing-grid-upgrade-".concat(e);let s;switch(i.buttonType){case"current":s=n()(y.FormattedMessage,{id:"pricingGrid.currentPlanButton.label",defaultMessage:"Current"});break;case"upgrade":s=n()(y.FormattedMessage,{id:"pricingGrid.upgradePlanButton.label",defaultMessage:"Upgrade"});break;case"downgrade":s=n()(y.FormattedMessage,{id:"pricingGrid.downgradePlanButton.label",defaultMessage:"Downgrade"});break;case"will-downgrade":s=n()(y.FormattedMessage,{id:"pricingGrid.willDowngradePlanButton.label",defaultMessage:"Future plan"});break;case"resubscribe":s=n()(y.FormattedMessage,{id:"pricingGrid.resubscribePlanButton.label",defaultMessage:"Resubscribe"});break;default:W.t1(i.buttonType)}if("current"===i.buttonType)return this.renderDisabledButtonWithTooltip({tooltip:n()(y.FormattedMessage,{id:"pricingGrid.currentPlan.tooltip",defaultMessage:"This is your current active plan"}),label:n()(y.FormattedMessage,{id:"pricingGrid.currentPlan.largeScreenLabel",defaultMessage:"Current plan"}),buttonClassName:a,wrapTooltip:!1});if(!t.canSwitchPlans){let e;return e=t.isInAppPurchase?n()(y.FormattedMessage,{id:"pricingGrid.switchPlanFromInAppPurchase.tooltip",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."}):n()(y.FormattedMessage,{id:"pricingGrid.switchPlanAsMember.tooltip",defaultMessage:"You need to be an administrator of this workspace to switch plans."}),this.renderDisabledButtonWithTooltip({tooltip:e,label:s,buttonClassName:a,wrapTooltip:!0})}return("personal"===e||"free"===e)&&t.memberCount>1?this.renderDisabledButtonWithTooltip({tooltip:n()(y.FormattedMessage,{id:"pricingGrid.switchToPersonalPlanButton.tooltip",defaultMessage:"The Personal and Personal Pro Plans are only available for 1-person use. If you'd like to use these plans, please remove the other members in this workspace."}),label:s,buttonClassName:a,wrapTooltip:!0}):"will-downgrade"===i.buttonType?this.renderDisabledButtonWithTooltip({tooltip:n()(y.FormattedMessage,{id:"pricingGrid.willDowngradePlan.tooltip",defaultMessage:"This is the plan after your current plan expires"}),label:n()(y.FormattedMessage,{id:"pricingGrid.willDowngradePlan.largeScreenLabel",defaultMessage:"Future plan"}),buttonClassName:a,wrapTooltip:!1}):"downgrade"===i.buttonType?n()(Ht.Z,{isLarge:!0,style:{width:"100%"},onClick:()=>{b.trackPricingGridButtonClick(this.environment,{plan:e,from:"pricing_grid_top",button_text:i.buttonType}),i.onClick()},className:a},void 0,s):n()(xe.Z,{isLarge:!0,style:{width:"100%"},onClick:()=>{b.trackPricingGridButtonClick(this.environment,{plan:e,from:"pricing_grid_top",button_text:i.buttonType}),i.onClick()},className:a},void 0,s)}renderDisabledButtonWithTooltip(e){const{tooltip:t,label:i,buttonClassName:a,wrapTooltip:s}=e;return n()(Le.Z,{style:{width:s?320:"auto"},textWrap:s,renderTooltip:()=>t,render:e=>m().createElement(Ht.Z,o()({style:{width:"100%",opacity:.5},isLarge:!0,disabled:!0},e,{className:a}),i)})}renderSalesContactLink(){return n()(va.Z,{onClick:()=>{const{currentUserStore:e}=Z.default.state,t=e&&e.getValue();b.trackContactSalesClick(this.environment),bc.Z.setState({open:!0,email:t&&t.email,name:t&&(0,be.Nz)(this.props.intl,t)})}},void 0,n()("div",{style:kc.getUpgradeButtonBelowLinkStyle()},void 0,n()(y.FormattedMessage,{id:"pricingGrid.contactSalesLink",defaultMessage:"Contact sales"})))}renderTeamTrialIndicator(){return n()(Le.Z,{delayThreshold:0,placement:Le.Z.Placement.Bottom,renderTooltip:()=>n()(y.FormattedMessage,{id:"pricingGrid.inTeamTrial.tooltip",defaultMessage:"Your current Team trial has a 1,000 block limit. Upgrade to go unlimited."}),textWrap:!0,style:{width:280},render:e=>m().createElement("div",o()({style:{...kc.getUpgradeButtonBelowLinkStyle(),fontWeight:500,display:"flex",flexDirection:"row",cursor:"help"}},e),n()("div",{style:{paddingRight:4,paddingTop:2}},void 0,this.renderCheck()),n()("div",{},void 0,n()(y.FormattedMessage,{id:"pricingGrid.inTeamTrial",defaultMessage:"In free trial"})))})}static renderTeamTrialButton(e){if(e.isActive&&"resubscribe"===e.buttonType)return;const t="current"===e.buttonType?n()(y.FormattedMessage,{id:"pricingGrid.cancelPlanLink",defaultMessage:"Cancel plan"}):n()(y.FormattedMessage,{id:"pricingGrid.teamTrialLink",defaultMessage:"Try for free"});return n()(va.Z,{onClick:e.onClickTeamFree},void 0,n()("div",{style:kc.getUpgradeButtonBelowLinkStyle()},void 0,t))}getPlanName(e){const{intl:t}=this.props;switch(e){case"free":return t.formatMessage({id:"pricingGrid.personalFreePlanColumn.header",defaultMessage:"Personal"});case"personal":return t.formatMessage({id:"pricingGrid.personalProPlanColumn.header",defaultMessage:"Personal Pro"});case"team":return t.formatMessage({id:"pricingGrid.teamPlanColumn.header",defaultMessage:"Team"});case"business":return t.formatMessage({id:"pricingGrid.businessPlanColumn.header",defaultMessage:"Business",description:"Shown in our plans page in settings to describe the business plan type."});case"enterprise":return t.formatMessage({id:"pricingGrid.enterprisePlanColumn.header",defaultMessage:"Enterprise"});default:W.t1(e)}}renderHeaderTitle(e){const t=this.getPlanName(e.plan);return n()("td",{style:{...kc.getHeaderStyle(),...kc.getActiveStyle(this.theme,this.isPlanActive(e.plan)),...this.getBorderStyle(e.plan)}},void 0,n()("div",{style:this.getHeaderTitleStyle()},void 0,t),void 0!==e.price&&n()("div",{style:{display:Mc(this.environment)?"block":"flex"}},void 0,n()("div",{style:kc.getHeaderPriceStyle()},void 0,e.price),void 0!==e.terms&&n()("div",{style:this.getHeaderTermsStyle(this.theme)},void 0,(0,Xd.X6)(this.props.intl,e.terms))))}renderHeaderLabels(e){const t=this.isPlanActive("team")||this.isPlanActive("business")||this.isPlanActive("enterprise");return n()("tr",{},void 0,n()("td",{style:{width:"28%"}}),n()("td",{style:{...this.getHeaderLabelStyle(!t,e,!1),...this.getBorderStyle("free"),borderLeft:"1px solid ".concat(this.theme.lightDividerColor)},colSpan:2},void 0,n()(y.FormattedMessage,{id:"pricingGrid.personalPlans.label",defaultMessage:"For individuals"})),n()("td",{style:{...this.getHeaderLabelStyle(t,e,!0),...this.getBorderStyle("enterprise")},colSpan:e?3:2},void 0,n()(y.FormattedMessage,{id:"pricingGrid.teamPlans.label",defaultMessage:"For teams & businesses"})))}renderHeaderTitles(e){const t=Yd.state.termType,i=(0,Xd.MZ)(Gt.Z,this.props.intl);return n()("tr",{},void 0,n()("td",{}),this.renderHeaderTitle({plan:"free",price:i.price[t].personal,image:Ji.Z.images.pricing.pricingFreeV2Png}),this.renderHeaderTitle({plan:"personal",price:i.price[t].pro,image:Ji.Z.images.pricing.pricingPersonalV2Png,terms:i.terms.pro}),this.renderHeaderTitle({plan:"team",price:i.price[t].team,image:Ji.Z.images.pricing.pricingTeamV2Png,terms:i.terms.team}),e&&this.renderHeaderTitle({plan:"business",price:i.price[t].business,image:Ji.Z.images.pricing.pricingEnterpriseV2Png,terms:i.terms.business}),this.renderHeaderTitle({plan:"enterprise",price:i.price[t].enterprise,image:Ji.Z.images.pricing.pricingEnterpriseV2Png,terms:i.terms.enterprise}))}renderHeaderAction(e,t){const{planState:i}=this.props;if(i&&(t||"business"!==e))return n()("td",{style:{...kc.getHeaderStyle(),...kc.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)}},void 0,this.renderButton(e,i),this.renderHeaderSubAction(e))}renderHeaderSubAction(e){if("enterprise"===e)return n()("div",{style:{marginTop:7}},void 0,this.renderSalesContactLink());if("team"===e){const{planState:t}=this.props;if(!t||!t.canSwitchPlans||t.plans.personal.isActive)return;return n()("div",{style:{marginTop:7}},void 0,t.isTeamTrial?this.renderTeamTrialIndicator():kc.renderTeamTrialButton(t.plans[e]))}}renderHeaderActions(e){if(this.props.planState)return n()("tr",{},void 0,n()("td",{style:{width:"28%",verticalAlign:"top",paddingTop:16}},void 0,n()(Cc,{})),Tc.map((t=>this.renderHeaderAction(t,e))))}renderHeader(e){return n()("thead",{},void 0,this.renderHeaderLabels(e),this.renderHeaderTitles(e),this.renderHeaderActions(e))}renderBadge(e){return n()("div",{style:{background:this.theme.buttonHoveredBackground,fontSize:10,fontWeight:500,letterSpacing:"0.015em",color:this.theme.mediumTextColor,display:"inline",textTransform:"uppercase",padding:"2px 4px",marginLeft:6,borderRadius:3,whiteSpace:"nowrap",position:"relative",top:-1}},void 0,"comingSoon"===e&&n()(y.FormattedMessage,{id:"pricingGrid.comingSoonBadge",defaultMessage:"Coming soon"}),"beta"===e&&n()(y.FormattedMessage,{id:"pricingGrid.betaBadge",defaultMessage:"Beta"}))}isPlanActive(e){return Boolean(this.props.planState&&this.props.planState.plans[e].isActive)}static getTableStyle(){return{fontSize:14,width:"100%",tableLayout:"fixed",borderCollapse:"initial"}}static getSectionStyle(e,t){const i={borderBottom:"1px solid ".concat(e.regularDividerColor),paddingBottom:7,paddingRight:15,fontWeight:500,verticalAlign:"bottom"};return 0===t?{...i,paddingTop:0}:{...i,paddingTop:20}}static getUpgradeButtonBelowLinkStyle(){return{fontSize:12}}static getRowStyle(e){return{borderBottom:"1px solid ".concat(e.regularDividerColor)}}static getRowLabelStyle(e){return{color:e.mediumTextColor,paddingRight:10,paddingTop:5,paddingBottom:6,verticalAlign:"top"}}static getValueStyle(){return{paddingLeft:10,paddingRight:10,textAlign:"left",overflow:"hidden",verticalAlign:"top"}}static getActiveStyle(e,t){const i=e.cardSidebarBackground;return{background:t?i:g.ZP.transparent}}getBorderStyle(e){return{borderLeft:"1px solid ".concat(this.theme.lightDividerColor),borderRight:["enterprise"].includes(e)?"1px solid ".concat(this.theme.lightDividerColor):void 0}}getHeaderLabelStyle(e,t,i){let a="36%";return t&&(a=i?"42%":"28%"),{paddingLeft:10,paddingRight:10,verticalAlign:"top",width:a,paddingTop:10,fontWeight:700,fontSize:12,paddingBottom:10,borderBottom:e?"2px solid ".concat(this.theme.regularTextColor):"1px solid ".concat(this.theme.lightDividerColor),borderTop:"1px solid ".concat(this.theme.lightDividerColor)}}static getHeaderStyle(){return{paddingLeft:10,paddingRight:10,verticalAlign:"top",width:"18%",paddingTop:10}}getHeaderTitleStyle(){return{fontSize:16,fontWeight:Mc(this.environment)?500:700,lineHeight:1.3,marginBottom:2}}static getHeaderPriceStyle(){return{fontSize:20,marginRight:7}}static getTooltipInnerStyle(){return{cursor:"help",width:"100%",display:"inline-block"}}getHeaderTermsStyle(e){return{fontSize:10,lineHeight:1,color:e.mediumTextColor,width:70,paddingTop:Mc(this.environment)?0:3}}}const Zc=(0,y.injectIntl)(kc);var Ac=i(10644);class Ic extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{store:Jd,downgradeModalStore:Kd}),l()(this,"renderChurnSurveyModal",(()=>{const e=this.stores.store.state,{data:t}=this.props,i=L.XX(t),a=L.CM(this.environment);if(!e.churnSurveyModalOpen||!a||!i)return;return"on"===ie.default.getGroup("churn_survey")?n()(ic,{churnType:e.churnType,periodEnd:i.periodEnd,customerId:i.customerId,onAccept:this.handleChurnSurveyModalAccept,onClose:this.handleChurnSurveyModalClose}):n()(dc,{churnType:e.churnType,periodEnd:i.periodEnd,onAccept:this.handleChurnSurveyModalAccept,onClose:this.handleChurnSurveyModalClose})})),l()(this,"handleFreeClick",(async()=>{const{data:e}=this.props;if(await new Promise((e=>{C.showDialog({showCancel:!0,keepFocus:!1,message:n()("div",{},void 0,n()("h4",{style:{margin:"8px 0 0"}},void 0,n()(y.FormattedMessage,{id:"subscriptSettings.freePersonal.downgradeTitle",defaultMessage:"Downgrade to the Personal Plan?"})),n()("p",{},void 0,n()(y.FormattedMessage,{id:"subscriptionSettings.freePersonal.downgradeMessageWithTeamsFirstParagraph",defaultMessage:"The Personal Plan is free for 1 member, and limited to only 5 guests.",description:"Downgrade message shown in confirmation modal."})),this.shouldShowTeamWarningDuringDowngrade()&&n()("p",{},void 0,n()(y.FormattedMessage,{id:"subscriptionSettings.freePersonal.downgradeMessageWithTeamsSecondParagraph",defaultMessage:"Pages in the “Teamspaces” section will no longer be in your sidebar, but still be accessible via search and links. We suggest you move them to the “Private” section before downgrading",description:"Downgrade message shown in confirmation modal."}))),items:[{label:n()(y.FormattedMessage,{id:"subscriptionSettings.freePersonal.downgradeConfirmationButton",defaultMessage:"Downgrade to Personal Plan"}),color:"red",onAccept:()=>{e(!0)}}],handleCancel:()=>{e(!1)}})}))){if(e&&"subscribed_admin"===e.type){if(!(await new Promise((e=>{const{store:t}=this.stores;t.setState({churnType:"free",churnSurveyModalOpen:!0,onAccept:()=>e(!0),onClose:()=>e(!1)})}))))return}await _.EO({environment:this.environment,spaceStore:this.props.spaceStore,planType:"personal",from:"space_settings-plans_tab"})}})),l()(this,"handlePersonalClick",(async e=>{const{spaceStore:t,data:i}=this.props,a=L.XX(i);if(this.shouldShowTeamWarningDuringDowngrade()){if(!(await new Promise((e=>{C.showDialog({showCancel:!0,keepFocus:!1,message:n()("div",{},void 0,n()("h4",{style:{margin:"8px 0 0"}},void 0,n()(y.FormattedMessage,{id:"subscriptSettings.personalPro.downgradeTitle",defaultMessage:"Downgrade to the Personal Pro Plan?",description:"Downgrade title shown in confirmation modal."})),n()("p",{},void 0,n()(y.FormattedMessage,{id:"subscriptionSettings.personalPro.downgradeMessage",defaultMessage:"Pages in the “Teamspaces” section will no longer be in your sidebar, but still be accessible via search and links. We suggest you move them to the “Private” section before downgrading",description:"Downgrade message shown in confirmation modal."}))),items:[{label:n()(y.FormattedMessage,{id:"subscriptionSettings.personalPro.downgradeConfirmationButton",defaultMessage:"Downgrade to Personal Pro Plan",description:"Downgrade button shown in confirmation modal."}),color:"red",onAccept:()=>{e(!0)}}],handleCancel:()=>{e(!1)}})}))))return}if(a&&L.lr(i)){const i=md.HA.personal[a.interval],n=L.CM(this.environment),s=n&&zd.rC[n]<zd.rC.personal;if(e&&!s&&void 0===a.canceledAt){const e=await new Promise((e=>{const{store:t}=this.stores;t.setState({churnType:"personal",churnSurveyModalOpen:!0,onAccept:()=>e(!0),onClose:()=>e(!1)})}));if(!e)return;e&&await _.Mg({environment:this.environment,spaceStore:t,plan:i,from:"space_settings-plans_tab"})}else await _.Mg({environment:this.environment,spaceStore:t,plan:i,from:"space_settings-plans_tab"})}else _.I0(this.environment,{subscriptionTier:"personal",from:"pricing_grid"})})),l()(this,"handleEducationPlanClick",(()=>{const{spaceStore:e}=this.props;_.r7({environment:this.environment,spaceStore:e})})),l()(this,"handleTeamClick",(async e=>{const{spaceStore:t,data:i}=this.props,a=L.XX(i),s=a&&void 0===a.canceledAt;let o;a&&s&&"enterprise"!==L.CM(this.environment)&&(o=this.props.intl.formatMessage({id:"spaceSubscriptionPlans.teamPlan.confirmMessage",defaultMessage:"You are about to subscribe to Notion's Team Plan for {price} per member per month.{br}You will be charged a prorated amount, minus any account balance."},{price:L._B({subscriptionTier:"team",billingInterval:"yearly"===Yd.state.termType?"year":"month",intl:this.props.intl}),br:n()("br",{})}));const r=L.CM(this.environment),l=r&&zd.rC[r]<zd.rC.team,d="unsubscribed_admin"===i.type||"unsubscribed_member"===i.type||a&&a.canceledAt||l;if(o){if(!(await C.confirmUserAction({message:o,acceptLabel:this.props.intl.formatMessage({id:"spaceSubscriptionPlans.teamPlan.confirmButtonLabel",defaultMessage:"{upgrading, select, true {Upgrade to Team Plan} other {Downgrade to Team Plan}}"},{upgrading:d})})))return}if(a&&L.lr(i)){const i=md.HA.team[a.interval];if(e&&!d){const e=await new Promise((e=>{const{store:t}=this.stores;t.setState({churnType:"team",churnSurveyModalOpen:!0,onAccept:()=>e(!0),onClose:()=>e(!1)})}));if(!e)return;e&&await _.Mg({environment:this.environment,spaceStore:t,plan:i,from:"space_settings-plans_tab"})}else await _.Mg({environment:this.environment,spaceStore:t,plan:i,from:"space_settings-plans_tab"})}else _.I0(this.environment,{subscriptionTier:"team",from:"pricing_grid"})})),l()(this,"handleTeamFreeClick",(async()=>{const{data:e}=this.props;if(e&&"subscribed_admin"===e.type){const e=await new Promise((e=>{const{store:t}=this.stores;t.setState({churnType:"team",churnSurveyModalOpen:!0,onAccept:()=>e(!0),onClose:()=>e(!1)})}));if(b.trackClickTeamCancelPlan(this.environment,{confirmed:e}),!e)return;e&&await _.EO({environment:this.environment,spaceStore:this.props.spaceStore,planType:"team",from:"space_settings-plans_tab"})}else if(e&&("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type)){const e=await new Promise(((e,t)=>{C.showDialog({showCancel:!0,keepFocus:!1,message:n()("div",{},void 0,n()("h4",{style:{margin:"8px 0 0"}},void 0,n()(y.FormattedMessage,{id:"subscriptionSettings.freeTeam.upgradeTitle",defaultMessage:"Try the Team Plan for free"})),n()("p",{style:{margin:"8px 0"}},void 0,n()(y.FormattedMessage,{id:"subscriptionSettings.freeTeam.upgradeMessage",defaultMessage:"You'll get access to most features of a paid Team Plan, with a 1,000 block storage limit. Upgrade to go unlimited anytime."}))),items:[{label:n()(y.FormattedMessage,{id:"subscriptionSettings.startTeamTrialDialog.confirmationbutton",defaultMessage:"Start Team trial"}),color:"blue",onAccept:()=>{e(!0)}}],handleCancel:()=>{e(!1)}})}));if(b.trackClickTeamTryForFree(this.environment,{confirmed:Boolean(e)}),!e)return;e&&await _.EO({environment:this.environment,spaceStore:this.props.spaceStore,planType:"team",from:"space_settings-plans_tab"})}})),l()(this,"handleBusinessClick",(async()=>{const{spaceStore:e,data:t}=this.props,i=L.XX(t),a=i&&void 0===i.canceledAt;if(i&&a){const e=n()(y.FormattedMessage,{id:"subscriptionSettings.upgradeToBusinessDialog.message",defaultMessage:"You are about to subscribe to Notion's Business Plan for {price} per member per month.{br}You will be charged a prorated amount, minus any account balance.",values:{price:L._B({subscriptionTier:"business",billingInterval:"yearly"===Yd.state.termType?"year":"month",intl:this.props.intl}),br:n()("br",{})},description:"Shown when a user is going to upgrade to a business plan type."});if(!(await C.confirmUserAction({message:e,acceptLabel:(0,L.gG)(i.plan)?n()(y.FormattedMessage,{id:"subscriptionSettings.downgradeToBusinessDialog.confirmationButton",defaultMessage:"Downgrade to Business Plan",description:"Shown when user is going to downgrade to a business plan type."}):n()(y.FormattedMessage,{id:"subscriptionSettings.upgradeToBusinessDialog.confirmationButton",defaultMessage:"Upgrade to Business Plan",description:"Shown when a user is going to upgrade to a business plan type."})})))return}if(i&&L.lr(t)){const t=md.HA.business[i.interval];await _.Mg({environment:this.environment,spaceStore:e,plan:t,from:"space_settings-plans_tab"})}else _.I0(this.environment,{subscriptionTier:"business",from:"pricing_grid"})})),l()(this,"handleEnterpriseClick",(async()=>{const{spaceStore:e,data:t}=this.props,i=L.XX(t),a=i&&void 0===i.canceledAt;if(i&&a){const e=n()(y.FormattedMessage,{id:"subscriptionSettings.upgradeToEnterpriseDialog.message",defaultMessage:"You are about to subscribe to Notion's Enterprise Plan for {price} per member per month.{br}You will be charged a prorated amount, minus any account balance.",values:{price:L._B({subscriptionTier:"enterprise",billingInterval:"yearly"===Yd.state.termType?"year":"month",intl:this.props.intl}),br:n()("br",{})}});if(!(await C.confirmUserAction({message:e,acceptLabel:n()(y.FormattedMessage,{id:"subscriptionSettings.upgradeToEnterpriseDialog.confirmationbutton",defaultMessage:"Upgrade to Enterprise Plan"})})))return}if(i&&L.lr(t)){const t=md.HA.enterprise[i.interval];await _.Mg({environment:this.environment,spaceStore:e,plan:t,from:"space_settings-plans_tab"})}else _.I0(this.environment,{subscriptionTier:"enterprise",from:"pricing_grid"})})),l()(this,"handleChurnSurveyModalAccept",(()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onAccept(),"on"!==ie.default.getGroup("churn_survey")&&e.reset()})),l()(this,"handleChurnSurveyModalClose",(()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onClose(),e.reset()}))}willMount(){_.bi(this.environment)}renderComponent(){return ra.Z.state.online?this.renderPlans():n()(Ac.Z,{})}renderPlans(){const{churnSurveyModalOpen:e}=this.stores.store.state,t="on"===ie.default.getGroup("churn_survey");return n()("div",{style:Ic.wrapStyle},void 0,n()(Ma.Z,{style:Ic.scrollerStyle,type:wa.Z.Y},void 0,this.renderSubscriptionInfo(),this.renderPricingGrid(),this.renderPriceDisclaimer(),this.allowEducationUpgrade()&&this.renderStudentUpgrade(),this.renderFAQ(),n()(Ga.Z,{innerStyle:{width:t?300:600,height:t?"auto":"80vh",overflow:"scroll"},open:e,render:this.renderChurnSurveyModal,onDismiss:this.handleChurnSurveyModalClose})))}renderPriceDisclaimer(){const{intl:e}=this.props;return n()("div",{style:Ic.priceDisclaimerStyle},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionPlans.priceDisclaimer",defaultMessage:"Prices shown are for annual billing. When billed month-to-month, the <b>Personal Pro Plan</b> is {personalMonthlyPrice} per month, the <b>Team Plan</b> is {teamMonthlyPrice} per member per month, and the <b>Enterprise Plan</b> is {enterpriseMonthlyPrice} per member per month.",values:{b:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("b",{},void 0,t)},personalMonthlyPrice:(0,yr.Dx)({amount:Gt.Z.pricing.personal.monthlyPrice,currency:"dollar",intl:e}),teamMonthlyPrice:(0,yr.Dx)({amount:Gt.Z.pricing.team.monthlyPricePerMember,currency:"dollar",intl:e}),enterpriseMonthlyPrice:(0,yr.Dx)({amount:Gt.Z.pricing.enterprise.monthlyPricePerMember,currency:"dollar",intl:e})}}))}renderSubscriptionInfo(){const{spaceStore:e}=this.props,{data:t}=this.props;return"subscribed_admin"===t.type?n()("div",{style:this.subscriptionInfoStyle()},void 0,L.D0(this.environment,e,t)):"unsubscribed_admin"===t.type||"unsubscribed_member"===t.type?n()("div",{style:{...this.subscriptionInfoStyle(),display:"flex",alignItems:"center",justifyContent:"space-between"}},void 0,n()("div",{},void 0,L.D0(this.environment,e,t))):void 0}renderPricingGrid(){const e=this.getPlanState();return n()(Zc,{planState:e,data:this.props.data})}renderStudentUpgrade(){return n()("div",{style:Ic.subsectionStyle},void 0,n()("div",{style:Ic.subsectionTitleStyle},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.title",defaultMessage:"Students & educators"})),n()("div",{style:{color:this.theme.mediumTextColor,marginBottom:15}},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.text",defaultMessage:"<p>Personal Pro Plans are free for students and educators! Simply sign up with your school email address and you'll immediately gain access to those features.</p><p>If you're already on a Personal Pro Plan, change the email associated with your account to your school email address to get it for free.</p>",values:{p:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("div",{style:{marginBottom:4}},void 0,t)}}})),n()(xe.Z,{isLarge:!0,onClick:this.handleEducationPlanClick},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.getEducationPlanButton.label",defaultMessage:"Get free Education plan"})))}renderFAQ(){return n()("div",{style:Ic.subsectionStyle},void 0,n()("div",{style:Ic.subsectionTitleStyle},void 0,n()(y.FormattedMessage,{id:"spaceSubscriptionPlans.faqSection.title",defaultMessage:"FAQ"})),n()(Sc,{cta:"intercom",type:"general",isSettings:!0}))}getMemberCount(){return L.su(this.props.data)}canSwitchPlans(){const e=L.wY(this.props.data);return this.props.spaceStore.canAdmin()&&!e}calculateButtonState(e){const{data:t}=this.props,i=L.DH(t);return"personal_free"===e?{free:"current",personal:"upgrade",team:"upgrade",business:"upgrade",enterprise:"upgrade"}:"personal"===e||"student"===e?{free:i?"current":"downgrade",personal:i?"resubscribe":"current",team:"upgrade",business:"upgrade",enterprise:"upgrade"}:"team_free"===e||"free"===e?{free:"downgrade",personal:"upgrade",team:"upgrade",business:"upgrade",enterprise:"upgrade"}:"team"===e?{free:"downgrade",personal:"downgrade",team:i?"resubscribe":"current",business:"upgrade",enterprise:"upgrade"}:"business"===e?{free:"downgrade",personal:"downgrade",team:"downgrade",business:i?"resubscribe":"current",enterprise:"upgrade"}:"enterprise"===e?{free:"downgrade",personal:"downgrade",team:"downgrade",business:"downgrade",enterprise:i?"resubscribe":"current"}:void(0,W.t1)(e)}isButtonStateActive(e){return["current","resubscribe"].includes(e)}getPlanState(){const e=L.CM(this.environment);if(!e)return;const t="team_free"===e||"free"===e,i=L.wY(this.props.data),a=this.calculateButtonState(e),n="on"===ie.default.getGroup("churn_survey");return{plans:{free:{buttonType:a.free,isActive:this.isButtonStateActive(a.free),onClick:this.handleFreeClick},personal:{buttonType:a.personal,isActive:this.isButtonStateActive(a.personal),onClick:()=>this.handlePersonalClick(n)},team:{buttonType:a.team,isActive:this.isButtonStateActive(a.team)||t,onClick:()=>this.handleTeamClick(n),onClickTeamFree:this.handleTeamFreeClick},business:{buttonType:a.business,isActive:this.isButtonStateActive(a.business),onClick:this.handleBusinessClick},enterprise:{buttonType:a.enterprise,isActive:this.isButtonStateActive(a.enterprise),onClick:this.handleEnterpriseClick}},isTeamTrial:t,isInAppPurchase:i,canSwitchPlans:this.canSwitchPlans(),memberCount:this.getMemberCount()}}allowEducationUpgrade(){const{data:e}=this.props,t=this.getPlanState();return t&&t.canSwitchPlans&&!L.wl(e)&&1===t.memberCount&&(t.plans.free.isActive||t.plans.personal.isActive)}shouldShowTeamWarningDuringDowngrade(){const{spaceStore:e}=this.props,t=null==e?void 0:e.getPlanType();return!!t&&((0,O.bq)()&&(0,Gd.u2)(t))}subscriptionInfoStyle(){return{textAlign:"left",marginBottom:24,fontSize:14,borderBottom:"1px solid ".concat(this.theme.regularDividerColor),paddingBottom:16}}}l()(Ic,"wrapStyle",{display:"flex",flexDirection:"column",height:"100%"}),l()(Ic,"scrollerStyle",{transform:"translateZ(0px)",flexGrow:1,padding:30}),l()(Ic,"subscriptionInfoCtaButtonStyle",{marginLeft:16,paddingLeft:10}),l()(Ic,"priceDisclaimerStyle",{fontSize:14,marginTop:20,marginBottom:40}),l()(Ic,"subsectionStyle",{fontSize:14,marginTop:40}),l()(Ic,"subsectionTitleStyle",{fontSize:20,fontWeight:v.Z.fontWeight.bold,marginBottom:12});const Pc=(0,y.injectIntl)(Ic);var _c=i(93963),xc=i(42982),Fc=i(38363);const Bc="teamColumn",Ec="ownersColumn",Dc="membersColumn",Rc="AccessLevelColumn",Lc="lastUpdatedColumn",Oc="contextMenuColumn",Nc=[Bc,Dc,Rc,Lc],Uc="filterAccessAny",Wc="filterAccessOnlyOpen",Vc="filterAccessOnlyClosed",zc="filterAccessOnlyPrivate",Gc="filterOwnerAny",Hc="filterOwnerShowOrphaned",qc="filterOwnerById";class Kc extends N.Z{getInitialState(){return{searchQuery:"",sortColumn:Lc,sortAscending:!1,showOnlyArchivedTeams:!1,filterByOwner:{type:Gc},filterAccess:Uc}}}const jc=new Kc;var Yc=i(51923);class Qc extends N.Z{getInitialState(){return{tokenQuery:"",showAutoCompletePopup:!1,defaultTeams:{}}}addedAndCurrentTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"current-default"===t||"add-default"===t}))}addedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"add-default"===t}))}removedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"remove-default"===t}))}}const Jc=new Qc;function Xc(e){var t;let{team:i}=e;return null===(t=Jc.state.defaultTeams[i.id])||void 0===t?void 0:t.state}function $c(e){let{team:t,persistedDefaultTeams:i}=e;if(i.includes(t))eu({store:t,state:"current-default"});else{const e={...Jc.state.defaultTeams};delete e[t.id],Jc.setState({...Jc.state,defaultTeams:e})}}function eu(e){const t=Jc.state;Jc.setState({...t,defaultTeams:{...t.defaultTeams,[e.store.id]:e}})}var tu=i(87279),iu=i(75024),au=i(30676),nu=i(47082);function su(e){let{allTeams:t,loaded:i}=e;const a=(0,ye.Fy)(),s=(0,y.useIntl)(),r=(0,ye.O7)(),[l,d]=(0,u.useState)(!1),[p,g,h]=(0,Se.oR)(Jc),[{currentSpaceStore:f}]=(0,Se.oR)(Z.default),v=!p.tokenQuery,{addedTeams:S,removedTeams:M,addedAndCurrentTeams:b}=(0,Se.VK)((()=>({addedAndCurrentTeams:h.addedAndCurrentTeams(),addedTeams:h.addedTeams(),removedTeams:h.removedTeams()})),[h]),w=(0,Se.VK)((()=>t.reduce(((e,t)=>(e[t.id]=t.getName(),e)),{})),[t]),C=(0,Se.VK)((()=>t.filter((e=>e.isDefault()))),[t]);(0,u.useEffect)((()=>function(e){let{persistedDefaultTeams:t}=e;const i=t.reduce(((e,t)=>(e[t.id]={state:"current-default",store:t},e)),{}),a=Jc.state;Jc.setState({...a,defaultTeams:i})}({persistedDefaultTeams:C})),[C,g]);const T=S.length>0||M.length>0,k=e=>function(e){let{team:t,persistedDefaultTeams:i}=e;"add-default"===Xc({team:t})?$c({team:t,persistedDefaultTeams:i}):eu({store:t,state:"remove-default"})}({team:e,persistedDefaultTeams:C}),A=e=>{!function(e){let{team:t,persistedDefaultTeams:i}=e;"remove-default"===Xc({team:t})?$c({team:t,persistedDefaultTeams:i}):eu({store:t,state:"add-default"})}({team:e,persistedDefaultTeams:C}),g((e=>({...e,showAutoCompletePopup:!1,tokenQuery:""})))},I=new Set(M.map((e=>e.store.id))),P=r.currentUser.id,_=(0,Se.VK)((()=>P?t.filter((e=>{const t=e.getValue();return!!t&&((0,Gd.pd)(t,P)&&"open"===(0,Gd.B5)(t.settings))})):[]),[t,P]),x=function(e){let{query:t,addedAndCurrentTeams:i,eligibleDefaultTeams:a,teamIdsToNames:n}=e;const s=new Set;for(const o of i)s.add(o.store.id);return(0,Ua.ZP)(t,a,(e=>{var t;return null!==(t=n[e.id])&&void 0!==t?t:""}))}({query:p.tokenQuery,addedAndCurrentTeams:b,teamIdsToNames:w,eligibleDefaultTeams:_}),F=[];x.length>0&&!v&&F.push({key:"default-teams-list",render:e=>m().createElement(Re.Z,o()({},e,{title:n()(y.FormattedMessage,{id:"defaultTeamsInput.defaultTeamList.title",description:"Title for the input menu to search for default teamspaces to add to the workspace",defaultMessage:"Teamspaces"}),loading:!1})),items:x.map((e=>({key:e.id,render:t=>m().createElement(au.F,o()({},t,{teamStore:e})),action:()=>A(e)})))});const B=p.showAutoCompletePopup&&F.length>0,E=(0,Yt.y)((e=>({defaultTeamsHeader:{fontSize:14,marginBottom:2},inputAndButtonContainer:{paddingTop:12,display:"flex"},inputContainer:{flexGrow:1},tokenInputMenu:{borderRadius:B?lu:ru,margin:0},menuList:{maxHeight:300,border:"1px solid ".concat(e.regularDividerColor),borderTop:0,borderRadius:du},updateButton:{marginLeft:10,height:35}})),[B]);return m().createElement(m().Fragment,null,n()("div",{style:E.defaultTeamsHeader},void 0,n()(y.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.title",defaultMessage:"Default teamspaces"})),n()(ii.Z,{isSmall:!0,isMultiline:!0},void 0,n()(y.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.caption",defaultMessage:"Choose teamspaces that all new and current workspace members will automatically join"})),n()("div",{style:E.inputAndButtonContainer},void 0,n()("div",{style:E.inputContainer},void 0,n()(De.ZP,{popupType:De.ZP.PopupType.Popup,placementToOrigin:De.ZP.Placement.Bottom,sameWidthAsOrigin:!0,open:B,borderRadius:du,onDismiss:()=>g((e=>({...e,showAutoCompletePopup:!1}))),origin:n()(nu.Z,{disabled:!i||l,style:E.tokenInputMenu,focusInitial:a.isMobile,focusAfterAnimation:!0,format:nu.Z.Format.Share,inputDivStyle:{alignItems:"center"},value:p.tokenQuery,onChange:e=>g((t=>({...t,tokenQuery:e.target.value,showAutoCompletePopup:!0}))),type:"default-teams",tokens:Object.values(p.defaultTeams).filter((e=>!I.has(e.store.id))).map((e=>n()(ou,{teamStore:e.store,onClickRemove:k}))),placeholder:s.formatMessage({id:"teamsWorkspaceSettings.defaultTeams.inputPlaceholder",defaultMessage:"Select a default teamspace..."}),onRemoveLastToken:()=>{const e=b,t=c().last(e);t&&k(t.store)},onEmptySubmit:c().identity,showBorder:!0}),render:()=>n()(Be.Z,{menuType:tu.o.Popup,tokenInputHeader:!0,disableHeaderBorder:!0},void 0,n()("div",{style:E.menuList},void 0,n()(Ee.Z,{type:Ee.Z.Type.Vertical,initialFocus:0,sections:F})))})),n()(xe.Z,{style:E.updateButton,disabled:!T||l,isLarge:!0,onClick:async()=>{if(f){d(!0);try{await async function(e){let{addedTeams:t,removedTeams:i,environment:a,spaceStore:n}=e;const s=n.getValue();return!!s&&await(0,Fc.lH)({addedStores:t.map((e=>{let{store:t}=e;return t})),removedStores:i.map((e=>{let{store:t}=e;return t})),environment:a,spaceValue:s,createNewTeamFlowId:void 0,from:"workspace_settings"})}({environment:r,addedTeams:S,removedTeams:M,spaceStore:f})}finally{d(!1)}}}},void 0,n()(y.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"}))))}function ou(e){const t=(0,ye.Fy)(),{teamStore:i,onClickRemove:a}=e,{name:s,icon:o}=(0,Se.VK)((()=>({name:i.getName(),icon:i.getIcon()})),[i]);return n()(io.Z,{showRemoveButton:!0,isSingle:!1,format:t.isMobile?Qs.l.Large:Qs.l.Medium,style:{marginLeft:6},onClickRemove:()=>a(i),value:n()("div",{style:{display:"flex"}},void 0,n()(xa.Z,{disabled:!0,icon:o,isEmptyPage:!1,size:14,style:{marginRight:4}}),s)})}const ru=3,lu=(0,iu.wK)({topLeft:ru,topRight:ru,bottomLeft:0,bottomRight:0}),du=(0,iu.wK)({topLeft:0,topRight:0,bottomLeft:ru,bottomRight:ru});var cu=i(17224),uu=i(79583);function mu(e){let{selectItems:t,currentSelectedItem:i,onChange:a,icon:s}=e;return n()(uu.Z,{items:t,getKey:e=>e.key,selectedItem:i,onSelect:a,renderItem:e=>m().createElement(Fe.Z,o()({title:e.value.name},e,{checkState:i.key===e.value.key})),renderOrigin:e=>{var t;return m().createElement(Ke.u,o()({},e,{title:null!==(t=i.originName)&&void 0!==t?t:i.name,on:!i.showFilterAsOffWhenSelected,icon:s}))}})}const pu={[Uc]:{key:Uc,name:n()(y.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterAllTeams",defaultMessage:"Any",description:"Select option text to clear filter for access level on the teamspaces table."}),originName:n()(y.FormattedMessage,{id:"manageTeamsAccessFilter.accessSelectPlaceolder",defaultMessage:"Access",description:"Placeholder option for the filter by access dropdown menu in the manage teamspaces settings"}),showFilterAsOffWhenSelected:!0},[Wc]:{key:Wc,name:n()(y.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterOpenTeams",defaultMessage:"Open",description:"Select option text to filter for open teamspaces only in the manage teamspaces table in workspace settings."})},[Vc]:{key:Vc,name:n()(y.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterClosedTeams",defaultMessage:"Closed",description:"Select option text to filter for closed teamspaces only in the manage teamspaces table in workspace settings."})},[zc]:{key:zc,name:n()(y.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterPrivateTeams",defaultMessage:"Private",description:"Select option text to filter for private teamspaces only in the manage teamspaces table in workspace settings."})}},gu=c().compact([pu.filterAccessAny,pu.filterAccessOnlyOpen,pu.filterAccessOnlyClosed,pu.filterAccessOnlyPrivate]);function hu(e){let{manageTeamsStore:t}=e;const i=(0,ye.O7)(),[a,s]=(0,Se.oR)(t),o=(0,Yt.y)((e=>({keyIcon:{width:18,height:18,fill:e.mediumIconColor},blueFill:{fill:g.ZP.blue}})),[]),r=(0,u.useCallback)((e=>{s({...a,filterAccess:e.key}),(0,cu.GZ)(i,{filter:"access",value:e.key})}),[a,s,i]),l=pu[a.filterAccess];return n()(mu,{selectItems:gu,currentSelectedItem:l,onChange:r,icon:h.Z.key({...o.keyIcon,...a.filterAccess!==Uc&&o.blueFill})})}const fu="showArchived",vu="hideArchived",yu={[vu]:{key:vu,name:n()(y.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.hideArchivedTeams",defaultMessage:"Active",description:"Select option text to hide archived teamspaces in the manage teamspaces table."}),originName:n()(y.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedSelectPlaceolder",defaultMessage:"Archived",description:"Placeholder option for the filter by archived dropdown menu in the manage teamspaces settings"}),showFilterAsOffWhenSelected:!0},[fu]:{key:fu,name:n()(y.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.showArchivedTeams",defaultMessage:"Archived",description:"Select option text to show only archived teamspaces in the manage teamspaces table."})}};function Su(e){let{manageTeamsStore:t}=e;const i=(0,ye.O7)(),[a,s]=(0,Se.oR)(t),o=(0,Yt.y)((e=>({archiveIcon:{width:16,height:16,marginRight:5,fill:e.mediumIconColor},blueFill:{fill:g.ZP.blue}})),[]),r=[yu.hideArchived,yu.showArchived],l=(0,u.useCallback)((e=>{s({...a,showOnlyArchivedTeams:e.key===fu}),(0,cu.GZ)(i,{filter:"archived",value:e.key})}),[a,s,i]),d=yu[a.showOnlyArchivedTeams?fu:vu];return n()(mu,{selectItems:r,currentSelectedItem:d,onChange:l,icon:h.Z.archiveFilled({...o.archiveIcon,...a.showOnlyArchivedTeams&&o.blueFill})})}i(99244);const Mu="ShowTeamsWithNoOwnersId";function bu(e){let{teamStores:t,manageTeamsStore:i}=e;const a=(0,ye.O7)(),[s,r]=(0,Se.oR)(i),l=function(e){switch(e.type){case Gc:return;case qc:return e.id;case Hc:return Mu;default:(0,W.t1)(e)}}(s.filterByOwner),[{currentSpaceStore:d}]=(0,Se.oR)(Z.default),p=(0,y.useIntl)(),f=(0,Se.VK)((()=>{const e=t.flatMap((e=>{const t=e.getValue();return t?(0,Gd.XO)(t):[]}));return c().uniq(e)}),[t]),v=(0,Yt.y)((e=>({icon:{marginRight:2,fill:e.mediumIconColor},blueFill:{fill:g.ZP.blue}})),[]),S=(0,u.useCallback)((e=>{if(d)return Ps({userId:e,currentSpaceStore:d}).getValue()}),[d]),M=(0,u.useCallback)((e=>{const t=e[e.length-1];let i;i=t===l||void 0===t?{type:Gc}:t===Mu?{type:Hc}:{type:qc,id:t},r({...s,filterByOwner:i}),(0,cu.GZ)(a,{filter:"owner",value:i.type})}),[l,s,r,a]),b=(0,u.useCallback)((async e=>{let{query:t}=e;if(!d)return[];const i=(await we.pz({query:t,currentSpaceStore:d,userIds:f})).map((e=>e.id));return""===t?[Mu,...i]:i}),[d,f]),w=(0,u.useCallback)(((e,t)=>{if(!d)return null;if(e===Mu)return m().createElement(Fe.Z,o()({},t,{title:n()(y.FormattedMessage,{id:"manageTeamsOwnerFilter.noOwnersFilterOption",description:"Teamspaces owners filter option for the manage teamspaces table to filter the table to only show teamspaces that have no owners.",defaultMessage:"No owners"}),checkState:s.filterByOwner.type===Hc,className:"notranslate"}));const i=S(e);return i?m().createElement(Mt.Z,o()({},t,{key:e,user:i,checkState:l===e})):null}),[d,S,l,s.filterByOwner.type]),C=(0,Se.VK)((()=>{if(s.filterByOwner.type!==qc)return;const e=S(s.filterByOwner.id);return e?(0,be.Nz)(p,e):void 0}),[s.filterByOwner,S,p]);let T;return T=s.filterByOwner.type===Hc?n()(y.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.onlyOrphanedTeams",description:"Title for the manage teamspaces filter pill when the filter is set to: Teamspaces without owners.",defaultMessage:"Owner: None"}):n()(y.FormattedMessage,C?{id:"manageTeamsOwnerFilter.filterTitle.withSpecifiedOwner",description:"Title for the manage teamspaces owner filter pill when an owner filter is specified.",defaultMessage:"Owner: {teamOwnerName}",values:{teamOwnerName:C}}:{id:"manageTeamsOwnerFilter.filterTitle.unset",description:"Title for the manage teamspaces filter pill.",defaultMessage:"Owner"}),n()(mt.Z,{mode:mt.z.Pill,title:T,disabled:0===t.length,icon:h.Z.person,iconStyles:{...v.icon,...s.filterByOwner.type!==Gc&&v.blueFill},items:c().compact([l]),hasItemsSelected:(0,W.$K)(l),onChange:M,labelText:{title:T,tokenInputPlaceholder:p.formatMessage({defaultMessage:"Search teamspace owner...",id:"manageTeamsOwnerFilter.searchOwner.placeholder",description:"The placeholder in the input for search an actor in manage teamspaces owner filter"}),resultSectionTitle:p.formatMessage({defaultMessage:"Select users",id:"manageTeamsOwnerFilter.searchOwner.resultsTitle",description:"The text shown above the list of all selectable actors in manage teamspaces owner filter"}),componentDebugName:"ManageTeamsSearchOwnerFilter"},performRequest:b,renderResultMenuItem:w,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}function wu(e){let{manageTeamsStore:t,teamStores:i}=e;const[a,s]=(0,Se.oR)(t),o=(0,Yt.y)((()=>({container:{display:"flex",alignItems:"center",marginTop:20},searchContainer:{maxWidth:250,marginRight:"auto"},archivedTeamsSwitch:{display:"flex",alignItems:"center",marginLeft:15,marginRight:15},archivedTeamsLabel:{marginLeft:10},dropdownContainer:{display:"flex",alignContent:"stretch",marginLeft:5}})),[]),r=(0,u.useCallback)((e=>{s({...a,searchQuery:e})}),[a,s]);return n()("div",{style:o.container},void 0,n()(Cu,{style:o.searchContainer,onChange:r,value:a.searchQuery}),n()("div",{style:o.dropdownContainer},void 0,n()(Su,{manageTeamsStore:t}),n()(bu,{teamStores:i,manageTeamsStore:t}),n()(hu,{manageTeamsStore:t})))}function Cu(e){let{style:t,value:i,onChange:a}=e;const s=(0,y.useIntl)(),o=(0,Yt.y)((e=>({input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),r=(0,u.useCallback)((e=>a(e.target.value)),[a]);return n()(tt.Z,{placeholder:s.formatMessage({defaultMessage:"Search teamspaces...",id:"manageTeamsFilterRow.searchFilter.placeholder",description:"Placeholder text for manage teamspaces list search filter."}),style:{...o.input,...t},value:i,onChange:r,left:h.Z.searchThick(o.searchIcon),format:tt.Z.Format.Small,showClearButton:!0})}var Tu=i(12534),ku=i(48690),Zu=i(20320),Au=i(93686),Iu=i(98742),Pu=i(92350),_u=i(45660),xu=i(86275),Fu=i(73643);function Bu(e){let{teamStore:t,accessLevel:i,isTeamOwner:a,onChangeAccessLevel:s}=e;const r=(0,ye.O7)(),l=(0,Pu.vR)(t),d=(0,xu.U)({teamStore:t,onChange:s,isCreateTeam:!1,isDefault:l}),c=(0,_u.e)(),u=(0,Fu.Z)(),p=(0,Yt.y)((e=>({selectButton:{paddingLeft:8,marginLeft:-8},label:{color:e.regularTextColor,fontSize:v.Z.fontSize.UIRegular.desktop,fontWeight:v.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),g=!a,f=d.find((e=>e.key===i));if(!f)throw new Error("Selected access level is not an option found in team access level option: ".concat(i));return n()(uu.Z,{items:d,getKey:e=>e.key,selectedItem:f,onSelect:e=>"private"===e.key&&c?(0,jn.y)(r,{from:"team_security_settings",for:u}):s(e.key),renderItem:e=>n()(Le.Z,{textWrap:!0,placement:oi.ug.Bottom,disableTooltip:!e.value.tooltip,renderTooltip:()=>e.value.tooltip,render:t=>m().createElement(Fe.Z,o()({title:e.value.title},(0,Iu.Z)(e,t)))}),disabled:g,renderOrigin:e=>m().createElement(ut.Z,o()({style:p.selectButton,disabled:g},e),n()("span",{style:p.label},void 0,f.level),!g&&h.Z.chevronDown(p.chevron))})}var Eu=i(13380);function Du(e){let{teamOwners:t,manageTeamsStore:i}=e;const[a]=(0,Se.oR)(i),[{currentSpaceStore:s}]=(0,Se.oR)(Z.default),o=(0,y.useIntl)(),r=(0,Se.VK)((()=>{if(!s)return;let e=t[0];if(a.filterByOwner.type===qc){const i=a.filterByOwner.id;t.includes(i)&&(e=i)}return e?Ps({userId:e,currentSpaceStore:s}).getValue():void 0}),[s,a.filterByOwner,t]),l=(0,Se.VK)((()=>{if(r)return(0,be.Nz)(o,r)}),[r,o]),d=(0,Yt.y)((e=>({container:{display:"flex",alignItems:"center",fontSize:v.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},nMoreOwnersText:{paddingLeft:3,color:e.mediumTextColor},noOwners:{marginRight:8,color:e.lightTextColor},userName:{flexShrink:1}})),[]);return t.length<1?n()("div",{style:d.noOwners},void 0,n()(y.FormattedMessage,{id:"manageTeamsOwnersCell.noOwners",description:"Label that shows that a teamspace has no owners in the manage teamspaces table.",defaultMessage:"No owners"})):n()("div",{style:d.container},void 0,n()(pn.Z,{style:d.userAvatar,avatarShouldShowShadow:!0,userValue:r,size:20}),n()(Eu.s,{style:d.userName},void 0,l),t.length>1&&n()("div",{style:d.nMoreOwnersText},void 0,n()(y.FormattedMessage,{id:"manageTeamsOwnersCell.nMoreOwnersLabel",description:"Label that shows in the owners cell in the manage teamspaces table. Ex: if there are 2 owners, James and Joe, the cell will show 'James +1'.",defaultMessage:"+{numAdditionalOwners}",values:{numAdditionalOwners:t.length-1}})))}const Ru=[Bc,Ec,Dc,Rc,Lc,Oc],Lu={[Rc]:{headerTitle:n()(y.FormattedMessage,{id:"manageTeamsTable.columnTitle.access",description:"Title of the access (private or open) column in the manage teamspaces table.",defaultMessage:"Access"}),renderCell:e=>{let{data:t,environment:i}=e;return n()(Bu,{teamStore:t.store,accessLevel:t.accessLevel,isTeamOwner:t.isCurrentUserOwnerOfTeam,onChangeAccessLevel:e=>Fc.Ju({environment:i,store:t.store,accessLevel:e,teamName:t.name,from:"manage_teams_table"})})},colWidth:{width:90},hasClickableContents:!0},[Bc]:{headerTitle:n()(y.FormattedMessage,{id:"manageTeamspacesTable.columnTitle.teamspace",description:"Title of the teamspace name column in the manage teamspaces table.",defaultMessage:"Teamspace"}),renderCell:e=>{let{data:t}=e;return n()(zu,{teamStore:t.store,isArchivedTeam:t.isArchivedTeam,name:t.name})},colWidth:{minWidth:30,widthPercent:35}},[Ec]:{headerTitle:n()(y.FormattedMessage,{id:"manageTeamsTable.columnTitle.owners",description:"Title of the teamspace owners column in the manage teamspaces table.",defaultMessage:"Owners"}),renderCell:e=>{let{data:t,manageTeamsStore:i}=e;return n()(Du,{teamOwners:t.owners,manageTeamsStore:i})},colWidth:{minWidth:60,widthPercent:25}},[Dc]:{headerTitle:n()(y.FormattedMessage,{id:"manageTeamsTable.columnTitle.members",description:"Title of the teamspace members column in the manage teamspace table.",defaultMessage:"Members"}),renderCell:e=>{let{data:t}=e;return n()(Eu.s,{},void 0,n()(y.FormattedMessage,{id:"manageTeamsTable.numMembersCell",description:"Text that shows in the members cell of each teamspace in the manage teamspaces table. The cell says the number of teamspace members.",defaultMessage:"{numTeamMembers, plural, one {# member} other {# members}}",values:{numTeamMembers:t.members.length}}))},colWidth:{minWidth:40,widthPercent:15}},[Lc]:{headerTitle:n()(y.FormattedMessage,{id:"manageTeamsTable.columnTitle.updated",description:"Title of the last updated column in the manage teamspaces table.",defaultMessage:"Updated"}),renderCell:e=>{let{data:t}=e;return n()(Eu.s,{},void 0,(0,Tt.default)(t.lastUpdated).format("MMM D, YYYY"))},colWidth:{minWidth:50,widthPercent:15}},[Oc]:{headerTitle:void 0,renderCell:e=>{let{data:t}=e;return n()(Zu.oN,{teamStore:t.store,from:"manage_teams_table"})},colWidth:{width:30},hasClickableContents:!0}};function Ou(e){let{teamStores:t,manageTeamsStore:i}=e;const a=(0,ye.O7)(),[{currentSpaceStore:s,currentUserStore:o}]=(0,Se.oR)(Z.default),[r,l]=(0,Se.oR)(i),[,d]=(0,Se.oR)(ku.Z),{showOnlyArchivedTeams:p,filterAccess:g,searchQuery:h,sortAscending:f,sortColumn:v,filterByOwner:y}=r,S=(0,Se.VK)((()=>{const e=null==s?void 0:s.getValue();return e?c().compact(t.map((t=>{const i=t.getValue(),a=null==o?void 0:o.id;if(!i||!a)return;const n=(0,Gd.XO)(i);return{store:t,name:i.name,owners:n,isCurrentUserOwnerOfTeam:n.includes(a),isCurrentUserOnTeam:(0,Gd.MA)(i,e,a),members:(0,Gd.E8)(i,e),accessLevel:t.getTeamAccessLevel(),isArchivedTeam:(0,Gd.m4)(i),lastUpdated:i.last_edited_time}}))):[]}),[s,null==o?void 0:o.id,t]),M=(0,Se.VK)((()=>S.filter((e=>p?e.isArchivedTeam:!e.isArchivedTeam)).filter((e=>{if(g===Wc&&"open"!==e.accessLevel)return!1;if(g===Vc&&"closed"!==e.accessLevel)return!1;if(g===zc&&"private"!==e.accessLevel)return!1;switch(y.type){case Hc:return 0===e.owners.length;case qc:return e.owners.includes(y.id);case Gc:return!0;default:(0,W.t1)(y)}}))),[S,p,g,y]),b=(0,Se.VK)((()=>function(e){let{data:t,sortColumn:i,sortAscending:a}=e;const n=[a?"asc":"desc"],s=[a?"desc":"asc"];switch(i){case Bc:return c().orderBy(t,(e=>e.name),s);case Dc:return c().orderBy(t,(e=>e.members.length),n);case Rc:return c().orderBy(t,(e=>pi.bx.indexOf(e.accessLevel)),n);case Lc:return c().orderBy(t,(e=>e.lastUpdated),n);default:(0,W.t1)(i)}}({data:M,sortAscending:f,sortColumn:v})),[f,v,M]),w=(0,Se.VK)((()=>(0,Ua.ZP)(h,b,(e=>e.name))),[h,b]),C=(0,u.useCallback)((e=>{d((t=>({...t,open:!0,tab:ku.a.Members,selectedTeamId:e})))}),[d]),T=(0,Yt.y)((e=>({container:{marginTop:17,tableLayout:"fixed",borderCollapse:"collapse",width:"100%",minWidth:Ru.reduce(((e,t)=>e+Ku(Lu[t].colWidth)+Hu),0)},tableHeaderRow:{borderTop:"1px solid ".concat(e.tableDividerColor),borderBottom:"1px solid ".concat(e.tableDividerColor)},noTeamsLabel:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),k=(0,u.useCallback)((e=>{const t=e===v&&!f;l((i=>({...i,sortAscending:t,sortColumn:e}))),(0,cu.dw)(a,{sortBy:e,sortOrder:f?"ascending":"descending"})}),[l,f,v,a]),A=(0,u.useCallback)((()=>{i.reset()}),[i]);return m().createElement(m().Fragment,null,n()("table",{style:T.container},void 0,n()("tr",{style:T.tableHeaderRow},void 0,Ru.map((e=>n()(Uu,{column:e,onSortableColumnClick:k,sortAscending:f,sortColumn:v},"header_".concat(e))))),n()("tr",{},void 0,Ru.map((e=>n()("td",{},"padding_row_".concat(e))))),w.map((e=>n()(Nu,{onShowTeamSettings:C,teamData:e,manageTeamsStore:i},"".concat(e.store.id,"_row"))))),n()(Vu,{style:T.noTeamsLabel,numItemsAfterFilter:w.length,numItemsBeforeFilter:t.length,onResetFilters:A}))}function Nu(e){let{teamData:t,manageTeamsStore:i,onShowTeamSettings:a}=e;const[s,o]=(0,u.useState)(!1),r=(0,u.useCallback)((()=>o(!0)),[]),l=(0,u.useCallback)((()=>o(!1)),[]),d=(0,u.useCallback)((e=>{Gu(e,(()=>a(t.store.id)))}),[a,t.store.id]),c=(0,Yt.y)((e=>({teamRow:{cursor:"pointer",borderBottom:"1px solid ".concat(e.tableDividerColor)}})),[]);return n()("tr",{onMouseLeave:l,onMouseEnter:r,style:c.teamRow,onClick:d},void 0,Ru.map(((e,a)=>n()(Wu,{isRowHovered:s,columnIndex:a,teamData:t,columnData:Lu[e],manageTeamsStore:i},"".concat(t.store.id,"_").concat(e)))))}function Uu(e){let{column:t,onSortableColumnClick:i,sortColumn:a,sortAscending:s}=e;const o=Lu[t],r=(0,Yt.y)((e=>({th:ju(o),innerDiv:{display:"flex",alignItems:"center",minWidth:Ku(o.colWidth),height:32},text:{fontSize:v.Z.fontSize.UISmall.desktop,fontWeight:v.Z.fontWeight.regular,color:e.mediumTextColor},sortButton:{padding:5,margin:-5,overflow:"hidden",maxWidth:"100%"},sortIcon:{fill:e.mediumTextColor,width:12,height:12,marginLeft:4}})),[o]),l=n()(Eu.s,{style:r.text},void 0,o.headerTitle),d=(c=t,Nc.includes(c)?n()(ut.Z,{style:r.sortButton,onClick:()=>i(t)},void 0,l,(()=>{if(t===a)return h.Z.arrowDownSmall({...r.sortIcon,...s&&{transform:"rotate(180deg)"}})})()):l);var c;return n()("th",{style:r.th},void 0,n()("div",{style:r.innerDiv},void 0,d))}function Wu(e){let{teamData:t,columnData:i,columnIndex:a,isRowHovered:s,manageTeamsStore:o}=e;const r=(0,ye.O7)(),l=(0,Yt.y)((e=>({td:{...ju(i),...s&&{background:e.buttonHoveredBackground}},innerDiv:{minWidth:Ku(i.colWidth),fontSize:v.Z.fontSize.UIRegular.desktop,color:e.regularTextColor,height:48,display:"flex",alignItems:"center"}})),[i,s]),d=Gu,c=Boolean(i.hasClickableContents);return n()("td",{style:l.td},void 0,n()("div",{style:l.innerDiv,onClick:c?d:void 0},void 0,i.renderCell({environment:r,data:t,manageTeamsStore:o})))}function Vu(e){let{style:t,numItemsBeforeFilter:i,numItemsAfterFilter:a,onResetFilters:s}=e;const o=0!==i;if(0!==a)return null;let r;return r=n()(y.FormattedMessage,o?{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.teamsFilteredOut",defaultMessage:"Could not find any teamspaces. <linkbutton>Reset your filters</linkbutton>",description:"Row that shows when the manage teamspaces table is empty because no teamspaces match the applied filters. The 'Reset your filters' link will clear the user's filters.",values:{linkbutton:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(va.Z,{onClick:s},void 0,t)}}}:{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.noTeamsExist",defaultMessage:"Could not find any teamspaces.",description:"Row that shows when the manage teamspaces table is empty because no teamspaces have been created yet."}),n()(ii.Z,{isSmall:!0,style:t},void 0,r)}function zu(e){let{teamStore:t,name:i,isArchivedTeam:a}=e;const s=(0,Yt.y)((()=>({teamNameContainer:{display:"flex",alignItems:"center",overflow:"hidden"},teamIcon:{marginRight:8},nameText:{flexShrink:1,minWidth:15},archivedTag:{marginLeft:5}})),[]);return n()("div",{style:s.teamNameContainer},void 0,n()(Au.p,{style:s.teamIcon,size:22,store:t,disabled:!0}),n()(Eu.s,{style:s.nameText},void 0,i),a&&n()(St.Z,{desktopStyle:s.archivedTag,mobileStyle:s.archivedTag},void 0,n()(y.FormattedMessage,{id:"manageTeamsTable.archivedTag",description:"Tag pill placed next to team name to mark it as an archived team in the manage teams table",defaultMessage:"Archived"})))}function Gu(e,t){(0,Tu.ZP)({event:e,context:Tu.Af.ManageTeamsRowClick,callback:t})}const Hu=10,qu={paddingLeft:Hu/2,paddingRight:Hu/2};function Ku(e){return"minWidth"in e?e.minWidth:e.width}function ju(e){let t={};return t="width"in e.colWidth?{width:e.colWidth.width}:{width:"".concat(e.colWidth.widthPercent,"%"),minWidth:e.colWidth.minWidth},{...qu,...t}}function Yu(e){let{isLoading:t,unarchivedTeams:i,archivedTeams:a}=e;const{isMobile:s=!1}=(0,ye.Fy)(),[,,o]=(0,Se.oR)(jc),r=(0,Yt.y)((()=>({container:{marginTop:8},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},subheader:{display:"flex",flexDirection:"column"}})),[]),l=(0,Se.VK)((()=>t?[]:[...i,...a]),[t,a,i]),d=(0,u.useCallback)((()=>Fc.lo("workspace_settings")),[]);return n()("div",{style:r.container},void 0,n()(qt.Z,{large:!s,style:r.header,small:!0},void 0,n()("div",{style:r.subheader},void 0,n()(y.FormattedMessage,{id:"manageTeamsBrowser.title",description:"Title of the section in teamspace settings for the manage teamspaces browser. This section shows a list of all teamspaces in the workspace.",defaultMessage:"Manage teamspaces"}),n()(ii.Z,{isSmall:!0,style:{marginTop:3}},void 0,n()(y.FormattedMessage,{id:"manageTeamsBrowser.subtitle",description:"Descripton of the teamspace settings in manage teamspaces browser",defaultMessage:"Manage all teamspaces you have access here"}))),n()(xe.Z,{onClick:d,isLarge:!0,className:B.my},void 0,n()(y.FormattedMessage,{id:"manageTeamsBrowser.newTeamButton.text",description:"Button for creating a new teamspace.",defaultMessage:"New teamspace"}))),t?n()(ya.Z,{}):m().createElement(m().Fragment,null,n()(wu,{teamStores:l,manageTeamsStore:o}),n()(Ou,{teamStores:l,manageTeamsStore:o})))}function Qu(e){let{title:t,description:i,disabled:a=!1,selected:s,onChange:o=(()=>{})}=e;return n()("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>!a&&o(!s)},void 0,n()("div",{style:{fontSize:14,marginRight:8,flexGrow:1}},void 0,t,i&&n()(ii.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,i)),n()("div",{style:{marginTop:5}},void 0,n()(ns.Z,{on:s,disabled:a})))}function Ju(){const e=(0,ye.Fy)();return n()(qt.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full"},void 0,n()(y.FormattedMessage,{id:"teamsWorkspaceSettings.title",description:"Title of the Teamspaces settings page inside workspace settings. This is where global settings for the teamspaces feature are set.",defaultMessage:"Teamspace settings"}))}function Xu(){var e;const t=(0,ye.O7)(),[{currentSpaceStore:i}]=(0,Se.oR)(Z.default),[,,a]=(0,Se.oR)(void 0,ae.Z),s=(0,Se.VK)((()=>i&&a.getValueForSpace(i)),[i,a]),o=null!==(e=null==s?void 0:s.disableTeamCreation)&&void 0!==e&&e,r=void 0===s,l=(0,u.useCallback)((()=>{i&&s&&async function(e){let{newSettingValue:t,environment:i,workspaceSecuritySettings:a,spaceStore:s}=e;const o="on"===ie.default.getGroup("show_workspace_owner"),r=n()(y.FormattedMessage,"allowTeamCreation"===t?{id:"manageTeamsHelpers.confirmChangeSecuritySetting.allowTeamCreation",defaultMessage:"Are you sure you want allow all members of this workspace to create teams?",description:"Confirmation dialog title asking the user if they want to turn on the 'Limit teamspace creation' workspace setting."}:o?{id:"manageTeamsHelpers.confirmChangeSecuritySetting.workspaceOwners.disableTeamCreation",defaultMessage:"Are you sure you want to limit teamspace creation to only workspace owners?",description:"Confirmation dialog title asking the workspace owner if they want to turn on the 'Limit team creation' workspace setting."}:{id:"manageTeamsHelpers.confirmChangeSecuritySetting.disableTeamCreation",defaultMessage:"Are you sure you want to limit teamspace creation to only admins?",description:"Confirmation dialog title asking the user if they want to turn on the 'Limit team creation' workspace setting."});!!(await C.confirmUserAction({message:r}))&&(0,Xs.n)(i,{securitySettingsState:{...a,disableTeamCreation:"disableTeamCreation"===t},spaceStore:s})}({newSettingValue:o?"allowTeamCreation":"disableTeamCreation",environment:t,spaceStore:i,workspaceSecuritySettings:s})}),[i,o,t,s]),d=(0,$t.u)();return m().createElement(m().Fragment,null,n()(pa.Z,{size:34}),n()(Qu,{disabled:r,onChange:l,title:n()(y.FormattedMessage,d?{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.title",description:"Title for a setting that, when on, will only allow workspace owners to create new teamspaces.",defaultMessage:"Limit teamspace creation to only workspace owners"}:{id:"teamWorkspacesSettings.disableTeamCreation.title",description:"Title for a setting that, when on, will only allow workspace admins to create new teamspaces.",defaultMessage:"Limit teamspace creation to only admins"}),description:n()(y.FormattedMessage,d?{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwnercaption",description:"Description for a setting that, when on, will only allow workspace owners to create new teamspaces.",defaultMessage:"Only allow workspace owners to create teamspaces"}:{id:"teamWorkspacesSettings.disableTeamCreation.caption",description:"Description for a setting that, when on, will only allow workspace admins to create new teams.",defaultMessage:"Only allow workspace admins to create teamspaces"}),selected:o}),n()(pa.Z,{size:34}))}function $u(e){const t=(0,Yt.y)((()=>({learnMoreLinkContainer:{paddingTop:6,paddingBottom:20}})),[]),i=(0,ye.O7)(),[{currentSpaceStore:a,currentUserStore:s,currentSpaceViewStore:o}]=(0,Se.oR)(Z.default),[r]=(0,dn.r5)((async()=>a&&s?await(0,O.qX)({environment:i,spaceStore:a,includeArchived:!0,currentUserId:s.id}):[]),[i,a,s]),{archivedTeams:l,unarchivedTeams:d}=(0,Se.VK)((()=>{if("resolved"!==r.status)return{archivedTeams:[],unarchivedTeams:[]};const e=[],t=[];return r.value.forEach((i=>{const a=i.getValue();void 0!==a&&(void 0===a.archived_by?t.push(i):e.push(i))})),{archivedTeams:e,unarchivedTeams:t}}),[r.status,r.value]),{loaded:u,teams:m}=(0,Se.VK)((()=>{const e={loaded:!1,teams:[]};if("idle"===r.status||"pending"===r.status)return e;const t=null==a?void 0:a.getValue(),i=null==o?void 0:o.getValue();return t&&i&&o?{loaded:!0,teams:c().uniqBy([...d||[],...o.getTeamsStores()],(e=>e.id))}:e}),[r.status,a,o,d]),p=(0,O.HC)();return n()(ba.Z,{},void 0,n()(Ju,{}),p&&n()(Yc.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_workspace_settings",containerStyle:t.learnMoreLinkContainer}),n()(su,{allTeams:m,loaded:u}),n()(Xu,{}),n()(Yu,{isLoading:!u,unarchivedTeams:m,archivedTeams:l}))}var em=i(77383);class tm extends N.Z{getInitialState(){return{emailInputValue:"",showAllInviteCredits:!1}}}const im=tm;var am=i(47593);class nm extends p.Z{constructor(){super(...arguments),l()(this,"handleImportActionClick",(()=>{am.Z.setState({open:!0}),b.trackCreditItemActionClick(this.environment,{type:"import_evernote"})})),l()(this,"handleWebActionClick",(()=>{T.navigateToExternalURL({environment:this.environment,url:"/product"}),b.trackCreditItemActionClick(this.environment,{type:"web_login"})})),l()(this,"handleDesktopActionClick",(()=>{T.navigateToExternalURL({environment:this.environment,url:"/desktop"}),b.trackCreditItemActionClick(this.environment,{type:"desktop_login"})})),l()(this,"handleMobileActionClick",(()=>{T.navigateToExternalURL({environment:this.environment,url:"/mobile"}),b.trackCreditItemActionClick(this.environment,{type:"mobile_login"})})),l()(this,"handleBrowserExtensionActionClick",(()=>{T.navigateToExternalURL({environment:this.environment,url:"/web-clipper"}),b.trackCreditItemActionClick(this.environment,{type:"browser_extension"})})),l()(this,"handleMobileShareSheetActionClick",(()=>{T.navigateToExternalURL({environment:this.environment,url:"/mobile"}),b.trackCreditItemActionClick(this.environment,{type:"mobile_share_sheet"})}))}renderComponent(){return n()("div",{style:this.getWrapperStyle()},void 0,n()("div",{style:{flex:0}},void 0,this.renderLeft()),n()("div",{style:this.getCenterStyle()},void 0,n()("div",{},void 0,this.renderTitle()),n()(ii.Z,{isSmall:!0,style:{marginBottom:2}},void 0,this.renderCaption())),n()("div",{style:{flex:0}},void 0,this.renderRight()))}renderTitle(){const{credit:e,intl:t}=this.props;if("invited_user"===e.type){const i=this.getUserStore(e.to_user_id).getValue();return n()(u.Fragment,{},void 0,(0,be.Nz)(t,i)," ",!e.activated&&i&&!i.onboarding_completed&&n()("span",{style:{color:this.theme.mediumTextColor}},void 0,n()(y.FormattedMessage,{id:"userCreditSettings.inviteFriendsSection.userHasNotSignedUpNote",defaultMessage:"(has not signed up)",description:"Annotation that appears next to a referred user's name if the user hasn't signed up for Notion yet"})),!e.activated&&i&&i.onboarding_completed&&n()("span",{style:{color:this.theme.mediumTextColor}},void 0,n()(y.FormattedMessage,{id:"userCreditSettings.inviteFriendsSection.userHasAlreadySignedUpNote",defaultMessage:"(has already signed up)",description:"Annotation that appears next to a referred user's name if the user has signed up for Notion already"})))}if("invited_by_user"===e.type){const i=this.getUserStore(e.from_user_id).getValue();return n()(u.Fragment,{},void 0,(0,be.Nz)(t,i),n()("span",{style:{color:this.theme.mediumTextColor}},void 0,n()(y.FormattedMessage,{id:"userCreditSettings.inviteFriendsSection.sourceOfReferralNote",defaultMessage:"(invited you)",description:"Annotation that appears next to the name of the user who invited this user to Notion"})))}return"import_evernote"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.evernoteImport.title",defaultMessage:"Import from Evernote"}):"web_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webApp.title",defaultMessage:"Log in on the web"}):"desktop_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.desktopApp.title",defaultMessage:"Log in on the desktop app"}):"mobile_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileApp.title",defaultMessage:"Log in on the mobile app"}):"browser_extension"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webClipper.title",defaultMessage:"Use the Web Clipper"}):"mobile_share_sheet"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileShare.title",defaultMessage:"Use the iOS or Android system share menu"}):void 0}renderCaption(){const{credit:e,intl:t}=this.props;if("invited_user"===e.type){const t=this.getUserStore(e.to_user_id).getValue();return t&&t.email}if("invited_by_user"===e.type){const t=this.getUserStore(e.from_user_id).getValue();return t&&t.email}return"import_evernote"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.evernoteImport.description",defaultMessage:"Import your notes and notebooks"}):"web_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webApp.description",defaultMessage:"Sign in to Notion from any web browser"}):"desktop_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.desktopApp.description",defaultMessage:"Download the desktop app and sign in"}):"mobile_login"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileApp.description",defaultMessage:"Download the mobile app and sign in"}):"browser_extension"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webClipper.description",defaultMessage:"Download the Chrome extension and save a link"}):"mobile_share_sheet"===e.type?t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileShare.description",defaultMessage:"Use the share menu to save a link into Notion"}):void 0}renderLeft(){const{credit:e}=this.props;if("invited_user"===e.type){const t=this.getUserStore(e.to_user_id);return n()(pn.Z,{userValue:t.getValue(),style:{marginRight:8},size:24,hasTooltip:!0})}if("invited_by_user"===e.type){const t=this.getUserStore(e.from_user_id);return n()(pn.Z,{userValue:t.getValue(),style:{marginRight:8},size:24,hasTooltip:!0})}return"import_evernote"===e.type?h.Z.evernoteLogo(this.getIconStyle()):"web_login"===e.type?h.Z.logInWeb(this.getIconStyle()):"desktop_login"===e.type?h.Z.deviceDesktop(this.getIconStyle()):"mobile_login"===e.type?h.Z.deviceMobile(this.getIconStyle()):"browser_extension"===e.type?h.Z.googleChrome(this.getIconStyle()):"mobile_share_sheet"===e.type?h.Z.deviceMobileShareSheet(this.getIconStyle()):void 0}renderRight(){const{credit:e,intl:t}=this.props;let i;return"import_evernote"===e.type?i={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.evernoteImport.actionLink",defaultMessage:"Connect"}),onClick:this.handleImportActionClick}:"web_login"===e.type?i={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webApp.actionLink",defaultMessage:"Visit"}),onClick:this.handleWebActionClick}:"desktop_login"===e.type?i={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.desktopApp.actionLink",defaultMessage:"Download"}),onClick:this.handleDesktopActionClick}:"mobile_login"===e.type?i={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileApp.actionLink",defaultMessage:"Download"}),onClick:this.handleMobileActionClick}:"browser_extension"===e.type?i={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.webClipper.actionLink",defaultMessage:"Install"}),onClick:this.handleBrowserExtensionActionClick}:"mobile_share_sheet"===e.type&&(i={text:t.formatMessage({id:"userCreditSettings.otherWaysToEarnCreditSection.mobileShare.actionLink",defaultMessage:"Download"}),onClick:this.handleMobileShareSheetActionClick}),n()("div",{style:{display:"flex",alignItems:"center"}},void 0,i&&!e.activated&&n()(ut.Z,{isBlue:!0,isSmall:!0,onClick:i.onClick},void 0,i.text),n()("div",{style:{minWidth:32,marginLeft:8,marginRight:8,textAlign:"right",fontWeight:v.Z.fontWeight.semibold,...!e.activated&&{color:this.theme.lightTextColor}}},void 0,(0,yr.Dx)({amount:e.amount,currency:"dollar",intl:this.props.intl})),n()("div",{style:this.getTickStyles(e.activated)},void 0,h.Z.check({fill:g.ZP.white,width:12,height:12,opacity:e.activated?1:0})))}getUserStore(e){const{currentSpaceStore:t}=Z.default.state;if(!t)throw new Error("No current space.");return yt.Z.createChildStore(t,{table:be.KJ,id:e})}getWrapperStyle(){const e="1px solid ".concat(this.theme.regularDividerColor);return{display:"flex",alignItems:"center",borderTop:this.props.isFirst?e:void 0,borderBottom:e,paddingTop:8,paddingBottom:8}}getCenterStyle(){return{flex:1,fontSize:14,marginLeft:4}}getIconStyle(){return{width:24,height:24,fill:this.theme.mediumIconColor,marginRight:8}}getTickStyles(e){const t=e?void 0:"inset 0 0 0 2px ".concat(this.theme.regularDividerColor);return{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:20,background:e?g.ZP.blue:void 0,boxShadow:t}}}const sm=(0,y.injectIntl)(nm);class om extends p.Z{constructor(){super(...arguments),l()(this,"storeTypes",{store:im}),l()(this,"renderCredit",((e,t)=>n()(sm,{credit:e,isFirst:0===t},e.id))),l()(this,"handleInviteCreditsToggleShowMoreClick",(()=>{const{store:e}=this.stores;e.setState({...e.state,showAllInviteCredits:!e.state.showAllInviteCredits})})),l()(this,"handleApplyCreditClick",(()=>{const{data:e}=this.props;he.ZP.setState({open:!0,currentTab:"subscribed_admin"===e.type?"billing":"plans",defaultSubtab:void 0}),b.trackApplyCreditClick(this.environment)}))}willMount(){_.bi(this.environment)}renderComponent(){if(ra.Z.state.online){const{credits:e}=this.props.data;return this.renderSettings(e)}return this.renderOfflineMessage()}renderOfflineMessage(){return n()(ba.Z,{},void 0,n()(ii.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,n()(y.FormattedMessage,{id:"userCreditSettings.offline.message",defaultMessage:"Please go online to manage your account credit."})))}renderOtherCreditWays(e){const t=this.getActionCredits(e);return t.length>0&&n()(u.Fragment,{},void 0,n()(qt.Z,{large:!0},void 0,n()(y.FormattedMessage,{id:"userCreditSettings.otherWaysToEarnCreditSectionAlt.title",defaultMessage:"Ways to earn credit"})),n()("div",{},void 0,t.map(this.renderCredit)))}renderReferralSection(e){const{store:t}=this.stores,{showAllInviteCredits:i}=t.state,a=this.getInviteCredits(e),s=i?a:a.slice(0,om.showInviteCreditCount);return a.length>0&&n()(m().Fragment,{},void 0,n()("div",{style:this.getHeaderContainerStyles()},void 0,n()("div",{style:this.getHeaderStyles()},void 0,n()(y.FormattedMessage,{id:"userCreditSettings.inviteFriendsSection.title",defaultMessage:"Invite friends and earn credit"}))),n()("div",{style:this.getInviteCreditStyles()},void 0,s.map((e=>this.renderCredit(e,1))),a.length>om.showInviteCreditCount&&n()(Fs.Z,{style:{marginTop:8},onClick:this.handleInviteCreditsToggleShowMoreClick},void 0,n()(y.FormattedMessage,i?{id:"userCreditSettings.inviteFriendsSection.showLessReferredUsers.link",defaultMessage:"Show {numberOfReferredUsers} less",values:{numberOfReferredUsers:a.length-om.showInviteCreditCount}}:{id:"userCreditSettings.inviteFriendsSection.showMoreReferredUsers.link",defaultMessage:"Show {numberOfReferredUsers} more",values:{numberOfReferredUsers:a.length-om.showInviteCreditCount}}))))}renderTotalCreditEarned(e){const{intl:t}=this.props,i=e.reduce(((e,t)=>e+(t.activated?t.amount:0)),0);return i>0&&n()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"}},void 0,n()(fa.Z,{title:t.formatMessage({id:"userCreditSettings.helpButton.caption",defaultMessage:"Learn how to earn and apply credits"}),href:(0,R.UY)("guides.referralsAndCredit"),analyticsFrom:"credit_settings"}),n()("div",{style:{display:"flex",alignItems:"center",paddingRight:28,marginTop:16}},void 0,n()("div",{style:{marginLeft:"auto",fontSize:14,color:this.theme.mediumTextColor}},void 0,n()(y.FormattedMessage,{id:"userCreditSettings.otherWaysToEarnCreditSection.totalCreditSummaryText",defaultMessage:"Total credit earned"})),n()("div",{style:{minWidth:44,fontWeight:v.Z.fontWeight.semibold,textAlign:"right"}},void 0,(0,yr.Dx)({amount:i,currency:"dollar",intl:t}))))}renderSettings(e){return n()(ba.Z,{},void 0,this.renderCreditBalance(),this.renderReferralSection(e),this.renderOtherCreditWays(e),this.renderTotalCreditEarned(e))}renderCreditBalance(){var e=this;const{data:t,intl:i}=this.props,{availableCredit:a,totalCredit:s}=t,o=fe.default.state.data;if(!o)return;const r=L.YK(o),l=Math.floor(a/Gt.Z.pricing.personal.monthlyPrice),d=s>=cc.cw;return n()(u.Fragment,{},void 0,n()(qt.Z,{large:!0,divider:"full"},void 0,n()(y.FormattedMessage,{id:"userCreditSettings.creditBalanceSection.title",defaultMessage:"Credit balance"})),n()("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:40,fontSize:14}},void 0,n()("div",{},void 0,n()(y.FormattedMessage,{id:"userCreditSettings.creditBalanceSection.creditBalanceMessage",defaultMessage:"Your current credit balance is {creditBalance}.",values:{creditBalance:n()("b",{style:{color:this.theme.regularTextColor}},void 0,(0,yr.Dx)({amount:a,currency:"dollar",intl:i}))}})," ",a>0&&!d&&n()(y.FormattedMessage,{id:"userCreditSettings.creditBalanceSection.freeMonthMessage",description:"Message in sidebar letting user know how many months of free Notion they can get with their credits",defaultMessage:"{numberOfMonths, plural, one {That's equivalent to <b>{numberOfMonths} month</b> of the Personal Pro Plan.} other {That's equivalent to <b>{numberOfMonths} months</b> of the Personal Pro Plan.}}",values:{numberOfMonths:l,b:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n()("b",{style:{color:e.theme.regularTextColor}},void 0,i)}}}),d&&n()(y.FormattedMessage,{id:"userCreditSettings.creditBalanceSection.maximumCreditBalanceExceeded",defaultMessage:"You've exceeded the maximum amount of credit per account, {maximumCreditBalance}. Any additional credit you earn will not increase your balance.",values:{maximumCreditBalance:(0,yr.Dx)({amount:cc.cw,currency:"dollar",intl:i})}})),a>0&&n()(Ht.Z,{isLarge:!0,onClick:this.handleApplyCreditClick},void 0,r?h.Z.settingsBilling(om.applyCreditButtonIconStyle):h.Z.settingsUpgrade(om.applyCreditButtonIconStyle),r?i.formatMessage({id:"userCreditSettings.creditBalanceSection.applyCreditButton.label",defaultMessage:"Apply your credit"}):i.formatMessage({id:"userCreditSettings.creditBalanceSection.upgradeForFreeButton.label",defaultMessage:"Upgrade for free"}))))}getActionCredits(e){const{id:t}=this.environment.currentUser,{currentUserSettingsStore:i}=Z.default.state;if(!t||!i)return[];const a=[],n=i.getValue();if(n&&cc.qQ(n)){const i={id:"web_login_default",version:0,amount:cc.lk.web_login,activated:!1,created_timestamp:Date.now(),type:"web_login",user_id:t};a.push(e.find((e=>"web_login"===e.type))||i);const n={id:"desktop_login_default",version:0,amount:cc.lk.desktop_login,activated:!1,created_timestamp:Date.now(),type:"desktop_login",user_id:t};a.push(e.find((e=>"desktop_login"===e.type))||n);const s={id:"mobile_login_default",version:0,amount:cc.lk.mobile_login,activated:!1,created_timestamp:Date.now(),type:"mobile_login",user_id:t};a.push(e.find((e=>"mobile_login"===e.type))||s)}const s={id:"import_evernote_default",version:0,amount:cc.lk.import_evernote,activated:!1,created_timestamp:Date.now(),type:"import_evernote",user_id:t};a.push(e.find((e=>"import_evernote"===e.type))||s);const o={id:"browser_extension_default",version:0,amount:cc.lk.browser_extension,activated:!1,created_timestamp:Date.now(),type:"browser_extension",user_id:t};a.push(e.find((e=>"browser_extension"===e.type))||o);const r={id:"mobile_share_sheet_default",version:0,amount:cc.lk.mobile_share_sheet,activated:!1,created_timestamp:Date.now(),type:"mobile_share_sheet",user_id:t};return a.push(e.find((e=>"mobile_share_sheet"===e.type))||r),a}getInviteCredits(e){const t=e.find((e=>"invited_by_user"===e.type)),i=e.filter((e=>"invited_user"===e.type&&!e.activated)),a=e.filter((e=>"invited_user"===e.type&&e.activated));return c().compact([t,...c().sortBy(i,(e=>-e.created_timestamp)),...c().sortBy(a,(e=>-e.created_timestamp))])}getHeaderContainerStyles(){return{borderBottom:"1px solid ".concat(this.theme.regularDividerColor),paddingBottom:4,marginBottom:12}}getHeaderStyles(){return{fontWeight:v.Z.fontWeight.medium,fontSize:18}}getInviteCreditStyles(){return{marginBottom:44}}}l()(om,"showInviteCreditCount",3),l()(om,"applyCreditButtonIconStyle",{width:20,height:20,marginRight:6});const rm=(0,y.injectIntl)(om);class lm extends p.Z{constructor(){var e;super(...arguments),e=this,l()(this,"lastSpaceSettingsStoreState",void 0),l()(this,"lastSpaceSettingsModalStoreOpen",!1),l()(this,"storeTypes",{spaceBasicSettingsStore:re,spaceProfileSettingsStore:ue,securitySettingsStore:ae.Z,spaceSecuritySamlSettingsStore:ge,spaceDomainSettingsStore:de}),l()(this,"renderContent",(()=>{const e={profile:this.renderProfile,notifications_and_settings:this.renderNotificationsAndSettings,credit:this.renderCredit,language_and_region:this.renderLanguageAndRegion,connected_apps:this.renderConnectedApps,debug_zone:this.renderDebugZone,settings:this.renderSettings,teams:this.renderTeamsSettings,members:this.renderMembers,analytics:this.renderAnalytics,plans:this.renderPlans,billing:this.renderBilling,subscription:this.renderSubscription,security:this.renderSecuritySaml,identity_provisioning:this.renderIdentityProvisioning,integrations:this.renderIntegrations,experiments:this.renderExperiments,audit_log:this.renderAuditLog};return n()(Vo.Z,{capture:!0,allowEsc:!0,render:t=>n()(zo.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>m().createElement(Jr,o()({sidebar:this.renderSidebar()},t),e[he.ZP.state.currentTab]())})})})),l()(this,"renderTabDot",(e=>{const{currentSpaceStore:t}=Z.default.state;return(null==t?void 0:t.getKeyStore("settings").getKeyStore("seen_membership_requests").getValue())&&"members"===e&&this.environment.device.isDesktop&&null!=t&&t.canEditMembership()&&(0,E.p1)(this.environment)&&ve.Z.state.count>0?n()(_c.z,{color:this.theme.redBadgeBackground}):null})),l()(this,"renderProfile",(()=>n()(nd,{isEducationPlan:L.wl(fe.default.state.data),spaceProfileSettingsStore:this.stores.spaceProfileSettingsStore}))),l()(this,"renderNotificationsAndSettings",(()=>n()(Yr.Z,{isMobile:!1}))),l()(this,"renderLanguageAndRegion",(()=>n()(jr,{}))),l()(this,"renderSettings",(()=>n()(Rl,{spaceStore:this.props.spaceStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore}))),l()(this,"renderTeamsSettings",(()=>n()($u,{}))),l()(this,"renderMembers",(()=>n()(Ll.Z,{store:this.props.spaceStore,unreadAccessRequests:ve.Z.state.count}))),l()(this,"shouldRenderAnalyticsTab",(()=>{const{device:e}=this.environment;return!e.isMobile&&"enterprise"===this.props.spaceStore.getKeyStore("subscription_tier").getValue()&&ie.default.checkGate("show_workspace_analytics")})),l()(this,"renderAnalytics",(()=>n()(rl,{}))),l()(this,"renderPlans",(()=>{const{data:e}=fe.default.state;if(e)return n()(Pc,{spaceStore:this.props.spaceStore,data:e})})),l()(this,"renderBilling",(()=>{const{data:e}=fe.default.state,t=L.XX(e);return e&&"subscribed_admin"===e.type&&t?n()(Ud,{spaceStore:this.props.spaceStore,subscriptionData:e,customerData:t}):e&&"unsubscribed_admin"===e.type?n()(Vd,{spaceStore:this.props.spaceStore,data:e}):void 0})),l()(this,"renderExperiments",(()=>n()(ba.Z,{},void 0,n()(Rn.Ub,{})))),l()(this,"shouldRenderMembersPrompt",(()=>{var e,t;const{currentSpaceViewStore:i,currentSpaceStore:a,currentUserStore:n}=Z.default.state;if(null==n||!n.id)return!1;const s=null==a?void 0:a.getValue();if(!s)return!1;if("enterprise"!==(null==a?void 0:a.getSubscriptionTier())||!(0,f.wv)(s,n.id)||!(0,D.U7)())return!1;const o=null==i?void 0:i.getSettings();return"dismissed"!==(null==o||null===(e=o.enterprise_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==o||null===(t=o.enterprise_settings_prompt)||void 0===t?void 0:t.status)&&(function(e){var t;const{currentSpaceViewStore:i}=Z.default.state;i&&void 0===(null===(t=i.getSettings())||void 0===t?void 0:t.enterprise_settings_prompt)&&A.createAndCommit({userAction:"userSettingsActions.updateOnboardingChecklistSettings",environment:e,perform:e=>{I(i,e,{enterprise_settings_prompt:{status:"showing",num_times_shown:0}})}})}(this.environment),!0)})),l()(this,"shouldRenderAuditLog",(()=>{const{device:e}=this.environment;return!e.isMobile&&"enterprise"===L.CM(this.environment)&&this.props.spaceStore.canAdmin()&&"on"===ie.default.getEligibleGroup({experimentId:"show_audit_log",defaultGroup:"on"})})),l()(this,"renderAuditLog",(()=>{if(!this.shouldRenderAuditLog())return null;const e=this.getAuditLogBannerText();return m().createElement(m().Fragment,null,n()(ba.Z,{bannerText:e},void 0,n()(Yi,{spaceStore:this.props.spaceStore})))})),l()(this,"getAuditLogBannerText",(()=>{var t,i;const{currentSpaceViewStore:a}=Z.default.state;if(!(null==a||null===(t=a.getSettings())||void 0===t||null===(i=t.audit_log_banner)||void 0===i?void 0:i.seen_page_audience)&&"on"===ie.default.getGroup("show_private_names_in_audit_log"))return function(e,t){var i;const{currentSpaceViewStore:a}=Z.default.state;if(!a)return;const n=null===(i=a.getSettings())||void 0===i?void 0:i.audit_log_banner;n&&n[t]||A.createAndCommit({userAction:"spaceViewActions.setAuditLogBannerToSeen.".concat(t),environment:e,perform:e=>{I(a,e,{audit_log_banner:{...n,[t]:!0}})}})}(this.environment,"seen_page_audience"),n()(y.FormattedMessage,{id:"auditLog.bannerText.pageAudienceNotification",defaultMessage:"You can now view the audience (or visibility level) of the target page for page events moving forward.<a>Learn more →</a>",description:"Banner that shows at top of audit log informing users about the new page audience feature.",values:{arrowRight:h.Z.arrowRight({width:12,height:12,marginLeft:2}),a:function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return n()("a",{style:{cursor:"pointer",textDecoration:"underline",marginLeft:2,color:g.ZP.white},onClick:()=>{(0,T.navigateToExternalURL)({environment:e.environment,url:(0,R.UY)("guides.auditLog.pageEvents")})}},void 0,i)}}})})),l()(this,"renderSubscription",(()=>n()(ba.Z,{},void 0,n()(xc.Z,{})))),l()(this,"renderCredit",(()=>{const{data:e}=fe.default.state;if(e)return n()(rm,{data:e})})),l()(this,"renderConnectedApps",(()=>"on"===ie.default.getEligibleGroup({experimentId:"better_integrations",defaultGroup:"control"})?n()(em.Z,{}):n()(Ta,{}))),l()(this,"renderDebugZone",(()=>n()(cd,{store:this.props.spaceStore}))),l()(this,"renderSecuritySaml",(()=>n()(co,{spaceStore:this.props.spaceStore,securitySettingsStore:this.stores.securitySettingsStore,samlConfigStore:this.stores.spaceSecuritySamlSettingsStore,domainSettingsStore:this.stores.spaceDomainSettingsStore,userStore:this.props.userStore}))),l()(this,"renderIdentityProvisioning",(()=>n()(Wo,{spaceStore:this.props.spaceStore,samlConfigStore:this.stores.spaceSecuritySamlSettingsStore,domainSettingsStore:this.stores.spaceDomainSettingsStore,userStore:this.props.userStore}))),l()(this,"renderIntegrations",(()=>"on"===ie.default.getEligibleGroup({experimentId:"better_integrations",defaultGroup:"control"})?n()(Bn,{spaceStore:this.props.spaceStore,userStore:this.props.userStore}):n()(sr,{spaceStore:this.props.spaceStore,userStore:this.props.userStore}))),l()(this,"handleModalOpen",(()=>{_.bi(this.environment),this.resetAuditLogSetting(),(0,S.kj)({environment:this.environment,spaceId:this.props.spaceStore.id,canAdmin:this.props.spaceStore.canAdmin()})})),l()(this,"handleModalDismiss",(()=>this.attemptCloseCurrentTab((()=>{he.ZP.setState({...he.ZP.state,open:!1}),se.reset(),this.stores.spaceDomainSettingsStore.reset(),this.resetAuditLogSetting(),ve.Z.reset()}))))}willMount(e){super.willMount(e);const{spaceStore:t}=this.props,{securitySettingsStore:i}=this.stores,a=i.getValueForSpace(t);a&&i.setState(a)}willMountOrUpdate(e){super.willMountOrUpdate(e);const{open:t}=he.ZP.state,i=he.ZP.state;this.lastSpaceSettingsModalStoreOpen===t&&c().isEqual(this.lastSpaceSettingsStoreState,i)||t&&b.trackOpenSettings(this.environment,{tab:i.currentTab}),this.lastSpaceSettingsModalStoreOpen=t,this.lastSpaceSettingsStoreState=c().clone(i)}renderComponent(){const{open:e}=he.ZP.state;return n()(Ga.Z,{open:e,innerStyle:{width:1150,maxWidth:"calc(100vw - 100px)",height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:715},onOpen:this.handleModalOpen,onDismiss:this.handleModalDismiss,render:this.renderContent,className:B.zY})}renderSidebar(){const{spaceStore:e}=this.props,{data:t}=fe.default.state,i=(0,F.S4)(this.environment),a=L.wY(t),s=(0,Rn.mS)(),o=ld().length>0,r="on"===ie.default.getEligibleGroup({experimentId:"split_identity_provisioning",defaultGroup:"unassigned"}),l="on"===ie.default.getEligibleGroup({experimentId:"better_integrations",defaultGroup:"control"})?e.canAdmin():e.canRead();return n()("div",{style:lm.sidebarStyle},void 0,n()("div",{style:lm.sidebarTabsStyle},void 0,n()("div",{},void 0,n()("div",{style:this.getSidebarHeader()},void 0,i&&i.email||n()(y.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.title",defaultMessage:"Me"})),this.renderTabButton("profile"),this.renderTabButton("notifications_and_settings"),this.renderTabButton("connected_apps"),this.renderTabButton("language_and_region"),t&&t.creditEnabled&&this.renderTabButton("credit"),o&&this.renderTabButton("debug_zone"),n()(pa.Z,{size:18,isHidden:!0}),n()("div",{style:this.getSidebarHeader()},void 0,n()(y.FormattedMessage,{id:"spaceSettings.sidebar.workspaceSettingsSection.title",defaultMessage:"Workspace"})),this.renderTabButton("settings"),e.canAdmin()&&(0,O.bq)()&&this.renderTabButton("teams"),e.canRead()&&this.renderTabButton("members"),this.shouldRenderAnalyticsTab()&&this.renderTabButton("analytics"),e.canRead()&&this.renderTabButton("plans"),e.canAdmin()&&t&&("subscribed_admin"===t.type||"unsubscribed_admin"===t.type)&&!a&&this.renderTabButton("billing"),a&&this.renderTabButton("subscription"),e.canAdmin()&&this.renderTabButton("security"),r&&e.canAdmin()&&this.renderTabButton("identity_provisioning"),l&&this.renderTabButton("integrations"),this.shouldRenderAuditLog()&&this.renderTabButton("audit_log"),s&&this.renderTabButton("experiments"),e.canRead()&&n()(Qi.Z,{source:"settings"}))),this.shouldRenderMembersPrompt()&&n()(Dn,{onMembersTabClick:()=>{this.attemptCloseCurrentTab((()=>{he.ZP.setState({...he.ZP.state,currentTab:"members"}),this.stores.spaceDomainSettingsStore.reset(),b.trackToggleSettingsTab(this.environment,{tab:"members"})}))}}))}renderTabButton(e){const t=he.ZP.state.currentTab===e,i=he.mY[e](this.environment),a=he.j7[e]();return n()(ei.Z,{hovered:t,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"5px 15px"},onClick:i=>{t||this.attemptCloseCurrentTab((()=>{he.ZP.setState({...he.ZP.state,currentTab:e,defaultSubtab:void 0}),this.stores.spaceDomainSettingsStore.reset(),b.trackToggleSettingsTab(this.environment,{tab:e})}))}},void 0,n()("div",{style:{display:"flex",alignItems:"center",...t&&{fontWeight:v.Z.fontWeight.semibold}}},void 0,n()("div",{style:this.getIconWrapStyle()},void 0,i),n()(ii.Z,{},void 0,a)),this.renderTabDot(e))}async attemptCloseCurrentTab(e){const t="on"===ie.default.getEligibleGroup({experimentId:"split_identity_provisioning",defaultGroup:"unassigned"}),{spaceStore:i}=this.props,{spaceProfileSettingsStore:a}=this.stores,{currentUserStore:s,currentUserSettingsStore:o}=Z.default.state;if(!s||!o)throw new Error("No user or settings store.");const r=n()(y.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Save changes?"}),l=n()(y.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationButton.label",defaultMessage:"Yes",description:"Label for button that appears below the question, 'Your changes have not been saved. Save changes?' to confirm that the user would like to save their changes."}),d=n()(y.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.cancelationButton.label",defaultMessage:"No",description:"Label for button that appears below the question, 'Your changes have not been saved. Save changes?' to not save changes and return to settings menu."}),{currentTab:u}=he.ZP.state;if("profile"===u){if(!c().isEqual(a.state,a.getValueForUser(s,o))){const{profilePhoto:t,name:i,startDayOfWeek:s}=a.state;return i?C.showDialog({message:r,showCancel:!0,keepFocus:!0,items:[{label:n()(y.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.updateSettingsButton.label",defaultMessage:"Update"}),color:"blue",onAccept:()=>{A.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:this.environment,perform:e=>{const{currentUserStore:a}=Z.default.state;if(a&&M.A({userStore:a,data:{name:i,profilePhoto:t},transaction:e}),o){const t=o.getSettings();(null==t?void 0:t.start_day_of_week)!==s&&(0,x.d2)({userSettingsStore:o,data:{start_day_of_week:s},transaction:e})}}}),e()}}],handleCancel:()=>{e()}}):C.showErrorMessage(n()(y.FormattedMessage,{id:"profileSettings.personalInfoSection.nameMissing.message",defaultMessage:"Please fill in name."})),!0}e()}else if("settings"===u&&i.canEdit()){const{spaceBasicSettingsStore:t}=this.stores;if(!c().isEqual(t.state,t.getValueForSpace(i))){if(await C.confirmUserAction({message:r,acceptLabel:l,cancelLabel:d})){if(!(await k.Y5({environment:this.environment,spaceId:i.id,spaceBasicSettingsStore:t})))return!1;k.OF({environment:this.environment,spaceStore:this.props.spaceStore,spaceBasicSettingsStore:t}),e()}else e();return!0}e()}else if("security"===u&&i.canAdmin()){const{securitySettingsStore:a,spaceSecuritySamlSettingsStore:n,spaceDomainSettingsStore:s}=this.stores,o=!c().isEqual(a.state,a.getValueForSpace(i)),u=await n.getValueForSpace(this.environment,i),m=(n.state.emailDomains.length>0||"enterprise"===L.CM(this.environment))&&(!n.state.id||n.state.id===i.id),p=m&&!c().isEqual(n.state,u)&&!t,g=await w.getEmailDomainsForSpace(this.environment,{spaceId:i.id}),h=m&&!c().isEqual(s.state,g)&&s.state.spaceCreation&&0!==n.state.emailDomains.length&&!t;if(o||p||h){if(await C.confirmUserAction({message:r,acceptLabel:l,cancelLabel:d})){const{disablePublicAccess:t,disableGuests:r,disableMoveToSpace:l,disableExport:d,disableSpacePageEdits:c,disablePublicAccessRequests:u,disablePersonalBots:m,disableTeamCreation:g,disableMembershipRequests:f}=a.state;if(o&&A.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:this.environment,perform:e=>{k.Xr({environment:this.environment,disablePublicAccess:t,disableGuests:r,disableMoveToSpace:l,disableExport:d,disableSpacePageEdits:c,disablePublicAccessRequests:u,transaction:e,spaceStore:this.props.spaceStore,disablePersonalBots:m,disableTeamCreation:g,disableMembershipRequests:f})}}),p){const{state:e}=n,t=await w.adminSamlConfigForSpace(this.environment,{spaceId:this.props.spaceStore.id,status:e.status,useMetadataUrl:e.useMetadataUrl,idpMetadataUrl:e.idpMetadataUrl,idpMetadata:e.idpMetadata,createAccount:e.createAccount});"failed"===t.type&&C.showError(t)}if(h&&s.state.spaceCreation){const e=await w.updateWorkspaceCreationForEmailDomains(this.environment,{emailDomains:n.state.emailDomains,workspaceCreationEnum:s.state.spaceCreation,spaceId:i.id});"failed"===e.type&&C.showError(e)}e()}else e();return!0}e()}else"audit_log"===u?(this.resetAuditLogSetting(),e()):e();return!1}resetAuditLogSetting(){X.reset(),te.reset()}getSidebarHeader(){return{letterSpacing:"0.03em",textTransform:"uppercase",fontSize:11,lineHeight:1,marginBottom:1,color:this.theme.mediumTextColor,fontWeight:v.Z.fontWeight.medium,padding:"5px 15px",textOverflow:"ellipsis",overflow:"hidden"}}getIconWrapStyle(){return{width:20,height:20,marginRight:8,color:this.theme.regularIconColor,fill:this.theme.regularIconColor}}}l()(lm,"theme",void 0),l()(lm,"sidebarStyle",{display:"flex",flexDirection:"column",height:"100%",justifyContent:"space-between",paddingTop:10}),l()(lm,"sidebarTabsStyle",{overflow:"auto",paddingBottom:12});const dm=lm},93039:(e,t,i)=>{i.d(t,{J:()=>k});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=(i(33948),i(67294)),l=i.n(r),d=i(480),c=i(24405),u=i(31942),m=i(59054),p=i(97880),g=i(5366),h=i(50906),f=i(54642),v=i(80676),y=i(27242),S=i(48762),M=i(62727),b=i(71202),w=i(25584),C=i(66722),T=i(83071);function k(e){const t=(0,c.y)((e=>({container:(0,v.s)(e),cityZipRow:{display:"flex"},verticalDivider:{display:"flex",borderLeft:"1px solid",borderLeftColor:e.groupedFormBorder},zipRow:{display:"flex",flex:2},stateRow:{display:"flex",flex:3}})),[]),i=(0,g.useIntl)(),a=(0,d.O7)();return o()("div",{},void 0,o()("div",{style:t.container},void 0,o()(A,{placeholder:i.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.fullName",defaultMessage:"Full name"}),address:e.address,updateAddress:e.updateAddress,addressKey:"name",environment:a}),e.shouldShowBusinessName&&o()(A,{placeholder:i.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.businessName",defaultMessage:"Business name (optional)"}),address:e.address,updateAddress:e.updateAddress,addressKey:"businessName",environment:a}),o()(Z,{updateAddress:e.updateAddress,address:e.address}),e.address&&l().createElement(l().Fragment,null,o()(A,{placeholder:i.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.address",defaultMessage:"Address"}),address:e.address,addressKey:"addressLine1",updateAddress:e.updateAddress,environment:a}),o()(A,{placeholder:i.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.city",defaultMessage:"City"}),addressKey:"city",address:e.address,updateAddress:e.updateAddress,environment:a}),o()("div",{style:t.cityZipRow},void 0,o()("div",{style:t.zipRow},void 0,o()(A,{placeholder:i.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.zipCode",defaultMessage:"Zip code"}),address:e.address,addressKey:"zipCode",updateAddress:e.updateAddress,environment:a})),o()("div",{style:t.verticalDivider}),o()("div",{style:t.stateRow},void 0,o()(A,{placeholder:i.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.state",defaultMessage:"State / Province"}),address:e.address,addressKey:"state",updateAddress:e.updateAddress,environment:a}))))))}function Z(e){const t=(0,d.O7)(),[i,a]=(0,r.useState)(!1),s=(0,g.useIntl)(),k=(0,c.y)((()=>({input:{background:"none",boxShadow:"none",padding:8}})),[]),[Z,A]=l().useState(""),[I]=(0,m.r5)((async()=>{const e=await f.getAvailableCountries(t,{});return"success"===e.type?e.data.countries:"failed"===e.type?[]:void(0,p.t1)(e)}),[t]),P=I.value;if(!P)return null;const _=(0,u.ZP)(Z,P,(e=>e.name)).map(((i,s)=>({key:s,render:e=>l().createElement(S.Z,n()({},e,{title:i.name})),action:()=>{i.countryCode!==e.address.country&&e.updateAddress({addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:i.countryCode});const n=y.Z.state;n.open&&y.Z.setState({...n,vatApplicable:Boolean(i.vatApplicable)}),A(i.name),a(!1),(0,h.trackSubscriptionUpgradeModalAddressFormUpdated)(t,{addressType:"country",addressUpdate:i.name})}})));return o()(v.c,{},void 0,o()(C.ZP,{popupType:C.ZP.PopupType.Popup,alignmentToOrigin:C.ZP.Alignment.End,placementToOrigin:C.ZP.Placement.Right,originGap:0,open:i,origin:o()(M.Z,{value:Z,focus:i,placeholder:s.formatMessage({id:"spaceSubscriptionPaymentForm.billingInformation.country",defaultMessage:"Country or region"}),style:k.input,onChange:t=>{A(t.target.value),e.updateAddress({country:void 0})},onFocus:()=>{a(!0)}}),onDismiss:()=>{a(!1)},render:()=>o()(b.Z,{menuType:b.Z.MenuType.Popup,width:"100%"},void 0,o()(w.Z,{type:w.Z.Type.Vertical,initialFocus:Z.length>0?0:void 0,sections:[{key:0,showNoResultMessage:!0,render:e=>l().createElement(T.Z,n()({},e,{title:o()(g.FormattedMessage,{id:"spaceSubscriptionBillingInfoForm.countryDropdown.title",defaultMessage:"Select a country or region"})})),items:_}]}))}))}function A(e){const t=(0,c.y)((()=>({input:{background:"none",boxShadow:"none",padding:8}})),[]);return o()(v.c,{},void 0,o()(M.Z,{value:e.address[e.addressKey],style:t.input,placeholder:e.placeholder,onBlur:(i=e.updateAddress,a=e.addressKey,n=e.environment,e=>{(0,h.trackSubscriptionUpgradeModalAddressFormUpdated)(n,{addressType:a,addressUpdate:e.target.value}),i({[a]:e.target.value})})}));var i,a,n}},10644:(e,t,i)=>{i.d(t,{Z:()=>c});var a=i(77094),n=i.n(a),s=(i(67294),i(83355)),o=i(5366),r=i(27386),l=i(46951);class d extends s.Z{renderComponent(){return n()(r.Z,{},void 0,n()(l.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,n()(o.FormattedMessage,{id:"spaceSubscriptionPlans.offlineMessage",defaultMessage:"Please go online to manage your plan."})))}}const c=d},1063:(e,t,i)=>{i.d(t,{X:()=>u});var a=i(77094),n=i.n(a),s=(i(67294),i(480)),o=i(24405),r=i(5366),l=i(50906),d=i(21115),c=i(42402);function u(e){const t=(0,s.O7)(),i=(0,o.y)((()=>({couponLink:{fontSize:12}})),[]);return n()(c.Z,{href:"https://notionup.typeform.com/to/qYXezfBW",external:!0,style:i.couponLink,onClick:()=>{const i=d.CM(t);l.trackCouponTypeformClicked(t,{tier:e.tier,currentTier:i})}},void 0,n()("div",{},void 0,n()(r.FormattedMessage,{id:"startupCouponInlineLink.text",defaultMessage:"Are you a startup?",description:"Shown in our billing/upgrade settings to ask if a user's workspace belongs to a startup."})))}},13787:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Z});var a=i(77094),n=i.n(a),s=i(77422),o=i.n(s),r=(i(33948),i(67294)),l=i.n(r),d=i(83355),c=i(8848),u=i(53397),m=i(89101),p=i(82990),g=i(5366),h=i(54642),f=i(28020),v=i(33846),y=i(92083),S=i(9209),M=i(12318),b=i(72693),w=i(42402),C=i(62727),T=i(15102);class k extends d.Z{constructor(){super(...arguments),o()(this,"storeTypes",{promoCodeStore:v.Z,promoError:M.default.of(void 0)}),o()(this,"handleModalDismiss",(()=>{S.Z.setState({open:!1})})),o()(this,"handleChangeEmail",(()=>{this.handleModalDismiss(),y.ZP.setState({open:!0,currentTab:"profile",defaultSubtab:void 0})})),o()(this,"handleInputChange",(e=>{this.stores.promoCodeStore.setState({...this.stores.promoCodeStore.state,inputValue:e.target.value.toUpperCase()}),this.stores.promoError.set(void 0)})),o()(this,"handleSubmitPromoCode",(async()=>{const e=this.stores.promoCodeStore.state.inputValue;if(e){const t=await h.getPromoCode(this.environment,{code:e});"failed"!==t.type&&t.data.promo?S.Z.state.open&&(await S.Z.state.handlePromoCode(this.stores.promoCodeStore.state.inputValue),this.handleModalDismiss()):this.stores.promoError.set(this.props.intl.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:e}))}}))}renderComponent(){const{open:e}=S.Z.state;return n()(T.Z,{open:e,innerStyle:k.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>this.renderModalContents(),onDismiss:this.handleModalDismiss})}renderModalContents(){return n()("div",{style:{fontSize:14}},void 0,n()("div",{},void 0,n()(g.FormattedMessage,{defaultMessage:"<p>Unfortunately you are not eligible for a free Personal Pro plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Personal Pro Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Personal Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:n()("br",{}),p:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("p",{style:{marginTop:0,marginBottom:8}},void 0,1===t.length?t[0]:l().Children.toArray(t))},pricinglink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(w.Z,{external:!0,href:m.AR.pricing},void 0,t)}}})),this.renderSchoolEmailCodePrompt(),this.renderPromoCode(),this.renderContactUs())}renderSchoolEmailCodePrompt(){const e=(0,f.S4)(this.environment);return n()("div",{style:{display:"flex",marginTop:16}},void 0,n()("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor}},void 0,n()(g.FormattedMessage,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})),n()("div",{style:{flexGrow:1}},void 0,n()("div",{style:{color:this.theme.mediumTextColor}},void 0,n()(g.FormattedMessage,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})),n()("div",{style:{fontWeight:p.Z.fontWeight.medium,marginTop:0}},void 0,e&&e.email),n()("div",{style:{color:this.theme.mediumTextColor,marginTop:4}},void 0,n()(g.FormattedMessage,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})),n()(b.Z,{style:{marginTop:12},onClick:this.handleChangeEmail,isLarge:!0},void 0,n()(g.FormattedMessage,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"}))))}renderPromoCode(){const e=this.stores.promoError.get(),t=this.props.intl.formatMessage({defaultMessage:"Enter student promo code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return n()("div",{style:{display:"flex",marginTop:16}},void 0,n()("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor}},void 0,n()(g.FormattedMessage,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})),n()("div",{style:{flexGrow:1}},void 0,n()("div",{style:{color:this.theme.mediumTextColor}},void 0,n()(g.FormattedMessage,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})),n()("div",{style:{display:"flex",marginTop:12}},void 0,n()(C.Z,{style:{marginRight:8,height:32},value:this.stores.promoCodeStore.state.inputValue,onChange:this.handleInputChange,onSubmit:this.handleSubmitPromoCode,placeholder:t}),n()(b.Z,{onClick:this.handleSubmitPromoCode,disabled:!this.stores.promoCodeStore.state.inputValue,isLarge:!0},void 0,n()(g.FormattedMessage,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"}))),n()("div",{style:{color:c.ZP.red,fontSize:12,marginTop:4,marginLeft:8,height:20}},void 0,e)))}renderContactUs(){return n()("div",{style:{display:"flex",alignItems:"center",color:this.theme.lightTextColor,borderTop:"1px solid ".concat(this.theme.regularDividerColor),paddingTop:14}},void 0,u.Z.help({width:14,marginTop:1,marginRight:6,fill:this.theme.lightIconColor})," ",n()("div",{},void 0,n()(g.FormattedMessage,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(w.Z,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0},void 0,t)}}})))}}o()(k,"wrapStyle",{padding:"24px 36px 24px",minWidth:300,maxWidth:400});const Z=(0,g.injectIntl)(k)},6202:(e,t,i)=>{i.d(t,{Z:()=>g});var a=i(77094),n=i.n(a),s=i(77422),o=i.n(s),r=(i(67294),i(83355)),l=i(8848),d=i(87279),c=i(72693),u=i(14947),m=i(86646);class p extends r.Z{renderComponent(){return n()(m.Z,{title:this.renderButton()})}renderButton(){const{isMobile:e}=this.environment.device;return e?n()(u.Z,{onClick:this.props.onClick,mobileFeedback:!0,disabled:this.props.disabled,style:p.buttonMobileStyle},void 0,this.props.title):n()(c.Z,{onClick:this.props.onClick,disabled:this.props.disabled,style:{width:"100%",maxWidth:300,display:"flex",margin:"auto"}},void 0,this.props.title)}}o()(p,"contextTypes",{...d.f}),o()(p,"buttonMobileStyle",{width:"100%",color:l.ZP.blue});const g=p},50987:(e,t,i)=>{i.d(t,{Z:()=>d});var a=i(77094),n=i.n(a),s=(i(67294),i(24405)),o=i(47714),r=i(46951);const l=e=>{let{title:t,subtitle:i,on:a,onChange:l,disabled:d,style:c}=e;const u=(0,s.y)((()=>({container:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1}})),[]);return n()("div",{style:{...u.container,...c}},void 0,n()("div",{style:u.title},void 0,t,n()(r.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"}},void 0,i)),n()(o.Z,{on:a,disabled:d,onClick:l}))};l.defaultProps={disabled:!1,style:{}};const d=l},30676:(e,t,i)=>{i.d(t,{F:()=>m});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=i(67294),l=i.n(r),d=i(28350),c=i(48762),u=i(93686);function m(e){const{teamStore:t}=e,{name:i}=(0,d.VK)((()=>({name:t.getName()})),[t]);return l().createElement(c.Z,n()({},e,{icon:o()(u.p,{size:14,store:t,disabled:!0}),title:i}))}},25854:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ie});var a=i(77094),n=i.n(a),s=i(77422),o=i.n(s),r=(i(33948),i(96486)),l=i.n(r),d=i(67294),c=i.n(d),u=i(83355),m=i(17215),p=i(32918),g=i(94044),h=i(5366),f=i(4708),v=i(65917),y=i(27006),S=i(54642),M=i(76464),b=i(64964),w=i(85834),C=i(21115);const T=e=>{const{environment:t,spaceStore:i,contextualInviteStore:a}=e,n=i.getRole();return!(!n||!(0,y.RN)(n))&&(!!a.hasGuests()&&(!i.getDisableMembershipRequests()&&(0,f.p1)(t)))},k=e=>{const{environment:t,spaceStore:i,contextualInviteStore:a}=e,n=i.getRole();return!(!n||!(0,y.dy)(n))&&(!!a.hasGuests()&&(0,C.lw)(t))},Z=async e=>{const{environment:t,contextualInviteStore:i}=e,{invitedEmailToUserIdMap:a}=i.state,n=[],s=[];for(const o of i.state.invitedUsers){if(!o.isGuest)continue;const e=await A(t,o,a);e?n.push({type:"existingUser",value:{id:e,email:o.email,version:1}}):s.push(o.email)}return{inviteTargets:n,unknownEmails:s}},A=async(e,t,i)=>{let a=t.id;if(a||(a=i[t.email]),!a){const i=await S.findUser(e,{email:t.email});if("failed"!==i.type){const e=i.data;e.value&&(a=e.value.value.id)}}return a},I=(e,t)=>{0!==t.length&&b.oV({label:e.formatMessage({id:"contextual_invite.request_members_failure",defaultMessage:"Failed to request {users} to become members",description:"Client side message shown when the request invitees to become members fails on the server side."},{users:_(t,e)})})},P=(e,t)=>{0!==t.length&&b.oV({label:e.formatMessage({id:"contextual_invite.contextual_invite_failure",defaultMessage:"Failed to invite to {users} as members",description:"Client side message shown when the invite guests as members fails on the server side."},{users:_(t,e)})})},_=(e,t)=>1===e.length?e[0].email:2===e.length?t.formatMessage({id:"contextual_invite.toast.two_users",defaultMessage:"{user1} and {user2}",description:"Client side message shown when the invite is for two users."},{user1:e[0].email,user2:e[1].email}):e.length>2?t.formatMessage({id:"contextual_invite.two_users",defaultMessage:"{user1}, and {numOfOtherUsers} others",description:"Client side message shown when the invite is for more than 2 users."},{user1:e[0].email,numOfOtherUsers:e.length-1}):"";var x=i(75472),F=i(65598),B=i(38755),E=i(27832),D=i(52878),R=i(19757),L=i(53397),O=i(97880),N=i(50906),U=i(72693),W=i(14947),V=i(40039),z=i(37235),G=i(46951);class H extends u.Z{constructor(){super(...arguments),o()(this,"storeTypes",{contextualInviteStore:w.ZP}),o()(this,"containerStyle",{padding:12,display:"flex",flexDirection:"column",gap:16}),o()(this,"iconStyle",{width:20,height:20,fill:this.theme.lightIconColor})}didMount(){N.trackOpenShareWorkspaceInvite(this.environment,this.getContextualInviteAnalyticsData())}renderComponent(){const{contextualInviteStore:e}=this.stores,t=e.getGuestEmails(),i=e.state.selection;if(!t.length)return null;const{expanded:a}=e.state;return n()("div",{style:this.containerStyle},void 0,n()("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},void 0,n()("div",{},void 0,n()(G.Z,{style:{fontWeight:600}},void 0,n()(h.FormattedMessage,{id:"ContextualInvite.send_guest_invite.title",defaultMessage:"Invite to page or workspace?",description:"Title for the invitation modal asking what user wants to share with these emails"})),this.renderEmailSubtitle(t)),n()(U.Z,{isLarge:!0,onClick:()=>{this.handleInviteClick()}},void 0,i===w.uq.page_guest?n()(h.FormattedMessage,{id:"ContextualInvite.send_guest_page_invite.button",defaultMessage:"Done",description:"Title for the invitation modal confirming that the invitees will be invited"}):n()(h.FormattedMessage,{id:"ContextualInvite.send_guest_invite.button",defaultMessage:"Invite",description:"Title for the invitation modal confirming that the invitees will be invited"}))),n()("div",{style:{display:"flex",gap:8,flexDirection:"column"}},void 0,a?this.renderExpandedOptions():this.renderInitialOptions()))}renderEmailSubtitle(e){return n()(G.Z,{isSmall:!0,isSecondaryColor:!0},void 0,1===e.length?e[0]:n()(z.Z,{placement:z.Z.Placement.Bottom,render:t=>c().createElement("span",t,n()(h.FormattedMessage,{id:"ContextualInvite.send_guest_invite.subtitle",defaultMessage:"{firstEmail}, {numOfEmails} more",values:{firstEmail:e[0],numOfEmails:e.length-1},description:"Subtitle for the invitation modal where it shows an example email which is invited and says how many additional people are invited"})),renderTooltip:()=>c().createElement(c().Fragment,null,e.map((e=>n()("div",{},void 0,e))))}))}renderInitialOptions(){const{selection:e}=this.stores.contextualInviteStore.state;return"page_guest"===e?this.renderPageGuestButton({state:"collapsed",onClick:()=>this.expand()}):this.renderWorkspaceMemberButton({state:"collapsed",onClick:()=>this.expand()})}renderRequestMemberOptions(){const{selection:e}=this.stores.contextualInviteStore.state,t=[w.uq.request_workspace_member,w.uq.page_guest],i={[w.uq.request_workspace_member]:this.renderRequestWorkspaceMemberButton({state:e===w.uq.request_workspace_member?"selected":"none",onClick:()=>this.selectRequestWorkspaceMemberOption()}),[w.uq.page_guest]:this.renderPageGuestButton({state:e===w.uq.page_guest?"selected":"none",onClick:()=>this.selectPageGuestOption()})};return t.map((e=>({...i[e],key:{option:e}})))}renderInviteMemberOptions(){const{order:e,selection:t}=this.stores.contextualInviteStore.state,i={[w.uq.workspace_member]:this.renderWorkspaceMemberButton({state:t===w.uq.workspace_member?"selected":"none",onClick:()=>this.selectWorkspaceMemberOption()}),[w.uq.page_guest]:this.renderPageGuestButton({state:t===w.uq.page_guest?"selected":"none",onClick:()=>this.selectPageGuestOption()})};return e.map((e=>({...i[e],key:{option:e}})))}renderSpaceIcon(){const{device:e}=this.environment,{spaceStore:t}=this.props,i=(0,B.getSpaceIcon)(this.environment,t),a=this.getSpaceName();return i||a?n()(V.Z,{disabled:!0,icon:i,isEmptyPage:!1,title:a,size:e.isMobile?24:20,style:{color:this.theme.regularTextColor}}):L.Z.folder(this.iconStyle)}getSpaceName(){const{spaceStore:e}=this.props;return(0,B.getSpaceName)(this.environment,e)}renderExpandedOptions(){const{inviteStage:e}=this.stores.contextualInviteStore.state;return e===w.TG.request_workspace?this.renderRequestMemberOptions():this.renderInviteMemberOptions()}renderWorkspaceMemberButton(e){const{state:t,onClick:i}=e;return n()(q,{icon:this.renderSpaceIcon(),title:n()(h.FormattedMessage,{defaultMessage:"Share this workspace",id:"ContextualInvite.share_this_workspace.title",description:"Title for the button to tell the inviter that they are giving access to the current workspace"}),subtitle:n()(h.FormattedMessage,{defaultMessage:"These people will have access to all content shared with workspace members in {workspaceName}. Adds new emails as billable members.",values:{workspaceName:this.getSpaceName()},id:"ContextualInvite.share_this_workspace.subtitle2",description:"Subtitle for the button to tell the inviter that they are giving member access of the workspace to the invitee"}),state:t,onClick:i})}renderRequestWorkspaceMemberButton(e){const{state:t,onClick:i}=e;return n()(q,{icon:this.renderSpaceIcon(),title:n()(h.FormattedMessage,{defaultMessage:"Request invite to workspace",id:"ContextualInvite.request_invite_workspace.title",description:"Title for the button to tell the inviter that they are requesting an invite for invitee to the current workspace."}),subtitle:n()(h.FormattedMessage,{defaultMessage:"Sends a request to admin to invite as a workspace member.",id:"ContextualInvite.request_invite_workspace.subtitle2",description:"Subtitle for button to tell the inviter that they are requesting an invite for invitee to the current workspace."}),state:t,onClick:i})}renderPageGuestButton(e){const{device:t}=this.environment,{state:i,onClick:a}=e,{blockStore:s}=this.props,o=s.hasIcon()?n()(V.Z,{disabled:!0,icon:s.getIcon(),isEmptyPage:!1,size:t.isMobile?24:20,style:{color:this.theme.regularTextColor}}):L.Z.fileAttachment(this.iconStyle);return n()(q,{icon:o,title:n()(h.FormattedMessage,{defaultMessage:"Only share this page",id:"ContextualInvite.share_this_page.title",description:"Title for the button to tell the inviter that they are giving access to the current page"}),subtitle:n()(h.FormattedMessage,{defaultMessage:"These people will only have access to this page. They will not be added to your bill.",id:"ContextualInvite.share_this_page.subtitle2",description:"Subtitle for the button to tell the inviter that they are giving guest access of the workspace to the invitee"}),state:i,onClick:a})}expand(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,expanded:!0})}selectWorkspaceMemberOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:w.uq.workspace_member})}selectRequestWorkspaceMemberOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:w.uq.request_workspace_member})}selectPageGuestOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:w.uq.page_guest})}async handleInviteClick(){const{contextualInviteStore:e}=this.stores,{spaceStore:t,blockStore:i,intl:a}=this.props;switch(e.state.inviteStage){case w.TG.share_page:case w.TG.closed:break;case w.TG.request_workspace:N.trackClickMembershipRequest(this.environment,this.getContextualInviteAnalyticsData()),await(async e=>{const{environment:t,spaceStore:i,originId:a,contextualInviteStore:n,intl:s}=e,{selection:o}=n.state;if("page_guest"===o||!n.hasGuests())return void n.reset();const{inviteTargets:r,unknownEmails:l}=await Z({environment:t,contextualInviteStore:n}),d={...n.state};n.reset();try{const e=r.map((e=>S.requestAccess(t,{type:"actor-to-space",forActorId:e.value.id,spaceId:i.id,message:void 0,attributes:{origin_id:a,origin_type:"share_menu",origin_table:"block",add_page_permission_on_approval:!1}})));await Promise.all(e)}catch(c){I(s,d.invitedUsers),v.log({level:"error",from:"contextualInviteHelpers",type:"requestMembers.inviteTargets",data:{miscDataToConvertToString:{...d,inviteTargets:r}}})}finally{l.length&&v.log({level:"error",from:"contextualInviteHelpers",type:"requestMembers.unknownUserId",data:{miscDataToConvertToString:{...d,unknownEmails:l}}})}})({environment:this.environment,spaceStore:t,originId:i.id,contextualInviteStore:e,intl:a});break;case w.TG.share_workspace:N.trackClickShareWorkspace(this.environment,this.getContextualInviteAnalyticsData()),await(async e=>{const{environment:t,spaceStore:i,contextualInviteStore:a,intl:n}=e,{selection:s,flowId:o}=a.state;if("page_guest"===s||!a.hasGuests())return void a.reset();const{inviteTargets:r,unknownEmails:l}=await Z({environment:t,contextualInviteStore:a}),d={...a.state};a.reset();const c=(0,C.CM)(t),u=c&&(0,C.o9)(c)?"editor":"read_and_write";try{await M.n_({environment:t,store:i,inviteTargets:r,inviteRole:u,isOnboarding:!1,invite:{inviteOrigin:"page_contextual_invite",inviteFlowId:o}})}catch(m){P(n,d.invitedUsers),v.log({level:"error",from:"contextualInviteHelpers",type:"inviteMembers.inviteTargets",data:{miscDataToConvertToString:{...d,inviteTargets:r}}})}finally{l.length&&v.log({level:"error",from:"contextualInviteHelpers",type:"inviteMembers.unknownUserId",data:{miscDataToConvertToString:{...d,unknownEmails:l}}})}})({environment:this.environment,spaceStore:t,contextualInviteStore:e,intl:a});break;default:(0,O.t1)(e.state.inviteStage)}}getContextualInviteAnalyticsData(){const{contextualInviteStore:e}=this.stores,{state:t}=e,i=(0,C.CM)(this.environment),a=e.getGuestEmails();return{invite_flow_id:t.flowId,user_count:a.length,user_emails:a,invite_space_role_selection:t.selection,is_bot:!1,subscription_tier:i}}}class q extends u.Z{renderComponent(){const{device:e}=this.environment,{icon:t,title:i,subtitle:a,state:s,onClick:o}=this.props,r="selected"===s;return n()(W.Z,{focused:r,disabled:!1,mobileFeedback:e.isMobile,onClick:o,style:{borderWidth:1,borderStyle:"solid",borderColor:this.theme.regularDividerColor,borderRadius:5,...r&&{backgroundColor:this.theme.cardBackground}}},void 0,n()("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:10,paddingBottom:10,paddingLeft:12,paddingRight:12}},void 0,n()("div",{style:{display:"flex",justifyContent:"center",width:24,height:24,marginTop:5,marginRight:12}},void 0,t),n()("div",{style:{marginRight:"auto"}},void 0,n()(G.Z,{},void 0,i),n()(G.Z,{isMultiline:!0,isSmall:!0,isSecondaryColor:!0},void 0,a)),n()("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginRight:4}},void 0,"selected"===s&&L.Z.thinCheck({width:16,height:16,fill:this.theme.lightIconColor}),"collapsed"===s&&L.Z.chevronDownThin({width:16,height:16,fill:this.theme.lightIconColor}))))}}const K=(0,h.injectIntl)(H);var j=i(62727),Y=i(21523),Q=i(71202),J=i(99444),X=i(42001),$=i(66722);class ee extends u.Z{constructor(){super(...arguments),o()(this,"storeTypes",{universalInviteStore:D.Z}),o()(this,"renderEmailInput",this.createComputedStore((()=>"milestone_2"===this.props.mode)))}renderComponent(){const{universalInviteStore:e}=this.stores,{permissionsInviteStore:t,contextualInviteStore:i}=e.state,a=e.stage,{spaceStore:s}=this.props;if(this.environment.device.isMobile||a===w.TG.closed)return null;if(!(0,F.Mm)(this.props.store)&&(a===w.TG.share_workspace||a===w.TG.request_workspace))return n()(K,{blockStore:this.props.store,spaceStore:s,contextualInviteStore:i});if(a===w.TG.share_page){const a={...this.props,renderInShareMenu:!0,permissionsInviteStore:t,contextualInviteStore:i,onInviteClick:()=>{(e=>{const{environment:t,spaceStore:i,contextualInviteStore:a}=e;if(T({environment:t,spaceStore:i,contextualInviteStore:a}))return a.startRequestMembership(),void S.setSeenMembershipRequests(t,{spaceId:i.id});k({environment:t,spaceStore:i,contextualInviteStore:a})?a.startWorkspaceInvite():a.setState({...a.state,inviteStage:w.TG.closed})})({environment:this.environment,spaceStore:s,contextualInviteStore:i})},onInviteComplete:e=>{(e=>{const{success:t,intl:i,contextualInviteStore:a}=e,n=a.state.invitedUsers;0!==n.length&&(t?b.oV({label:i.formatMessage({id:"contextual_invite.permission_invite_success3",defaultMessage:"Successfully sent invites to {users}",description:"Client side message shown when the page invite succeeds on the server side."},{users:_(n,i)})}):(b.oV({label:i.formatMessage({id:"contextual_invite.permission_invite_failure",defaultMessage:"Failed to send invites to {users}",description:"Client side message shown when the page invite fails on the server side."},{users:_(n,i)})}),a.reset()))})({success:e,intl:this.props.intl,contextualInviteStore:i})},onCancel:async()=>{await(0,x.Aw)(this.environment,t.state)||e.reset()}};return this.renderEmailInput.state?c().createElement(te,a):c().createElement(J.default,a)}}}class te extends J.PermissionsInviteBase{constructor(){super(...arguments),o()(this,"inviteTargetLength",this.createComputedStore((()=>this.stores.permissionsInviteStore.state.inviteTargets.length))),o()(this,"blockTitle",this.createComputedStore((()=>{if((0,F.Mm)(this.props.store))return"";const e=this.props.store,t=e.getValue();if(!t)return"";const i=m.T5({table:e.table,value:t,getRecordValue:e.getRecordValue,userTimeZone:p.x7,intl:this.props.intl});return i||m.Q2({table:e.table,value:t,getRecordValue:e.getRecordValue,userTimeZone:p.x7,intl:this.props.intl})}))),o()(this,"handleInviteInputSubmit",(async()=>{const{permissionsInviteStore:e}=this.stores;"invitee"===e.state.inputFocus?e.setState({...e.state,inputFocus:"email-content"}):await super.handleInviteInputSubmit()})),o()(this,"resetFocusOnClickEmpty",(e=>{const{permissionsInviteStore:t}=this.stores;e.currentTarget===e.target&&t.setState({...t.state,inputFocus:"none"})}))}renderComponent(){return this.renderInShareMenu.state?this.renderUniversalInviteInner():super.renderComponent()}renderUniversalInviteInner(){const{permissionsInviteStore:e}=this.stores;return n()("div",{style:this.getContainerStyle(),onClick:this.resetFocusOnClickEmpty},void 0,n()($.ZP,{popupType:$.kQ.Popup,alignmentToOrigin:R.v2.Start,placementToOrigin:R.ug.Bottom,open:"invitee"===e.state.inputFocus,originGap:10,disableMouseCapture:!0,forceRemeasureStore:this.inviteTargetLength,origin:super.renderHeader(),onDismiss:()=>{e.setState({...e.state,inputFocus:"email-content"})},render:()=>{const e=super.renderSearchRequest(),t={menuType:Q.Z.MenuType.Popup,disableScroller:!1};return n()("div",{},void 0,c().createElement(Q.Z,t,e))},style:{width:360}}),this.renderEmailMessageInput(),this.renderActions())}renderEmailMessageInput(){const{permissionsInviteStore:e}=this.stores,t=this.getEmailMessage(),{inputFocus:i,emailMessage:a}=e.state,s=a.length/g.vr>=.8,o=(0,g.TQ)(a),r=s||o,l=(0,f._6)(this.environment),d="email-content"===i;return n()(j.Z,{textarea:!0,value:a,focus:d,focusInitial:!1,maxlength:g.vr,onFocus:()=>{e.setState({...e.state,inputFocus:"email-content"})},style:{background:d?"none":this.theme.inputBackground,alignItems:"flex-start",paddingLeft:12,paddingRight:12,paddingTop:8,paddingBottom:r?34:12},inputStyle:{minHeight:l?80:100},placeholder:t,onChange:t=>{e.setState({...e.state,emailMessage:t.target.value})},right:r&&this.renderMessageWarning({shouldShowLengthWarning:s,shouldShowLinkWarning:o}),isRightLastElementOfInput:!0,onSubmit:async()=>{await super.handleInviteClick()}})}renderActions(){return n()("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"center",width:"100%"},onClick:this.resetFocusOnClickEmpty},void 0,n()("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"flex-end",gap:8}},void 0,this.renderDesktopInputRightInnerButton({isLarge:!1}),n()(X.Z,{style:{minWidth:g.UF,justifyContent:"center"},isLarge:!1,isLightGray:!0,onClick:()=>{var e,t;null===(e=(t=this.props).onCancel)||void 0===e||e.call(t)}},void 0,n()(h.FormattedMessage,{defaultMessage:"Cancel",id:"ContextualInvite.permissions_invites.button.cancel",description:"Button to cancel"}))),n()(Y.Z,{style:{paddingLeft:0,paddingRight:0},disableHover:!0}))}renderMessageWarning(e){const{permissionsInviteStore:t}=this.stores,{shouldShowLengthWarning:i,shouldShowLinkWarning:a}=e;return n()("span",{style:{fontSize:12,color:this.theme.lightTextColor,position:"absolute",bottom:8,left:12}},void 0,i&&n()(h.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",description:"Message showing how many characters out of the maximum the user has already typed.",values:{characters:t.state.emailMessage.length,maxCharacters:g.vr}}),i&&a&&" · ",a&&n()(h.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning",description:"Warning message to the user that hyperlinks will be removed from their custom message."}))}getEmailMessage(){var e,t;const{currentUserStore:i,currentSpaceStore:a}=E.default.state,{permissionsInviteStore:n}=this.stores,{intl:s}=this.props,{inviteTargets:o}=n.state,r=!n.state.isInviteTargetsEmpty&&l().every(o,x.OA);if(!a)return s.formatMessage(g.VX.default);const d=(null==i||null===(e=i.state.value)||void 0===e?void 0:e.name)||(null==i||null===(t=i.state.value)||void 0===t?void 0:t.email),c=(0,B.getSpaceName)(this.environment,a);if(!d||!c)return s.formatMessage(g.VX.default);return(0,g.jm)({includeOptional:!1,isGuest:r,emailProps:{userName:d,pageName:this.blockTitle.state,spaceName:c},intl:this.props.intl})}getContainerStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",minHeight:52,paddingTop:10,paddingBottom:10,paddingLeft:e.getSafePaddingLeftCSS(14),paddingRight:e.getSafePaddingRightCSS(14),flexDirection:"column",gap:10}}}const ie=(0,h.injectIntl)(ee)},25735:(e,t,i)=>{i.d(t,{Y:()=>p});var a=i(77094),n=i.n(a),s=(i(33948),i(67294)),o=i.n(s),r=i(28350),l=i(24405),d=i(5366),c=i(16639),u=i(27832),m=i(41493);function p(e){const t=(0,l.y)((e=>({container:{marginBottom:4},userContainer:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4},user:{flexGrow:1},moreMessage:{marginLeft:2,marginTop:4,color:e.mediumInvertedTextColor}})),[]),{group:i,limit:a,noMembersMessage:s}=e,[{currentSpaceStore:p}]=(0,r.oR)(u.default),{countRemainingUsers:g,limitedUserValues:h}=(0,r.VK)((()=>(0,c.rm)({group:i,spaceStore:p,limit:a})),[i,p,a]);return 0===h.length?o().createElement(o().Fragment,null,s):n()("div",{style:t.container},void 0,h.map((e=>n()("div",{style:t.userContainer},e.id,n()(m.Z,{style:t.user,userValue:e,avatarSize:18})))),g>0&&n()("div",{style:t.moreMessage},void 0,n()(d.FormattedMessage,{id:"blockPermissionsSettings.groupPermissionUsers.tooltip",defaultMessage:"{countRemainingUsers} more…",values:{countRemainingUsers:g}})))}},29127:(e,t,i)=>{i.r(t),i.d(t,{default:()=>oa});var a=i(77094),n=i.n(a),s=i(77422),o=i.n(s),r=(i(33948),i(73210),i(67294)),l=i.n(r),d=i(83355),c=i(18466),u=i(70203),m=i(63143),p=i(50906),g=i(26111),h=i(87531),f=i(74647),v=i(95477),y=i(69988),S=i(22889),M=i(86785),b=i(65598),w=i(80084),C=i(15517),T=i(23537),k=i(27832),Z=i(72087),A=i(32470),I=i(55320),P=i(49085),_=i(62965);class x extends P.Z{getInitialState(){return{localResults:void 0,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0,serverResultsAllLoaded:!1,errorState:B,jumpToResult:void 0}}setState(e){const t={...this.instanceState};if(!(0,_.Z)(this.instanceState,t))return;const i=function(e){const{newState:t,priorState:i}=e,{localResults:a,serverError:n,serverResultsLoading:s}=t,o=Boolean(a),r=s?void 0:n;if(!o&&s)return!i.errorState.isLoading&&i.errorState.showMajorError?i.errorState:{isLoading:s};if(o)return{hasLocalResults:o,serverError:r,isLoading:!1,showMajorError:!1};return r?{hasLocalResults:o,serverError:r,isLoading:!1,showMajorError:!0}:{hasLocalResults:o,serverError:r,isLoading:!1,showMajorError:!1}}({newState:e,priorState:t});super.setState({...e,errorState:i})}}function F(e){const t=Boolean(e.localResults),i=Boolean(e.serverResults)&&!e.serverResultsLoading;return t||i||!1}const B={showMajorError:!1,isLoading:!1,hasLocalResults:!1,serverError:void 0};const E=x;var D=i(30857),R=i(29026),L=i(67719),O=i(97464),N=i.n(O),U=i(96486),W=i.n(U),V=i(480),z=i(28350),G=i(24405),H=i(59054),q=i(29477),K=i(43250),j=i(87279),Y=i(59488),Q=i(88632),J=i(69327),X=i(29798),$=i(69454),ee=i(69972),te=i(52377),ie=i(37770),ae=i(71202),ne=i(15282),se=i(97880),oe=i(82990),re=i(5366),le=i(15447),de=i(12318),ce=i(25584),ue=i(12235),me=i(83071),pe=i(53772),ge=i(75024),he=i(86646),fe=i(47966);class ve extends d.Z{constructor(){super(...arguments),o()(this,"openSidebar",(()=>R.ZP.setState({...R.ZP.state,isSidebarOpen:!0}))),o()(this,"styles",{footer:()=>{const{device:e}=this.environment;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:e.isMobile?oe.Z.fontSize.UIRegular.mobile:oe.Z.fontSize.UIRegular.desktop}},footerWrapper:{flexShrink:0},footerText:{color:this.theme.lightTextColor,fontSize:ge.yv(this.environment,"UISmall"),...oe.Z.textOverflowStyle},footerDebugButton:{...ye(this.theme),marginRight:6}})}renderComponent(){const e=this.styles;return n()("footer",{style:e.footerWrapper},void 0,n()(me.Z,{topBorder:!0,style:e.footer(),disableDesktopPadding:!0},void 0,l().createElement(he.Z,N()({},this.props,{style:e.footerText})),(0,pe.x)(v.Z)&&!R.ZP.state.isSidebarOpen&&n()(fe.Z,{onClick:this.openSidebar,style:e.footerDebugButton},void 0,"Open Debug Sidebar")))}}const ye=e=>({fontSize:12,color:e.lightTextColor,marginLeft:6,paddingRight:4,paddingLeft:4,height:24}),Se=ve;var Me=i(53397),be=i(62134);function we(){const e=(0,V.O7)(),t=(0,re.useIntl)(),i=(0,G.y)((t=>({upDownIcon:{marginRight:4,marginBottom:-2,display:"inline",width:12,height:12,fill:t.mediumIconColor},enterIcon:{marginRight:4,marginBottom:-2,display:"inline",width:11,height:11,fill:t.mediumIconColor},commandGlyph:{fontSize:.75*ge.yv(e,"UIRegular"),paddingRight:1,color:t.lightTextColor},footerText:{fontSize:ge.yv(e,"UISmall"),color:t.lightTextColor,...oe.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16}})),[e]),a={...ge.mK,...i.footerText},{command:s}=be.fg(e);return n()("ul",{style:a},void 0,n()("li",{style:i.inlineHint},void 0,Me.Z.arrowsUpDownThick(i.upDownIcon),t.formatMessage({id:"searchFooter.helpText.selectHint",defaultMessage:"Select"})),n()("li",{style:i.inlineHint},void 0,Me.Z.enter(i.enterIcon),t.formatMessage({id:"searchFooter.helpText.openHint",defaultMessage:"Open"})),n()("li",{style:i.inlineHint},void 0,n()("span",{style:i.commandGlyph},void 0,s),Me.Z.enter(i.enterIcon),e.device.isElectron?t.formatMessage({id:"searchFooter.helpText.openNewWindow",defaultMessage:"Open in a new window"}):t.formatMessage({id:"searchFooter.helpText.openNewTab",defaultMessage:"Open in a new tab"})))}var Ce=i(94184),Te=i.n(Ce),ke=i(21202),Ze=i(92338),Ae=i(98742),Ie=i(21115),Pe=i(16402),_e=i(77907),xe=i(95155),Fe=i(80270),Be=i(57248),Ee=i(48762),De=i(74538),Re=i(40039),Le=i(8934),Oe=i(79029),Ne=i(37235);class Ue extends d.Z{constructor(){super(...arguments),o()(this,"styles",{title:{fontWeight:oe.Z.fontWeight.medium,lineHeight:"20px"},jumpToTitle:{fontWeight:oe.Z.fontWeight.medium,fontSize:15,lineHeight:"20px"},menuItem:{minHeight:36,paddingTop:this.environment.device.isMobile?12:8,paddingBottom:this.environment.device.isMobile?12:8},menuItemWithCaption:{minHeight:36,paddingTop:this.environment.device.isMobile?12:8,paddingBottom:this.environment.device.isMobile?8:4},textWrapper:{marginLeft:10,alignItems:void 0,flex:void 0,width:"100%"},inlineTextWrapper:{alignItems:"baseline"},highlight:{fontWeight:oe.Z.fontWeight.medium},enterIcon:{height:14,width:14},caption:{marginTop:1},debugHit:{fontFamily:"monospace",marginRight:-28,marginLeft:-28},timestamp:{fontSize:oe.Z.fontSize.UISmall.desktop,fontWeight:oe.Z.fontWeight.regular},toolTip:{maxWidth:300},toolTipTitle:{fontWeight:oe.Z.fontWeight.medium,fontSize:oe.Z.fontSize.UISmall.desktop},toolTipText:{fontWeight:oe.Z.fontWeight.medium,fontSize:oe.Z.fontSize.UISmall.desktop,marginLeft:0,paddingRight:20},toolTipValue:{fontSize:oe.Z.fontSize.UISmall.desktop,fontWeight:oe.Z.fontWeight.regular},toolTipMenuItem:{minHeight:20}})}renderComponent(){var e;const{focused:t,isLastInSection:i,isBeforeFocused:a,inline:s,className:o,result:r}=this.props,d=this.styles,c=this.getThemeColors(),u={...null!=r&&null!==(e=r.highlight)&&void 0!==e&&e.text||!this.hasPath()?d.menuItem:d.menuItemWithCaption,...!s&&!i&&!a&&!t&&c.menuItemBorder},m={...d.caption,...c.caption},p={...d.timestamp,...c.timestamp},g={...d.textWrapper,...this.props.inline&&d.inlineTextWrapper},h={title:this.renderTitle(),icon:this.renderIcon(),caption:this.renderCaption(),body:this.renderPreview(),right:this.renderRight(t),rightStyle:t?void 0:p,dontShrinkRight:!0,captionStyle:m,style:u,textWrapperStyle:g,className:Te()("notranslate",o),buttonStyle:{paddingLeft:2},hoveredStyle:{background:this.theme.buttonHoveredBackground}},f=(0,Ie.CM)(this.environment),y="personal"===f||"personal_free"===f||"free"===f;if(!("local"===v.Z.env||"development"===v.Z.env)||y)return l().createElement(Ee.Z,N()({},this.props,h,{disableTransition:!0,ignoreLocalHoverState:!0}));const{hasHoveredForContext:S}=R.ZP.state,M=S?50:600;return n()(Ne.Z,{delayThreshold:M,placement:Ne.Z.Placement.Right,originGap:18,renderTooltip:()=>this.renderTooltip(),style:d.toolTip,render:e=>l().createElement(Ee.Z,N()({},this.props,h,{disableTransition:!0,ignoreLocalHoverState:!0},(0,Ae.Z)(e,this.props)))})}renderTooltip(){return R.ZP.update((e=>({...e,hasHoveredForContext:!0}))),n()(Be.Z,{store:this.props.store})}renderTitle(){const{store:e,result:t,placeholder:i,index:a}=this.props,s=this.styles,o=this.getThemeColors(),r="on"===xe.default.getGroup("navigational_search_improvements"),l={...(null==t?void 0:t.sources.includes(Ze.vp.Local))&&0===a&&r?s.jumpToTitle:s.title,...this.hasAnyHighlight()&&o.highlightedTitle},d=[];if(t&&t.highlight)if(d.push(...(0,y.fe)(t.highlight.pathText)),this.usesFullPageIndexingHighlight())d.push(...(0,y.fe)(t.highlight.title));else{Fe.Z.createChildStore(this.props.store,{table:ke.iU,id:t.id,spaceId:t.spaceId}).isNavigableBlock()&&d.push(...(0,y.fe)(t.highlight.text))}const c=this.getWordHighlighter({words:d});return n()("div",{style:{display:"flex",flexDirection:"row",...l}},void 0,A.ZP.state.showDebugInfo&&void 0!==a&&"".concat(a+1,". "),n()(Oe.Z,{style:l,store:e,placeholder:i,highlighter:c}))}renderRight(e){return l().createElement(l().Fragment,null,A.ZP.state.showDebugInfo&&this.renderDebugRight(),e?this.renderEnterIcon():this.renderTimestamp())}renderTimestamp(){const{result:e,lastViewed:t}=this.props;if(!e&&t)return(0,Pe.IS)(t,{useCompactFormat:!0})}renderDebugRight(){var e;const{result:t,index:i,originalPosition:a}=this.props,n=null==t||null===(e=t.sources)||void 0===e?void 0:e.map((e=>e===Ze.vp.Local?["💻"]:e===Ze.vp.ElasticSearch?["🌐"]:e===Ze.vp.Postgres?["🐘"]:void(0,se.t1)(e))),s=void 0===i||void 0===a?" ":i>a?"⬇️":i<a?"⬆️":void 0;return l().createElement(l().Fragment,null,s,n)}renderIcon(){const{store:e}=this.props;return l().createElement(l().Fragment,null,n()(Re.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:20,largeIcon:!0}))}renderCaption(){const{store:e,result:t,inline:i}=this.props;if(!this.hasPath())return;const a=this.getWordHighlighter({words:(0,y.fe)(t&&t.highlight&&t.highlight.pathText),removeDuplicate:!0}),{device:s}=this.environment,o=i||s.isMobile?0:2;return l().createElement(l().Fragment,null,n()(Le.Z,{store:e,extraLength:o,showFullPathInTooltip:!0,highlighter:a}))}renderPreview(){const{result:e,debugLocal:t,debugHit:i}=this.props;return l().createElement(l().Fragment,null,(()=>{if(!e)return;if(!e.highlight)return;if(Fe.Z.createChildStore(this.props.store,{table:ke.iU,id:e.id,spaceId:e.spaceId}).isNavigableBlock()&&!this.usesFullPageIndexingHighlight())return;if(!e.highlight.text)return;const t=e.highlight.text,i=(0,y.ZP)(t);if(this.usesFullPageIndexingHighlight()){const t=e=>e.filter(y.il).map((e=>e[0].toLowerCase())),a=e=>void 0===e?[]:t((0,y.ZP)(e)),n=new Set([...a(e.highlight.title),...a(e.highlight.pathText)]);if(t(i).every((e=>n.has(e))))return}const a=this.styles,s=this.getThemeColors();return n()(De.Z,{text:t,highlighter:{tokenize:e=>(0,y.Vu)(i),style:{...a.highlight,...s.highlight}}})})(),t&&n()("div",{style:this.styles.debugHit},void 0,n()(_e.LazyAdminReactJson,{data:{debugLocal:t},defaultCollapsed:!0,jsonTreeRef:this.props.debugLocalRef,customCollapsedRenderers:[ze],showCopyButton:!1,showModalButton:!1})),i&&n()("div",{style:this.styles.debugHit},void 0,n()(_e.LazyAdminReactJson,{data:{debugHit:i},defaultCollapsed:!0,jsonTreeRef:this.props.debugAreaRef,customCollapsedRenderers:[Ve],showCopyButton:!0,showModalButton:!0})))}usesFullPageIndexingHighlight(){const{result:e,clusterInfo:t}=this.props;return e&&!e.sources.includes(Ze.vp.Local)&&(null==t?void 0:t.isFullPageIndexing)}getWordHighlighter(e){const{words:t,removeDuplicate:i}=e;if(0===t.length)return;const a={...this.styles.highlight,...this.getThemeColors().highlight},n=i?new Set:void 0;return{tokenize:e=>(0,y.XT)({text:e,patterns:t,uniqueTokenHighlighterContext:n}),style:a}}renderEnterIcon(){const{device:e}=this.environment,{focused:t}=this.props,i=this.styles,a=this.getThemeColors();if(e.isMobile)return;const n={...i.enterIcon,...a.enterIcon,opacity:t?1:0};return Me.Z.enter(n)}hasPath(){const{hidePath:e,store:t}=this.props;return!e&&(0,Le.L)(t)}hasAnyHighlight(){const{result:e}=this.props;if(!e)return!1;const{highlight:t}=e;return!!t&&Boolean(t.text||t.pathText)}getThemeColors(){return{highlightedTitle:{color:this.theme.mediumTextColor},menuItemBorder:{boxShadow:"0 1px 0 ".concat(this.theme.lightDividerColor)},highlight:{color:this.theme.regularTextColor},enterIcon:{fill:this.theme.mediumIconColor},caption:{color:this.theme.mediumTextColor},timestamp:{color:this.theme.lightTextColor},toolTipTitle:{color:this.theme.mediumTextColor},toolTipText:{color:this.theme.regularTextColor},toolTipValue:{color:this.theme.lightTextColor}}}}o()(Ue,"contextTypes",j.f);const We=Ue;function Ve(e){let{data:t}=e;if(!["_score","matched_queries"].every((e=>t[e])))return null;const{_score:i,matched_queries:a}=t;return{element:l().createElement(l().Fragment,null,i,a&&" ".concat(a.join(", "))),expanded:!1}}function ze(e){let{data:t}=e;const i=t;if(!i)return null;const{localSource:a}=i;return{element:l().createElement(l().Fragment,null,"from ".concat(a)),expanded:!1}}class Ge extends d.Z{constructor(){super(...arguments),o()(this,"storeTypes",{isLoadingRecents:de.default.of(!1),endOfRecentsReached:de.default.of(!1)}),o()(this,"renderComponent",(()=>{if(!le.X4.state)return;const{resultListStore:e}=this.props,{device:t}=this.environment,i=this.defaultViewStyles,{currentSpaceStore:a}=k.default.state;if(!a)return;const s=le.X4.state,o={};s.forEach((e=>{let{pageId:t,visitedAt:i}=e;return o[t]=i}));const r=new Map;s.map(((e,i)=>{const a=le._5(e.visitedAt),n="Today"!==a&&"Yesterday"!==a,s={key:"".concat(e.store.id,":").concat(i),action:t=>this.props.onSelect({store:e.store,action:t}),render:i=>l().createElement(We,N()({},i,{inline:!t.isMobile,store:e.store,hidePath:!1,lastViewed:n?o[e.store.id]:void 0,buttonStyle:{paddingLeft:1}}))};var d;r.has(a)?null===(d=r.get(a))||void 0===d||d.push(s):r.set(a,[s])}));const d=[];for(const[l,u]of r.entries()){const e=this.getMessageFromBucket(l),t={key:l,items:u,render:t=>n()(me.Z,{title:e,desktopTitleStyle:i.sectionHeader,disableDesktopPadding:!0,style:i.sectionMenuWithNewFilterBar},void 0,t.children)};d.push(t)}const c=!t.isMobile&&s.length>0;return l().createElement(l().Fragment,null,n()("div",{style:i.wrapper},void 0,n()(ce.Z,{type:ce.Z.Type.Vertical,store:e,initialFocus:this.getInitialFocus(),disableKeyboardArrowWrap:!0,sections:d,unfocusOnScroll:!0}),n()(ue.Z,{onChange:this.handleScrollOffsetChange})),c&&n()(Se,{title:n()(we,{})}))})),o()(this,"handleScrollOffsetChange",(e=>{this.getLastPageTimestamp()&&e<=200&&!this.stores.isLoadingRecents.get()&&!this.stores.endOfRecentsReached.get()&&this.loadMoreRecents()})),o()(this,"loadMoreRecents",W().throttle((async()=>{const e=this.getLastPageTimestamp(),{currentSpaceStore:t}=k.default.state,i=this.environment.currentUser.id,a=null==t?void 0:t.id;if(!i||!a||!e)return;this.stores.isLoadingRecents.set(!0);const n=await le.Od(e,{environment:this.environment,userId:i,spaceId:a});this.stores.isLoadingRecents.set(!1),n||this.stores.endOfRecentsReached.set(!0)}),300)),o()(this,"defaultViewStyles",{wrapper:{width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto"},sectionHeader:{fontWeight:oe.Z.fontWeight.semibold,marginBottom:7,marginLeft:2},sectionMenuWithNewFilterBar:{marginTop:0,marginBottom:16}})}getInitialFocus(){if(R.ZP.state.query.text.trim())return;const e=le.X4.state;return e&&e.length>0?1:0}getLastPageTimestamp(){const{currentSpaceStore:e}=k.default.state;if(!e)return;const t=J.Z.getWithoutSubscribing(e.id),i=t[t.length-1];return null==i?void 0:i.visitedAt}getMessageFromBucket(e){switch(e){case"Today":return n()(re.FormattedMessage,{id:"search.recentPagesTimeBuckets.today.text",defaultMessage:"Today",description:"Time buckets for the recent pages default view: Today"});case"Yesterday":return n()(re.FormattedMessage,{id:"search.recentPagesTimeBuckets.yesterday.text",defaultMessage:"Yesterday",description:"Time buckets for the recent pages default view: Yesterday"});case"Past Week":return n()(re.FormattedMessage,{id:"search.recentPagesTimeBuckets.pastWeek.text",defaultMessage:"Past Week",description:"Time buckets for the recent pages default view: Past 30 Days"});case"Past 30 Days":return n()(re.FormattedMessage,{id:"search.recentPagesTimeBuckets.past30Days.text",defaultMessage:"Past 30 Days",description:"Time buckets for the recent pages default view: Past 30 Days"});case"Older":return n()(re.FormattedMessage,{id:"search.recentPagesTimeBuckets.older.text",defaultMessage:"Older",description:"Time buckets for the recent pages default view: Older"})}(0,se.t1)(e)}}const He=Ge;var qe=i(15157),Ke=i(61766),je=i(15510),Ye=i(11082),Qe=i(84619),Je=i(31299),Xe=i(33929),$e=i(255),et=i(24042),tt=i(85567),it=i(98707);const at=(0,re.defineMessages)({searchPages:{defaultMessage:"Search pages",id:"searchPageFilter.searchTokenFilter.tokenInput.placeholder"},selectAPage:{defaultMessage:"Select a page",id:"searchPageFilter.searchTokenFilter.resultSection.title"}});class nt extends d.Z{constructor(){super(...arguments),o()(this,"renderFilterListItem",((e,t)=>{let{disabled:i,onRemove:a,onClick:s}=t;const o=this.styles,r=this.createBlockStore(e),l=n()($e.Z,{disabled:i,onClick:a});return n()(et.Z,{disabled:i,focused:!1,store:r,right:l,style:o.menuItem,desktopTitleStyle:o.menuItemTitle,onClick:s})})),o()(this,"renderItemForSummary",(e=>n()(Oe.Z,{store:this.createBlockStore(e),shouldWrap:!0,maxLength:50}))),o()(this,"renderToken",((e,t)=>{const{blockIds:i}=this.props,a=this.tokenStyles,s=1===i.length,o=this.createBlockStore(e),r=n()("div",{style:a.token},void 0,n()(Re.Z,{disabled:!0,icon:o.getIcon(),isEmptyPage:!1,size:20,style:a.icon}),n()(Oe.Z,{store:o}));return n()(tt.Z,{format:this.environment.device.isMobile?Qe.l.Large:Qe.l.Small,value:r,showRemoveButton:!0,onClickRemove:t.onRemove,isSingle:s,shouldShrink:!0,backgroundColor:"transparent",shouldWrap:!1},e)})),o()(this,"renderResultMenuItem",((e,t)=>{const i=this.createBlockStore(e);return l().createElement(et.Z,N()({},t,{key:e,store:i}))})),o()(this,"performRequest",(async e=>{let{query:t,current:i}=e;const{currentSpaceStore:a}=k.default.state;if(!a)return[];const n=t?(await Je.nJ({environment:this.environment,query:t,limit:20,spaceId:a.id,requireEditPermissions:!1,excludeTemplates:!1,source:"quick_find_ancestor_filter"})).results:le.X4.state.map((e=>e.pageId)),s=new Set(i);return n.filter((e=>!s.has(e)))})),o()(this,"createBlockStore",(e=>{const{parentStore:t}=this.props;return Fe.Z.createChildStore(t,{table:ke.iU,id:e})})),o()(this,"styles",{menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{fill:"currentColor"}}),o()(this,"tokenStyles",{token:{display:"flex",alignItems:"center"},icon:{marginRight:4}})}renderComponent(){const{mode:e,title:t,blockIds:i,onChange:a,disabled:s,focused:o,onMenuDismiss:r}=this.props;return n()(it.Z,{mode:e,hasItemsSelected:(null==i?void 0:i.length)>0,title:t,icon:Me.Z.searchInPage,iconStyles:this.styles.recordIcon,items:i,onChange:a,focused:o,renderFilter:this.renderFilterListItem,renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:n()(re.FormattedMessage,{defaultMessage:"Add another page",id:"searchPageFilter.searchTokenFilter.addAPage.button"}),labelText:{title:t,tokenInputPlaceholder:Xe.default.formatMessage(at.searchPages),componentDebugName:"SearchPageFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,disabled:s,onMenuDismiss:r})}}const st=nt;var ot=i(83890),rt=i(29369),lt=i(20431),dt=i(30676),ct=i(35223);class ut extends d.Z{constructor(){super(...arguments),o()(this,"renderFilterListItem",((e,t)=>{let{disabled:i,onRemove:a,onClick:s}=t;const o=this.styles,r=this.createTeamStore(e),l=n()($e.Z,{disabled:i,onClick:a});return n()(dt.F,{disabled:i,focused:!1,teamStore:r,right:l,style:o.menuItem,desktopTitleStyle:o.menuItemTitle,onClick:s},e)})),o()(this,"renderItemForSummary",(e=>{var t;return null===(t=this.createTeamStore(e).state.value)||void 0===t?void 0:t.name})),o()(this,"renderAvatarFactory",(e=>{const t=e.getIcon();return e=>n()(Re.Z,{disabled:!0,icon:t,isEmptyPage:!1,size:e})})),o()(this,"renderToken",((e,t)=>{const{teamIds:i}=this.props,a=1===(null==i?void 0:i.length),s=this.createTeamStore(e);if(!s)return;const o=s.getName();return n()(ct.Z,{format:this.environment.device.isMobile?ct.Z.Format.Large:ct.Z.Format.Small,showRemoveButton:!0,isSingle:a,onClickRemove:t.onRemove,renderAvatar:this.renderAvatarFactory(s),backgroundColor:"transparent",title:o},e)})),o()(this,"renderResultMenuItem",((e,t)=>{const i=this.createTeamStore(e);return l().createElement(dt.F,N()({},t,{key:e,teamStore:i}))})),o()(this,"performRequest",(async e=>{var t;let{query:i,current:a}=e;const n=new Set(a),s=k.default.state.currentSpaceViewStore,o=k.default.state.currentSpaceStore,r=null===(t=k.default.state.currentUserStore)||void 0===t?void 0:t.id;if(!s||!o||!r)return[];const l=await(0,T.qX)({environment:this.environment,spaceStore:o,currentUserId:r});return(await Je.zf({query:i,spaceViewStore:s,teamStores:l})).filter((e=>!n.has(e.id))).slice(0,20).map((e=>e.id))})),o()(this,"createTeamStore",(e=>{const{parentStore:t}=this.props;return lt.Z.createChildStore(t,{table:rt.e0,id:e})})),o()(this,"styles",{menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:6,fill:"currentColor"}})}renderComponent(){const{mode:e,title:t,teamIds:i,onChange:a,disabled:s,focused:o,onMenuDismiss:r,intl:l}=this.props;return n()(it.Z,{mode:e,title:t,icon:Me.Z.openTeamSearch,iconStyles:this.styles.recordIcon,items:i||[],onChange:a,disabled:s,focused:o,renderFilter:this.renderFilterListItem,renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:n()(re.FormattedMessage,{defaultMessage:"Add a teamspace",id:"search.filterMenu.addATeamButton.label",description:"In-line help message in the search filter UI when one teamspace is selected for filtering search results and the user wants to add another teamspace (filter)"}),labelText:{title:t,tokenInputPlaceholder:l.formatMessage({defaultMessage:"Search teamspaces",id:"search.filterMenu.searchTeams.placeholder",description:"Placeholder text for a search box for teamspace names in search filters"}),componentDebugName:"SearchTeamFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,onMenuDismiss:r,hasItemsSelected:Boolean(i&&(null==i?void 0:i.length)>0)})}}const mt=(0,re.injectIntl)(ut);var pt=i(55811),gt=i(75689),ht=i(91642),ft=i(60843);class vt extends d.Z{constructor(){super(...arguments),o()(this,"handleToggle",(()=>{const{value:e,onChange:t}=this.props;t(!e)})),o()(this,"styles",{menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},pillIcon:{height:16,width:16,fill:"currentColor",marginRight:6}})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){return n()(ht.Z,{marginAfter:!1},void 0,this.renderSwitcherMenuItem(e))}renderMobile(e){const{title:t,value:i,disabled:a}=this.props;return e===it.z.Button?this.renderSwitcherMenuItem(e):n()(gt.Z,{disabled:a,onClick:this.handleToggle,label:t,isToggle:!0,isToggleActive:i})}renderSwitcherMenuItem(e){const{title:t,icon:i,value:a,style:s,...o}=this.props,r=this.styles,d=this.getThemeColors(),c={...r.menuItem,...d.menuItem,...s};return e===it.z.Pill?n()(pt.u,{on:a,hideChevron:!0,title:n()("span",{},void 0,t),onClick:this.handleToggle,icon:i(r.pillIcon)}):l().createElement(ft.Z,N()({title:t,icon:i(r.icon),on:a,onClick:this.handleToggle,style:c},o))}getThemeColors(){return{menuItem:{color:this.theme.mediumTextColor}}}}o()(vt,"Mode",it.z);const yt=vt;var St=i(80172),Mt=i(17215),bt=i(32918),wt=i(76725),Ct=i(19889),Tt=i(20454);function kt(e){const{filterUIName:t,parentStore:i}=e,a=(0,z.VK)((()=>R.ZP.state.query.filters),[]),s=(0,G.y)((e=>({title:{maxWidth:220,...oe.Z.textOverflowStyle}})),[]),o=(0,z.VK)((()=>{switch(t){case"personFilter":return function(e,t){const i=e.createdBy,a=Xe.default.getIntl(),n=W().compact(i.map((e=>{const i=Tt.Z.createChildStore(t,{table:Ct.KJ,id:e});return(0,Ct.Nz)(a,i.getValue())})));return(0,wt.Z)(n,Pt)}(a,i);case"teamsFilter":return function(e,t){const i=e.inTeams;if(!i)return[];const a=W().compact(i.map((e=>lt.Z.createChildStore(t,{table:rt.e0,id:e}).getName())));return(0,wt.Z)(a,Pt)}(a,i);case"pageFilter":return function(e,t){const i=e.ancestors,a=W().compact(i.map((e=>{const i=Fe.Z.createChildStore(t,{table:ke.iU,id:e}),a=i.getValue();return a?Mt.T5({table:i.table,value:a,getRecordValue:i.getRecordValue,userTimeZone:bt.x7,intl:Xe.default.getIntl()}):""})));return(0,wt.Z)(a,Pt)}(a,i);case"dateFilter":return function(e){const t=Xe.default.getIntl(),i=At(e);if("createdTime"===i)return w._Q(e.createdTime,t);if("lastEditedTime"===i)return w._Q(e.lastEditedTime,t);return""}(a);case"titleToggle":return[]}(0,se.t1)(t)}),[i,t,a]);return n()("div",{style:s.title},void 0,n()(re.FormattedMessage,{defaultMessage:"{filterName}{colon} {filterOperator} {filterValues}",id:"search.filterBarFilter.title",values:{filterName:Zt(t),filterOperator:0===o.length?void 0:It(t,a),filterValues:o,colon:0===o.length?void 0:":"},description:"Filter bar pill titles, potentially containing a filter value preview."}))}function Zt(e){switch(e){case"personFilter":return n()(re.FormattedMessage,{id:"search.filterMenu.moreFilters.person",defaultMessage:"Created by",description:"Search filter by people who created the page"});case"teamsFilter":return n()(re.FormattedMessage,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace",description:"Label for button that opens a teamspace picker to add teamspace restricts (filters) to search results"});case"pageFilter":return n()(re.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In page"});case"dateFilter":return n()(re.FormattedMessage,{id:"search.filterMenu.moreFilters.date",defaultMessage:"Date",description:"Search filter by some date"});case"titleToggle":return n()(re.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Only search titles",description:"Label for only search titles toggle in search modal"})}(0,se.t1)(e)}function At(e){const t=w.VD.createdTime(e.createdTime),i=w.VD.lastEditedTime(e.lastEditedTime);return t?"createdTime":i?"lastEditedTime":void 0}function It(e,t){switch(e){case"personFilter":case"teamsFilter":case"pageFilter":case"dateFilter":case"titleToggle":return}(0,se.t1)(e)}const Pt=e=>", ";var _t=i(41558),xt=i(14947),Ft=i(46167),Bt=i(83264),Et=i(89206),Dt=i(66722),Rt=i(79583);const Lt={today:n()(re.FormattedMessage,{defaultMessage:"Today",id:"searchDateFilter.quickActions.today.label",description:"Filter search query results for documents edited or created today"}),pastWeek:n()(re.FormattedMessage,{defaultMessage:"Last 7 days",id:"searchDateFilter.quickActions.last7Days.label",description:"Filter search query results for documents edited or created in the last 7 days"}),pastMonth:n()(re.FormattedMessage,{defaultMessage:"Last 30 days",id:"searchDateFilter.quickActions.last30Days.label",description:"Filter search query results for documents edited or created in the last 30 days"})};function Ot(e){let{date:t,onClick:i,onDismiss:a}=e;const s=bt.x7,o=bt.Lg(s),r=o;let l;const d=Lt[t];"today"===t?l=o:"pastWeek"===t?l=bt.Oo():"pastMonth"===t?l=bt.dj():(0,se.t1)(t);return n()(Ee.Z,{focused:!1,icon:Me.Z.calendar({height:18,width:18}),title:d,onClick:e=>{i({value:{starting:{type:"date",start_date:l.start_date},ending:{type:"date",start_date:r.start_date}}}),a(e)}})}class Nt extends d.Z{constructor(){super(...arguments),o()(this,"storeTypes",{store:_t.Z}),o()(this,"renderPillButtonOrigin",(()=>{const{icon:e,title:t}=this.props,{store:i}=this.stores,a=this.styles,{dateFilterType:s}=i.state,o=R.ZP.state.query.filters[s].starting;return n()(pt.u,{on:Boolean(o),icon:e(a.pillIcon),title:n()("span",{},void 0,t),onClick:this.handleOriginActivate})})),o()(this,"renderPopupContents",(()=>{const{title:e}=this.props,{store:t}=this.stores;return l().createElement(l().Fragment,null,n()("div",{style:this.styles.dateFilterHeader},void 0,this.renderOperatorSelect(),n()(xt.Z,{style:this.styles.clearButton,onClick:this.handleClear},void 0,n()(re.FormattedMessage,{defaultMessage:"Clear",id:"searchDateFilter.clearButton.label",description:"Button to remove the current date range our search results are being filtered by"}))),n()("div",{style:this.styles.quickDatesWrapper},void 0,n()(Ot,{date:"today",onClick:this.updateTemporary,onDismiss:this.handleMenuClose}),n()(Ot,{date:"pastWeek",onClick:this.updateTemporary,onDismiss:this.handleMenuClose}),n()(Ot,{date:"pastMonth",onClick:this.updateTemporary,onDismiss:this.handleMenuClose})),n()(Bt.Z,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:t,onDismiss:this.handleMenuClose,hideDateInputMenuItems:!0}))})),o()(this,"handleOriginActivate",(()=>{const{disabled:e}=this.props,{store:t}=this.stores;e||t.setState({...t.state,isOpen:!0,focus:"starting"})})),o()(this,"handleMenuClose",(e=>{const{onMenuDismiss:t}=this.props,{store:i}=this.stores,{temporaryDateRange:a,dateFilterType:n}=i.state;w.zD(e)||(this.updateFilter(n,a),i.setState({...i.state,isOpen:!1}),t&&t())})),o()(this,"handleClear",(()=>{const{store:e}=this.stores,{dateFilterType:t}=e.state;this.updateFilter(t,{starting:void 0,ending:void 0}),e.clearTemporaryDateRange()})),o()(this,"handleMenuListKey",(e=>{e.preventDefault&&e.preventDefault()})),o()(this,"updateTemporary",(e=>{const{store:t}=this.stores;if(e.error)return;t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}});const{dateFilterType:i,temporaryDateRange:a}=t.state,{starting:n,ending:s}=a;n&&s&&this.updateFilter(i,{starting:n,ending:s})})),o()(this,"styles",{menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},pillIcon:{height:16,width:16,fill:"currentColor",marginRight:6},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},summary:{display:"inline-flex"},quickDatesWrapper:{marginTop:12,boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor),paddingBottom:15,marginBottom:15},clearButton:{color:this.theme.mediumTextColor,fill:this.theme.lightIconColor,fontWeight:500,fontSize:13,paddingLeft:2,paddingRight:2,paddingBottom:2,borderRadius:3,flexShrink:0},dateFilterHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginLeft:12,marginRight:12}})}didMount(){this.updateTemporary({value:this.props.value})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{store:t}=this.stores,i=this.styles;return n()(ht.Z,{},void 0,n()(Et.Z,{capture:t.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey},void 0,n()(Dt.ZP,{popupType:this.getPopupType(),open:t.state.isOpen,origin:this.renderPillButtonOrigin(),render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:Dt.ZP.Placement.Bottom,alignmentToOrigin:Dt.ZP.Alignment.Start,keepFocus:!0,style:i.popup})))}updateFilter(e,t){R.ZP.updateFilters({[e]:t})}getHumanReadableDateFilterType(e){return{lastEditedTime:n()(re.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),createdTime:n()(re.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"})}[e]}updateFilterFromToggle(e){const{value:t}=this.props,{store:i}=this.stores,{dateFilterType:a}=i.state;this.updateFilter(e,t),e!==a&&(this.updateFilter(a,{starting:void 0,ending:void 0}),i.setState({...i.state,dateFilterType:e}))}renderOperatorSelect(){const{device:e}=this.environment,{store:t}=this.stores,{dateFilterType:i}=t.state,a={width:190,items:["createdTime","lastEditedTime"],selectedItem:i,getKey:e=>e,onSelect:e=>this.updateFilterFromToggle(e),renderItem:e=>l().createElement(Ee.Z,N()({title:this.getHumanReadableDateFilterType(e.value)},e)),renderOrigin:t=>l().createElement(xt.Z,N()({},t,{style:{paddingLeft:2,paddingRight:2,paddingBottom:2,borderRadius:3,flexShrink:0}}),n()("div",{style:{display:"flex",alignItems:"center",...!e.isMobile&&{color:this.theme.mediumTextColor,fill:this.theme.lightIconColor,fontWeight:500,fontSize:13}}},void 0,n()("span",{style:{marginRight:4}},void 0,this.getHumanReadableDateFilterType(i)),this.renderOperatorChevron()))};return l().createElement(Rt.Z,N()({},a,{mobileActionSheet:!0}))}renderOperatorChevron(){const{device:e}=this.environment;return Me.Z.chevronDown({width:10,height:10,...e.isMobile&&{marginTop:2}})}renderMobile(e){const{store:t}=this.stores,i=e===it.z.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return n()(Dt.ZP,{popupType:Dt.ZP.PopupType.SlideUp,open:t.state.isOpen,origin:i,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:i}=this.props,a=this.styles;return n()(Ee.Z,{disabled:i,focused:!1,icon:e(a.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,dateFormat:i,disabled:a,intl:s}=this.props,o=this.styles,r=n()("div",{style:o.summary},void 0,Me.Z.calendar(o.iconActiveMobile),w._Q(t,s,i));return n()(gt.Z,{disabled:a,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:r})}getCurrentValue(){const{store:e}=this.stores,{dateFilterType:t,temporaryDateRange:i}=e.state;return{...R.ZP.state.query.filters[t],...i}}getPopupType(){const{device:e}=this.environment;return e.isMobile?Ft.Z.PopupType.SlideUp:Ft.Z.PopupType.Popup}}const Ut=(0,re.injectIntl)(Nt),Wt="SearchFilterSettings";function Vt(e){const t=(0,z.qz)(void 0,Ke.Z),{parentStore:i,isMobile:a}=e,s=(0,V.O7)(),o=(0,z.VK)((()=>s.currentUser.id),[s]),d=(0,z.VK)((()=>R.ZP),[]),c=(0,z.Kw)(d),u=c.query.filters,m=(0,z.VK)((()=>(0,T.bq)()),[]),p=(0,G.y)((e=>({scroller:{display:"flex",alignItems:"center",paddingLeft:5,paddingRight:5,paddingTop:12,paddingBottom:10},barContainer:{display:"flex",alignItems:"center"},scrollerContainer:{position:"relative",flexGrow:0,overflow:"hidden"},draggableList:{display:"flex",flexShrink:0,marginLeft:6}})),[]),g=(0,r.useCallback)((e=>t=>d.updateFilters({[e]:t})),[d]),h=(0,r.useCallback)((()=>{t.setState({...t.state,open:!1})}),[t]),f=(0,r.useCallback)((()=>n()(ot.Z,{mode:it.z.Pill,focused:!1,title:n()(kt,{filterUIName:"personFilter",parentStore:i}),parentStore:i,userIds:u.createdBy,onMenuDismiss:h,onChange:g("createdBy")})),[i,u.createdBy,h,g]),v=(0,r.useCallback)((()=>m&&n()(mt,{mode:it.z.Pill,focused:!1,title:n()(kt,{filterUIName:"teamsFilter",parentStore:i}),parentStore:i,teamIds:u.inTeams,onMenuDismiss:h,onChange:g("inTeams")})),[i,u.inTeams,h,g,m]),y=(0,r.useCallback)((()=>n()(st,{mode:it.z.Pill,focused:!1,title:n()(kt,{filterUIName:"pageFilter",parentStore:i}),parentStore:i,blockIds:u.ancestors,onMenuDismiss:h,onChange:g("ancestors")})),[i,u.ancestors,h,g]),S=(0,r.useCallback)((()=>n()(Ut,{mode:it.z.Pill,focused:!1,title:n()(kt,{filterUIName:"dateFilter",parentStore:i}),icon:Me.Z.calendar,value:u.lastEditedTime,onMenuDismiss:h})),[u.lastEditedTime,h,i]),M=(0,r.useCallback)((()=>!a&&n()(yt,{mode:it.z.Pill,focused:!1,title:n()(kt,{filterUIName:"titleToggle",parentStore:i}),icon:Me.Z.title,value:u.navigableBlockContentOnly||!1,onChange:g("navigableBlockContentOnly")})),[u.navigableBlockContentOnly,g,a,i]);(0,r.useEffect)((()=>{const e=qe.Z.get({userId:o,key:Wt});e&&e.filterOrder&&d.updateFilterState(e)}),[o,d]);const b={personFilter:f(),teamsFilter:v(),pageFilter:y(),dateFilter:S(),titleToggle:M()};return n()("div",{style:p.barContainer},void 0,n()("div",{style:p.scrollerContainer},void 0,n()(Ye.Z,{type:St.Z.X,style:p.scroller,showLeftRightOverlay:!1},void 0,l().createElement(l().Fragment,null,n()(je.Z,{direction:je.K.Horizontal,keys:c.filterState.filterOrder,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,renderKey:e=>b[e],style:p.draggableList,onDrop:e=>function(e){const t={...c.filterState,filterOrder:e};qe.Z.set({userId:o,key:Wt,value:t}),d.setState({...c,filterState:t})}(e)})))))}var zt=i(12174),Gt=i(13548),Ht=i(42001),qt=i(93481),Kt=(i(15306),i(8848));function jt(e){const t=(0,V.Fy)();return n()(Ft.Z,{popupType:t.isMobile?Ft.Z.PopupType.SlideUp:Ft.Z.PopupType.Popup,renderOrigin:t=>l().createElement(Qt,N()({events:t},e)),render:t=>l().createElement(Yt,N()({parent:t},e))})}function Yt(e){let{parent:t,experiment:i,searchExperimentOverrides:a,onChange:s}=e;const o=(0,V.Fy)(),r=(0,G.y)((()=>({menuOptionStyle:{color:Kt.ZP.mediumTextColor}})),[]);let d;d=o.isMobile?{menuType:ae.Z.MenuType.Modal,title:i.experimentId,right:n()(re.FormattedMessage,{defaultMessage:"Done",id:"appearanceSettings.modal.done"}),onClickRight:t.close}:{menuType:ae.Z.MenuType.Popup,width:250};const c=i.groups.map((e=>({key:e,action:a=>{s({experimentId:i.experimentId,group:e}),t.close()},render:(t,i)=>l().createElement(Ee.Z,N()({},t,{title:e,style:r.menuOptionStyle}))})));return l().createElement(ae.Z,d,n()(ce.Z,{type:ce.Z.Type.Vertical,initialFocus:void 0,sections:[{key:i.experimentId,render:e=>l().createElement(me.Z,e),items:c}]}))}function Qt(e){let{experiment:t,events:i,searchExperimentOverrides:a}=e;const s=(0,G.y)((e=>({experimentGroupButtonChevronStyle:{width:10,fill:e.lightIconColor},experimentGroupButtonStyle:{overflowX:"hidden",justifyContent:"left",overflow:"hidden",marginLeft:6,color:e.mediumTextColor},rowContainer:{display:"flex",overflow:"hidden",flexDirection:"row"},groupCell:{overflow:"hidden",marginRight:4}})),[]);return l().createElement(Ht.Z,N()({},i,{isSmall:!0,key:t.experimentId,style:s.experimentGroupButtonStyle}),n()("div",{style:s.rowContainer},void 0,n()("div",{style:s.groupCell},void 0,a[t.experimentId]||t.group),n()("div",{},void 0,Me.Z.chevronDown(s.experimentGroupButtonChevronStyle))))}const Jt=e=>({fontSize:14,lineHeight:1.2,color:e.mediumTextColor,overflow:"hidden",textOverflow:"ellipsis",marginRight:4,display:"flex",alignItems:"center",wordBreak:"break-all",whiteSpace:"nowrap"}),Xt=function(e){const{experiment:t}=e,{leftOverrides:i,rightOverrides:a,experimentDiffers:s,experimentAgreesButNondefault:o}=(0,z.VK)((()=>{var e,i;const a=A.v_.state.searchExperimentOverrides,n=A.BJ.state.searchExperimentOverrides,s=(null!==(e=a[t.experimentId])&&void 0!==e?e:t.group)!==(null!==(i=n[t.experimentId])&&void 0!==i?i:t.group);return{leftOverrides:a,rightOverrides:n,experimentDiffers:s,experimentAgreesButNondefault:!s&&void 0!==n[t.experimentId]&&a[t.experimentId]!==t.group}}),[t]),d=(0,G.y)((e=>({rowContainer:{backgroundColor:s?e.equationErrorPlaceholderBackground:o?e.accentColors.yellow[100]:void 0},titleCell:{...Jt(e)}})),[o,s]),c=(0,r.useCallback)((e=>{const{experimentId:t,group:i,store:a}=e;a.setState({...a.state,searchExperimentOverrides:{...a.state.searchExperimentOverrides,[t]:i}})}),[]);return l().createElement(l().Fragment,null,n()("div",{style:{...d.titleCell,...d.rowContainer}},void 0,t.experimentId.replace("search-","")),n()("div",{style:d.rowContainer},void 0,n()(jt,{experiment:t,searchExperimentOverrides:i,onChange:e=>{c({...e,store:A.v_})}})),n()("div",{style:d.rowContainer},void 0,n()(jt,{experiment:t,searchExperimentOverrides:a,onChange:e=>{c({...e,store:A.BJ})}})))};let $t;!function(e){e[e.Button=0]="Button",e[e.MenuItem=1]="MenuItem"}($t||($t={}));class ei extends d.Z{constructor(){super(...arguments),o()(this,"handleFilterClick",(e=>{const{onMenuDismiss:t}=this.props;this.applyFilter(e),this.openSidebar(),t&&t()})),o()(this,"applyFilter",(e=>{R.ZP.updateFilters(e)})),o()(this,"openSidebar",(()=>{R.ZP.isSidebarOpen()||R.ZP.setState({...R.ZP.state,isSidebarOpen:!0})})),o()(this,"styles",{menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},buttonFilter:{padding:"4px 8px",display:"flex",alignItems:"center",overflow:"hidden"},buttonText:{...oe.Z.textOverflowStyle},icon:{display:"inline-block",height:14,width:14,fill:"currentColor"},buttonIcon:{marginRight:6}})}renderComponent(){const{mode:e}=this.props;return e===$t.Button?this.renderAsButton():e===$t.MenuItem?this.renderAsMenuItem():void(0,se.t1)(e)}renderAsButton(){const{icon:e,title:t,filter:i}=this.props,a=this.styles,s=this.getThemeColors();return n()(xt.Z,{style:{...a.buttonFilter,...s.buttonFilter},onClick:()=>this.handleFilterClick(i)},void 0,e&&e({...a.icon,...a.buttonIcon}),n()("span",{style:a.buttonText},void 0,t))}renderAsMenuItem(){const{icon:e,title:t,filter:i,focused:a}=this.props,s=this.styles,o=this.getThemeColors(),r={...s.menuItem,...o.menuItem};return n()(Ee.Z,{icon:e&&e(s.icon),focused:a,title:t,onClick:()=>this.handleFilterClick(i),style:r})}getThemeColors(){const{device:e}=this.environment;return{menuItem:{color:e.isDesktop?this.theme.mediumTextColor:void 0,...this.props.isLastInSection&&{boxShadow:void 0}},buttonFilter:{color:this.theme.mediumTextColor}}}}o()(ei,"Mode",$t);class ti extends d.Z{renderComponent(){const e=ti.getCurrentPageFilter();if(e)return l().createElement(ei,N()({icon:Me.Z.searchInPage,title:n()(re.FormattedMessage,{id:"search.filterMenu.quickFilters.inCurrentPage",defaultMessage:"In current page"}),filter:e},this.props))}static isActive(e){const t=ti.getCurrentPageFilter();if(!t)return!1;if(!t.ancestors)return!1;const i=t.ancestors[0];return-1!==e.ancestors.indexOf(i)}}o()(ti,"getCurrentPageFilter",(()=>{const{mainEditorCurrentBlockStore:e}=k.default.state;if(e&&e.id)return{ancestors:[e.id]}}));class ii extends d.Z{renderComponent(){const e=ii.getCurrentUserFilter(this.environment);if(e)return l().createElement(ei,N()({icon:Me.Z.person,title:n()(re.FormattedMessage,{id:"search.filterMenu.quickFilters.createdByMe",defaultMessage:"Created by me"}),filter:e},this.props))}static isActive(e,t){const i=ii.getCurrentUserFilter(e);if(!i)return!1;if(!i.createdBy)return!1;const a=i.createdBy[0];return-1!==t.createdBy.indexOf(a)}}o()(ii,"getCurrentUserFilter",(e=>{const{id:t}=e.currentUser;if(t)return{createdBy:[t]}}));class ai extends d.Z{renderComponent(){const e=ai.getPastWeekFilter();if(e)return l().createElement(ei,N()({icon:Me.Z.calendar,title:n()(re.FormattedMessage,{id:"search.filterMenu.quickFilters.editedLastWeek",defaultMessage:"Edited last week"}),filter:e},this.props))}static isActive(e){const{lastEditedTime:t}=ai.getPastWeekFilter();return W().isEqual(t,e.lastEditedTime)}}o()(ai,"getPastWeekFilter",(()=>({lastEditedTime:{starting:bt.Oo(bt.x7),ending:bt.Lg(bt.x7)}})));var ni=i(56109),si=i(62727);function oi(){const{leftPattern:e,rightPattern:t}=(0,z.VK)((()=>({leftPattern:A.v_.state.forcedClusterPattern,rightPattern:A.BJ.state.forcedClusterPattern})),[]),{titleCell:i,rightTitleCell:a,leftTitleCell:s}=(0,G.y)((i=>{const a=Jt(i);return{titleCell:a,rightTitleCell:{...a,color:t?a.color:i.lightTextColor,width:"95%"},leftTitleCell:{...a,color:e?a.color:i.lightTextColor,width:"95%"}}}),[e,t]),[o,d]=(0,r.useState)(t),[c,u]=(0,r.useState)(e);(0,r.useEffect)((()=>{void 0===t&&d(void 0),void 0===e&&u(void 0)}),[t,e]);const m=(0,r.useCallback)((()=>{A.BJ.setState({...A.BJ.state,forcedClusterPattern:o})}),[o]),p=(0,r.useCallback)((()=>{A.v_.setState({...A.v_.state,forcedClusterPattern:c})}),[c]),g=(0,r.useCallback)((e=>{d(e.target.value)}),[]),h=(0,r.useCallback)((e=>{u(e.target.value)}),[]);return l().createElement(l().Fragment,null,n()("div",{style:i},void 0,"forcedClusterPattern"),n()(ni.Z,{capture:!0,allowMenuList:!1},void 0,n()(si.Z,{style:s,onBlur:p,value:c,onChange:h,placeholder:"cluster-pattern"}),n()(si.Z,{style:a,onBlur:m,value:o,onChange:g,placeholder:"cluster-pattern"})))}let ri;!function(e){e.Button="Button",e.Section="Section"}(ri||(ri={}));class li extends d.Z{constructor(){var e;super(...arguments),o()(this,"storeTypes",{buttonPopupStore:Ke.Z,debugMenuOpen:de.default.of(!1)}),o()(this,"renderAddFilterOrigin",(e=>{const t=this.styles;return l().createElement(Ht.Z,N()({},e,{style:t.addFilterButtonMobile,icon:Me.Z.filterCircled,isBlue:!0}),n()(re.FormattedMessage,{defaultMessage:"Add filter",id:"search.addFilter.button.label"}))})),o()(this,"renderAddFilterMenu",(()=>n()(ae.Z,{menuType:ae.Z.MenuType.ActionSheet},void 0,this.renderSuggestedFilters(),n()(ht.Z,{title:this.renderMoreFiltersTitle()},void 0,this.renderCreatedByFilter(it.Z.Mode.Button),this.renderCreatedTimeFilter(it.Z.Mode.Button),this.renderLastEditedTimeFilter(it.Z.Mode.Button),this.renderAncestorFilter(it.Z.Mode.Button),this.renderInTeamFilter(it.Z.Mode.Button))))),o()(this,"searchExperimentsToToggle",this.createComputedStore((()=>Object.entries(zt.g6).map((e=>{let[t,i]=e;return{experimentId:t,experimentVersion:1,group:xe.default.getGroup(t),groups:["control",...i]}}))))),o()(this,"closeAddFilterMenu",(()=>{const{buttonPopupStore:e}=this.stores;e.setState({...e.state,open:!1})})),o()(this,"callTitleFilterUpdateFns",(e=>{R.ZP.updateFilters({navigableBlockContentOnly:e})})),o()(this,"closeSidebar",(()=>R.ZP.setState({...R.ZP.state,isSidebarOpen:!1}))),o()(this,"styles",{sidebar:{paddingTop:12,paddingBottom:24,overflowY:"auto",overflowX:"hidden",flex:"0 0 ".concat(null!==(e=this.stores.debugMenuOpen)&&void 0!==e&&e.state?440:220,"px"),minHeight:400},sidebarHidden:{display:"none"},addFilterButtonMobile:{fontSize:this.props.isMobile?oe.Z.fontSize.UISmall.mobile:oe.Z.fontSize.UISmall.desktop,fontWeight:oe.Z.fontWeight.medium,marginRight:-8}})}renderComponent(){return this.props.isMobile?this.props.mode===ri.Button?this.renderAddButtonMobile():this.props.mode===ri.Section?this.renderActiveFiltersMobile():void(0,se.t1)(this.props.mode):this.renderSidebar()}renderActiveFiltersMobile(){const{state:e}=R.ZP,t=w.De(e.query.filters);return n()(me.Z,{disableMobilePadding:!0,disableMobileBorders:!0},void 0,this.renderTitlesOnlyFilter(it.z.Section),this.renderDeletedOnlyFilter(it.z.Section),this.renderActiveFilters(t,it.Z.Mode.Section))}renderAddButtonMobile(){const{buttonPopupStore:e}=this.stores;return n()(Ft.Z,{popupType:Ft.Z.PopupType.SlideUp,buttonPopupStore:e,renderOrigin:this.renderAddFilterOrigin,render:this.renderAddFilterMenu})}renderActiveFilters(e,t){return n()(l().Fragment,{},void 0,e.createdBy&&this.renderCreatedByFilter(t),e.createdTime&&this.renderCreatedTimeFilter(t),e.lastEditedTime&&this.renderLastEditedTimeFilter(t),e.ancestors&&this.renderAncestorFilter(t),e.inTeams&&this.renderInTeamFilter(t))}renderSuggestedFilters(){const{filters:e}=R.ZP.state.query,t=ii.isActive(this.environment,e),i=ai.isActive(e),a=ti.isActive(e);if(!(t&&i&&a))return n()(ht.Z,{title:n()(re.FormattedMessage,{id:"search.filterMenu.quickFiltersSection.title",defaultMessage:"Quick filters"}),marginAfter:!0},void 0,!t&&n()(ii,{mode:$t.MenuItem,focused:!1,onMenuDismiss:this.closeAddFilterMenu}),!i&&n()(ai,{mode:$t.MenuItem,focused:!1,onMenuDismiss:this.closeAddFilterMenu}),!a&&n()(ti,{mode:$t.MenuItem,focused:!1,onMenuDismiss:this.closeAddFilterMenu,isLastInSection:!0}))}renderSidebar(){var e;const t=this.styles,i=this.getThemeColors(),a={...t.sidebar,...i.sidebar,...!R.ZP.isSidebarOpen()&&t.sidebarHidden,flex:"0 0 ".concat((null===(e=this.stores.debugMenuOpen)||void 0===e?void 0:e.state)||360,"px")};return n()("aside",{style:a},void 0,n()(xt.Z,{onClick:this.closeSidebar,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16,position:"absolute",top:10,right:10}},void 0,Me.Z.closeSmall({width:14,fill:this.theme.mediumTextColor})),this.renderDevToolsSection())}renderForcedClusterPatternInput(){return null}renderShowDebugInfoToggle(){return n()(yt,{mode:it.z.Button,focused:!1,title:"Show debug info",icon:Me.Z.bot,value:A.ZP.state.showDebugInfo,onChange:e=>{A.ZP.setState({...A.ZP.state,showDebugInfo:Boolean(e)})}})}renderShowDebugSearchToggle(){return n()(yt,{mode:it.z.Button,focused:!1,title:"Explain query",icon:Me.Z.bot,value:"everything"===A.ZP.state.debug,onChange:e=>{A.ZP.setState({...A.ZP.state,debug:e?"everything":void 0})}})}renderDevToolsSection(){if((0,pe.x)(v.Z))return n()(ht.Z,{title:n()(xt.Z,{onClick:()=>{this.stores.debugMenuOpen.setState(!this.stores.debugMenuOpen.state)}},void 0,"Dev Tools")},void 0,n()(Gt.Z,{isVisible:!0,animationStyle:{height:"100%"},render:()=>n()("div",{style:{overflow:"scroll"}},void 0,this.renderShowDebugInfoToggle(),this.renderShowDebugSearchToggle(),this.renderForcedClusterPatternInput(),n()(ht.Z,{style:{marginTop:16},title:"Dev Experiments",right:(0,A.gq)({device:this.environment.device})&&n()(Ht.Z,{onClick:()=>{A.v_.reset(),A.BJ.reset()},style:{paddingLeft:0,paddingRight:0,height:"unset"}},void 0,Me.Z.sync({width:12}))},void 0,n()("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr",minWidth:"100%",maxWidth:"100%",paddingLeft:14}},void 0,this.searchExperimentsToToggle.state.map((e=>n()(Xt,{experiment:e},e.experimentId))),n()(oi,{}))))}))}renderTitlesOnlyFilter(e){const{filters:t}=R.ZP.state.query;return n()(yt,{mode:e,focused:!1,title:n()(re.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Only search titles",description:"Label for only search titles toggle in search modal"}),icon:Me.Z.typesTitle,value:t.navigableBlockContentOnly||!1,onChange:this.callTitleFilterUpdateFns})}renderDeletedOnlyFilter(e){const{filters:t}=R.ZP.state.query;return n()(yt,{mode:e,focused:!1,title:n()(re.FormattedMessage,{id:"search.filterMenu.deletedOnlyToggle.label",defaultMessage:"Deleted only",description:"Label for only match deleted content toggle in search modal"}),icon:Me.Z.trash,value:t.isDeletedOnly||!1,onChange:this.createUpdateFunction("isDeletedOnly")})}renderMoreFiltersTitle(){return n()(re.FormattedMessage,{id:"search.filterMenu.moreFiltersSection.title",defaultMessage:"More filters"})}renderAncestorFilter(e){const{parentStore:t}=this.props,{filters:i}=R.ZP.state.query;return n()(st,{mode:e,focused:!1,title:n()(re.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In page"}),parentStore:t,blockIds:i.ancestors,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("ancestors")})}renderCreatedByFilter(e){const{parentStore:t}=this.props,{filters:i}=R.ZP.state.query;return n()(ot.Z,{mode:e,focused:!1,title:n()(re.FormattedMessage,{id:"search.filterMenu.moreFilters.createdBy",defaultMessage:"Created by"}),parentStore:t,userIds:i.createdBy,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("createdBy")})}renderCreatedTimeFilter(e){const{filters:t}=R.ZP.state.query;return n()(qt.Z,{mode:e,focused:!1,title:n()(re.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"}),icon:Me.Z.calendar,value:t.createdTime,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("createdTime")})}renderLastEditedTimeFilter(e){const{filters:t}=R.ZP.state.query;return n()(qt.Z,{mode:e,focused:!1,title:n()(re.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),icon:Me.Z.calendar,value:t.lastEditedTime,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("lastEditedTime")})}renderInTeamFilter(e){if(!(0,T.bq)())return;const{parentStore:t}=this.props,{filters:i}=R.ZP.state.query;return n()(mt,{mode:e,focused:!1,title:n()(re.FormattedMessage,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace",description:"Label for button that opens a teamspace picker to add teamspace restricts (filters) to search results"}),parentStore:t,teamIds:i.inTeams,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("inTeams")})}createUpdateFunction(e){return t=>R.ZP.updateFilters({[e]:t})}getThemeColors(){return{sidebar:{backgroundColor:this.theme.sidebarSecondaryBackground,borderLeft:"1px solid ".concat(this.theme.regularDividerColor)}}}}const di=li;var ci=i(56255);class ui extends d.Z{constructor(){super(...arguments),o()(this,"openSidebar",(()=>{R.ZP.setState({...R.ZP.state,isSidebarOpen:!0})})),o()(this,"styles",{menuItemMobile:{paddingBottom:0},titleWrapper:{flex:void 0,marginTop:-3,marginBottom:-1},showSidebarButton:()=>{const{device:e}=this.environment;return{padding:"0 4px",fontSize:e.isMobile?oe.Z.fontSize.UISmall.mobile:oe.Z.fontSize.UISmall.desktop,fontWeight:oe.Z.fontWeight.medium,borderRadius:3,height:20,lineHeight:"20px"}}})}renderComponent(){const{device:e}=this.environment,t=this.styles,i={...e.isMobile&&t.menuItemMobile},a=this.shouldAllowFilters()&&this.renderAddFilterButton();return n()(he.Z,{title:this.renderSortMenu(),right:a,textWrapperStyle:t.titleWrapper,style:i})}renderSortMenu(){return n()(ci.Z,{currentSortBy:R.ZP.state.query.sort,setSortBy:e=>{R.ZP.setState({...R.ZP.state,query:{...R.ZP.state.query,sort:e}})},sortOptions:this.sortOptions})}renderAddFilterButton(){const{device:e}=this.environment,{parentStore:t}=this.props;if(e.isMobile)return n()(di,{parentStore:t,isMobile:!0,mode:ri.Button})}shouldAllowFilters(){const{isPublicPageSearch:e}=this.props;return!e}get sortOptions(){return[{key:Ze.As.Relevance,formattedName:n()(re.FormattedMessage,{id:"search.sort.sortOrder.bestMatches",defaultMessage:"Best matches"})},{key:Ze.As.LastEditedNewest,formattedName:n()(re.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.newestFirst",defaultMessage:"Last edited: Newest first"})},{key:Ze.As.LastEditedOldest,formattedName:n()(re.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.oldestFirst",defaultMessage:"Last edited: Oldest first"})},{key:Ze.As.CreatedNewest,formattedName:n()(re.FormattedMessage,{id:"search.sort.sortOrder.created.newestFirst",defaultMessage:"Created: Newest first"})},{key:Ze.As.CreatedOldest,formattedName:n()(re.FormattedMessage,{id:"search.sort.sortOrder.created.oldestFirst",defaultMessage:"Created: Oldest first"})}]}}const mi=ui;var pi=i(38755);class gi extends P.Z{getInitialState(){return{open:!1}}}const hi=new gi;var fi=i(68932),vi=i(92166);class yi extends d.Z{constructor(){super(...arguments),o()(this,"typingTimer",void 0),o()(this,"renderSpinner",(()=>{const{showSpinner:e}=this.props,t=this.styles,i={...this.getThemeColors().searchIcon,...t.searchIcon()};return n()(vi.Z,{show:e,showDelay:500,showHold:200,render:e=>e?n()(fi.Z,{style:i}):Me.Z.searchThick(i)})})),o()(this,"handleQueryChange",(e=>{this.handleTyping();const t=String(e.target.value);this.props.onQueryChange(t)})),o()(this,"handleClearButtonClick",(()=>{R.ZP.resetQuery({resetFilters:!0}),R.ZP.update((e=>({...e,isSidebarOpen:!1,source:void 0})))})),o()(this,"handleFocus",(()=>{const{onFocusChange:e}=this.props;e(!0)})),o()(this,"handleBlur",(()=>{const{onFocusChange:e}=this.props;e(!1)})),o()(this,"styles",{inputDesktop:{fontSize:18,height:yi.DESKTOP_INPUT_HEIGHT,paddingLeft:16,paddingRight:16,flexGrow:0,flexShrink:0,zIndex:1},inputMobile:{fontSize:16,border:"none",boxShadow:"none",borderRadius:7,lineHeight:"1.2",padding:"6px 8px"},searchIcon:()=>{const{device:e}=this.environment;return{width:e.isMobile?16:18,height:e.isMobile?16:18,marginRight:e.isMobile?12:10,flexGrow:0,flexShrink:0}},input:{minWidth:0,...oe.Z.textOverflowStyle},clearButton:{marginLeft:8}})}willUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=void 0)}renderComponent(){var e;const{device:t}=this.environment,{isOpen:i,searchResultStore:a}=this.props,s=this.styles,o=this.getThemeColors(),r=a.state.jumpToResult&&a.state.jumpToResult.store.getIcon()||void 0,l=n()(Re.Z,{disabled:!0,icon:r,isEmptyPage:Boolean(r),size:20}),d=u.Jc(null===(e=a.state.jumpToResult)||void 0===e?void 0:e.store.getTitleValue()),c=R.ZP.state.query.text,m=(null==d?void 0:d.slice(0,c.length).toLocaleLowerCase())===c.toLocaleLowerCase()&&c&&c.length<20,p=m?c+(null==d?void 0:d.substring(c.length)):void 0,g=t.isMobile?si.Z.Format.ExtraLarge:si.Z.Format.Transparent,h=t.isMobile?{...s.inputMobile,...o.inputMobile}:{...s.inputDesktop,...o.inputDesktop},f="on"===xe.default.getGroup("navigational_search_improvements")&&!t.isMobile;return n()(si.Z,{format:g,placeholder:this.getPlaceholderText(),left:this.renderSpinner(),value:c,suggestedText:f?m?p:"":void 0,focus:t.isMobile?void 0:i&&!hi.state.open,focusInitial:!(0,Y.Y)("supportsNativeHome")&&t.isMobile,focusAfterAnimation:!0,showClearButton:!0,selectAll:!1,onChange:this.handleQueryChange,onClearButtonClick:this.handleClearButtonClick,onFocus:this.handleFocus,onBlur:this.handleBlur,style:h,inputStyle:s.input,clearButtonStyle:s.clearButton,icon:f&&Boolean(R.ZP.state.query.text.trim())?l:void 0})}handleTyping(){const{onTypingChange:e}=this.props;this.typingTimer&&window.clearTimeout(this.typingTimer),e(!0),this.typingTimer=window.setTimeout((()=>e(!1)),yi.TYPING_DEBOUNCE_MS)}getPlaceholderText(){const{currentSpaceStore:e,mainEditorCurrentBlockStore:t}=k.default.state,i=e&&(0,pi.getSpaceName)(this.environment,e);if(i)return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedSpace",defaultMessage:"Search {spaceName}…"},{spaceName:i});if(t){const e=u.Jc(t.getTitleValue()).slice(0,yi.MAX_PLACEHOLDER_TITLE_LENGTH);return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedPage",defaultMessage:"Search in {pageTitle}…"},{pageTitle:e})}return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.unnamedPage",defaultMessage:"Search in page…"})}getThemeColors(){return{inputDesktop:{boxShadow:"0 1px 0 ".concat(this.theme.regularDividerColor)},inputMobile:{background:this.theme.inputBackground},searchIcon:{fill:this.theme.mediumIconColor}}}}o()(yi,"TYPING_DEBOUNCE_MS",300),o()(yi,"DESKTOP_INPUT_HEIGHT",48),o()(yi,"MAX_PLACEHOLDER_TITLE_LENGTH",100);const Si=(0,re.injectIntl)(yi);var Mi=i(472),bi=(i(41817),i(73935)),wi=i.n(bi),Ci=i(16328),Ti=i(39634);class ki extends d.Z{constructor(){super(...arguments),o()(this,"styles",{menuItem:{minHeight:void 0,...this.environment.device.isMobile&&{background:void 0,boxShadow:void 0},paddingTop:32,paddingBottom:32},text:{textAlign:"center"},title:{margin:0,fontWeight:oe.Z.fontWeight.medium,fontSize:ge.yv(this.environment,"UIRegular"),lineHeight:ge.Dp(this.environment,"UIRegular")},caption:{fontSize:ge.yv(this.environment,"UIRegular")}})}renderComponent(){const{style:e,captionStyle:t,...i}=this.props,a={...this.styles.menuItem,...e},n={...this.styles.caption,...t};return l().createElement(he.Z,N()({},i,{title:this.renderTitle(),caption:this.renderCaption(n),textWrapperStyle:this.styles.text,style:a,captionStyle:n}))}renderTitle(){const{title:e}=this.props;if(!e)return;const t=this.styles,i=this.getThemeColors(),a={...t.title,...i.title};return n()("h4",{role:"alert",style:a},void 0,e)}renderCaption(e){const{caption:t}=this.props;if(!t)return;const i={...e,...this.getThemeColors().caption};return n()("div",{style:i},void 0,t)}getThemeColors(){return{title:{color:this.theme.mediumTextColor},caption:{color:this.theme.lightTextColor}}}}o()(ki,"contextTypes",{...j.f});const Zi=ki;var Ai=i(86512);class Ii extends d.Z{constructor(){super(...arguments),o()(this,"handleSendMessageClick",(()=>{Ti.j({environment:this.environment,from:"quick_find"})})),o()(this,"styles",{menuItem:{marginTop:"auto",marginBottom:"auto"},caption:{marginTop:"auto"},reportProblemButton:{display:"inline"},searchDeletedButton:{display:"inline"}})}renderComponent(){return l().createElement(Zi,N()({},this.getErrorMessage(),{style:this.styles.menuItem,captionStyle:this.styles.caption,shouldWrapCaption:!0}))}renderNoResults(){return{title:Ii.noResultsTitle,caption:this.renderNoResultsMessage()}}renderNoResultsMessage(){var e=this;const t=R.ZP.state.query.filters,i=w.FN(t);if(!w.VD.isDeletedOnly(t.isDeletedOnly)){const t=this.styles,i=this.getThemeColors(),a={...t.searchDeletedButton,...i.searchDeletedButton};return n()(re.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.searchDeleted",defaultMessage:"Some results may be in your deleted pages.{br}<searchdeleted>Search deleted pages</searchdeleted>",description:"Message prompted to users when their Search return no results to suggest them search in deleted pages",values:{searchdeleted:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return n()(Ai.Z,{onClick:e.props.handleSearchDeletedOnly,style:a},void 0,i)},br:n()("br",{})}})}return n()(re.FormattedMessage,i?{defaultMessage:"Try different search terms or filters",id:"searchErrorMenuItem.errorPrompt.searchTermsAndFilters"}:{defaultMessage:"Try different search terms",id:"searchErrorMenuItem.errorPrompt.searchTerms"})}renderOffline(){return{title:Ii.noResultsTitle,caption:n()(re.FormattedMessage,{defaultMessage:"Go online for more results.",id:"searchErrorMenuItem.errorPrompt.goOnline"})}}renderRequestFailed(){var e=this;const t=this.styles,i=this.getThemeColors(),a={...t.reportProblemButton,...i.reportProblemButton};return{title:n()(re.FormattedMessage,{id:"searchErrorMenuItem.error.genericErrorMessage",defaultMessage:"Something went wrong"}),caption:n()(re.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.refreshOrReport",defaultMessage:"Try refreshing or <reportlink>report a problem</reportlink>.",values:{reportlink:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return n()(Ai.Z,{onClick:e.handleSendMessageClick,style:a},void 0,i)}}})}}getErrorMessage(){const{error:e}=this.props;switch(e.type){case Ze.Ix.NoResults.type:return this.renderNoResults();case Ze.Ix.Offline.type:return this.renderOffline();case Ze.Ix.RequestFailed.type:return this.renderRequestFailed();default:(0,se.t1)(e)}}getThemeColors(){return{reportProblemButton:{color:this.theme.blueColor},searchDeletedButton:{color:this.theme.blueColor}}}}o()(Ii,"contextTypes",{...j.f}),o()(Ii,"noResultsTitle",n()(re.FormattedMessage,{defaultMessage:"No results",id:"searchErrorMenuItem.error.noResults"}));const Pi=Ii;class _i extends d.Z{constructor(){super(...arguments),o()(this,"storeTypes",{isInLoadMoreResultsScrollOffset:de.default.of(!1)}),o()(this,"renderSearchResult",((e,t,i)=>{var a,n,s;const{store:o}=e,r=o.isNavigableBlock()?o:o.getNavigableBlockStore(),d="on"===xe.default.getGroup("navigational_search_improvements");if(!r)return;const c=l().createRef(),u=l().createRef(),m=Boolean(A.ZP.getDebugLevel()),p=m&&e.sources.includes(Ze.vp.Local)?{score:e.score,frecencyScore:e.frecencyScore,localSource:e.localSource,personalizationBoost:e.personalizationBoost}:void 0,g=m&&e.sources.includes(Ze.vp.ElasticSearch)?null===(a=this.props.debugInfo)||void 0===a||null===(n=a.requests[0])||void 0===n||null===(s=n.rawResponse)||void 0===s?void 0:s.hits.hits.find((e=>e._id===o.id)):void 0,h=this.props.clusterInfo;return{key:"".concat(o.id,":").concat(t),action:t=>{if(c.current){const{event:e}=t;function i(t){const i=wi().findDOMNode(t.current);return Boolean(i&&e.target&&(i===e.target||i.contains(e.target)))}if(i(c)||i(u))return}this.props.handleSelectResult({store:o,action:t,selectedResult:e,allSearchResults:i})},render:i=>l().createElement(We,N()({},i,{index:t,originalPosition:e.originalPosition,isFirstInSection:0===t,isLastInSection:!!d&&void 0,store:r,hidePath:!1,result:e,className:K.ul,debugLocal:p,debugHit:g,debugAreaRef:c,debugLocalRef:u,clusterInfo:h}))}})),o()(this,"handleScrollOffsetChange",((e,t)=>{const{onMaybeLoadMoreResults:i}=this.props,{isInLoadMoreResultsScrollOffset:a}=this.stores,n=e<=_i.LOAD_MORE_RESULTS_SCROLL_OFFSET_PX;n&&!a.get()&&i(),a.set(n),t.offsetFromTop&&R.ZP.update((e=>({...e,hasScrolled:!0})))})),o()(this,"resultStyles",{results:{flex:1,display:"flex",flexDirection:"column",overflow:"auto",height:"100%"},messageMenuItem:{...this.environment.device.isMobile&&{background:void 0,boxShadow:void 0}},debugMessageMenuItemTextStyle:{whiteSpace:"pre-wrap",fontFamily:"monospace"}})}renderComponent(){var e,t,i,a,s,o,r;const{errorState:d,results:c,resultListStore:u,parentStore:m,publicAccessPermission:p}=this.props,g=this.resultStyles,h=W().findLastIndex(c,(e=>e.sources.includes(Ze.vp.Local))),f=c?c.slice(0,h):[],v=c?c.slice(h):[],y=[f.length>0?{key:"localResults",render:e=>l().createElement(me.Z,N()({},e,{shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0})),items:W().compact(f.map(((e,t)=>this.renderSearchResult(e,t,f))))}:void 0,v.length>0?{key:"serverResults",render:e=>l().createElement(me.Z,N()({},e,{shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0})),items:W().compact(v.map(((e,t)=>this.renderSearchResult(e,t,v))))}:void 0].filter(se.$K),S=null===(e=this.props.debugInfo)||void 0===e||null===(t=e.requests[0])||void 0===t||null===(i=t.rawResponse)||void 0===i||null===(a=i.profile)||void 0===a||null===(s=a.shards[0])||void 0===s||null===(o=s.searches)||void 0===o||null===(r=o[0])||void 0===r?void 0:r.query[0].children;return l().createElement("section",{style:g.results,ref:this.props.resultsSectionRef},!this.environment.device.isMobile&&n()(mi,{parentStore:m,isPublicPageSearch:Boolean(p)}),S&&this.renderDebugMessage(n()(_e.LazyAdminReactJson,{data:{parsedQuery:S},customCollapsedRenderers:[Bi],showCopyButton:!0,showModalButton:!0})),y&&n()(ce.Z,{type:ce.Z.Type.Vertical,initialFocus:0,store:u,disableKeyboardArrowWrap:!0,sections:y}),this.renderError(d)||n()(ue.Z,{onChange:this.handleScrollOffsetChange}))}renderError(e){if(!e.isLoading)return e.showMajorError?n()(Pi,{error:e.serverError,handleSearchDeletedOnly:()=>{R.ZP.updateFilters({isDeletedOnly:!0}),R.ZP.setState({...R.ZP.state,isSidebarOpen:!0})}}):e.serverError&&e.serverError!==Ze.Ix.NoResults?this.renderMessage(e.serverError.message):void 0}renderDebugMessage(e){const t=this.resultStyles;return n()(me.Z,{disableMobilePadding:!0,disableMobileBorders:!0},void 0,n()(he.Z,{body:e,bodyStyle:t.debugMessageMenuItemTextStyle}))}renderMessage(e){const t=this.resultStyles;return n()(me.Z,{disableMobilePadding:!0,disableMobileBorders:!0},void 0,n()(Ci.Z,{title:e,style:t.messageMenuItem}))}}o()(_i,"LOAD_MORE_RESULTS_SCROLL_OFFSET_PX",200);const xi=_i;function Fi(e){const t=e.replaceAll(/\(MatchNoDocsQuery\("Matching no documents because no terms present"\)\)\^[0-9\.]/g,"").replaceAll(/MatchNoDocsQuery\("Matching no documents because no terms present"\)/g,"").replaceAll(/ConstantScore\(([^)]+):([^)]+)\)/g,"<i>$1</i>:<b>$2</b>").replace(/function score \(\((.*)\), functions:.*\)/,"$1").replaceAll("( ","(").replaceAll(" )",")").replaceAll("|","| <br/>").replaceAll(/([^( ]+):"([^"]+)"/g,'<i>$1</i>:<b>"$2"</b>').replaceAll(/([^( ]+):([^) ]+)/g,"<i>$1</i>:<b>$2</b>");return n()("span",{dangerouslySetInnerHTML:{__html:t}})}function Bi(e){var t;let{data:i,keyPath:a}=e;var n;if(1===a.length)return{element:Fi(null===(n=i[0])||void 0===n?void 0:n.description),expanded:!1};if(!["type","description","time_in_nanos"].every((e=>i[e])))return null;let s=(null==i?void 0:i.description)||"";return null!==(t=s)&&void 0!==t&&t.includes("permissions.teamIds")&&(s="PermissionsQuery"),{element:Fi(s),expanded:!1}}const Ei=function(e){const{parentStore:t,publicAccessPermission:i,resultListStore:a,localSearchCache:s,searchResultStore:o,queryResultsSectionRef:l,errorState:d,searchExperimentOverrides:c,forcedClusterPattern:u}=e,[{currentSpaceStore:m}]=(0,z.oR)(k.default),{isOpen:p,openAsPage:g,searchSessionId:h,localResults:f,serverResults:v,clusterInfo:y,query:S,limit:M,debug:b,debugInfo:C,recentPagesForBoosting:T}=(0,z.VK)((()=>{var e,t,i,a;return{query:R.ZP.state.query,limit:R.ZP.state.limit,recentPagesForBoosting:R.ZP.state.recentPagesForBoosting,debug:A.ZP.getDebugLevel(),isOpen:I.default.state.open,openAsPage:I.default.state.openAsPage,searchSessionId:I.default.state.sessionId,localResults:null===(e=o.state.localResults)||void 0===e?void 0:e.results,serverResults:null===(t=o.state.serverResults)||void 0===t?void 0:t.results,clusterInfo:null===(i=o.state.serverResults)||void 0===i?void 0:i.clusterInfo,debugInfo:null===(a=o.state.serverResults)||void 0===a?void 0:a.debugInfo}}),[o]),Z=(0,V.O7)(),{isOnline:P,shouldSearchLocal:_}=(0,z.VK)((()=>{return{isOnline:Boolean(Q.Z.state.online),shouldSearchLocal:"on"!==(e="search-no-local-blending",null!==(t=null==c?void 0:c[e])&&void 0!==t?t:xe.default.getGroup(e))};var e,t}),[c]);(0,H.r5)((async()=>{if(!p&&!g)return;o.update((e=>({...e,serverResultsLoading:!0})));const e={query:S,limit:M,debug:b};D.default.update((e=>({...e,numServerRequests:e.numServerRequests+1})));const a=await async function(e){const{parentStore:t,requestInput:i,isOnline:a,environment:n,publicAccessPermission:s,searchSessionId:o,searchSessionFlowNumber:r,source:l,spaceId:d,searchExperimentOverrides:c,forcedClusterPattern:u,recentPagesForBoosting:m}=e,{query:p}=i;if(!p.text.trim()&&!w.FN(p.filters))return;if(!a)return{error:Ze.Ix.Offline};const g=Mi.default.createMetric("rum.server_quick_search_query"),h=await w.MS({environment:n,input:i,spaceId:d,publicAccessPermission:s,searchSessionId:o,searchSessionFlowNumber:r,source:l,searchExperimentOverrides:c,forcedClusterPattern:u,recentPagesForBoosting:m});if(!h)return;if("failed"===h.type)return h.offline?{error:Ze.Ix.Offline}:{error:Ze.Ix.RequestFailed};const f=h.data.trackEventProperties,v={};if(Object.keys(f).forEach((e=>{v["server-".concat(e)]=f[e]})),0===h.data.results.length)return{error:Ze.Ix.NoResults};const y=h.data.results.map(((e,i)=>({...e,originalPosition:i,store:Fe.Z.createChildStore(t,{table:ke.iU,id:e.id})})));return Mi.default.emit(n,g,void 0),{value:{results:y,total:h.data.total,debugInfo:h.data.debug,serverEventProperties:v,clusterInfo:h.data.clusterInfo}}}({parentStore:t,environment:Z,requestInput:e,spaceId:null==m?void 0:m.id,searchSessionId:h,searchSessionFlowNumber:D.default.state.numServerRequests,publicAccessPermission:i,isOnline:P,source:R.ZP.state.source,searchExperimentOverrides:c,forcedClusterPattern:u,recentPagesForBoosting:T}),n={query:R.ZP.state.query,limit:R.ZP.state.limit,debug:A.ZP.getDebugLevel()};if(W().isEqual(e,n)){if(a&&!a.error){const e=a.value.results;o.update((t=>({...t,serverError:null==a?void 0:a.error,serverResultsLoading:!1,serverResults:w.b9(a),serverResultsAllLoaded:e.length<M,serverEventProperties:a.value.serverEventProperties,localResults:o.state.clearLocalResultsOnServerResponse?void 0:t.localResults,clearLocalResultsOnServerResponse:!1})))}else o.update((e=>({...e,serverError:null==a?void 0:a.error,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0,localResults:o.state.clearLocalResultsOnServerResponse?void 0:e.localResults,clearLocalResultsOnServerResponse:!1})));return a}}),[p,g,o,S,M,b,t,Z,null==m?void 0:m.id,h,i,P,c,u,T],{debounce:Je.vp}),(0,H.r5)((()=>{const e=_?function(e){const{parentStore:t,requestInput:i,isOnline:a,environment:n,publicAccessPermission:s,localSearchCache:o}=e,{query:r}=i;if(!o)return;if(!r.text.trim())return;if(s)return;const l=Mi.default.createMetric("rum.local_quick_search_query"),d=w.tz({input:i,cache:o});if(!d)return;if(0===d.results.length)return{error:Ze.Ix.NoResults};const c=w.YB({sort:r.sort,unsorted:d.results,batchSize:R.Xv,currentUserId:n.currentUser.id}).map(((e,i)=>({...e,originalPosition:i,store:Fe.Z.createChildStore(t,{table:ke.iU,id:e.id})}))),u=a?w.g8(n,c):c,m=a?u.length:d.total;if(0===m)return{error:Ze.Ix.NoResults};const p={value:{total:m,results:u,debugInfo:void 0}};return Mi.default.emit(n,l,void 0),p}({parentStore:t,environment:Z,requestInput:{query:S,limit:M},publicAccessPermission:i,isOnline:P,localSearchCache:s}):void 0;D.default.update((e=>({...e,numLocalRequests:e.numLocalRequests+1})));const a=w.b9(e);return W().isEmpty(null==a?void 0:a.results)&&F(o.state)&&o.state.serverResultsLoading?o.update((e=>({...e,clearLocalResultsOnServerResponse:!0}))):o.update((e=>({...e,clearLocalResultsOnServerResponse:!1,localResults:a}))),Promise.resolve(e)}),[Z,P,M,_,s,t,i,S,o],{debounce:Je.E5});const x=(0,r.useCallback)((()=>{!o.state.serverResultsLoading&&!o.state.serverResultsAllLoaded&&void 0!==o.state.serverResults&&R.ZP.update((e=>({...e,limit:e.limit+R.Xv,source:"quick_find_scroll"})))}),[o]),B=(0,r.useMemo)((()=>w.oO({results:{local:f,server:v}})),[f,v]);return(0,z.VK)((()=>{if(!B||B.length<0)return void o.update((e=>({...e,jumpToResult:void 0})));const e=B[0];e.sources.includes(Ze.vp.Local)?o.update((t=>({...t,jumpToResult:e}))):o.update((e=>({...e,jumpToResult:void 0})))}),[o,B]),n()(xi,{errorState:d,resultsSectionRef:l,handleSelectResult:e.handleSelectResult,onMaybeLoadMoreResults:x,resultListStore:a,results:B,debugInfo:C,clusterInfo:y,parentStore:t,publicAccessPermission:i})};var Di=i(15102),Ri=i(1800),Li=i(54642),Oi=i(47307),Ni=i(53471),Ui=i(60709),Wi=i(92660),Vi=i(4637),zi=i(48243);const Gi=(0,re.defineMessages)({additionalInformationPlaceholder:{id:"SearchBadResultsForm.additionalInformation.placeholder",defaultMessage:"Any additional comments or context (e.g. ...)",description:"Text box for any freeform feedback describing why the search results are poor quality"},urlPlaceholder:{id:"SearchBadResultsForm.url.placeholder",defaultMessage:"Link to page you were looking for",description:"Hyperlink to the the search page the user was looking for"}}),Hi=e=>{const t=(0,G.F)(),i=(0,z.qz)(void 0,Ke.Z);return n()(Ft.Z,{popupType:Ft.Z.PopupType.Popup,buttonPopupStore:i,renderOrigin:e=>l().createElement(l().Fragment,null,l().createElement(Ht.Z,N()({style:{width:"100%"}},e),n()(Ci.Z,{title:"Select Result"}),Me.Z.chevronDown({width:10,marginLeft:4,fill:t.lightIconColor}))),placementToOrigin:Ui.Iw.Bottom,alignmentToOrigin:Ui.lU.Start,render:t=>{var i;const a=[{key:"results",render:e=>l().createElement(me.Z,N()({},e,{topBorder:0!==e.index})),items:(null===(i=e.results)||void 0===i?void 0:i.map((i=>({key:i.id,render:e=>l().createElement(et.Z,N()({store:i.store,checkState:!1,hidePath:!0},e)),action:()=>{e.onSelect(i),t.close()}}))))||[]}],s={menuType:ae.Z.MenuType.Popup,width:240};return l().createElement(ae.Z,s,n()(ce.Z,{type:ce.Z.Type.Vertical,initialFocus:void 0,sections:a}))}})};function qi(){hi.reset()}const Ki=e=>{let{searchStoreState:t,currentSpaceStore:i,serverResults:a,localResults:s,environment:o}=e;const r=hi.getState(),l=w.AX(a),d=w.AX(s),c={query:t.query,limit:t.limit,debug:"everything"},u=w.bC(o),m=w.gC({input:c,spaceId:null==i?void 0:i.id,publicAccessPermission:u,source:"report_bad_search"});if(!m)return;const p={queryText:t.query.text.trim(),apiRequest:m,serverResults:JSON.stringify(l,null,2),localResults:JSON.stringify(d,null,2),desiredUrl:r.desiredUrl,additionalInformation:r.additionalInformation,screenshotUrl:r.screenshotUrl};(0,Li.reportBadSearch)(o,p).then((e=>{200!==e.status&&Oi.showErrorMessage(n()("h1",{},void 0,"Failed to submit report"))})),hi.reset()},ji=function(e){const{serverResults:t,localResults:i,combinedResults:a}=e,s=(0,V.Fy)(),o=(0,G.y)((e=>({textArea:{width:"100%",background:e.popoverBackground,display:"block",marginTop:17,marginBottom:17},urlArea:{width:"100%",height:"50%",background:e.popoverBackground,display:"block",marginTop:17,marginBottom:17},modalWrap:{width:360,padding:24,fontSize:14},modalTitle:{fontSize:16,marginBottom:12,fontWeight:oe.Z.fontWeight.medium},buttonArea:{display:"flex",justifyContent:"flex-end",marginTop:18},outlineButton:{marginRight:12},screenshotWrapper:{display:"flex",flexDirection:"column",justifyContent:"center",alignContent:"center",alignItems:"center"}})),[]),[d]=(0,r.useState)(R.ZP),[{currentSpaceStore:c}]=(0,z.oR)(k.default),[u,m]=(0,z.oR)(hi),[p,g]=(0,r.useState)("at-rest"),h=(0,V.O7)(),{screenshotUrl:f}=u,y=async()=>{try{g("screenshotting");const e=await(async()=>new Promise((async(e,t)=>{const i=document.createElement("canvas");i.width=window.outerWidth;const a=i.getContext("2d"),n=document.createElement("video");if(!a)return;const s=A.ZP.state.showDebugInfo;A.ZP.setStateWithoutPersisting({...A.ZP.state,showDebugInfo:!0});const o=await navigator.mediaDevices.getDisplayMedia();n.srcObject=o,await n.play(),setTimeout((()=>{var r,l;i.width=(null===(r=o.getTracks()[0])||void 0===r?void 0:r.getSettings().width)||1400,i.height=(null===(l=o.getTracks()[0])||void 0===l?void 0:l.getSettings().height)||900,a.drawImage(n,0,0,i.width,i.height),A.ZP.setStateWithoutPersisting({...A.ZP.state,showDebugInfo:s}),i.toBlob((i=>{if(!i)return t("no blob!");const a=new File([i],"fileName.jpg",{type:"image/jpeg"});return o.getTracks().forEach((e=>e.stop())),e(a)}),"image/jpeg")}),500)})))();if(!e)throw new Error("no file");return new Promise((async(t,i)=>{g("uploading"),await(0,Ni.cT)({environment:h,file:e,bucket:"public",preventLimitFreeFileSize:!0,onComplete:e=>(hi.setState({...hi.state,screenshotUrl:e}),t(e)),onError:i}),g("at-rest")}))}catch(e){throw g("at-rest"),e}},S=(0,r.useCallback)((e=>{m({...u,desiredUrl:e?(0,Ri.Z)({pageId:e.store.id,pageValue:e.store.getValue(),baseUrl:v.Z.domainBaseUrl}):void 0})}),[u,m]),M=(0,r.useCallback)((()=>{Ki({searchStoreState:d.state,currentSpaceStore:c,serverResults:t,localResults:i,environment:h})}),[d,c,t,i,h]);return n()(Wi.Z,{onDismiss:qi,style:"screenshotting"===p?{display:"none"}:{},render:()=>n()(ee.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:e=>l().createElement("div",N()({style:o.modalWrap},e),n()("div",{style:o.modalTitle},void 0,n()(re.FormattedMessage,{id:"SearchBadResultsForm.title",defaultMessage:"Report Bad Search",description:"Title for the poor search quality report form."})),n()(si.Z,{textarea:!0,style:o.textArea,placeholder:Xe.default.formatMessage(Gi.additionalInformationPlaceholder),value:u.additionalInformation,onChange:e=>{m({...u,additionalInformation:e.target.value})},focusInitial:!0}),n()(Hi,{results:a,onSelect:S}),n()(si.Z,{textarea:!0,style:o.urlArea,placeholder:Xe.default.formatMessage(Gi.urlPlaceholder),value:u.desiredUrl,onChange:e=>{m({...u,desiredUrl:e.target.value})}}),!s.isNative&&n()("div",{style:o.screenshotWrapper},void 0,"uploading"===p?n()(fi.Z,{}):n()(fe.Z,{onClick:y},void 0,"Click to Include Screenshot"),f&&"at-rest"===p&&n()(zi.Z,{url:f,isAuthenticated:!1,stripGoogleIconQuery:!0,width:90,render:(e,t)=>n()("div",{style:{width:90,height:90}},void 0,n()(Vi.Z,{src:t,style:{width:90,height:90,objectFit:"fill",borderRadius:3}}))})),n()("div",{style:o.buttonArea},void 0,n()(fe.Z,{isLarge:!0,onClick:qi,style:o.outlineButton},void 0,n()(re.FormattedMessage,{id:"SearchBadResultsForm.cancelButton.label",defaultMessage:"Cancel",description:"Exit the modal"})),n()(fe.Z,{isRed:!0,isLarge:!0,onClick:M,disabled:"at-rest"!==p,disabledFeedback:!0},void 0,n()(re.FormattedMessage,{id:"SearchBadResultsForm.reportButton.label",defaultMessage:"Submit",description:"Submit the form"}))))}),requireOnline:!0,modalStore:hi})};function Yi(e){const[t,i]=(0,z.oR)(hi),a=(0,G.y)((e=>({button:{...ye(e)}})),[]);return n()(fe.Z,{style:a.button,onClick:()=>{i({...t,open:!0})}},void 0,n()(re.FormattedMessage,{defaultMessage:"Report bad search",id:"search.header.badSearch.button.label",description:"Button that takes user to the poor search result page"}),l().createElement(ji,e))}class Qi extends d.Z{constructor(){super(...arguments),o()(this,"storeTypes",{requestModalOpen:de.default.of(!1),responseModalOpen:de.default.of(!1)}),o()(this,"styles",{footer:()=>{const{device:e}=this.environment;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:e.isMobile?oe.Z.fontSize.UIRegular.mobile:oe.Z.fontSize.UIRegular.desktop}},footerText:{fontSize:ge.yv(this.environment,"UISmall"),...oe.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16},resultCountWrapper:{display:"flex",alignItems:"center",...oe.Z.textOverflowStyle},resultCount:{fontWeight:oe.Z.fontWeight.medium},resultText:{verticalAlign:"middle",marginRight:6},spinner:{display:"inline",width:12,height:12,verticalAlign:"middle"},keyboardShortcut:{marginRight:4,marginBottom:1,fontVariant:"all-small-caps",fontSize:1.1*ge.yv(this.environment,"UISmall")},commandGlyph:{fontSize:.75*ge.yv(this.environment,"UIRegular")},footerDebugButton:ye(this.theme),debugModalStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll"},navigationHints:{marginLeft:15}})}renderComponent(){const{localResults:e,serverResults:t,shouldShow:i}=this.props,a="production"!==v.Z.env&&"staging"!==v.Z.env;if(!a&&!i)return;const s=this.styles,o=this.getThemeColors(),r={...s.resultCount,...o.resultCount},{count:d,isLowerBound:c}=this.getResultCount(),u=n()("span",{style:s.resultText},void 0,c?this.props.intl.formatMessage({id:"SearchResultsFooter.helpText.resultCountApproximate",description:"Approximate number of results displayed in footer of search modal.",defaultMessage:"{resultCount, plural, other {<resultwrapper>{resultCount}+</resultwrapper> results}}"},{resultCount:d,resultwrapper:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("span",{style:r},void 0,t)}}):this.props.intl.formatMessage({id:"SearchResultsFooter.helpText.resultCount",description:"Exact number of results displayed in footer of search modal.",defaultMessage:"{resultCount, plural, one {<resultwrapper>{resultCount}</resultwrapper> result} other {<resultwrapper>{resultCount}</resultwrapper> results}}"},{resultCount:d,resultwrapper:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()("span",{style:r},void 0,t)}})),m=n()("div",{style:s.resultCountWrapper},void 0,u,this.renderSpinner(this.props.showSpinner),n()("div",{style:s.navigationHints},void 0,n()(we,{})));return n()(Se,{title:m,right:l().createElement(l().Fragment,null,a&&n()(Yi,{localResults:null==e?void 0:e.results,serverResults:null==t?void 0:t.results,combinedResults:this.props.combinedResults}),this.renderSearchDebugButtons())})}renderSpinner(e){const t=this.styles;return n()(vi.Z,{show:e,showDelay:500,showHold:200,render:e=>e&&n()(fi.Z,{style:t.spinner})})}renderSearchDebugButtons(){var e,t;if(!A.ZP.state.debug&&!A.ZP.state.showDebugInfo)return;const{rawRequest:i,rawResponse:a}=(null===(e=this.props.serverResults)||void 0===e||null===(t=e.debugInfo)||void 0===t?void 0:t.requests[0])||{};return l().createElement(l().Fragment,null,i&&l().createElement(l().Fragment,null,n()(Di.Z,{open:this.stores.requestModalOpen.state,innerStyle:this.styles.debugModalStyle,onDismiss:()=>{this.stores.requestModalOpen.setState(!1)},render:()=>n()(_e.LazyAdminReactJson,{showCopyButton:!0,data:i})}),n()(fe.Z,{style:this.styles.footerDebugButton,onClick:()=>this.stores.requestModalOpen.setState(!0)},void 0,"Open Request")),a&&l().createElement(l().Fragment,null,n()(Di.Z,{open:this.stores.responseModalOpen.state,innerStyle:this.styles.debugModalStyle,onDismiss:()=>{this.stores.responseModalOpen.setState(!1)},render:()=>n()(_e.LazyAdminReactJson,{showCopyButton:!0,data:a,defaultCollapsed:!0})}),n()(fe.Z,{style:this.styles.footerDebugButton,onClick:()=>this.stores.responseModalOpen.setState(!0)},void 0,"Open Response")))}getResultCount(){var e,t;const{serverResults:i,localResults:a}=this.props,n=null!==(e=null!==(t=null==i?void 0:i.total)&&void 0!==t?t:null==a?void 0:a.total)&&void 0!==e?e:0,s=Boolean(i&&n>=100);return{count:n,isLowerBound:Boolean(i&&a&&n<R.Xv)||s}}getThemeColors(){return{footerText:{color:this.theme.lightTextColor},resultCount:{color:this.theme.mediumTextColor},keyboardShortcut:{color:this.theme.mediumTextColor}}}}const Ji=(0,re.injectIntl)(Qi),Xi="80vh";function $i(e){const t=(0,V.Fy)();return n()(te.Z,{capture:!0,ignoreBlockSelection:!0,focusOffscreenInput:!1,restoreSelection:!t.isMobile,render:()=>n()(ee.Z,{capture:!0,allowMenuList:!0,render:t=>l().createElement(ea,N()({},e,{ignoreAreaEvents:t}))})})}function ea(e){const{parentStore:t,ignoreAreaEvents:i,renderAsPage:a,onClose:s,modalBodyMenuRef:o,searchFilterMenuRef:d,queryResultsSectionRef:c,searchResultStore:u}=e,m=(0,G.y)((e=>({body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},topbar:{height:void 0,marginTop:10,marginLeft:16,marginBottom:10,marginRight:16},topbarRightButtonWrapper:{flex:void 0,paddingLeft:16},topbarButton:{fontWeight:void 0,padding:0,color:e.mediumTextColor},scroller:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",maxHeight:a?"100vh":Xi},defaultBodyScroller:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",maxHeight:a?"100%":"50vh"},clearButton:{color:e.lightTextColor},sxsContainer:{display:"flex",flexDirection:"row",height:"100%",overflow:"hidden",maxWidth:"100%"}})),[a]),[p,g,h]=(0,z.oR)(void 0,X.Z),[f,v]=(0,r.useState)(!1),[y,S]=(0,r.useState)(!1),M=(0,V.O7)(),b=(0,V.Fy)(),[C]=(0,z.oR)(k.default),{isSearchMenuOpen:T,shouldShowSpinner:Z,localResults:P,serverResults:_,shouldShowFilterSidebar:x,publicAccessPermission:F,hasQuery:B,errorState:L,showMajorError:O,hasResults:U,searchExperimentOverridesLeft:q,searchExperimentOverridesRight:Y,forcedClusterPatternRight:ee,forcedClusterPatternLeft:te,shouldShowSxSView:ie}=(0,z.VK)((()=>{const e=Boolean(Q.Z.state.online),t=w.bC(M),i=u.state.errorState;return{isSearchMenuOpen:I.default.state.open,shouldShowSpinner:e&&Boolean(R.ZP.state.query.text)&&u.state.serverResultsLoading&&!f,localResults:u.state.localResults,serverResults:u.state.serverResults,shouldShowFilterSidebar:na({device:b,isPublicAccessPermissionForPage:Boolean(t)}),publicAccessPermission:t,isMobile:b.isMobile,hasQuery:Boolean(R.ZP.state.query.text)||w.VA(R.ZP.state.query.filters),errorState:i,showMajorError:!1===i.isLoading&&i.showMajorError,hasResults:Boolean(u.state.localResults||u.state.serverResults),isLoading:i.isLoading,searchExperimentOverridesLeft:A.v_.state.searchExperimentOverrides,searchExperimentOverridesRight:A.BJ.state.searchExperimentOverrides,forcedClusterPatternLeft:A.v_.state.forcedClusterPattern,forcedClusterPatternRight:A.BJ.state.forcedClusterPattern,shouldShowSxSView:(0,A.gq)({device:b})}}),[f,u,b,M]),ne=(0,r.useMemo)((()=>W().debounce((()=>{const{activeElement:e}=document;e instanceof HTMLInputElement&&e.blur()}),500,{leading:!0})),[]),se=(0,r.useCallback)((()=>{y&&ne()}),[ne,y]),oe=(0,r.useCallback)((e=>{var t;""!==e?(D.default.update((e=>({...e,numKeystrokes:e.numKeystrokes+1}))),R.ZP.setState({...R.ZP.state,query:{...R.ZP.state.query,text:e},limit:R.Xv,source:"quick_find_input_change",recentPagesForBoosting:null!==(t=k.default.state.currentSpaceStore)&&void 0!==t&&t.id&&J.Z.get(k.default.state.currentSpaceStore.id)||[]}),h.update((e=>({...e,focus:{section:0,indexLocal:0,indexGlobal:0}})))):R.ZP.resetQuery({resetFilters:!1})}),[h]),re=(0,r.useCallback)((e=>{S(e),e||b.isMobileNative&&$.Z.updateKeyboardPhase(M,$.i.willHide,0)}),[b.isMobileNative,M]),le=(0,r.useMemo)((()=>n()(Si,{isOpen:Boolean(a||T),onTypingChange:v,onFocusChange:re,showSpinner:Z,onQueryChange:oe,searchResultStore:u})),[a,T,re,Z,oe,u]),de=(0,r.useMemo)((()=>{if(b.isMobile){return{menuType:j.o.Modal,left:le,shouldRenderLeftDirectly:!0,width:a?"100vw":void 0,...ia({isPhone:b.isPhone,renderAsPage:a,style:m.topbarRightButtonWrapper,onClick:s}),header:B&&n()(mi,{parentStore:t,isPublicPageSearch:Boolean(F)}),disableHeaderShadow:!0,topbarStyle:m.topbar,leftRightButtonStyle:m.topbarButton,onScroll:aa(b)?se:void 0,bodyScrollerClassName:K.GZ,...i}}if(!B){const e={menuType:j.o.Popup,maxHeight:"80vh",minHeight:50,disableScroller:!0,scrollerStyle:m.defaultBodyScroller,...i};return a&&b.isDesktop&&(e.maxWidth="100%"),e}const e={menuType:j.o.Popup,maxHeight:a?"100vh":Xi,minHeight:50,disableScroller:!0,scrollerStyle:m.scroller,...i};return a&&b.isDesktop&&(e.maxWidth="100%"),e}),[b,m,i,le,a,s,B,t,F,se]),[{value:ce}]=(0,H.r5)((()=>async function(e){let{environment:t,appStoreState:{currentSpaceStore:i,currentSpaceViewStore:a},isPublicAccessPermissionForPage:n}=e;if(n)return;if(!i)return;return w.hb({environment:t,currentSpaceStore:i,currentSpaceViewStore:a})}({environment:M,appStoreState:C,isPublicAccessPermissionForPage:Boolean(F)})),[M,C,F]),ue=(0,r.useMemo)((()=>w.oO({results:{local:null==P?void 0:P.results,server:null==_?void 0:_.results}})),[P,_]),me={parentStore:t,publicAccessPermission:F,resultListStore:h,localSearchCache:ce,searchResultStore:u,queryResultsSectionRef:c,errorState:L,handleSelectResult:e.handleSelectResult,searchExperimentOverrides:q,forcedClusterPattern:te},[,,pe]=(0,z.oR)(void 0,X.Z),[ge,,he]=(0,z.oR)(void 0,E),fe={...me,resultListStore:pe,searchResultStore:he,searchExperimentOverrides:Y,forcedClusterPattern:ee};return l().createElement(ae.Z,N()({},de,{className:K.O,ref:o}),n()(ta,{enableLazyLoading:a},void 0,n()("div",{style:m.body},void 0,!b.isMobile&&le,!b.isMobile&&n()(Vt,{parentStore:t,isMobile:b.isMobile}),B?l().createElement(l().Fragment,null,!O&&b.isMobile&&l().createElement(di,{parentStore:t,isMobile:!0,mode:ri.Section,ref:d}),n()("div",{style:m.sxsContainer},void 0,n()("div",{style:{display:"flex",flexDirection:"column",width:ie?"50%":"100%"}},void 0,l().createElement(Ei,me),n()(Ji,{localResults:P,serverResults:_,combinedResults:ue,showSpinner:Z,shouldShow:!O&&U&&!b.isMobile})),ie&&n()("div",{style:{display:"flex",flexDirection:"column",width:ie?"50%":"100%"}},void 0,l().createElement(Ei,fe),n()(Ji,{localResults:ge.localResults,serverResults:ge.serverResults,combinedResults:ue,showSpinner:ge.serverResultsLoading,shouldShow:!b.isMobile})))):n()(He,{parentStore:t,onSelect:e.onRecentPageSelect,resultListStore:h})),x&&l().createElement(di,{parentStore:t,ref:d})))}function ta(e){const{enableLazyLoading:t,children:i}=e,a=(0,V.O7)();return t?n()(ie.Z,{fetch:async()=>{var e;await q.Vs(0),await k.default.waitUntil((()=>void 0!==k.default.state.currentSpaceStore)),null===(e=a.mobileNative)||void 0===e||e.markTransitionReady({type:"search"})},loading:()=>n()(r.Fragment,{}),render:()=>i}):n()(r.Fragment,{},void 0,i)}function ia(e){let{isPhone:t,style:i,renderAsPage:a,onClick:s}=e;return t&&(0,Y.Y)("supportsNativeHome")||a?{rightOuterStyle:{display:"none"}}:{right:n()(ne.CancelMenuText,{}),onClickRight:s,rightOuterStyle:i}}function aa(e){return!!e.isMobile&&(!e.isIOS||e.isMobileNative)}function na(e){let{device:t,isPublicAccessPermissionForPage:i}=e;if(!i&&!t.isMobile)return R.ZP.isSidebarOpen()}class sa extends d.Z{constructor(){super(...arguments),o()(this,"inactiveTimer",void 0),o()(this,"spaceId",void 0),o()(this,"isOpen",!1),o()(this,"queryResultsSectionRef",l().createRef()),o()(this,"searchFilterMenuRef",l().createRef()),o()(this,"modalBodyMenuRef",l().createRef()),o()(this,"storeTypes",{localCacheRequestStore:Z.Z,searchResultStore:E}),o()(this,"renderContent",(()=>n()($i,{renderAsPage:this.props.renderAsPage,parentStore:this.props.parentStore,onRecentPageSelect:this.onRecentPageSelect,onClose:this.handleComponentClose,searchResultStore:this.stores.searchResultStore,handleSelectResult:this.onQueryResultSelect,searchFilterMenuRef:this.searchFilterMenuRef,modalBodyMenuRef:this.modalBodyMenuRef,queryResultsSectionRef:this.queryResultsSectionRef}))),o()(this,"onRecentPageSelect",(e=>{this.handleSelectResult({...e,context:"recent_pages"})})),o()(this,"onQueryResultSelect",(e=>{this.handleSelectResult({...e,context:"query_results"})})),o()(this,"handleComponentOpenClose",(()=>{this.isOpen!==I.default.state.open&&(this.isOpen=I.default.state.open,I.default.state.open?(clearTimeout(this.inactiveTimer),R.ZP.update((e=>({...e,hasScrolled:!1,hasHoveredForContext:!1})))):this.addRecentSearch())})),o()(this,"getNumResultsAboveFold",(()=>w.MQ({environment:this.environment,searchResultsSection:this.queryResultsSectionRef.current,modalBodyMenu:this.modalBodyMenuRef.current,searchFilterMenu:this.searchFilterMenuRef.current}))),o()(this,"getNumLocalResults",(()=>{var e,t;return null!==(e=null===(t=this.stores.searchResultStore.state.localResults)||void 0===t?void 0:t.results.length)&&void 0!==e?e:0})),o()(this,"handleComponentClose",(()=>{const{device:e}=this.environment,{searchResultStore:t}=this.stores,{selectedQueryResult:i,numKeystrokes:a,numServerRequests:n,numLocalRequests:s,hadMetaClick:o}=D.default.state,{serverEventProperties:r}=t.state,{query:l,hasScrolled:d}=R.ZP.state;if(a>0&&(n>0||s>0)&&!i&&!o&&(I.default.state.openAsPage||I.default.state.open)){const e=Date.now(),t=I.default.state.openedTimeMs,i=I.default.state.sessionId;p.trackAbandonedSearch(this.environment,{...r,timeToAbandonMs:e-t,numKeystrokes:a,numResultsAboveFold:this.getNumResultsAboveFold(),searchSessionId:i,searchSessionFlowNumber:n,hasScrolled:d,numLocalResults:this.getNumLocalResults()})}this.props.renderAsPage||h.IB(),""===l.text.trim()?R.ZP.reset():w.FN(l.filters)||R.ZP.update((e=>({...e,isSidebarOpen:!1}))),this.inactiveTimer=window.setTimeout(this.resetState,2*m.hM),e.isMobile&&f.close(),D.default.reset()})),o()(this,"handleSelectResult",(e=>{let{store:t,action:i,context:a,selectedResult:n,allSearchResults:s}=e;const{searchResultStore:o}=this.stores,{serverEventProperties:r}=o.state,{numKeystrokes:l,hadMetaClick:d}=D.default.state;if(!I.default.state.open&&!I.default.state.openAsPage)return;const{event:c}=i,u=c.metaKey||c.ctrlKey;"query_results"===a&&this.stores.searchResultStore.update((e=>({...e,selectedQueryResult:!0})));const m=Date.now(),{openedTimeMs:h,sessionId:f}=I.default.state,{numServerRequests:y}=D.default.state,{query:M}=R.ZP.state;p.trackSelectSearchItem(this.environment,{...r,context:a,queryStringLength:M.text.trim().length,hasFilters:w.FN(M.filters),activeFilters:M.filters,selectedItemIndex:i.index,numKeystrokes:l,isMetaClick:Boolean(u),isSidebarOpen:R.ZP.isSidebarOpen(),timeToSelectMs:m-h,sources:null==n?void 0:n.sources,hadMetaClick:d,numResultsAboveFold:this.getNumResultsAboveFold(),selectedSearchResultMetadata:this.getSearchResultMetadata(t,null==n?void 0:n.highlight),selectedSearchResultContent:"production"!==v.Z.env?this.getSearchResultContent(t,null==n?void 0:n.highlight):void 0,allSearchResultMetadata:null==s?void 0:s.slice(0,sa.MAX_RESULT_TO_TRACK).map((e=>this.getSearchResultMetadata(e.store,e.highlight))),totalSearchResultCount:null==s?void 0:s.length,searchSessionId:f,searchSessionFlowNumber:y,originalPosition:null==n?void 0:n.originalPosition,numLocalResults:this.getNumLocalResults()}),void 0!==(null==n?void 0:n.highlightBlockId)?g.navigateToBlock({environment:this.environment,store:t,scrollToBlockId:null==n?void 0:n.highlightBlockId,metaClick:u,visitType:S.vu.Search}):g.navigateToPage(t,u,this.environment),u?D.default.update((e=>({...e,hadMetaClick:!0}))):this.handleComponentClose()})),o()(this,"getSearchResultMetadata",((e,t)=>c.Z.withListenerIgnored((()=>{var i;return{blockId:e.id,blockType:e.getType(),lowestNavigableAncestorId:null===(i=e.getNavigableBlockStore())||void 0===i?void 0:i.id,depth:M.qA(e).length,matchesText:Boolean(null==t?void 0:t.text),matchesPathText:Boolean(null==t?void 0:t.pathText),isNavigable:e.isNavigableBlock(),lastEditedTime:e.getKeyStore("last_edited_time").getValue()}})))),o()(this,"getPathText",(e=>{const t=[];return M.uJ(e).forEach((e=>{if(b.NZ(e)){var i;const a=(0,u.Q)(null===(i=e.getNavigableBlockStore())||void 0===i?void 0:i.getTitleValue());a&&t.push(a)}else if((0,T.bq)()&&b.Y(e)){const i=e.getName();i&&t.push(i)}})),t})),o()(this,"handleSpaceChange",(()=>{const e=k.default.state.currentSpaceStore&&k.default.state.currentSpaceStore.id;this.spaceId!==e&&(this.spaceId=e,this.resetState())})),o()(this,"addRecentSearch",(()=>{const{currentSpaceStore:e}=k.default.state;if(!e)return;const{query:t}=R.ZP.state;t.text.trim()&&F(this.stores.searchResultStore.state)&&C._({currentUserId:this.environment.currentUser.id,spaceId:e.id,query:t})})),o()(this,"resetState",(()=>{const{localCacheRequestStore:e,searchResultStore:t}=this.stores;R.ZP.reset(),e.reset(),I.default.reset(),t.reset()}))}willMount(){var e;this.spaceId=null===(e=k.default.state.currentSpaceStore)||void 0===e?void 0:e.id,(0,A.lO)()}didMount(){this.props.renderAsPage||I.default.addListener(this.handleComponentOpenClose),k.default.addListener(this.handleSpaceChange)}willUnmount(){this.props.renderAsPage||I.default.removeListener(this.handleComponentOpenClose),k.default.removeListener(this.handleSpaceChange),this.inactiveTimer&&(clearTimeout(this.inactiveTimer),this.inactiveTimer=void 0)}renderComponent(){if(this.props.renderAsPage)return this.renderContent();const{device:e,mobileNative:t}=this.environment,i=Boolean(I.default.state.open);return n()(L.Z,{open:i,onDismiss:this.handleComponentClose,modalStyle:this.getModalStyle(),disableAnimation:!e.isMobile||(null==t?void 0:t.supportsNativeHomeOnPhone())||!1,renderContent:this.renderContent})}getPublicAccessPermissionForPage(){return w.bC(this.environment)}getSearchResultContent(e,t){return c.Z.withListenerIgnored((()=>{var i;return{title:(0,u.Q)(null===(i=e.getNavigableBlockStore())||void 0===i?void 0:i.getTitleValue()),pathText:this.getPathText(e),highlight:{text:(0,y.fe)(null==t?void 0:t.text),pathText:(0,y.fe)(null==t?void 0:t.pathText)}}}))}getModalStyle(){const{renderAsPage:e}=this.props,t=(0,A.gq)({device:this.environment.device}),i=na({device:this.environment.device,isPublicAccessPermissionForPage:Boolean(this.getPublicAccessPermissionForPage())});return{width:"75%",minHeight:sa.MIN_MENU_HEIGHT,maxHeight:e?"100vh":sa.MAX_MENU_HEIGHT,background:this.theme.popoverBackground,maxWidth:t?"90vw":i?900:660}}}o()(sa,"MAX_RESULT_TO_TRACK",50),o()(sa,"MIN_MENU_HEIGHT",50),o()(sa,"MAX_MENU_HEIGHT","80vh");const oa=sa},69507:(e,t,i)=>{i.d(t,{l:()=>m});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=i(67294),l=i.n(r),d=i(83355),c=i(5366),u=i(83071);class m extends d.Z{renderComponent(){return l().createElement(u.Z,n()({title:o()(c.FormattedMessage,{id:"inviteUserModal.searchDropdown.selectPersonTitle",defaultMessage:"Select a person"})},this.props))}}},62889:(e,t,i)=>{i.r(t),i.d(t,{CreateTeamFromPageConfirmModal:()=>y});var a=i(77094),n=i.n(a),s=(i(41817),i(67294),i(480)),o=i(24405),r=i(53397),l=i(5366),d=i(82990),c=i(38363),u=i(23537),m=i(72684),p=i(72693),g=i(92660),h=i(29551),f=i(47966),v=i(51923);function y(){const e=(0,s.O7)(),t=(0,l.useIntl)(),i=(0,u.HC)(),a=(0,o.y)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},infoIcon:{height:16,width:16,fill:e.lightIconColor,marginRight:4},title:{marginTop:16,marginBottom:12,color:e.regularTextColor,fontWeight:d.Z.fontWeight.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]);return n()(g.Z,{onDismiss:()=>{m.Z.setState({open:!1})},render:()=>n()("div",{style:a.modal},void 0,n()(h.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center"},void 0,r.Z.loop(a.loopIcon),n()("div",{style:a.title},void 0,n()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?",description:"Title in confirmation modal for creating a teamspace from a page."})),n()("div",{style:a.description},void 0,n()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page.",description:"Description in confirmation modal for creating a teamspace from a page."})),n()(p.Z,{isLarge:!0,style:a.confirmButton,onClick:()=>{if(m.Z.state.open){const{pageStore:i,flowId:a}=m.Z.state;(0,c.Sq)({environment:e,intl:t,page:i,flowId:a}),m.Z.setState({open:!1})}}},void 0,n()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace",description:"Confirm button in confirmation modal for creating a teamspace from a page."})),n()(f.Z,{isLarge:!0,style:a.cancelButton,onClick:()=>m.Z.setState({open:!1})},void 0,n()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel",description:"Cancel button in confirmation modal for creating a teamspace from a page."})),i&&n()(v.Z,{message:n()(l.FormattedMessage,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces",description:"Learn more link in confirmation modal for creating a teamspace from a page."}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"}))),requireOnline:!0,modalStore:m.Z})}},72360:(e,t,i)=>{i.r(t),i.d(t,{SidebarCreateTeamModal:()=>se});var a=i(77094),n=i.n(a),s=(i(33948),i(41817),i(96486)),o=i.n(s),r=i(67294),l=i.n(r),d=i(480),c=i(28350),u=i(24405),m=i(53397),p=i(82990),g=i(5366),h=i(50906),f=i(38363),v=i(33929),y=i(78122),S=i(27832),M=i(20431),b=i(19522),w=i(33052),C=i(72693),T=i(14947),k=i(62727),Z=i(89206),A=i(68932),I=i(15102),P=i(40039),_=i(13490),x=i(97464),F=i.n(x),B=i(98742),E=i(86275),D=i(60709),R=i(19757),L=i(48762),O=i(46167),N=i(71202),U=i(25584),W=i(83071),V=i(37235);function z(e){let{currentAccessLevel:t,onChange:i}=e;const{device:a}=(0,d.O7)(),s=(0,u.y)((e=>({chevronDown:{width:12,marginLeft:4,fill:e.lightIconColor},selectedButton:{width:"100%",margin:0,paddingTop:4,paddingBottom:4,border:"1px solid ".concat(e.outlineButtonBorder)},selectedCheckmark:{width:a.isMobile?16:14}})),[a.isMobile]),o=(0,E.U)({isCreateTeam:!0,teamStore:void 0,onChange:i,isDefault:!1});return n()(O.Z,{popupType:a.isMobile?O.Z.PopupType.SlideUp:O.Z.PopupType.Popup,renderOrigin:e=>{const i=o.find((e=>e.key===t));return i?l().createElement(L.Z,F()({},e,{title:i.title,caption:i.caption,icon:i.icon({fill:i.iconColor}),right:m.Z.chevronDown(s.chevronDown),focused:!1,shouldWrapCaption:!0,buttonStyle:s.selectedButton})):null},placementToOrigin:D.Iw.Bottom,alignmentToOrigin:D.lU.Start,sameWidthAsOrigin:!0,render:e=>{const i=[{key:"access levels",render:e=>l().createElement(W.Z,F()({},e,{topBorder:0!==e.index})),items:o.map((i=>{const a=i.key===t;return{key:i.key,render:e=>n()(V.Z,{placement:R.ug.Top,disableTooltip:!i.tooltip,renderTooltip:()=>i.tooltip,render:t=>l().createElement(L.Z,F()({},(0,B.Z)(e,t),{title:i.title,caption:i.caption,icon:i.icon({fill:i.iconColor}),right:a?n()("div",{style:s.selectedCheckmark},void 0,m.Z.check()):void 0,disabled:i.disabled,shouldWrapCaption:!0}))}),action:()=>{i.onSelect(),e.close()}}}))}];return n()(N.Z,{menuType:N.Z.MenuType.Popup},void 0,n()(U.Z,{type:U.Z.Type.Vertical,initialFocus:void 0,sections:i}))}})}var G=i(30688),H=i(51923);const q={display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",position:"relative",padding:22},K={createTeamContainer:{...q,width:480},addMembersContainer:{...q,width:500},inputs:{paddingLeft:12,paddingRight:12,paddingBottom:8,width:"100%"}},j=(0,g.defineMessages)({teamNamePlaceholder:{id:"sidebarCreateTeamModal.teamScreen.namePlaceholder",defaultMessage:"Acme Labs"},teamDescriptionPlaceholder:{id:"sidebarCreateTeamModal.teamScreen.descriptionPlaceholder",defaultMessage:"Details about your teamspace"}});function Y(){const[e,t]=(0,c.oR)(b.Z);return l().createElement(l().Fragment,null,n()(_.Z,{hasMarginTop:!0,style:{fontWeight:p.Z.fontWeight.medium,marginTop:18}},void 0,n()(g.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamDescriptionLabel",defaultMessage:"Description"})),n()(k.Z,{value:e.description,placeholder:v.default.formatMessage(j.teamDescriptionPlaceholder),textarea:!0,onChange:i=>{t({...e,description:i.target.value})}}))}function Q(e){return n()("div",{style:{fontSize:18,fontWeight:p.Z.fontWeight.semibold,marginTop:12,textAlign:"center"}},void 0,(()=>{switch(e.screen){case b.F.Team:return n()(g.FormattedMessage,{id:"sidebarCreateTeamModal.teamTitle.label",defaultMessage:"Create a new teamspace"});case b.F.Members:return n()(g.FormattedMessage,{id:"sidebarCreateTeamModal.membersTitle.label",defaultMessage:"Add people"})}})())}function J(){const e=(0,d.O7)(),[t]=(0,c.oR)(b.Z),i=(0,r.useCallback)(((t,i)=>{f.ED({environment:e,from:i,teamStore:t})}),[e]),{open:a,screen:s}=t;if(a)switch(s){case b.F.Team:return n()(ie,{});case b.F.Members:const e=t.teamId;return e?n()(ne,{teamId:e,onCompleted:e=>{i(e,"success")},onCanceled:e=>{i(e,"dismiss_button")}}):null}return null}function X(){const[e,t]=(0,c.oR)(b.Z);return l().createElement(l().Fragment,null,n()(_.Z,{hasMarginTop:!0,style:{fontWeight:p.Z.fontWeight.medium}},void 0,n()(g.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamNameLabel",defaultMessage:"Teamspace name"})),n()(k.Z,{value:e.name,placeholder:v.default.formatMessage(j.teamNamePlaceholder),onChange:i=>{t({...e,name:i.target.value})},preventSafariAutofill:!0}))}function $(e){const t=(0,u.F)();return n()("div",{style:{fontSize:14,color:t.mediumTextColor,width:290,marginTop:3,marginBottom:22,textAlign:"center",lineHeight:1.4}},void 0,(()=>{switch(e.screen){case b.F.Team:return n()(g.FormattedMessage,{id:"sidebarCreateTeamModal.teamDescription.label",defaultMessage:"Teamspaces are where your team organizes pages, permissions, and members"});case b.F.Members:return n()(g.FormattedMessage,{id:"sidebarCreateTeamModal.membersDescription.label",defaultMessage:"Invite people to collaborate"})}})())}function ee(){const[e,t]=(0,c.oR)(b.Z),[i]=(0,c.oR)(S.default),a=(0,d.O7)(),s=(0,u.y)((e=>({box:{justifyContent:"space-between",alignItems:"center",display:"flex",width:"100%",paddingTop:12,paddingBottom:14,paddingRight:14,paddingLeft:14,boxShadow:"0 -1px 0 ".concat(e.regularDividerColor)},button:{marginLeft:8},previous:{fontSize:14,color:e.mediumTextColor,cursor:"pointer"}})),[]),{handleNextClick:o,nextMessage:r,isDisabled:l}={handleNextClick:async()=>{if(!i.currentSpaceStore)return;const n=e.name;if(!(await(0,y.Xg)({environment:a,spaceStore:i.currentSpaceStore,teamName:n})))return;t((e=>({...e,loading:!0})));const s=await(0,f.Cm)({environment:a,name:n,description:e.description,icon:e.icon,accessLevel:e.accessLevel,flowId:e.flowId,createTeamHome:!0});t(s?e=>({...e,loading:!1,screen:b.F.Members,name:"",description:"",teamId:s.id}):e=>({...e,loading:!1,open:!1}))},nextMessage:n()(g.FormattedMessage,{id:"sidebarCreateTeamModal.footer.createTeam",defaultMessage:"Create teamspace"}),isDisabled:""===e.name};return n()("div",{style:s.box},void 0,n()(H.Z,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_sidebar_create_team_modal"}),n()(C.Z,{isLarge:!0,onClick:o,disabled:l,style:s.button},void 0,r))}function te(){const[e,t]=(0,c.oR)(b.Z),i=(0,u.y)((e=>({logo:{fontSize:12,color:e.lightTextColor,marginTop:4},container:{alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",width:"100%"}})),[]),[{currentSpaceStore:a}]=(0,c.oR)(S.default);if(!a)return null;const s=e.icon?{icon:e.icon,pointer:{table:"space",id:a.id}}:void 0;return n()("div",{style:i.container},void 0,n()(P.Z,{disabled:!1,bucket:"public",icon:s,isEmptyPage:!1,title:"team-icon-".concat(a.id),size:56,iconLoggingData:{recordTable:"team",source:"team_creation"},onChange:i=>{t({...e,icon:i})}}),n()("div",{style:i.logo},void 0,n()(g.FormattedMessage,{id:"sidebarCreateTeamModal.logo.label",defaultMessage:"Choose icon"})))}function ie(){const[e]=(0,c.oR)(b.Z),{loading:t}=e,i=(0,u.F)(),a=(0,d.O7)();return(0,r.useEffect)((()=>{if(e.open){const{from:t,flowId:i}=e;h.trackCreateTeamStart(a,{from:t,flowId:i})}}),[]),l().createElement(l().Fragment,null,n()("div",{style:K.createTeamContainer},void 0,n()(Q,{screen:b.F.Team}),n()($,{screen:b.F.Team}),n()("div",{style:{...K.full,...K.inputs}},void 0,n()(te,{}),n()(X,{}),n()(Y,{}),n()(ae,{}))),n()(ee,{}),t&&n()("div",{style:{width:"100%",height:"100%",backgroundColor:i.modalUnderlayBackground,position:"absolute",top:0,left:0}},void 0,n()(A.Z,{style:{position:"absolute",top:"50%",left:"50%"}})))}function ae(){const[e,t]=(0,c.oR)(b.Z);return n()("div",{style:{marginTop:20}},void 0,n()(_.Z,{hasMarginTop:!0,style:{fontWeight:p.Z.fontWeight.medium}},void 0,n()(g.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.permissionsLabel",defaultMessage:"Permissions",description:"Header label above the teamspace access level switcher."})),n()(z,{currentAccessLevel:e.accessLevel,onChange:i=>{t({...e,accessLevel:i})}}))}function ne(e){const t=(0,d.O7)(),[,,i]=(0,c.oR)(b.Z),[,,a]=(0,c.oR)(void 0,w.Z);(0,c.VK)((()=>{const{defaultInviteTargets:e,flowId:t}=i.state;a.setState({...a.state,flowId:t}),e&&a.setState({...a.state,isInviteTargetsEmpty:!1,inviteTargets:e})}),[i,a]);const[s]=(0,c.oR)(S.default);if(!s.currentSpaceStore)return null;const o=M.Z.createChildStore(s.currentSpaceStore,{table:"team",id:e.teamId,spaceId:s.currentSpaceStore.id});return n()("div",{style:K.full},void 0,n()("div",{style:K.addMembersContainer},void 0,n()(G.Z,{store:o,permissionsInviteStore:a,isNewlyCreatedTeam:!0,onSubmitSuccessful:()=>{i.reset(),e.onCompleted(o),(0,f.hI)({environment:t,teamStore:o,shouldScroll:!0})},onDismiss:()=>{i.reset(),e.onCanceled(o)}})))}function se(){const e=(0,d.O7)(),[t,,]=(0,c.oR)(b.Z),i=(0,u.y)((e=>({modal:{maxWidth:600,borderRadius:3},closeButton:{position:"absolute",top:14,right:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:14,fill:e.mediumTextColor},wrapper:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"}})),[]),a=(0,r.useCallback)((t=>{f.ED({environment:e,from:t})}),[e]),{open:s}=t;return n()(I.Z,{open:s,innerStyle:i.modal,onDismiss:()=>{a("modal")},render:()=>{const{device:t}=e;return n()("div",{style:{height:"100%"}},void 0,!t.isMobile&&n()(T.Z,{onClick:()=>{a("close_button")},style:i.closeButton,hoveredStyle:i.closeButtonHover},void 0,m.Z.closeSmall(i.closeButtonIcon)),n()("div",{style:i.wrapper},void 0,n()(Z.Z,{capture:!0,onBackspace:o().identity,onLeft:o().identity,onRight:o().identity,onSelectAll:o().identity,onRedo:o().identity,onUndo:o().identity,onCut:o().identity,onCopy:o().identity,onPaste:o().identity,onKeypress:o().identity,onDelete:o().identity,onTab:o().identity},void 0,n()(J,{}))))}})}},67110:(e,t,i)=>{i.r(t),i.d(t,{default:()=>te});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=i(77422),l=i.n(r),d=(i(33948),i(73210),i(67294)),c=i.n(d),u=i(83355),m=i(8848),p=i(33728),g=i(53397),h=i(19889),f=i(82990),v=i(5366),y=i(21325),S=i(43250),M=i(75472),b=i(33665),w=i(16639),C=i(21115),T=i(27832),k=i(78291),Z=i(33052),A=i(48762),I=i(83182),P=i(71202),_=i(25584),x=i(16328),F=i(15282),B=i(91487),E=i(40039),D=i(7765),R=i(69507),L=i(83071),O=i(47082),N=i(37235),U=i(97680),W=i(96486),V=i.n(W),z=i(480),G=i(24405),H=i(92350),q=i(60709),K=i(46167),j=i(42001);const Y=["owner","member"],Q=(0,v.defineMessages)({ownerLabel:{id:"teamPermissionsMenu.ownerItem.label",defaultMessage:"Teamspace owner"},ownerCaption:{id:"teamPermissionsMenu.ownerItem.caption",defaultMessage:"Can edit teamspace settings and full access to teamspace pages."},memberLabel:{id:"teamPermissionsMenu.memberItem.label",defaultMessage:"Member"},memberCaption:{id:"teamPermissionsMenu.memberItem.caption",defaultMessage:"Cannot edit teamspace settings and can access teamspace pages."}}),J={owner:{label:Q.ownerLabel,caption:Q.ownerCaption},member:{label:Q.memberLabel,caption:Q.memberCaption}};function X(e){const{disabled:t,selectedRole:i,onChange:a,store:s}=e,{device:r}=(0,z.O7)(),l=(0,G.F)(),d=(0,H.ql)(s);return o()(K.Z,{popupType:r.isMobile?K.Z.PopupType.SlideUp:K.Z.PopupType.Popup,renderOrigin:e=>c().createElement(j.Z,n()({disabled:t,disabledFeedback:!0},e),c().createElement(v.FormattedMessage,J[i].label),g.Z.chevronDown({width:10,marginLeft:4,fill:l.lightIconColor})),placementToOrigin:q.Iw.Bottom,render:e=>{const t=[{key:"roles",render:e=>c().createElement(L.Z,n()({},e,{topBorder:0!==e.index})),items:Y.map((t=>{const s=!d&&"owner"===t;return{key:t,render:e=>c().createElement(A.Z,n()({},e,{focused:!1,checkState:V().isEqual(t,i),disabled:s,disabledFeedback:s,title:o()("div",{style:{display:"flex",alignItems:"center"}},void 0,c().createElement(v.FormattedMessage,J[t].label)),caption:o()("span",{style:{color:l.mediumTextColor}},void 0,c().createElement(v.FormattedMessage,J[t].caption)),shouldWrapCaption:!0})),action:()=>{a(t),e.close()}}}))}];let s;return s=r.isMobile?{menuType:P.Z.MenuType.Modal,title:o()(v.FormattedMessage,{id:"userPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:o()(v.FormattedMessage,{id:"userPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:P.Z.MenuType.Popup,width:264},c().createElement(P.Z,s,o()(_.Z,{type:_.Z.Type.Vertical,initialFocus:void 0,sections:t}))}})}const $="member";class ee extends u.Z{constructor(){super(...arguments),l()(this,"storeTypes",{permissionsInviteStore:Z.Z}),l()(this,"handleModalDismiss",(async()=>{const{permissionsInviteStore:e}=this.stores,{disabled:t}=this.props;return e.setState({...e.state,inviteTargets:[],isInviteTargetsEmpty:!0,modalOpen:!t&&await(0,M.Aw)(this.environment,e.state)})})),l()(this,"handleInputChange",(e=>{const t=e.target.value,{extractedEmails:i,newInputValue:a}=(0,p.zI)(t),n=i.map((e=>({type:"newUser",value:{email:e}}))).filter((e=>!(0,M.Nd)({target:e,permissionsInviteStore:this.stores.permissionsInviteStore}))),s=[...this.stores.permissionsInviteStore.state.inviteTargets,...n];s.length>0?this.stores.permissionsInviteStore.setState({...this.stores.permissionsInviteStore.state,inviteTargets:s,isInviteTargetsEmpty:!1,tokenQuery:a}):this.stores.permissionsInviteStore.setState({...this.stores.permissionsInviteStore.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:a})})),l()(this,"handleClickRemoveToken",(e=>{const{permissionsInviteStore:t}=this.stores;if(t.state.isInviteTargetsEmpty)return;const i=t.state.inviteTargets.filter((t=>t!==e));0===i.length?t.setState({...t.state,inviteTargets:[],inviteRole:$,isInviteTargetsEmpty:!0}):t.setState({...t.state,inviteTargets:i})}))}async willMount(){await y.bi(this.environment)}renderComponent(){const{onEmptySubmit:e}=this.props,{permissionsInviteStore:t}=this.stores,{tokenQuery:i}=t.state,a=t.state.inviteTargets.map((e=>{const i="newUser"===e.type?e.value.email:"".concat(e.type,"-").concat(e.value.id);return o()(B.Z,{target:e,onClickRemove:this.handleClickRemoveToken,role:t.state.inviteRole,disabled:this.props.disabled,shouldWrap:!0,style:this.getInputTokenVerticalMarginStyle()},i)})),{device:s}=this.environment,r=this.props.intl.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups",description:"Placeholder text for inviting people or groups to a team"}),l=o()(O.Z,{focus:this.isInputFocusedAndEnabled(),focusInitial:s.isMobile,focusAfterAnimation:!0,format:O.Z.Format.Share,value:i,onChange:this.handleInputChange,type:"email",tokens:a,disabled:this.props.disabled,placeholder:r,onRemoveLastToken:()=>{const e={...this.stores.permissionsInviteStore.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=$),this.stores.permissionsInviteStore.setState(e)},right:!s.isMobile&&this.renderDesktopInputRightInnerSelect({marginLeft:8,display:"flex",alignItems:"center"}),style:this.getTokenMenuItemStyle(),inputAndTokenWrapRightStyle:{alignItems:"center"},inputStyle:this.getInputTokenVerticalMarginStyle(),inputDivStyle:{marginBottom:0},dontShowBorderBottom:s.isAndroid,onEmptySubmit:e}),d=this.isInputFocusedAndEnabled()&&i.length>0,u={request:i,performRequest:e=>(0,M.jL)({query:e,sectionLimit:10,shouldShowBots:!1,shouldShowGroups:!0,membersOnly:this.props.membersOnly,environment:this.environment,intl:this.props.intl}),render:(e,t,a)=>{if(!d)return null;if(e)return o()(R.l,{loading:!a},void 0,o()(x.Z,{title:o()(v.FormattedMessage,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})}));const{inviteUsers:s,inviteGroups:r}=(0,M.NN)({targetStore:this.props.store,permissionsInviteStore:this.stores.permissionsInviteStore,currentInviteActors:t}),{data:l}=k.default.state,u=s.map((e=>({key:"newUser"===e.type?e.value.email:e.value.id,render:t=>{const i=l?C.uF(l):[],a="existingUser"===e.type&&i.find((t=>t.userId===e.value.id));let s;if(a){const t=e.value.name?"".concat(e.value.name," (").concat(e.value.email,")"):e.value.email,{userRoleBadge:i,tooltip:r}=(0,M.Ji)({role:a.role,intl:this.props.intl,nameOrEmail:t});s=o()(N.Z,{renderTooltip:()=>r,render:e=>c().createElement("div",n()({style:(0,M.ZK)({environment:this.environment,customStyle:{minWidth:ee.inviteButtonWidth}})},e),i)})}return"existingUser"===e.type?c().createElement(U.Z,n()({},t,{user:e.value,right:s})):c().createElement(A.Z,n()({},t,{icon:g.Z.mail({width:ee.avatarSize,height:ee.avatarSize}),right:s,title:e.value.email.trim()}))},action:()=>{const{permissionsInviteStore:t}=this.stores;t.setState({...t.state,inviteTargets:[...t.state.inviteTargets,e],isInviteTargetsEmpty:!1,tokenQuery:""})}}))),{currentSpaceStore:m}=T.default.state,y=r.map((e=>{const{value:t}=e,i=(0,w.kF)({intl:this.props.intl,group:t}),a=m&&t.icon?{pointer:{table:m.table,id:m.id},icon:t.icon}:void 0;return{key:t.id,render:e=>c().createElement(A.Z,n()({},e,{icon:o()(E.Z,{disabled:!0,size:22,icon:a,isEmptyPage:!1,title:i}),title:i})),action:()=>{const{permissionsInviteStore:t}=this.stores;t.setState({...t.state,inviteTargets:[...t.state.inviteTargets,e],isInviteTargetsEmpty:!1,tokenQuery:""})}}})),S=[],{permissionsInviteStore:b}=this.stores;if(u.length>0&&S.push({key:"user results",render:e=>c().createElement(R.l,n()({},e,{loading:!a})),items:u}),y.length>0&&S.push({key:"group results",render:e=>c().createElement(L.Z,n()({},e,{title:o()(v.FormattedMessage,{id:"inviteUserModal.searchDropdown.selectGroupTitle",defaultMessage:"Select a group"}),loading:!a})),items:y}),0===S.length){const e=(0,p.H3)(b.state.tokenQuery);if(e){const i={type:"newUser",value:{email:e}},n=(0,M.Nd)({target:i,permissionsInviteStore:this.stores.permissionsInviteStore});if(!n)return;if(n)return o()(R.l,{loading:!a},void 0,o()(x.Z,{title:o()(v.FormattedMessage,{id:"inviteUserModal.userAlreadyInvitedMessage",defaultMessage:"Already inviting {user}.",values:{user:o()("span",{style:{fontWeight:f.Z.fontWeight.bold}},void 0,(0,M.DF)({intl:this.props.intl,target:n}))}})}));const s=(t&&t.inviteUsers||[]).find((t=>"existingUser"===t.type&&t.value.email===e));if(s&&"existingUser"===s.type&&(0,M.Zp)({store:this.props.store,target:s}))return o()(R.l,{loading:!a},void 0,o()(x.Z,{title:o()(v.FormattedMessage,{id:"inviteUserModal.userAlreadyHasPermissionMessage",defaultMessage:"{user} already has permission.",values:{user:o()("span",{style:{fontWeight:f.Z.fontWeight.bold}},void 0,(0,h.Nz)(this.props.intl,s.value))}})}))}return o()(R.l,{loading:!a},void 0,o()(x.Z,{title:o()(v.FormattedMessage,{id:"inviteUserModal.searchPersonDropdown.noSearchResultsMessage",defaultMessage:"Type or paste in emails above, separated by commas."})}))}return o()(_.Z,{type:_.Z.Type.Vertical,initialFocus:i.length>0?0:void 0,sections:S})}};let y;return y=s.isMobile?{menuType:P.Z.MenuType.Modal,title:o()(v.FormattedMessage,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:o()("div",{style:{color:m.ZP.blue}},void 0,o()(v.FormattedMessage,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})),left:o()(F.CancelMenuText,{}),onClickLeft:this.handleModalDismiss,header:l}:{menuType:P.Z.MenuType.Popup,width:"100%",header:l,tokenInputHeader:!1,disableScroller:!0,scrollerStyle:{zIndex:1}},o()("div",{style:{borderRadius:3,boxShadow:this.isInputFocusedAndEnabled()?this.theme.outlineBlueInputBoxShadow:this.theme.inputBoxShadow},onFocus:()=>{t.setState({...t.state,isFocused:!0})},onBlur:()=>{t.setState({...t.state,isFocused:!1})}},void 0,c().createElement(P.Z,n()({},y,{className:S.FJ}),s.isMobile&&o()(L.Z,{title:o()(v.FormattedMessage,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"})},void 0,this.renderDesktopInputRightInnerSelect()),o()("div",{style:{position:"absolute",width:"100%",zIndex:1,backgroundColor:this.theme.popoverBackground,borderRadius:3,boxShadow:this.theme.inputBoxShadow}},void 0,c().createElement(D.Z,u)),s.isMobile&&this.renderHelpButton()))}renderHelpButton(){return o()(L.Z,{topBorder:!0,disableDesktopPadding:!0},void 0,o()(I.Z,{title:o()(v.FormattedMessage,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,b.UY)("guides.invitePerson"),analyticsFrom:"invite_person"}))}renderDesktopInputRightInnerSelect(e){const{permissionsInviteStore:t}=this.stores,i=o()(X,{disabled:this.props.disabled,store:this.props.store,selectedRole:t.state.inviteRole,onChange:e=>t.setState({...t.state,inviteRole:e})});return e?o()("div",{style:e},void 0,i):i}isInputFocusedAndEnabled(){return Boolean(this.stores.permissionsInviteStore.state.isFocused)&&!this.props.disabled}getTokenMenuItemStyle(){const e=8-ee.inputTokenVerticalMargin;return{alignItems:"unset",borderRadius:3,paddingTop:e,paddingBottom:e,paddingLeft:8,paddingRight:e}}getInputTokenVerticalMarginStyle(){return{marginTop:ee.inputTokenVerticalMargin,marginBottom:ee.inputTokenVerticalMargin}}}l()(ee,"avatarSize",24),l()(ee,"inviteButtonWidth",70),l()(ee,"inputTokenVerticalMargin",3);const te=(0,v.injectIntl)(ee)},30688:(e,t,i)=>{i.d(t,{Z:()=>F});var a=i(97464),n=i.n(a),s=i(77094),o=i.n(s),r=(i(33948),i(67294)),l=i.n(r),d=i(480),c=i(28350),u=i(27006),m=i(64684),p=i(82990),g=i(5366),h=i(95209),f=i(38363),v=i(43250),y=i(21115),S=i(77907),M=i(27832),b=i(78291),w=i(72693),C=i(29368),T=i(47966),k=i(50987),Z=i(37235),A=i(93686),I=i(13380);const P={button:{height:32},buttonContainer:{width:"100%",paddingTop:22,display:"flex",justifyContent:"end"},autoAddToggleContainer:{width:"100%",marginTop:22},switcherRow:{marginTop:22},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},titleAndIcon:{paddingBottom:18,alignItems:"center",display:"flex"},addMembersTo:{minWidth:"25%"},icon:{paddingRight:3,paddingLeft:3},teamName:{paddingRight:10,fontWeight:p.Z.fontWeight.medium,...p.Z.textOverflowStyle,maxWidth:250},full:{width:"100%"},submitTooltip:{minWidth:250}},_=e=>{const{store:t,permissionsInviteStore:i,isAddAllMembersToggled:a,membersOnly:n,onEmptySubmit:s}=e;return o()(S.LazyTeamPermissionsInvite,{store:t,permissionsInviteStore:i,disabled:a,membersOnly:n,onEmptySubmit:s})};function x(e){let{isLoading:t,isNewlyCreatedTeam:i,isDefaultTeamChanged:a,onDismiss:s,onSubmit:r,workspaceMembersToInvite:d,includesGroups:c,inviteRole:u}=e,m=o()(g.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.done",defaultMessage:"Done"});const p=d>0,h=p||a,f="owner"===u;return i?p?m=o()(g.FormattedMessage,"owner"===u?{id:"teamPermissionsInviteOverlay.inviteModal.inviteNOwners",defaultMessage:"{numMembers, plural, one {Invite {numMembers} owner} other {Invite {numMembers} owners}}",description:"Button prompt for inviting teamspace owners.",values:{numMembers:d}}:{id:"teamPermissionsInviteOverlay.inviteModal.inviteNMembers",defaultMessage:"{numMembers, plural, one {Invite {numMembers} member} other {Invite {numMembers} members}}",description:"Button prompt for inviting teamspace members.",values:{numMembers:d}}):h||(m=o()(g.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.skipForNow",defaultMessage:"Skip for now",description:"Button prompt to skip adding teamspace members."})):p&&(m=o()(g.FormattedMessage,"owner"===u?{id:"teamPermissionsInviteOverlay.inviteModal.addNOwners",defaultMessage:"{numMembers, plural, one {Add {numMembers} owner} other {Add {numMembers} owners}}",description:"Button prompt for adding teamspace owners.",values:{numMembers:d}}:{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers",defaultMessage:"{numMembers, plural, one {Add {numMembers} member} other {Add {numMembers} members}}",description:"Button prompt for adding teamspace members.",values:{numMembers:d}})),h?o()(Z.Z,{textWrap:!0,style:P.submitTooltip,disableTooltip:!(c&&f),renderTooltip:()=>o()(g.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.groupsAsOwnersTooltip",defaultMessage:"Cannot add groups as teamspace owners. Remove any groups to continue.",description:"Explains to user it cannot proceed to add permission groups as teamspace owners."}),render:e=>l().createElement(w.Z,n()({style:P.button,onClick:r,disabled:t||c&&f},e),m)}):o()(T.Z,{style:P.button,onClick:s,disabled:t},void 0,m)}const F=function(e){let{store:t,permissionsInviteStore:i,isNewlyCreatedTeam:a,onSubmitSuccessful:n,onDismiss:s}=e;const l=(0,d.O7)(),{membersOnly:p,teamName:S,isDefaultTeam:w}=(0,c.VK)((()=>{var e;return{membersOnly:Boolean(t.getDisableGuests()||(null===(e=M.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableGuests())),teamName:t.getName(),isDefaultTeam:t.isDefault()}}),[t]);(0,r.useEffect)((()=>()=>{a&&(0,f.hI)({environment:l,teamStore:t,shouldScroll:!0})}),[a,t,l]);const[T,Z]=(0,r.useState)(!1),[F,B]=(0,r.useState)(w),E=(0,c.VK)((()=>{var e,i;if(a)return!1;const n=null===(e=M.default.state.currentSpaceStore)||void 0===e?void 0:e.getRole(),s=!!n&&(0,u.zz)(n),o=t.getValue(),r=t.getTeamAccessLevel(),l=null===(i=M.default.state.currentUserStore)||void 0===i?void 0:i.id,d=Boolean(o&&l&&(0,m.pd)(o,l));return s&&"open"===r&&d}),[t,a]),D=(0,c.VK)((()=>{const{data:e}=b.default.state;return e?y.su(e):0}),[]),R=(0,c.VK)((()=>F?D:i.state.inviteTargets.length),[F,i,D]),L=(0,c.VK)((()=>i.state.inviteRole),[i]),O=(0,c.VK)((()=>{if(i.state.isInviteTargetsEmpty)return!1;return Boolean(i.state.inviteTargets.find((e=>"group"===e.type)))}),[i]),N=(0,c.VK)((()=>i.state.flowId),[i]),U=w!==F,W=async()=>{if(Z(!0),U){const e=M.default.state.currentSpaceStore;e&&await f.MH({teamStore:t,spaceStore:e,environment:l,isDefault:F,createNewTeamFlowId:N,from:"team_permission_overlay"})}else R>0&&await h.zK({environment:l,store:t,permissionsInviteStore:i,inviteOrigin:"team_invite_overlay"});h.Mr({permissionsInviteStore:i}),Z(!1),null==n||n()};return o()("div",{className:v.D$,style:{...P.full}},void 0,o()("div",{style:P.container},void 0,o()("div",{style:P.titleAndIcon},void 0,o()("div",{style:P.addMembersTo},void 0,o()(g.FormattedMessage,{id:"TeamPermissionsInviteOverlay.membersTitle.label",defaultMessage:"Add members to",description:"A prefix for adding members to a certain teamspace (followed by the teamspace's name)."})),o()("div",{style:P.icon},void 0,o()(A.p,{disabled:!0,store:t,size:20})),o()(I.s,{style:P.teamName},void 0,S)),o()("div",{style:P.full},void 0,o()(_,{store:t,permissionsInviteStore:i,isAddAllMembersToggled:F,membersOnly:p,onEmptySubmit:W})),E&&o()("div",{style:P.autoAddToggleContainer},void 0,o()(C.Z,{size:"100%"}),o()(k.Z,{style:P.switcherRow,title:o()(g.FormattedMessage,{id:"teamSettings.defaultTeam.title",defaultMessage:"Make default teamspace",description:"Shown as a title for a toggle in teamspace settings that indicates whether the teamspace should be synced with the entire workspace."}),subtitle:o()(g.FormattedMessage,{id:"teamSettings.defaultTeam.subtitle",defaultMessage:"Automatically add all workspace members to this teamspace",description:"Shown as a sub-title for a toggle in teamspace settings that indicates whether the teamspace should be synced with the entire workspace."}),on:F,onChange:()=>{B(!F)},disabled:T})),o()("div",{style:P.buttonContainer},void 0,o()(x,{isLoading:T,onSubmit:W,onDismiss:()=>{h.Mr({permissionsInviteStore:i}),null==s||s()},isNewlyCreatedTeam:a,isDefaultTeamChanged:U,workspaceMembersToInvite:R,includesGroups:O,inviteRole:L}))))}},86100:(e,t,i)=>{i.r(t),i.d(t,{default:()=>l});var a=i(77094),n=i.n(a),s=(i(33948),i(67294),i(28350)),o=i(67719),r=i(30688);const l=function(e){const[t,,i]=(0,s.oR)(e.permissionsInviteStore),a=()=>{i.reset()};return n()(o.Z,{modalStyle:{alignSelf:"center",overflow:"visible",top:0,width:500},open:t.modalOpen,onDismiss:a,renderContent:()=>n()("div",{style:{display:"flex",flexDirection:"column",alignItems:"end",padding:22}},void 0,n()(r.Z,{store:e.store,permissionsInviteStore:i,isNewlyCreatedTeam:!1,onSubmitSuccessful:a,onDismiss:a})),origin:e.origin})}},51923:(e,t,i)=>{i.d(t,{Z:()=>u});var a=i(77094),n=i.n(a),s=(i(67294),i(5366)),o=i(97880),r=i(33665),l=i(74523);function d(e){switch(e){case"bestPractices":return(0,r.UY)("guides.teamspacesLearnMore");case"workspaceOwnerGuide":return(0,r.UY)("guides.teamspacesWorkspaceOwner");case"settingsAndPermissions":return(0,r.UY)("guides.teamspacesSettingsAndPermissions");default:return(0,o.t1)(e)}}function c(e){return e||n()(s.FormattedMessage,{defaultMessage:"Learn about teamspaces",description:"Link that takes a user to a guide with more information about the teamspaces feature.",id:"teamsLearnMoreLink"})}function u(e){let{onClick:t,message:i,helpCenterLocation:a,analyticsFrom:s,containerStyle:o}=e;return n()("div",{style:o},void 0,n()(l.Z,{title:c(i),analyticsFrom:s,href:d(a),onClick:t}))}},62512:(e,t,i)=>{i.d(t,{n:()=>h});var a=i(77094),n=i.n(a),s=i(67294),o=i.n(s),r=i(28350),l=i(24405),d=i(19889),c=i(5366),u=i(23596),m=i(40039),p=i(52738);const g=u.Z.iconSize;function h(e){let{ownerStores:t,teamStore:i}=e;const a=(0,l.y)((e=>({container:{position:"relative",width:g,height:g},offsetIcon:{position:"absolute",bottom:0,right:2},teamBadge:{position:"absolute",bottom:-5,right:-3,background:e.modalBackground,padding:.75,borderRadius:"0.25em"}})),[]),{teamName:s,teamIcon:d}=(0,r.VK)((()=>({teamName:i.getName(),teamIcon:i.getIcon()})),[i]),c=e=>n()(m.Z,{disabled:!0,title:s,icon:d,isEmptyPage:!1,size:e});return 0===t.length?c(g):n()("div",{style:a.container},void 0,t.length>=2?o().createElement(o().Fragment,null,n()(f,{isSmall:!0,store:t[0]}),n()(f,{isSmall:!0,store:t[1],style:a.offsetIcon})):n()(f,{store:t[0]}),n()("div",{style:a.teamBadge},void 0,c(16)))}function f(e){let{store:t,isSmall:i=!1,style:a={}}=e;const s=(0,c.useIntl)(),o=i?22:g,u=(0,l.y)((e=>({icon:{width:o,height:o,borderRadius:o,boxShadow:e.avatarBoxShadow,...a}})),[o,a]),{userValue:h,userName:f}=(0,r.VK)((()=>{const e=null==t?void 0:t.getValue();return{userValue:e,userName:(0,d.Nz)(s,e)}}),[s,t]),v=h?n()(p.Z,{avatarShouldShowShadow:!0,userValue:h,size:o}):n()(m.Z,{bucket:"public",disabled:!0,isEmptyPage:!1,title:f,size:o,icon:void 0});return n()("div",{style:u.icon},void 0,v)}},13380:(e,t,i)=>{i.d(t,{s:()=>m});var a=i(77094),n=i.n(a),s=i(97464),o=i.n(s),r=i(67294),l=i.n(r),d=i(24405),c=i(82990);i(33948);var u=i(37235);function m(e){let{children:t,style:i}=e;const a=(0,r.useRef)(null),s=function(e){const[t,i]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{const{current:t}=e;if(!t)return void i(!1);const a="ResizeObserver"in window?new ResizeObserver((e=>{let[t]=e;i(t.target.scrollWidth>t.target.clientWidth)})):void 0;return null==a||a.observe(t),()=>null==a?void 0:a.unobserve(t)}),[]),t}(a),m=(0,d.y)((()=>({overflowText:{...c.Z.textOverflowStyle,...i}})),[i]);return n()(u.Z,{delayThreshold:500,placement:u.Z.Placement.Bottom,forceVisibleState:!!s&&void 0,renderTooltip:()=>s?t:void 0,render:e=>l().createElement("div",o()({ref:a,style:m.overflowText},e),t)})}},57361:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Me});var a=i(77094),n=i.n(a),s=(i(33948),i(67294)),o=i.n(s),r=i(480),l=i(28350),d=i(24405),c=i(6287),u=i(50906),m=i(54642),p=i(90922),g=i(85997),h=i(26111),f=i(62854),v=i(93561),y=i(39865),S=i(28020),M=i(34174),b=i(93959),w=i(54258),C=i(27832),T=i(72500),k=i(37394),Z=i(15102),A=i(97464),I=i.n(A),P=(i(41817),i(96486)),_=i.n(P),x=i(41892),F=i(53397),B=i(21202),E=i(97880),D=i(5366),R=i(84210),L=i(92350),O=i(82136),N=i(80270),U=i(72693),W=i(48762),V=i(46167),z=i(56508),G=i(80527),H=i(71202),q=i(25584),K=i(47966),j=i(60588),Y=i(66722),Q=i(83071),J=i(14254),X=i(93686),$=i(46951),ee=i(52738);function te(e){const{teamStore:t,preset:i,typedDatabases:a,onAddToTeam:s,...c}=e,u=(0,r.O7)(),m=(0,d.F)(),p=(0,l.VK)((()=>t.getUserIdsInTeam().length),[t]),g=(0,l.VK)((()=>{if(!i)return!1;const e=(0,b.w5)("collection",i);for(const i of e)if("collection"===i.type){var t,n;if((null!==(t=null===(n=a[i.uri])||void 0===n?void 0:n.length)&&void 0!==t?t:0)>0){return a[i.uri][0].getParentBlockStore()}}}),[i,a]),f=g?()=>{g&&(k.Z.reset(),h.navigate({environment:u,url:(0,R.Z)({store:g})}))}:e.onAddToTeam,v=n()(G.Z,g?{isBlue:!0,style:{borderRadius:"100px"},icon:F.Z.arrowRight,onClick:f,caption:n()(D.FormattedMessage,{defaultMessage:"Go",description:"Go to the existing databases",id:"TemplateDetail.TeamItem.goButton"}),captionStyle:{textTransform:"none",color:m.accentColors.blue[400]},hovered:!0}:{isBlue:!0,style:{borderRadius:"100px"},icon:F.Z.plusThick,onClick:f,caption:n()(D.FormattedMessage,{defaultMessage:"Add",description:"Add a new instance of the databases to the team",id:"TemplateDetail.TeamItem.addButton"}),captionStyle:{textTransform:"none",color:m.accentColors.blue[400]},hovered:!0});return o().createElement(W.Z,I()({},c,{style:{width:256,paddingTop:6,paddingBottom:6},icon:n()(X.p,{store:t,size:20}),desktopIconStyle:{alignSelf:"flex-start",marginTop:3},right:c.focused?v:void 0,title:n()("div",{style:{display:"flex",flexDirection:"column"}},void 0,n()(J.o,{teamStore:t}),n()("div",{style:{fontSize:12,color:m.lightTextColor}},void 0,n()(D.FormattedMessage,{defaultMessage:"{numberOfMembers, plural, one {{numberOfMembers} member} other {{numberOfMembers} members}}",values:{numberOfMembers:p},description:"Number of members on a team",id:"TemplateDetail.TeamItem.teamMemberCount"}))),onClick:f}))}function ie(e){var t;const i=(0,r.O7)(),a=(0,d.F)(),s=(0,d.y)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,paddingTop:22,paddingLeft:40,paddingRight:40,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground},heroImg:{height:"100%",width:"100%"}})),[]),[c,m]=(0,l.oR)(k.Z),p=(0,l.VK)((()=>C.default.state.currentUserStore),[]),g=(0,l.VK)((()=>{var e;if(c.open&&"preset"===(null===(e=c.selectedTemplate)||void 0===e?void 0:e.type)){const e=c.selectedTemplate.uri,t=(0,b.SP)(e),i=null==t?void 0:t.presets.find((t=>t.uri===e));if(t&&i)return{currentApp:t,currentPreset:i}}}),[c]),h=(0,l.VK)((()=>{if(!g||!c.open)return;const{currentApp:e,currentPreset:t}=g,i=null==g?void 0:g.currentPreset.allToggleFeatures.filter((e=>!(null!=g&&g.currentPreset.requiredFeatures.some((t=>t.feature===e))))),s=_().join(_().compact(i.slice(0,c.showAllFeatures?i.length:6).map((e=>{var t;return null==g||null===(t=g.currentApp.allFeatures.find((t=>t.uri===e)))||void 0===t?void 0:t.name}))),", ");return o().createElement(o().Fragment,null,n()($.Z,{isSmall:!0,style:{marginTop:20,marginBottom:4}},void 0,n()(D.FormattedMessage,{id:"templateDetail.customizableFeatures.label",defaultMessage:"Features",description:"Label shown in template library listing template features"})),n()("div",{style:{fontSize:14}},void 0,n()("span",{},void 0,s),!c.showAllFeatures&&i.length>6&&o().createElement(o().Fragment,null,n()("span",{},void 0,", "),n()("span",{style:{color:a.lightTextColor,cursor:"pointer"},onClick:()=>m({...c,showAllFeatures:!0})},void 0,"".concat(i.length-6," more...")))),e.presets.length>1&&o().createElement(o().Fragment,null,n()($.Z,{isSmall:!0,style:{marginTop:20,marginBottom:4}},void 0,n()(D.FormattedMessage,{id:"templateDetail.relatedTemplates.label",defaultMessage:"Related templates"})),n()("div",{style:{display:"flex",flexDirection:"row",flexFlow:"wrap",gap:6}},void 0,e.presets.map((e=>{if(e.uri!==t.uri)return n()(K.Z,{style:{borderRadius:5},onClick:()=>{m({...c,selectedTemplate:{type:"preset",uri:e.uri},showAllFeatures:!1})}},void 0,n()("img",{src:e.icon,style:{width:16,height:16,marginLeft:-2}}),n()("span",{style:{marginLeft:6,fontSize:14}},void 0,e.name))})))))}),[g,m,c,a.lightTextColor]),f=(0,l.VK)((()=>{if(!c.open)return;const{selectedTemplate:e}=c;if(e){if("preset"===e.type){var t;if(!g)return;const{currentPreset:e}=g,a=null===(t=e.previews)||void 0===t?void 0:t.find((e=>"previewRootId"in e)),o=a&&new N.Z(i,{table:B.iU,id:a.previewRootId,spaceId:a.spaceId}),r=o?n()("div",{style:{overflow:"hidden"}},void 0,n()(j.Z,{store:o,loadingContainerStore:void 0,context:O.S.InAppTemplatePreview,paddingLeft:4,paddingRight:4,paddingBottom:0,pageCoverHeight:0,titleFontSize:0,disabled:!0},o.id)):n()("img",{style:s.heroImg,src:x.Z.images.appPackages.projectPreview1Png});return[e.name,e.description,n()("img",{src:e.icon,style:{width:30,height:30}}),r]}if("pageTemplate"===e.type){var a;const{template:t}=e,s=new N.Z(i,{table:B.iU,id:t.previewRootId,spaceId:t.spaceId}),o=n()(j.Z,{store:s,loadingContainerStore:void 0,context:O.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:j.Z.defaultPageCoverHeight(i),disabled:!0});return[t.name,t.description,n()("span",{style:{fontSize:20}},void 0,n()(z.Z,{},void 0,null!==(a=t.emoji)&&void 0!==a?a:"")),o]}(0,E.t1)(e)}}),[c,g,i,s]),v=(0,L.E7)(),y=(0,l.VK)((()=>v.filter((e=>e.canAddOrRemoveTopLevelPages()))),[v]),S=o().useCallback((t=>{c.open&&(c.selectedTemplate&&e.onGetTemplateClick(c.selectedTemplate,t),m({open:!1}))}),[e,m,c]);if(!c.open)return null;if(!f)return null;const[M,w,T,Z]=f,A=c.open&&"preset"===(null===(t=c.selectedTemplate)||void 0===t?void 0:t.type),P=n()(V.Z,{renderOrigin:e=>o().createElement(U.Z,I()({},e,{style:{width:182,height:35}}),n()(D.FormattedMessage,{id:"templateDetail.getTemplateButton.label",defaultMessage:"Get template"})),onClick:()=>{(0,u.trackGetTemplateClick)(i,{template_name:M})},render:t=>{let s;s=i.device.isMobile?{menuType:H.Z.MenuType.ActionSheet}:{menuType:H.Z.MenuType.Popup,width:"100%"};const r=y.map((t=>({key:t.id,action:()=>{},render:i=>{var a;return o().createElement(te,I()({teamStore:t,typedDatabases:null!==(a=e.typedDatabases[t.id])&&void 0!==a?a:{},preset:null==g?void 0:g.currentPreset,onAddToTeam:()=>S(t)},i))}})));return o().createElement(H.Z,s,n()(q.Z,{style:{paddingTop:6,paddingBottom:6},type:q.Z.Type.Vertical,initialFocus:void 0,sections:_().compact([r.length>0?{key:"teams",render:e=>o().createElement(Q.Z,I()({},e,{disableDesktopPadding:!0,style:{paddingTop:4,paddingBottom:4},title:"Teamspaces"})),items:r}:void 0,{key:"private",render:e=>o().createElement(Q.Z,I()({},e,{topBorder:r.length>0,disableDesktopPadding:!0,style:{paddingTop:4,paddingBottom:4}})),items:[{key:"private",action:()=>{},render:e=>o().createElement(W.Z,I()({},e,{style:{width:256},icon:n()("div",{style:{position:"relative"}},void 0,n()(ee.Z,{hasTooltip:!1,userValue:null==p?void 0:p.getValue()}),F.Z.lockedFilled({position:"absolute",bottom:-2,right:-2,zIndex:1,width:10,height:10,fill:a.accentColors.red[500]})),title:"Add to Private",onClick:()=>S()}))}]}])}))},originGap:4,popupType:i.device.isMobile?Y.kQ.SlideUp:Y.kQ.Popup});return o().createElement(o().Fragment,null,n()("div",{style:s.container},void 0,n()("div",{style:{position:"relative",height:A?"45%":"70%",overflow:"hidden"}},void 0,n()("div",{style:{position:"absolute",top:-20,left:0,width:"132%",height:"100%",transform:"scale(0.75)",transformOrigin:"left top",opacity:1,zIndex:999,pointerEvents:"none"}},void 0,n()("div",{style:{background:a.hoveredMarginDiscussionBackground,height:24,bottom:0,left:0,position:"absolute"}}),Z)),n()("div",{},void 0,n()("div",{style:{display:"flex",flexDirection:"row",width:"100%",marginTop:20,marginBottom:20,justifyContent:"space-between"}},void 0,n()("div",{style:{display:"flex",flexDirection:"column"}},void 0,n()("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start",marginBottom:20}},void 0,T,n()("div",{style:{display:"flex",flexDirection:"column",marginLeft:10}},void 0,n()("span",{style:{fontSize:20,fontWeight:700,lineHeight:1.2,marginTop:3}},void 0,M))),n()("div",{style:{fontSize:14}},void 0,w),h),n()("div",{style:{paddingLeft:30}},void 0,P,n()($.Z,{isSmall:!0,style:{marginTop:20,marginBottom:4}},void 0,n()(D.FormattedMessage,{id:"templateDetail.madeBy.label",defaultMessage:"Made by"})),n()("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},void 0,n()("img",{src:x.Z.images.notionLogoPng,style:{width:15,height:16}}),n()("span",{style:{fontSize:14,fontWeight:500,marginLeft:5,marginRight:5}},void 0,"Notion")))))))}i(99244);var ae=i(89101),ne=i(68989),se=i(33929),oe=i(60709),re=i(14947);function le(e){const{icon:t,title:i,on:a,wrapStyle:s,innerStyle:o,hideChevron:l}=e,c=(0,d.F)(),u=(0,r.O7)(),m=(0,d.y)((e=>({button:{fontSize:14,display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",borderRadius:32,height:u.device.isMobile?28:24,lineHeight:u.device.isMobile?"28px":"24px",padding:"0 8px",border:"1px solid ".concat(e.outlineButtonBorder),color:e.mediumTextColor,...a&&{color:e.blueColor,border:"1px solid ".concat(e.filterPillBorder),background:e.filterPillBackground},...o}})),[u.device.isMobile,o,a]);return n()("div",{style:{borderRadius:14,marginRight:6,display:"inline-flex",...s}},void 0,n()(re.Z,{style:m.button,hoveredStyle:a?{background:c.outlineBlueButtonHoveredBackground}:void 0,pressedStyle:a?{background:c.outlineBlueButtonPressedBackground}:void 0,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,onDoubleClick:e.onDoubleClick},void 0,t,i,!l&&F.Z.chevronDown({width:10,marginLeft:4,marginTop:1,fill:a?c.blueColor:c.lightIconColor})))}var de=i(62727),ce=i(89206);const ue=(0,D.defineMessages)({allPersona:{id:"templateGallery.sidebar.persona.all",defaultMessage:"All",description:"All"},designPersona:{id:"templateGallery.sidebar.persona.design",defaultMessage:"Design"},engPersona:{id:"templateGallery.sidebar.persona.eng",defaultMessage:"Engineering"},pmPersona:{id:"templateGallery.sidebar.persona.pm",defaultMessage:"Product Management"},marketingPersona:{id:"templateGallery.sidebar.persona.marketing",defaultMessage:"Marketing"},salesPersona:{id:"templateGallery.sidebar.persona.sales",defaultMessage:"Sales"},financePersona:{id:"templateGallery.sidebar.persona.finance",defaultMessage:"Finance"},supportPersona:{id:"templateGallery.sidebar.persona.support",defaultMessage:"Support"},hrPersona:{id:"templateGallery.sidebar.persona.hr",defaultMessage:"Human Resources"}}),me=[ne.Yt.roadmap,ne.Yt.engineeringToDo,ne.Yt.designTasks,ne.Yt.hrMeetingNotes,ne.Yt.pmMeetingNotes,ne.Yt.teamMeetingNotes,ne.Yt.salesMeetingNotes,ne.Yt.designMeetingNotes,ne.Yt.supportMeetingNotes,ne.Yt.marketingMeetingNotes,ne.Yt.engineeringMeetingNotes,ne.Yt.pmDocs,ne.Yt.teamDocs,ne.Yt.engineeringDocs,ne.Yt.supportProcessDocs,ne.Yt.companyGoals,ne.Yt.teamDirectory],pe=[ne.Yt.companyHome,ne.Yt.oneOnOneNotes,ne.Yt.engineeringWiki,ne.Yt.engineeringTechSpec,ne.Yt.productWiki,ne.Yt.productSpec,ne.Yt.productTeamUpdate,ne.Yt.visionAndStrategy,ne.Yt.presentation,ne.Yt.investorUpdate,ne.Yt.designSprint,ne.Yt.designSystem,ne.Yt.designPortfolio,ne.Yt.userResearch,ne.Yt.experimentResults,ne.Yt.dataDeepDive,ne.Yt.brandAssets,ne.Yt.teamWiki,ne.Yt.brainstorm,ne.Yt.projectRetrospective,ne.Yt.productLaunchBrief,ne.Yt.contentCalendar,ne.Yt.blogEditorialCalendar,ne.Yt.socialMediaCalendar,ne.Yt.campaignBrief,ne.Yt.moodBoard,ne.Yt.mediaList,ne.Yt.newHireOnboarding,ne.Yt.employeeBenefits,ne.Yt.interviewGuide,ne.Yt.recruitingTracker,ne.Yt.resume,ne.Yt.jobBoard,ne.Yt.applicantTracker,ne.Yt.peopleDirectory,ne.Yt.productFAQs,ne.Yt.helpCenter,ne.Yt.salesWiki,ne.Yt.salesCRM,ne.Yt.salesAssets,ne.Yt.competitiveAnalysis],ge={design:ue.designPersona,eng:ue.engPersona,pm:ue.pmPersona,marketing:ue.marketingPersona,sales:ue.salesPersona,support:ue.supportPersona,hr:ue.hrPersona},he={design:["notion://projects/projects_preset"],eng:["notion://projects/agile_preset",w.fS("engineeringWiki","preset")],pm:["notion://projects/agile_preset",w.fS("productWiki","preset")],marketing:["notion://projects/projects_preset"],sales:["notion://projects/projects_preset",w.fS("salesWiki","preset")],finance:["notion://projects/projects_preset",w.fS("companyHome","preset")],support:["notion://projects/projects_preset",w.fS("companyHome","preset")],hr:["notion://projects/projects_preset",w.fS("companyHome","preset")]},fe={design:[...ne.Fe("designer",se.default.getIntl()).items,...[ne.Yt.designPortfolio,ne.Yt.designSprint,ne.Yt.brainstorm].map((e=>ne.G_(e,se.default.getIntl())))],eng:[...ne.Fe("programmer",se.default.getIntl()).items,...[ne.Yt.experimentResults,ne.Yt.engineeringTechSpec,ne.Yt.brainstorm,ne.Yt.dataDeepDive,ne.Yt.projectRetrospective].map((e=>ne.G_(e,se.default.getIntl())))],pm:[...ne.Fe("product_manager",se.default.getIntl()).items,...[ne.Yt.investorUpdate,ne.Yt.visionAndStrategy,ne.Yt.teamWiki,ne.Yt.presentation,ne.Yt.experimentResults,ne.Yt.productSpec,ne.Yt.brainstorm,ne.Yt.dataDeepDive,ne.Yt.projectRetrospective,ne.Yt.oneOnOneNotes,ne.Yt.productLaunchBrief].map((e=>ne.G_(e,se.default.getIntl())))],marketing:[...ne.Fe("marketing",se.default.getIntl()).items,...[ne.Yt.presentation,ne.Yt.brainstorm,ne.Yt.blogEditorialCalendar,ne.Yt.socialMediaCalendar,ne.Yt.campaignBrief].map((e=>ne.G_(e,se.default.getIntl())))],sales:ne.Fe("sales",se.default.getIntl()).items,support:ne.Fe("customer_support",se.default.getIntl()).items,hr:[...ne.Fe("hr_recruiting",se.default.getIntl()).items,...[ne.Yt.peopleDirectory,ne.Yt.employeeBenefits,ne.Yt.recruitingTracker,ne.Yt.interviewGuide].map((e=>ne.G_(e,se.default.getIntl())))]};function ve(){const[e,t]=(0,l.oR)(k.Z),[i,a]=(0,s.useState)(""),[c,m]=(0,s.useState)(),p=(0,D.useIntl)(),g=(0,d.F)(),h=(0,r.O7)(),f=(0,d.y)((e=>({sidebar:{height:"100%",width:275,background:e.sidebarBackground,alignContent:"center",paddingTop:12,paddingLeft:12,paddingRight:12,display:"flex",flexDirection:"column",alignItems:"stretch",borderRight:"1px solid ".concat(e.lightDividerColor)},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:14,padding:"16px 10px"},filterBar:{marginBottom:6,display:"flex",flexDirection:"row",width:273,flexWrap:"wrap",gap:6}})),[]),v=()=>n()(V.Z,{popupType:V.Z.PopupType.Popup,renderOrigin:e=>o().createElement(le,I()({on:!0,icon:F.Z.person({width:14,marginRight:6,fill:g.blueColor}),title:n()("span",{},void 0,o().createElement(D.FormattedMessage,c?ge[c]:ue.allPersona))},e)),placementToOrigin:oe.Iw.Bottom,render:e=>(e=>{const t=[{key:"personas",render:e=>o().createElement(Q.Z,I()({},e,{topBorder:0!==e.index})),items:[void 0,...(0,E.Yd)(ge)].map((t=>({key:null!=t?t:"all",render:e=>o().createElement(W.Z,I()({},e,{focused:!1,checkState:_().isEqual(t,c),title:n()("div",{style:{display:"flex",alignItems:"center"}},void 0,o().createElement(D.FormattedMessage,t?ge[t]:ue.allPersona)),shouldWrapCaption:!0})),action:()=>{m(t),e.close(),(0,u.trackTemplateModalPersonaSelection)(h,{persona:null!=t?t:"all"})}})))}],i={menuType:H.Z.MenuType.Popup,width:260};return o().createElement(H.Z,i,n()(q.Z,{type:q.Z.Type.Vertical,initialFocus:void 0,sections:t}))})(e)}),y=(0,l.VK)((()=>{if(!e.open)return;const t=(0,M.pp)().filter((e=>"notion://wiki_app"!==e.uri)).flatMap((e=>e.presets));if(""!==i)return t.filter((e=>e.name.toLowerCase().includes(i.toLowerCase())));const a=t.filter((e=>{var t;return!c||!(null===(t=he[c])||void 0===t||!t.includes(e.uri))}));return a.length>0?a:(0,M.pp)().map((e=>e.presets[0]))}),[i,c,e]);o().useEffect((()=>{var i;if(!e.open)return;const a=null==y||null===(i=y[0])||void 0===i?void 0:i.uri;a&&!e.selectedTemplate&&t({...e,selectedTemplate:{type:"preset",uri:a},showAllFeatures:!1})}),[y,e,t]);const S=(""===i&&c?fe[c]:Object.values(fe).flat()).filter((e=>e.name.toLowerCase().includes(i.toLowerCase()))),b=pe.map((e=>e.sources["en-US"].previewRootId)),w=_().chain(S).uniqBy((e=>e.previewRootId)).filter((e=>void 0===me.find((t=>t.sources["en-US"].previewRootId===e.previewRootId)))).sortBy((e=>b.indexOf(e.previewRootId))).value();return n()("div",{style:f.sidebar},void 0,n()(ce.Z,{capture:!0,onBackspace:_().identity,onLeft:_().identity,onRight:_().identity,onSelectAll:_().identity,onRedo:_().identity,onUndo:_().identity,onCut:_().identity,onCopy:_().identity,onPaste:_().identity,onKeypress:_().identity,onDelete:_().identity,onTab:_().identity},void 0,n()(de.Z,{placeholder:p.formatMessage({id:"templateGallery.sidebar.searchbar.placeholder",defaultMessage:"Search templates"}),left:F.Z.searchThick(f.searchIcon),showClearButton:!0,format:de.Z.Format.Small,value:i,style:f.searchBar,onChange:e=>a(e.target.value)})),n()("div",{style:f.filterBar},void 0,v()),n()(ye,{pageTemplates:w,presets:y||[]}))}function ye(e){const{presets:t,pageTemplates:i}=e,a=(0,d.F)(),s=(0,r.O7)(),o=(0,d.y)((e=>({button:{height:44,padding:"8px 0",borderRadius:5,marginBottom:4,transition:"all 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start"},unSelectedItem:{color:e.mediumTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.whiteButtonBackground,boxShadow:e.lightBoxShadow,fontWeight:500,color:e.regularTextColor},hoveredItem:{borderRadius:5,background:e.buttonHoveredBackground},presetIcon:{width:16,height:16},presetTitle:{fontSize:14,color:e.regularTextColor},presetDescription:{fontSize:12}})),[]);return n()("div",{style:{flexGrow:1,width:"100%",overflowY:"auto"}},void 0,n()(Q.Z,{style:{marginTop:6},desktopTitleStyle:{paddingLeft:8}},void 0,t.map((e=>n()(Se,{icon:e.icon,name:e.name,template:{type:"preset",uri:e.uri}})))),n()(Q.Z,{style:{marginTop:6},topBorder:!0,desktopTitleStyle:{paddingLeft:8}},void 0,i.map((e=>n()(Se,{icon:e.icon,emoji:e.emoji,name:e.name,template:{type:"pageTemplate",template:e}})))),n()(Q.Z,{style:{marginTop:6},topBorder:!0,desktopTitleStyle:{paddingLeft:8}},void 0,n()(W.Z,{desktopIconStyle:{alignSelf:"unset"},focused:!1,buttonStyle:{...o.button},title:n()("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},void 0,n()(D.FormattedMessage,{defaultMessage:"More from the Community",id:"templateGallerySidebar.goToMarketingTemplateGalleryButton.label"}),F.Z.typesRelation({width:12,height:12,marginLeft:8,marginRight:10,marginBottom:0,fill:a.mediumIconColor})),onClick:()=>{(0,u.trackBrowseMoreTemplatesLink)(s),(0,h.navigateToExternalURL)({environment:s,url:ae._j.templates})}})))}function Se(e){var t,i,a;const[s,o]=(0,l.oR)(k.Z),c=(0,r.O7)(),m=(0,d.y)((e=>({button:{height:44,padding:"8px 0",borderRadius:5,marginBottom:4,transition:"all 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start"},unSelectedItem:{color:e.mediumTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.whiteButtonBackground,boxShadow:e.lightBoxShadow,fontWeight:500,color:e.regularTextColor},hoveredItem:{borderRadius:5,background:e.buttonHoveredBackground},presetIcon:{width:16,height:16},presetTitle:{fontSize:14,color:e.regularTextColor},presetDescription:{fontSize:12}})),[]),p=(0,l.VK)((()=>{if(!s.open)return!1;const{selectedTemplate:t}=s;return _().isEqual(t,e.template)}),[e.template,s]);if(!s.open)return null;const g=null!==(t=e.icon)&&void 0!==t&&t.startsWith("/")?n()("img",{src:e.icon,style:m.presetIcon}):n()(z.Z,{},void 0,null!==(i=null!==(a=e.emoji)&&void 0!==a?a:e.icon)&&void 0!==i?i:"");return n()(W.Z,{desktopIconStyle:{alignSelf:"unset"},buttonStyle:{...m.button,...p?m.selectedItem:m.unSelectedItem},focused:!1,icon:g,title:n()("span",{style:m.presetTitle},void 0,e.name),shouldWrapCaption:!0,hoveredStyle:m.hoveredItem,onClick:()=>{o({...s,selectedTemplate:e.template,showAllFeatures:!1}),(0,u.trackTemplateModalItemClick)(c,{template_name:"preset"===e.template.type?e.template.uri:e.template.template.name})}})}function Me(){const e=(0,r.Fy)(),t=(0,r.O7)(),i=(0,d.y)((t=>({modal:{width:e.isMobile?"auto":890,height:e.isMobile?"auto":640,borderRadius:5}})),[e.isMobile]),[a]=(0,l.oR)(k.Z),A=function(e){const t=(0,r.O7)(),[{currentSpaceStore:i}]=(0,l.oR)(C.default),[a,n]=o().useState({});return(0,s.useEffect)((()=>{!async function(){if(!e)return;if(!i)return;const a=await m.getTypedDatabases(t,{spaceId:i.id});if("success"===a.type){const e={};for(const n of a.data.result){var s;const{teamId:a,appUri:o,collectionId:r}=n,l=null!=a?a:"private",d=l in e?e[l]:e[l]={};(null!==(s=d[o])&&void 0!==s?s:d[o]=[]).push(new T.Z(t,{table:c.v,id:r,spaceId:i.id}))}n(e)}}()}),[t,i,e]),a}(a.open),I=async(e,i)=>{const{currentSpaceStore:n,currentSpaceViewStore:s}=C.default.state;if(!a.open)return;const o=(0,S.np)(),r=!a.createNewPage&&o&&o.isEmptyPage()?o:void 0;if("preset"!==e.type||e.uri.startsWith("notion://wiki")){const n="preset"===e.type?(0,w.CQ)(e.uri):e.template;if(!n)return;const{currentSpaceStore:s,currentSpaceViewStore:o}=C.default.state;if(!s||!o)return;let l;l=i?await(0,f.N)({environment:t,spaceStore:s,spaceViewStore:o,teamStore:i,template:n,from:"template_gallery"}):await g.rC({environment:t,item:n,isPrivate:a.isPrivate,spaceStore:s,spaceViewStore:o,useMinimalTemplates:!1,initializeStore:r}),l&&(0,h.navigateToBlock)({environment:t,store:l})}else{var l;const a=e.uri,o=null===(l=(0,b.SP)(a))||void 0===l?void 0:l.uri;if(!o||!n||!s)return;const{performResult:d}=(0,v.createAndCommit)({environment:t,perform:e=>{const s=(0,M.pp)().find((e=>e.uri===o)),r=null==s?void 0:s.presets.find((e=>e.uri===a));if(r){const s=(0,b.KC)(r);return p.ZM({environment:t,appParentStore:null!=i?i:n,appUri:o,preset:a,features:s,transaction:e})}return[]},userAction:"templateGallery.getTemplate"});d&&d.length>0&&((0,h.navigateToBlock)({environment:t,store:d[0]}),r&&(0,y.Tq)({environment:t,blocks:[r]}))}(0,u.trackTemplateModalAccept)(t,{template_name:"preset"===e.type?e.uri:e.template.name})},{open:P}=a;return n()(Z.Z,{open:P,innerStyle:i.modal,onDismiss:()=>k.Z.reset(),render:()=>a.open?n()("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:5,overflow:"hidden"}},void 0,n()(ve,{}),n()(ie,{onGetTemplateClick:I,typedDatabases:A})):null})}},80676:(e,t,i)=>{i.d(t,{s:()=>o,c:()=>r});var a=i(77094),n=i.n(a),s=(i(67294),i(24405));function o(e){return{backgroundColor:e.groupedFormBackground,borderWidth:1,borderStyle:"solid",borderColor:e.groupedFormBorder,borderRadius:3,borderBottomWidth:0}}function r(e){const t=(0,s.y)((t=>({group:{display:"flex",borderBottomColor:t.groupedFormBorder,borderBottomWidth:1,borderBottomStyle:"solid",alignItems:"center",flex:1,...e.style}})),[e.style]);return n()("div",{style:t.group},void 0,e.children)}},33689:(e,t,i)=>{i.d(t,{J:()=>r});var a=i(32918),n=i(97880);var s=i(78291),o=i(21115);function r(e){let{environment:t}=e;const i=(0,o.CM)(t),{data:r}=s.default.state,l=(0,o.XX)(r);return function(e){let{subscriptionTier:t,subscriptionCreatedAtTime:i}=e;return"enterprise"===t||("team"===t||"team_free"===t)&&(0,n.$K)(i)&&i<a.Xn}({subscriptionTier:i,subscriptionCreatedAtTime:null==l?void 0:l.created})}},45660:(e,t,i)=>{i.d(t,{e:()=>d,D:()=>c});var a=i(480),n=i(28350),s=i(33689),o=i(21115),r=i(23537),l=i(27832);function d(){const{currentSpaceStore:e}=(0,n.Kw)(l.default),t=(0,a.O7)();return(0,n.VK)((()=>{var i,a;if(!(0,r.Tp)())return!1;const n=null!==(i=null==e||null===(a=e.state.value)||void 0===a?void 0:a.subscription_tier)&&void 0!==i?i:(0,o.CM)(t);return!("enterprise"===n||"business"===n)}),[e,t])}function c(){const e=(0,a.O7)(),t=d();return(0,n.VK)((()=>t&&!(0,s.J)({environment:e})),[t,e])}},86275:(e,t,i)=>{i.d(t,{U:()=>y});var a=i(77094),n=i.n(a),s=(i(67294),i(480)),o=i(28350),r=i(24405),l=i(53397),d=i(5366),c=i(64684),u=i(93678),m=i(26524);const p=function(e){let{tier:t}=e;const i=()=>n()(d.FormattedMessage,"business"===t?{id:"upgradeToBusinessBadge",description:"Shows Business Plan is required to access feature",defaultMessage:"Business"}:{id:"upgradeToEnterpriseBadge",description:"Shows Enterprise plan is required to access feature",defaultMessage:"Enterprise"});return n()(m.Z,{},void 0,n()(i,{}))};var g=i(27832);var h=i(45660),f=i(35901),v=i(73643);function y(e){let{isCreateTeam:t,teamStore:i,isDefault:a,onChange:y}=e;const M=(0,s.O7)(),b=function(){const{currentSpaceStore:e}=(0,o.Kw)(g.default);return(0,o.VK)((()=>{var t;return null!==(t=null==e?void 0:e.canAdmin())&&void 0!==t&&t}),[e])}(),w=(0,f.y)(null==i?void 0:i.id),C=(0,h.e)(),T=(0,v.Z)(),{isClosedOrPrivateTeamDisabled:k,closedOrPrivateDisabledTooltip:Z}=(0,o.VK)((()=>{var e;return null!==(e=null==i?void 0:i.isDefault())&&void 0!==e&&e?b?w?{isClosedOrPrivateTeamDisabled:!0,closedOrPrivateDisabledTooltip:n()(d.FormattedMessage,{id:"TeamAccessLevelSwitcher.closeOrPrivateTeamspace.disabledTooltipOnlyDefaultTeam",defaultMessage:"Add another default teamspace to change teamspace permissions.",description:"Tooltip text shown when hovering over close or private teamspace button and it is disabled because this is the only default teamspace left."})}:{isClosedOrPrivateTeamDisabled:!1,closedOrPrivateDisabledTooltip:void 0}:{isClosedOrPrivateTeamDisabled:!0,closedOrPrivateDisabledTooltip:n()(d.FormattedMessage,{id:"TeamAccessLevelSwitcher.closeOrPrivateTeamspace.disabledTooltipNonAdmin",defaultMessage:"You can't change this setting because this is a default teamspace. Contact your workspace admin for help.",description:"Tooltip text shown when hovering over close or private teamspace button and it is disabled because user is not a workspace admin."})}:{isClosedOrPrivateTeamDisabled:!1,closedOrPrivateDisabledTooltip:void 0}}),[i,b,w]),A=(0,o.VK)((()=>{var e;const t=null==i?void 0:i.getSettingsStore().getValue();return!!t&&(null!==(e="private"===(0,c.B5)(t))&&void 0!==e&&e)}),[i]),I=(0,r.F)(),P=(0,r.y)((()=>({iconStyle:{width:22,height:22},lockIcon:{width:16,height:16},lockIconContainer:{width:22,height:22,display:"flex",justifyContent:"center",alignItems:"center"}})),[]),_=n()(d.FormattedMessage,"business"===T?{id:"TeamAccessLevelSwitcher.privateTeamspaceUpsellBusiness.tooltip",defaultMessage:"Upgrade to Business Plan to enable Private teamspaces",description:"Tooltip asks user to upgrade to Business Plan to be able to set team as private"}:{id:"TeamAccessLevelSwitcher.privateTeamspaceUpsellEnterprise.tooltip",defaultMessage:"Upgrade to Enterprise Plan to enable Private teamspaces",description:"Tooltip asks user to upgrade to Enterprise Plan to be able to set teamspace as private"}),x=n()(d.FormattedMessage,{id:"TeamAccessLevelSwitcher.openTeamspace.title",defaultMessage:"Open",description:"Toggle title for open teamspace."}),F=n()(d.FormattedMessage,{id:"TeamAccessLevelSwitcher.closedTeamSpace.title",defaultMessage:"Closed",description:"Toggle title for closed teamspace."}),B=n()(d.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamSpace.title",defaultMessage:"Private",description:"Toggle title for private teamspace."});return[{key:"open",icon:e=>l.Z.openTeam({...e,...P.iconStyle}),iconColor:I.teamAccessLevelIcons.blue,level:x,title:a?n()(S,{title:x,badge:n()(m.Z,{},void 0,n()(d.FormattedMessage,{id:"TeamAccessLevelSwitcher.openTeamspace.defaultPill",defaultMessage:"Default",description:"Pill displayed next to the open access level option when a teamspace is a default teamspace."}))}):x,caption:n()(d.FormattedMessage,t?{id:"CreateTeamspaceMenu.openTeamspace.caption",defaultMessage:"Anyone can see and join this teamspace",description:"Toggle caption for open teamspace."}:{id:"TeamAccessLevelSwitcher.openTeamspace.caption",defaultMessage:"Anyone can see and join",description:"Toggle caption for open teamspace."}),disabled:!1,onSelect:()=>y("open"),tooltip:a&&n()(d.FormattedMessage,{id:"TeamAccessLevelSwitcher.openTeamspace.defaultTooltip",defaultMessage:"All workspace members are members of this teamspace",description:"Tooltip displayed when hovering above the open access level option when a teamspace is a default teamspace."})},{key:"closed",icon:e=>n()("div",{style:P.lockIconContainer},void 0,l.Z.unlockedFilled({...e,...P.lockIcon})),iconColor:I.teamAccessLevelIcons.orange,level:F,title:F,caption:n()(d.FormattedMessage,t?{id:"CreateTeamspaceMenu.closedTeamspace.caption",defaultMessage:"Anyone can see this teamspace but not join",description:"Toggle caption for closed teamspace."}:{id:"TeamAccessLevelSwitcher.closedTeamspace.caption",defaultMessage:"Anyone can see but not join",description:"Toggle caption for closed teamspace."}),disabled:k,tooltip:Z,onSelect:()=>y("closed")},{key:"private",icon:e=>n()("div",{style:P.lockIconContainer},void 0,l.Z.lockedFilled({...e,...P.lockIcon})),iconColor:I.teamAccessLevelIcons.red,level:B,title:C?n()(S,{title:B,badge:n()(p,{tier:T})}):B,caption:n()(d.FormattedMessage,t?{id:"CreateTeamspaceMenu.privateTeamspace.caption",defaultMessage:"Only members can see that this teamspace exists",description:"Toggle caption for private teamspace."}:{id:"TeamAccessLevelSwitcher.privateTeamspace.caption",defaultMessage:"Only members can see",description:"Toggle caption for private teamspace."}),disabled:!C&&k||C&&!b,tooltip:C?_:Z,onSelect:()=>{if(C&&!A)return(0,u.y)(M,{from:"team_security_settings",for:T,dontOpenPlansOnCancel:!0});y("private")}}]}function S(e){let{title:t,badge:i}=e;const a=(0,r.y)((()=>({container:{display:"flex",flexWrap:"wrap",alignItems:"center"},badge:{marginLeft:5}})),[]);return n()("div",{style:a.container},void 0,t,n()("div",{style:a.badge},void 0,i))}},73643:(e,t,i)=>{i.d(t,{Z:()=>n});var a=i(92994);const n=function(){return"on"===(0,a.a)("show-business-plan")?"business":"enterprise"}},19234:(e,t,i)=>{i.d(t,{gq:()=>a});i(96486);function a(e){return e.country&&(t=e.country,!["US","CA"].includes(t))?"skip":e.addressLine1&&e.zipCode||e.addressLine1&&e.city&&e.state||e.zipCode?"should_resolve":"insufficient_data";var t}}}]);
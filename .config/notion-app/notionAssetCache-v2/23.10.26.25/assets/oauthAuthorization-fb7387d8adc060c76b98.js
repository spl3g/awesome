"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[370],{41491:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ue});var o=i(77094),n=i.n(o),a=i(77422),s=i.n(a),r=(i(33948),i(85827),i(15306),i(67294)),l=i.n(r),d=i(83355),c=i(24405),p=i(15070),g=i(8848),h=i(53397),u=i(56589),m=i(82036),v=i(26825),S=i(4615),f=i(89101),y=i(21202),w=i(77420),b=i(9844),A=i(9852),k=i(90965),M=i(97880),x=i(82990),P=i(5366),T=i(92625),I=i(36110),z=i(26111),B=i(29974),C=i(21325),_=i(67669),Z=i(38755),N=i(21115),F=i(27832),L=i(95155),E=i(80270),O=i(41952),W=i(62213),R=i(78291),D=i(12318),U=i(72693),V=i(11106),j=i(42402),H=i(68932),G=i(97464),q=i.n(G),Y=i(85767),K=i(37871),$=i(45094),J=i(81236),Q=i(17364),X=i(83071),ee=i(1101),te=i(98285),ie=i(34011),oe=i(31280);class ne extends oe.g6{renderAccountHeader(e){const t=Q.Z.getUserEmailAddress(this.environment,e);return t&&n()(ee.Z,{emailAddress:t,userId:e,disabled:!1,accountActions:[(0,Y.qu)(e)]})}renderFooter(){return n()("div",{style:this.getFooterStyle()},void 0,n()(X.Z,{},void 0,K.k(this.environment)&&l().createElement(te.Z,q()({createType:"add-account",disableLoginLink:this.props.disableLoginLink},this.stores))))}getMenuListSections(e){const{device:t}=this.environment;return[{key:"spaces",render:e=>l().createElement(X.Z,q()({},e,{disableMobilePadding:!0,topBorder:t.isMobile,style:{borderBottom:"1px solid ".concat(this.theme.regularDividerColor)}})),items:this.getSpaceMenuListItems(e)}]}getSpaceMenuListItems(e){const{onSpaceClick:t}=this.props,i=[],{currentUserRootStore:o,currentSpaceStore:a}=F.default.state,s=Q.Z.getSpaceViewStores(this.environment,e);if(!o||!a)return[];s.sort(((e,t)=>{var i,o;const n=Number(Boolean(null===(i=e.getSpaceStore())||void 0===i?void 0:i.canAdmin()));return Number(Boolean(null===(o=t.getSpaceStore())||void 0===o?void 0:o.canAdmin()))-n}));for(const r of s){const s=r.getSpaceStore();if(s){const d=e===o.id&&s.id===a.id,c=(0,Z.getSpaceName)(this.environment,s),p=(0,Z.isGuestOfSpace)(s);let g;const h=J.Z.getPublicSpaceData(this.environment,s.id);if(h){const e=h.productId?this.props.intl.formatMessage((0,$.em)(h.productId)):this.props.intl.formatMessage("team"===s.getPlanType()?$.js.teamTrialPlan:$.js.personalPlan);g=this.props.intl.formatMessage("personal"===s.getPlanType()?$.js.workspaceSubtitleWithoutMembers:$.js.workspaceSubtitleWithMembers,{numberOfWorkspaceMembers:this.props.intl.formatNumber(h.memberCount),planType:e})}i.push({key:r.id,render:e=>l().createElement(ie.Z,q()({},e,{id:r.id,icon:(0,Z.getSpaceIcon)(this.environment,s),title:c,caption:g,isCheck:d,showDragHandle:!1,disabled:p,disableTooltip:!p,tooltipMessage:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.workspaceSwitcher.disabledWorkspace.tooltip",defaultMessage:"This integration can only be added by a member or admin."})})),action:async e=>{let{event:i}=e;this.close(),d||await t({event:i,spaceViewStore:r})}})}}return i}getUnreadCountForOtherSpaces(){return 0}}const ae=(0,P.injectIntl)(ne);var se=i(47966),re=i(40039),le=i(77383);const de=(0,P.defineMessages)({loadingMessage:{id:"oauthAuthorization.loadingMessage",defaultMessage:"Authorizingâ€¦",description:"Loading modal shown when user is authorizing a Notion Integration from our OAuth screen."}});class ce extends d.Z{constructor(){super(...arguments),s()(this,"storeTypes",{authorizationStepStore:D.default.of("permissions"),botAccessOptionStore:D.default.of("duplicate_template"),selectedBlockIdsStore:D.default.of({}),existingBotStore:D.default.of(void 0),isLoading:D.default.of(!1)}),s()(this,"renderErrorOrAuthorizationPage",(()=>{const{responseType:e,integrationId:t}=this.props,{existingBotStore:i}=this.stores,{currentUserRootStore:o,currentSpaceStore:a,currentSpaceViewStore:s,currentUserSettingsStore:r}=F.default.state;if(!(o&&a&&s&&r))return;const l=(0,Z.getSpaceName)(this.environment,a);if(!t||!(0,S.e)(t))return this.renderError({type:m._.invalid_request,body:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.invalidClientId.body",defaultMessage:"Missing or incomplete Client ID. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(j.Z,{href:"https://developers.notion.com/#handling-errors"},void 0,t)}}}),integration:void 0});const d=(0,O.Kv)(o,{table:b.K2,id:t});return d.isReady()?d.state.value?"code"!==e?this.renderError({type:m._.invalid_request,body:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.invalidResponseType",defaultMessage:"Missing or invalid response_type. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(j.Z,{href:"https://developers.notion.com/#handling-errors"},void 0,t)}},description:"Do not translate 'response_type', it's code."}),integration:d.state.value}):i.state&&i.state.created_by_id!==o.id?this.renderError({type:m._.access_denied,title:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationAlreadyInstalled.title",defaultMessage:"This integration has already been added to {workspaceName}",values:{workspaceName:l}}),body:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationAlreadyInstalled.body",defaultMessage:"You can review and remove added integrations in Settings."}),integration:d.state.value,primaryAction:n()(U.Z,{isLarge:!0,onClick:()=>{I.Hx({environment:this.environment,spaceViewStore:s,spaceStore:a,userSettingsStore:r,userRootStore:o})}},void 0,n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationAlreadyInstalled.openWorkspaceSettingsButton.label",defaultMessage:"Open Settings"}))}):this.renderAuthorizationPage(d.state.value):this.renderError({type:m._.invalid_request,body:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.clientNotFound.body",defaultMessage:"Missing or incomplete Client ID. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(j.Z,{href:"https://developers.notion.com/#handling-errors"},void 0,t)}}}),integration:d.state.value}):n()(H.Z,{})})),s()(this,"initializeStores",(async()=>{const{selectedBlockIdsStore:e,existingBotStore:t}=this.stores,{currentUserRootStore:i,currentSpaceStore:o}=F.default.state;if(!i||!o)return;await C.bi(this.environment);const{data:n}=R.default.state;if(!n)return;const a=N.NM(n),s=await this.getExistingBot(a.map((e=>e.botId)));if(!s)return t.reset(),void e.reset();t.setState(s);const r=a.find((e=>e.botId===s.id));r&&e.setState(r.pageIds.reduce(((e,t)=>(e[t]=!0,e)),{}))})),s()(this,"getExistingBot",(async e=>{const{integrationId:t}=this.props,{currentUserRootStore:i,currentSpaceStore:o}=F.default.state;if(!i||!o)return;return(await Promise.all(e.map((async e=>{const t=(0,O.Kv)(i,{table:w.cZ,id:e,spaceId:o.id});return await t.load(),t.getValue()})))).find((e=>e&&e.alive&&(0,p.oA)(e)&&e.parent_id===i.id&&e.integration_id===t))})),s()(this,"switchToPagePickerStep",(()=>{this.stores.authorizationStepStore.setState("page_picker")})),s()(this,"switchToBotAccessOptionStep",(()=>{this.stores.authorizationStepStore.setState("bot_access_option")})),s()(this,"switchToPermissionsStep",(()=>{this.stores.authorizationStepStore.setState("permissions")})),s()(this,"handleSpaceSwitch",(async e=>{const{spaceViewStore:t}=e;await B.ce({environment:this.environment,spaceViewStore:t}),await this.initializeStores()})),s()(this,"handleCancel",(e=>{I.VW({environment:this.environment,params:this.props,integration:e,errorType:m._.access_denied})})),s()(this,"handleAuthorizeWithTemplate",(async e=>{const{integration:t,spaceId:i,currentSpaceStore:o}=e;if("external"===t.type||!t.info.template_page_id)return void this.stores.authorizationStepStore.setState("invalid_template");const n=E.Z.createChildStore(o,{table:y.iU,id:t.info.template_page_id});(0,_.S4)(n)?await this.handleAuthorize({integration:t,spaceId:i,templatePageId:t.info.template_page_id}):this.stores.authorizationStepStore.setState("invalid_template")})),s()(this,"handleAuthorize",(async e=>{const{integration:t,spaceId:i,templatePageId:o}=e,{selectedBlockIdsStore:n,isLoading:a}=this.stores;a.set(!0),T.j({message:de.loadingMessage}),await I.VW({environment:this.environment,params:this.props,integration:t,spaceId:i,blockIdsForBot:o?[]:Object.keys(n.state).filter((e=>n.state[e])),templatePageId:o}),T.x(),a.set(!1)})),s()(this,"handleClickPage",((e,t)=>{const{selectedBlockIdsStore:i}=this.stores;i.setState({...i.state,[e]:!t})})),s()(this,"handleClickSection",(e=>{const{selectedBlockIdsStore:t}=this.stores,i=e.every((e=>t.state[e.id]));t.setState({...t.state,...e.reduce(((e,t)=>(e[t.id]=!i,e)),{})})}))}willMount(){const{responseType:e,integrationId:t,redirectUri:i,state:o,owner:n}=this.props;A.setOauthAuthorizationParams({responseType:e,integrationId:t,redirectUri:i,state:o,owner:n})}async didMount(){const{currentSpaceStore:e,currentSpaceViewStore:t}=F.default.state;e&&t&&e.canAdmin()?await this.initializeStores():await this.setCurrentSpaceToFirstAdminSpace()}renderComponent(){const{currentSpaceStore:e}=F.default.state;if(e)return n()("div",{style:this.getLayoutContainerStyle()},void 0,n()("div",{style:this.getPageContainerStyle()},void 0,n()("div",{style:this.getContentBoxStyle()},void 0,this.renderTopbar(),n()("div",{style:this.getContentBodyStyle()},void 0,this.renderErrorOrAuthorizationPage()))))}renderAuthorizationPage(e){const{redirectUri:t}=this.props,{authorizationStepStore:i}=this.stores,{currentSpaceStore:o,currentSpaceViewStore:a}=F.default.state;if(!o||!a)return;const s=(0,Z.getSpaceName)(this.environment,o);return!o.state.value||(0,Z.isGuestOfSpace)(o)?this.renderError({type:m._.access_denied,title:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.notAnAdmin.title",defaultMessage:"You're not allowed to add integrations to {workspaceName}",values:{workspaceName:s}}),body:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.notAnAdmin.body",defaultMessage:"Contact an admin to grant you access, or switch to another workspace."}),integration:e,primaryAction:n()(U.Z,{isLarge:!0,onClick:()=>W.Z.setState({...W.Z.state,open:!0})},void 0,n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.notAnAdmin.switchWorkspaceButton.label",defaultMessage:"Switch workspace"}))}):o.canAdmin()||this.isIntegrationAllowedByAdmin(e)?u._(e,t)?"permissions"===i.state?this.renderPermissionsStep(e,o):"page_picker"===i.state?this.renderPagePickerStep(e,o):"bot_access_option"===i.state?this.renderBotAccessOptionStep(e,o):"invalid_template"===i.state?this.renderError({type:m._.invalid_request,body:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.invalidTemplate.body",defaultMessage:"The page template is either no longer public or not allowed to be duplicated. <inlinetextlink>Contact the developer</inlinetextlink> for more help.",values:{inlinetextlink:function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return n()(j.Z,{href:"mailto:".concat(e.info.email)},void 0,i)}},description:"This error message appears when a user tries to install an integration with a template but the template is invalid."}),integration:e,primaryAction:n()(U.Z,{isLarge:!0,onClick:this.switchToBotAccessOptionStep},void 0,n()(P.FormattedMessage,{id:"oauthAuthorizationPage.invalidTemplate.backButton.label",defaultMessage:"Back",description:"Text for a button that will take the user back to the previous page"}))}):(0,M.t1)(i.state):this.renderError({type:m._.invalid_request,body:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.invalidRedirectUri.body",defaultMessage:"Missing or invalid redirect_uri. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n()(j.Z,{href:"https://developers.notion.com/#handling-errors"},void 0,t)}},description:"Do not translate 'redirect_uri', it's code."}),integration:e}):this.renderError({type:m._.access_denied,title:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationNotApproved.title",defaultMessage:'You are not permitted to add the integration "{integrationName}" to {workspaceName}',values:{integrationName:e.name,workspaceName:s}}),body:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationNotApproved.body",defaultMessage:"Contact your system administrator for more information."}),integration:e,primaryAction:n()(U.Z,{isLarge:!0,onClick:()=>W.Z.setState({...W.Z.state,open:!0})},void 0,n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.notAnAdmin.switchWorkspaceButton.label",defaultMessage:"Switch workspace"}))})}renderPermissionsStep(e,t){var i,o,a,s,r,d,c,p=this;const g=(0,Z.getSpaceName)(this.environment,t),u=e.info.website_url,m=(0,v.FD)(e.capabilities),S=m?n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.finishButton.label",defaultMessage:"Allow access",description:"This button, once clicked, adds an integration to a user's workspace and automatically gives it access to pages the user has access to."}):he(e)?n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.nextButton.label",defaultMessage:"Next",description:"This button will take a user to the next screen in the OAuth flow for installing integrations."}):n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.continueButton.label",defaultMessage:"Select pages",description:"This button will take a user to a screen where they can choose pages to share with an integration."}),f=m?()=>this.handleAuthorize({integration:e,spaceId:t.id}):he(e)?this.switchToBotAccessOptionStep:this.switchToPagePickerStep;return l().createElement(l().Fragment,null,this.renderIntegrationHeader(e,t),n()("div",{style:{marginBottom:8}},void 0,n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.intro",defaultMessage:"<inlinetextlink>{integrationName}</inlinetextlink> wants to",values:{integrationName:e.name,inlinetextlink:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return u?n()(j.Z,{href:u,style:p.getInlineTextLinkStyle()},void 0,t):t}}})),(null===(i=e.capabilities)||void 0===i?void 0:i.read_content)&&n()(pe,{icon:h.Z.eye,title:n()(P.FormattedMessage,m?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.readContentWithInheritedAccess",defaultMessage:"View pages you have access to",description:"Title for a bot permission that allows the bot to view whatever pages its installing user can view."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.readContent",defaultMessage:"View pages you select",description:"This is one of the things an integration can do once it's added to a user's workspace."})},void 0,n()(P.FormattedMessage,m?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.readContentWithInheritedAccess.description",defaultMessage:'"{integrationName}" will be able to view pages you can view.',values:{integrationName:e.name},description:"Description for a bot permission that allows the bot to view whatever pages its installing user can view."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.readContent.description",defaultMessage:'"{integrationName}" will be able to view pages you select in the next step. You can also share pages later with "{integrationName}" in Notion.',values:{integrationName:e.name}})),(null===(o=e.capabilities)||void 0===o?void 0:o.update_content)&&n()(pe,{icon:h.Z.pencil,title:n()(P.FormattedMessage,m?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.updateContentWithInheritedAccess",defaultMessage:"Edit pages you have access to",description:"Title for a bot permission that allows the bot to edit whatever pages its installing user can edit."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.updateContent",defaultMessage:"Edit pages you select",description:"This is one of the things an integration can do once it's added to a user's workspace."})},void 0,n()(P.FormattedMessage,m?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.updateContentWithInheritedAccess.description",defaultMessage:'"{integrationName}" will be able to edit pages you can edit.',values:{integrationName:e.name},description:"Description for a bot permission that allows the bot to edit whatever pages its installing user can edit."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.updateContent.description",defaultMessage:'"{integrationName}" will be able to edit pages you select in the next step. You can also share pages later with "{integrationName}" in Notion.',values:{integrationName:e.name}})),(null===(a=e.capabilities)||void 0===a?void 0:a.insert_content)&&n()(pe,{icon:h.Z.plus,title:n()(P.FormattedMessage,m?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.insertContentWithInheritedAccess",defaultMessage:"Create new content within pages you have access to",description:"Title for a bot permission that allows the bot to add new content wherever its installing user can add new content."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.insertContent",defaultMessage:"Create new content within pages you select",description:"This is one of the things an integration can do once it's added to a user's workspace."})},void 0,n()(P.FormattedMessage,m?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.insertContentWithInheritedAccess.description",defaultMessage:'"{integrationName}" will be able to add new content or sub-pages wherever you have permission to add new content or sub-pages.',values:{integrationName:e.name,workspaceName:g},description:"Description for a bot permission that allows the bot to add new content wherever its installing user can add new content."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.insertContent.description",defaultMessage:'"{integrationName}" will be able to add new content or sub-pages to pages you select in the next step. You can also share pages later with "{integrationName}" in Notion.',values:{integrationName:e.name,workspaceName:g}})),((null===(s=e.capabilities)||void 0===s?void 0:s.read_user_without_email)||(null===(r=e.capabilities)||void 0===r?void 0:r.read_user_with_email))&&n()(pe,{icon:h.Z.settingsMembers,title:null!==(d=e.capabilities)&&void 0!==d&&d.read_user_with_email?n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.viewUsersAndEmail",defaultMessage:"View workspace users and their emails",description:"This is one of the things an integration can do once it's added to a user's workspace."}):n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.viewUsers",defaultMessage:"View workspace users",description:"This is one of the things an integration can do once it's added to a user's workspace."})},void 0,null!==(c=e.capabilities)&&void 0!==c&&c.read_user_with_email?n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.viewUsersAndEmail.detail",defaultMessage:'"{integrationName}" will be able to see basic information about all workspace members and guest data, including their names, profile images, and email addresses.',values:{integrationName:e.name}}):n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.viewUsers.detail",defaultMessage:'"{integrationName}" will be able to see basic information about all workspace members and guests, like their names and profile images, but not their email addresses.',values:{integrationName:e.name}})),this.renderOptionButtons({leftText:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.cancelButton.label",defaultMessage:"Cancel"}),leftAction:()=>this.handleCancel(e),rightText:S,rightAction:f}),n()("div",{style:{display:"flex",alignItems:"center",marginTop:20}},void 0,t.canAdmin()&&!this.isIntegrationAllowedByAdmin(e)&&n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.integrationApprovalNotice",defaultMessage:"Authorizing this integration will add it to your workspace's approval list. Other workspace members will be able to install this integration."})),this.renderFooter(e))}renderBotAccessOptionStep(e,t){const i="duplicate_template"===this.stores.botAccessOptionStore.getState(),o=n()(P.FormattedMessage,i?{id:"oauthAuthorizationPage.selectPagesStep.finishButton.label",defaultMessage:"Allow access",description:"This button, once clicked, adds an integration to a user's workspace and automatically gives it access to a set of pages the user selected."}:{id:"oauthAuthorizationPage.permissionStep.continueButton.label",defaultMessage:"Select pages",description:"This button will take a user to a screen where they can choose pages to share with an integration."}),a=i?()=>this.handleAuthorizeWithTemplate({integration:e,spaceId:t.id,currentSpaceStore:t}):this.switchToPagePickerStep;return l().createElement(l().Fragment,null,this.renderIntegrationHeader(e,t),n()("div",{style:this.getBotAccessOptionsStyle()},void 0,n()(ge,{title:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.botAccessOption.useTemplate.title",defaultMessage:"Use a template provided by the developer",description:"The user will select this option if they want to duplicate a template when installing an integration."}),subtitle:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.botAccessOption.useTemplate.subtitle",defaultMessage:"{integrationName} can {capabilities} content in a new page you'll create",description:"Explains what will happen when a user decides to duplicate a template when installing an integration.",values:{capabilities:n()(P.FormattedList,{value:(0,le.O)(e.capabilities),type:"conjunction"}),integrationName:e.name}}),icon:h.Z.plus,isSelected:"duplicate_template"===this.stores.botAccessOptionStore.getState(),selectOption:()=>this.stores.botAccessOptionStore.setState("duplicate_template")}),n()(ge,{title:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.botAccessOption.pickPages.title",defaultMessage:"Select pages to to share with {integrationName}",description:"The user will select this option if they want to give bot access to existing pages.",values:{integrationName:e.name}}),subtitle:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.botAccessOption.pickPages.subtitle",defaultMessage:"Select one or multiple pages to share with {integrationName}",description:"Explains what will happen when a user decides to give bot access to existing pages.",values:{integrationName:e.name}}),icon:h.Z.checkboxSquareChecked,isSelected:"pick_pages"===this.stores.botAccessOptionStore.getState(),selectOption:()=>this.stores.botAccessOptionStore.setState("pick_pages")})),this.renderOptionButtons({leftText:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.botAccess.backButton.label",defaultMessage:"Back",description:"Text for a button that will take the user back to the previous page"}),leftAction:this.switchToPermissionsStep,rightText:o,rightAction:a}),this.renderFooter(e))}renderPagePickerStep(e,t){return l().createElement(l().Fragment,null,n()("div",{style:this.getSubtitleStyle()},void 0,n()(P.FormattedMessage,{id:"oauthAuthorizationPage.selectPagesStep.title",defaultMessage:'Allow "{integrationName}" to access these pages',values:{integrationName:e.name}})),n()(V.Z,{onClickPage:this.handleClickPage,onClickSection:this.handleClickSection,selectedBlockIdsStore:this.stores.selectedBlockIdsStore}),this.renderOptionButtons({leftText:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.selectPagesStep.backButton.label",defaultMessage:"Back",description:"Text for a button that will take the user back to the previous page"}),leftAction:he(e)?this.switchToBotAccessOptionStep:this.switchToPermissionsStep,rightText:n()(P.FormattedMessage,{id:"oauthAuthorizationPage.selectPagesStep.finishButton.label",defaultMessage:"Allow access",description:"This button, once clicked, adds an integration to a user's workspace and automatically gives it access to a set of pages the user selected."}),rightAction:()=>this.handleAuthorize({integration:e,spaceId:t.id})}))}renderTopbar(){const{isMobile:e}=this.environment.device;return n()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",height:60,paddingLeft:20,paddingRight:8,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:g.ZP.contentBorder}},void 0,h.Z.notionLogoStroked({width:e?28:30,height:e?28:30,marginRight:10,flexShrink:0}),n()("div",{style:{fontWeight:x.Z.fontWeight.medium,fontSize:16}},void 0,"Notion"),n()("div",{style:{flexGrow:1,flexShrink:1}}),n()("div",{style:{flexShrink:0}},void 0,n()(ae,{format:oe._S.Regular,onSpaceClick:e=>{let{spaceViewStore:t}=e;return this.handleSpaceSwitch({spaceViewStore:t})},shouldShowUnexpandButton:!1,disableLoginLink:!0,buttonStyle:{borderRadius:3,marginBottom:0}})))}renderIntegrationHeader(e,t){var i=this;const o=(0,Z.getSpaceName)(this.environment,t),a=e.info.website_url,s=e.info.icon?{pointer:{table:b.K2,id:e.id},icon:e.info.icon}:void 0;return l().createElement(l().Fragment,null,n()("div",{style:{padding:15}},void 0,n()(re.Z,{icon:s,disabled:!0,title:e.name,size:54,isEmptyPage:!1,style:{margin:"auto"}})),n()("div",{style:this.getTitleStyle()},void 0,n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.title",defaultMessage:"<inlinetextlink>{integrationName}</inlinetextlink> wants to access {workspaceName}",values:{integrationName:e.name,workspaceName:o,inlinetextlink:function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return a?n()(j.Z,{style:{...i.getInlineTextLinkStyle(),fontWeight:x.Z.fontWeight.semibold},href:a},void 0,t):t}}})))}renderOptionButtons(e){return n()("div",{style:this.getButtonGroupStyle()},void 0,n()(se.Z,{isLarge:!0,onClick:e.leftAction,style:{height:32}},void 0,e.leftText),n()(U.Z,{isLarge:!0,onClick:e.rightAction,disabled:this.stores.isLoading.get()},void 0,e.rightText))}renderFooter(e){const t=e.info.terms_of_use_url,i=e.info.privacy_policy_url,o=(this.props.redirectUri||e.redirect_uris[0]||"").replace("http://","").replace("https://","").split(/[/?#]/)[0];return n()("footer",{style:this.getFooterStyle()},void 0,n()("div",{style:{color:this.theme.regularTextColor,fontWeight:x.Z.fontWeight.semibold,marginBottom:4}},void 0," ",n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.warning.title",defaultMessage:'Make sure you trust "{integrationName}" ({redirectUriDomain})',values:{integrationName:e.name,redirectUriDomain:o}})),n()("div",{},void 0,n()(P.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.warning.body",defaultMessage:'If you continue, you may be sharing sensitive information. Notion does not review third party integrations such as "{integrationName}". Learn how "{integrationName}" handles your data by reviewing their <privacypolicylink>Privacy Policy</privacypolicylink> and <termsofservicelink>Terms of Service</termsofservicelink>.',values:{integrationName:e.name,privacypolicylink:function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return i?n()(j.Z,{href:i},void 0,t):t},termsofservicelink:function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return t?n()(j.Z,{href:t},void 0,i):i}}})))}renderError(e){let{integration:t,type:i,title:o,body:a,primaryAction:s}=e;const r=o||n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.genericError.title",defaultMessage:"Something went wrong"});return n()("section",{style:this.getErrorContainerStyle()},void 0,h.Z.genericError(this.getErrorIconStyle()),n()("header",{style:{...this.getTitleStyle(),marginBottom:12}},void 0,r),a&&n()("p",{style:this.getErrorBodyStyle()},void 0,a),s&&n()("div",{style:this.getErrorBodyStyle()},void 0,s),n()(se.Z,{onClick:()=>{I.VW({environment:this.environment,integration:t,errorType:i,params:this.props})}},void 0,n()(P.FormattedMessage,{id:"oauthAuthorizationPage.error.cancelButton.label",defaultMessage:"Cancel"})))}isIntegrationAllowedByAdmin(e){const{currentSpaceStore:t}=F.default.state;if(!t||!t.state.value)return!1;const i=t.state.value.bot_settings;if(!i)return!0;if((0,k.CJ)(i)){const t=i.integration_approval_statuses;return!(!t||!t[e.id])&&Boolean("approved"===t[e.id].status)}return!0}async setCurrentSpaceToFirstAdminSpace(){const{currentUserRootStore:e}=F.default.state;if(e){const t=e.getSpaceViewStores();if(t.length>0){const e=t.find((e=>e.canAdmin()));return void(await this.handleSpaceSwitch({spaceViewStore:e||t[0]}))}}z.navigate({environment:this.environment,url:f._j.login,redirect:!0})}getLayoutContainerStyle(){const{WindowSizeStore:e}=this.environment;return{height:"100%",overflow:"auto",backgroundColor:e.state.width>500?g.ZP.frontCreamBackground:g.ZP.white}}getPageContainerStyle(){return{display:"flex",justifyContent:"center"}}getContentBoxStyle(){const{WindowSizeStore:e}=this.environment,t=e.state.width>500,i=e.state.height<600?16:t?"calc((100vh - 600px) / 2)":0,o=t?this.theme.lightBoxShadow:"none";return{width:"500px",minHeight:"600px",borderRadius:5,backgroundColor:g.ZP.white,boxShadow:o,display:"flex",flexDirection:"column",fontSize:x.Z.fontSize.UIRegular.desktop,marginTop:i,transition:"all 0.2s ease"}}getContentBodyStyle(){return{paddingLeft:40,paddingRight:40,paddingTop:25,paddingBottom:25,flex:1,display:"flex",flexDirection:"column"}}getFooterStyle(){return{fontSize:x.Z.fontSize.UISmall.desktop,color:this.theme.mediumTextColor,paddingTop:32,paddingBottom:16}}getTitleStyle(){const{device:e}=this.environment;return{fontSize:e.isMobile?18:20,margin:"0 50px 32px",textAlign:"center",fontWeight:x.Z.fontWeight.medium}}getSubtitleStyle(){return{fontSize:14,textAlign:"center",fontWeight:x.Z.fontWeight.medium,marginBottom:16}}getButtonGroupStyle(){return{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:24}}getBotAccessOptionsStyle(){return{display:"grid",gridTemplateRows:"1fr 1fr",gap:8,marginTop:8}}getErrorContainerStyle(){return{textAlign:"center",flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}}getErrorIconStyle(){const{device:e}=this.environment,t=e.isMobile?25:48;return{fill:g.ZP.red,width:t,height:t,marginBottom:20,display:"inline-block"}}getErrorBodyStyle(){return{marginTop:0,marginBottom:24,width:"80%"}}getInlineTextLinkStyle(){return{borderBottom:"1px solid rgba(54, 53, 47, 0.2)",color:"black",textDecoration:"none"}}}function pe(e){const[t,i]=(0,r.useState)(!1),o=(0,c.y)((e=>({permissionItem:{display:"flex",justifyContent:"space-between",padding:"6px 0",cursor:"pointer",userSelect:"none"},permissionItemHeading:{display:"flex",alignItems:"center"},permissionItemDetails:{paddingLeft:32,transition:"all 0.2s ease",color:e.mediumTextColor},rightStyle:{width:22,height:18},sharedIconStyle:{width:24,height:16,textAlign:"center",marginRight:8}})),[]);return l().createElement(l().Fragment,null,n()("div",{style:o.permissionItem,onClick:()=>i(!t)},void 0,n()("div",{style:o.permissionItemHeading},void 0,n()("div",{style:o.sharedIconStyle},void 0,e.icon({width:16,height:16,color:g.ZP.regularIconColor})),n()("div",{},void 0,e.title)),e.children&&n()("div",{},void 0,h.Z.chevronDownThin({width:12,height:12,color:g.ZP.lightIconColor,transform:t?"rotate(180deg)":void 0,transition:"transform 0.2s ease"}))),n()("div",{style:{...o.permissionItemDetails,opacity:t?1:0,flex:t?1:0,paddingBottom:t?8:0,transform:t?"translate3d(0,-4px,0)":"translate3d(0,-8px,0)"}},void 0,t&&e.children))}function ge(e){const{title:t,subtitle:i,icon:o,isSelected:a,selectOption:s}=e,r=(0,c.y)((()=>({button:{height:"none",padding:12,width:"100%"},option:{width:"100%",whiteSpace:"normal",display:"grid",gridTemplateColumns:"min-content auto min-content",padding:6},text:{overflowWrap:"normal"},title:{fontSize:16,lineHeight:"16px",fontWeight:x.Z.fontWeight.medium,color:g.ZP.frontTextMedium,marginBottom:6},subtitle:{fontSize:15,color:g.ZP.frontTextLight},icon:{width:14,height:14,color:g.ZP.regularIconColor,marginRight:12}})),[]);return n()(se.Z,{onClick:s,style:r.button,hovered:a},void 0,n()("div",{style:r.option},void 0,o(r.icon),n()("div",{style:r.text},void 0,n()("div",{style:r.title},void 0,t),n()("div",{style:r.subtitle},void 0,i)),a&&h.Z.check(r.icon)))}function he(e){return"on"===L.default.getEligibleGroup({experimentId:"oauth_template_duplication",defaultGroup:"control"})&&"external"!==e.type&&(0,M.$K)(e.info.template_page_id)}const ue=(0,P.injectIntl)(ce)},27386:(e,t,i)=>{i.d(t,{Z:()=>p});var o=i(77094),n=i.n(o),a=(i(67294),i(83355)),s=i(20088),r=i(29368),l=i(11082),d=i(80172);class c extends a.Z{static renderDivider(){return n()(r.Z,{size:37})}renderComponent(){const{device:e}=this.environment,{children:t,controlRow:i,paddingLeftRight:o,bannerText:a}=this.props,r=()=>o||(e.isMobile?18:60),c=()=>e.isMobile?18:36;return this.props.disableScroller?n()("div",{style:{paddingLeft:r(),paddingRight:r()}},void 0,n()("div",{style:{paddingTop:c(),paddingBottom:c()}},void 0,t),i&&n()("div",{style:{paddingTop:16,paddingBottom:16,boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor)}},void 0,i)):n()("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%",backgroundColor:this.theme.cardContentBackground}},void 0,a&&n()(s.Z,{type:s.$.Blue,isMobile:!1},void 0,a),n()(l.Z,{type:d.Z.All,style:{flexGrow:1,WebkitOverflowScrolling:"touch",transform:"translateZ(0)",paddingLeft:r(),paddingRight:r(),paddingTop:a?15:c(),paddingBottom:a?22:c()}},void 0,t),i&&n()("div",{style:{flexGrow:0,flexShrink:0,paddingLeft:r(),paddingRight:r(),paddingTop:16,paddingBottom:16,boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor)}},void 0,i))}}const p=c},40235:(e,t,i)=>{i.d(t,{Z:()=>p});var o=i(77094),n=i.n(o),a=i(77422),s=i.n(a),r=(i(67294),i(83355)),l=i(82990),d=i(46951);class c extends r.Z{renderComponent(){const{columns:e,rows:t,cellStyle:i,tableStyle:o,hideHeader:a}=this.props;return n()("table",{style:{...this.getStyle(),...o}},void 0,!a&&n()("thead",{},void 0,n()("tr",{style:c.headerRowStyle},void 0,e.map((e=>n()("th",{style:{...c.tableHeaderStyle,...e.style}},e.key,n()(d.Z,{isSmall:!0},void 0,e.header)))))),n()("tbody",{},void 0,t.map((t=>n()("tr",{style:this.getRowStyle()},t.key,t.columns.map(((t,o)=>{const a=e[o];return n()("td",{style:{...c.cellStyle,...i}},a.key,t)})))))))}getStyle(){return{width:"100%",fontSize:13,borderTop:"1px solid ".concat(this.theme.regularDividerColor),borderBottom:"1px solid ".concat(this.theme.regularDividerColor)}}getRowStyle(){return{width:"100%",borderTop:"1px solid ".concat(this.theme.regularDividerColor)}}}s()(c,"cellPaddingTopBottom",8),s()(c,"headerRowStyle",{height:32,width:"100%"}),s()(c,"tableHeaderStyle",{fontWeight:l.Z.fontWeight.regular,textAlign:"left",paddingTop:c.cellPaddingTopBottom,paddingBottom:c.cellPaddingTopBottom}),s()(c,"cellStyle",{paddingTop:c.cellPaddingTopBottom,paddingBottom:c.cellPaddingTopBottom});const p=c}}]);